"use strict";(self.webpackChunkshop_management_frontend=self.webpackChunkshop_management_frontend||[]).push([[136],{6136:(ci,st,l)=>{l.r(st),l.d(st,{DeliveryModule:()=>ei});var h=l(177),g=l(9417),Z=l(5911),p=l(5596),v=l(8834),M=l(2102),T=l(9631),B=l(2798),W=l(5084),J=l(6600),u=l(9159),K=l(6695),R=l(2042),k=l(9213),F=l(6471),w=l(9183),x=l(5416),O=l(5351),q=l(9454),H=l(6850),tt=l(450),ht=l(7575),_t=l(1975),I=l(9115),et=l(4823),Q=l(6233),nt=l(1997),A=l(3902),$=l(1188),S=l(4978),N=l(400),L=l(1413),G=l(605),d=l(6977),ft=l(8032),_=l.n(ft),t=l(7705),P=l(1626),rt=l(4412),U=l(7673),b=l(9437),E=l(8141),j=l(2525),Ct=l(6932);let ct=(()=>{class r{constructor(e,n){this.http=e,this.firebaseService=n,this.apiUrl=`${j.c.apiUrl}/delivery`,this.currentAssignmentSubject=new rt.t(null),this.currentAssignment$=this.currentAssignmentSubject.asObservable()}getAvailablePartners(e){return this.http.get(`${this.apiUrl}/partners/available`,{params:(new P.Nl).set("orderId",e.toString())}).pipe((0,b.W)(n=>(console.error("Error fetching available partners:",n),(0,U.of)([]))))}autoAssignDeliveryPartner(e){return this.http.post(`${this.apiUrl}/orders/${e}/auto-assign`,{}).pipe((0,E.M)(n=>{this.currentAssignmentSubject.next(n),this.firebaseService.sendDeliveryNotification(n.partnerPhone,"New Delivery Assignment",`You have a new delivery for order #${n.orderNumber}`),_().fire({title:"Partner Assigned!",text:`${n.partnerName} has been assigned to this order.`,icon:"success",timer:3e3})}),(0,b.W)(n=>{throw console.error("Error auto-assigning partner:",n),_().fire("Error","No delivery partners available. Please try manual assignment.","error"),n}))}assignDeliveryPartner(e,n){return this.http.post(`${this.apiUrl}/orders/${e}/assign`,{partnerId:n}).pipe((0,E.M)(i=>{this.currentAssignmentSubject.next(i),this.firebaseService.sendDeliveryNotification(i.partnerPhone,"New Delivery Assignment",`You have a new delivery for order #${i.orderNumber}`),_().fire({title:"Partner Assigned!",text:`Delivery partner has been assigned to order #${i.orderNumber}.`,icon:"success",timer:3e3})}),(0,b.W)(i=>{throw console.error("Error assigning partner:",i),_().fire("Error","Failed to assign delivery partner","error"),i}))}getAssignment(e){return this.http.get(`${this.apiUrl}/assignments/${e}`).pipe((0,E.M)(n=>this.currentAssignmentSubject.next(n)),(0,b.W)(n=>{throw console.error("Error fetching assignment:",n),n}))}getPartnerAssignments(e,n){let i=new P.Nl;return n&&(i=i.set("status",n)),this.http.get(`${this.apiUrl}/partners/${e}/assignments`,{params:i}).pipe((0,b.W)(a=>(console.error("Error fetching partner assignments:",a),(0,U.of)([]))))}acceptAssignment(e){return this.http.post(`${this.apiUrl}/assignments/${e}/accept`,{}).pipe((0,E.M)(n=>{this.currentAssignmentSubject.next(n),_().fire({title:"Assignment Accepted!",text:"You have accepted this delivery assignment.",icon:"success",timer:2e3})}),(0,b.W)(n=>{throw console.error("Error accepting assignment:",n),_().fire("Error","Failed to accept assignment","error"),n}))}rejectAssignment(e,n){return this.http.post(`${this.apiUrl}/assignments/${e}/reject`,{reason:n}).pipe((0,E.M)(()=>{this.currentAssignmentSubject.next(null),_().fire({title:"Assignment Rejected",text:"The assignment has been rejected.",icon:"info",timer:2e3})}),(0,b.W)(i=>{throw console.error("Error rejecting assignment:",i),_().fire("Error","Failed to reject assignment","error"),i}))}startPickup(e){return this.http.post(`${this.apiUrl}/assignments/${e}/start-pickup`,{}).pipe((0,E.M)(n=>{this.currentAssignmentSubject.next(n),_().fire({title:"Pickup Started",text:"Heading to pickup location...",icon:"info",timer:2e3})}),(0,b.W)(n=>{throw console.error("Error starting pickup:",n),_().fire("Error","Failed to start pickup","error"),n}))}verifyPickupOTP(e,n){return this.http.post(`${this.apiUrl}/assignments/${e}/verify-pickup`,{assignmentId:e,otp:n,type:"PICKUP"}).pipe((0,E.M)(a=>{this.currentAssignmentSubject.next(a),this.firebaseService.sendOrderNotification(a.orderNumber,"OUT_FOR_DELIVERY","Your order is out for delivery!"),_().fire({title:"Pickup Completed!",text:"Order picked up successfully. Heading to delivery location.",icon:"success",timer:3e3})}),(0,b.W)(a=>{throw console.error("Error verifying pickup OTP:",a),_().fire("Error","Invalid OTP. Please try again.","error"),a}))}startDelivery(e){return this.http.post(`${this.apiUrl}/assignments/${e}/start-delivery`,{}).pipe((0,E.M)(n=>{this.currentAssignmentSubject.next(n),_().fire({title:"Delivery Started",text:"Heading to delivery location...",icon:"info",timer:2e3})}),(0,b.W)(n=>{throw console.error("Error starting delivery:",n),_().fire("Error","Failed to start delivery","error"),n}))}verifyDeliveryOTP(e,n,i){const a=new FormData;return a.append("assignmentId",e.toString()),a.append("otp",n),a.append("type","DELIVERY"),i&&a.append("proofImage",i),this.http.post(`${this.apiUrl}/assignments/${e}/verify-delivery`,a).pipe((0,E.M)(s=>{this.currentAssignmentSubject.next(s),this.firebaseService.sendOrderNotification(s.orderNumber,"DELIVERED","Your order has been delivered successfully!"),_().fire({title:"Delivery Completed!",html:`\n            <div>\n              <p>Order delivered successfully!</p>\n              <p><strong>Earnings: \u20b9${s.earnings}</strong></p>\n            </div>\n          `,icon:"success",confirmButtonText:"Great!"})}),(0,b.W)(s=>{throw console.error("Error verifying delivery OTP:",s),_().fire("Error","Invalid OTP. Please try again.","error"),s}))}updateLocation(e,n,i){return this.http.post(`${this.apiUrl}/partners/${e}/location`,{latitude:n,longitude:i}).pipe((0,b.W)(a=>(console.error("Error updating location:",a),(0,U.of)(null))))}getTrackingInfo(e){return this.http.get(`${this.apiUrl}/assignments/${e}/tracking`).pipe((0,b.W)(n=>(console.error("Error fetching tracking info:",n),(0,U.of)({partnerLocation:null,estimatedTime:"Calculating...",status:"UNKNOWN"}))))}toggleOnlineStatus(e,n){return this.http.post(`${this.apiUrl}/partners/${e}/status`,{isOnline:n}).pipe((0,E.M)(()=>{_().fire({title:n?"You are Online!":"You are Offline",text:n?"You will receive delivery requests.":"You will not receive new requests.",icon:"info",timer:2e3})}),(0,b.W)(i=>{throw console.error("Error toggling online status:",i),_().fire("Error","Failed to update status","error"),i}))}getPartnerEarnings(e,n="today"){return this.http.get(`${this.apiUrl}/partners/${e}/earnings`,{params:(new P.Nl).set("period",n)}).pipe((0,b.W)(()=>(0,U.of)({totalEarnings:0,completedDeliveries:0,pendingEarnings:0,averageRating:0})))}reportIssue(e,n,i){return this.http.post(`${this.apiUrl}/assignments/${e}/report-issue`,{issue:n,description:i}).pipe((0,E.M)(()=>{_().fire({title:"Issue Reported",text:"Your issue has been reported to support.",icon:"info",timer:3e3})}),(0,b.W)(a=>{throw console.error("Error reporting issue:",a),_().fire("Error","Failed to report issue","error"),a}))}static{this.\u0275fac=function(n){return new(n||r)(t.KVO(P.Qq),t.KVO(Ct.f))}}static{this.\u0275prov=t.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function Pt(r,o){1&r&&(t.j41(0,"span",12)(1,"mat-icon"),t.EFF(2,"wifi"),t.k0s(),t.EFF(3," Online "),t.k0s())}function vt(r,o){1&r&&(t.j41(0,"span",13)(1,"mat-icon"),t.EFF(2,"wifi_off"),t.k0s(),t.EFF(3," Offline "),t.k0s())}function Ot(r,o){1&r&&t.EFF(0,"Accepted")}function Mt(r,o){1&r&&t.EFF(0,"Pickup")}function bt(r,o){1&r&&t.EFF(0,"Delivery")}function kt(r,o){if(1&r){const e=t.RV6();t.j41(0,"button",30),t.bIt("click",function(){t.eBV(e);const i=t.XpG(3);return t.Njj(i.startPickup())}),t.j41(1,"mat-icon"),t.EFF(2,"directions"),t.k0s(),t.EFF(3," Start Pickup "),t.k0s()}}function Ft(r,o){if(1&r){const e=t.RV6();t.j41(0,"div",31)(1,"mat-form-field")(2,"mat-label"),t.EFF(3,"Enter Shop OTP"),t.k0s(),t.j41(4,"input",32),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG(3);return t.Njj(a.otpInput=i)}),t.k0s()(),t.j41(5,"button",33),t.bIt("click",function(){t.eBV(e);const i=t.XpG(3);return t.Njj(i.verifyPickupOTP())}),t.j41(6,"mat-icon"),t.EFF(7,"verified"),t.k0s(),t.EFF(8," Verify & Pickup "),t.k0s()()}if(2&r){const e=t.XpG(3);t.R7$(4),t.Y8G("ngModel",e.otpInput)}}function yt(r,o){if(1&r&&(t.j41(0,"div",26)(1,"h3")(2,"mat-icon"),t.EFF(3,"store"),t.k0s(),t.EFF(4," Pickup Location"),t.k0s(),t.j41(5,"p"),t.EFF(6),t.k0s(),t.j41(7,"div",27),t.DNE(8,kt,4,0,"button",28),t.DNE(9,Ft,9,1,"div",29),t.k0s()()),2&r){const e=t.XpG(2);t.R7$(6),t.JRh(e.currentAssignment.pickupAddress),t.R7$(2),t.Y8G("ngIf","ACCEPTED"===e.currentAssignment.status),t.R7$(1),t.Y8G("ngIf","PICKUP_STARTED"===e.currentAssignment.status)}}function xt(r,o){if(1&r){const e=t.RV6();t.j41(0,"button",30),t.bIt("click",function(){t.eBV(e);const i=t.XpG(3);return t.Njj(i.startDelivery())}),t.j41(1,"mat-icon"),t.EFF(2,"directions"),t.k0s(),t.EFF(3," Start Delivery "),t.k0s()}}function Et(r,o){if(1&r){const e=t.RV6();t.j41(0,"div",31)(1,"mat-form-field")(2,"mat-label"),t.EFF(3,"Enter Customer OTP"),t.k0s(),t.j41(4,"input",32),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG(3);return t.Njj(a.otpInput=i)}),t.k0s()(),t.j41(5,"button",33),t.bIt("click",function(){t.eBV(e);const i=t.XpG(3);return t.Njj(i.verifyDeliveryOTP())}),t.j41(6,"mat-icon"),t.EFF(7,"verified"),t.k0s(),t.EFF(8," Complete Delivery "),t.k0s()()}if(2&r){const e=t.XpG(3);t.R7$(4),t.Y8G("ngModel",e.otpInput)}}function Dt(r,o){if(1&r&&(t.j41(0,"div",26)(1,"h3")(2,"mat-icon"),t.EFF(3,"home"),t.k0s(),t.EFF(4," Delivery Location"),t.k0s(),t.j41(5,"p"),t.EFF(6),t.k0s(),t.j41(7,"div",27),t.DNE(8,xt,4,0,"button",28),t.DNE(9,Et,9,1,"div",29),t.k0s()()),2&r){const e=t.XpG(2);t.R7$(6),t.JRh(e.currentAssignment.deliveryAddress),t.R7$(2),t.Y8G("ngIf","PICKED_UP"===e.currentAssignment.status),t.R7$(1),t.Y8G("ngIf","DELIVERY_STARTED"===e.currentAssignment.status)}}const wt=function(){return["PICKED_UP","DELIVERY_STARTED","DELIVERED"]},It=function(){return["ACCEPTED","PICKUP_STARTED"]},jt=function(){return["PICKED_UP","DELIVERY_STARTED"]};function St(r,o){if(1&r){const e=t.RV6();t.j41(0,"mat-card",14)(1,"mat-card-header")(2,"mat-card-title"),t.EFF(3),t.j41(4,"mat-chip")(5,"mat-icon"),t.EFF(6),t.k0s(),t.EFF(7),t.k0s()()(),t.j41(8,"mat-card-content")(9,"div",15)(10,"mat-stepper",16,17)(12,"mat-step",18),t.DNE(13,Ot,1,0,"ng-template",19),t.k0s(),t.j41(14,"mat-step",18),t.DNE(15,Mt,1,0,"ng-template",19),t.k0s(),t.j41(16,"mat-step",18),t.DNE(17,bt,1,0,"ng-template",19),t.k0s()()(),t.DNE(18,yt,10,3,"div",20),t.DNE(19,Dt,10,3,"div",20),t.j41(20,"div",21)(21,"div",22)(22,"mat-icon"),t.EFF(23,"route"),t.k0s(),t.j41(24,"span"),t.EFF(25),t.k0s()(),t.j41(26,"div",22)(27,"mat-icon"),t.EFF(28,"schedule"),t.k0s(),t.j41(29,"span"),t.EFF(30),t.k0s()(),t.j41(31,"div",22)(32,"mat-icon"),t.EFF(33,"payments"),t.k0s(),t.j41(34,"span"),t.EFF(35),t.k0s()()(),t.j41(36,"div",23)(37,"button",24),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.callCustomer())}),t.j41(38,"mat-icon"),t.EFF(39,"phone"),t.k0s(),t.EFF(40," Call Customer "),t.k0s(),t.j41(41,"button",24),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.openNavigation(i.currentAssignment.status.includes("PICKUP")?i.currentAssignment.pickupAddress:i.currentAssignment.deliveryAddress))}),t.j41(42,"mat-icon"),t.EFF(43,"navigation"),t.k0s(),t.EFF(44," Navigate "),t.k0s(),t.j41(45,"button",25),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.reportIssue())}),t.j41(46,"mat-icon"),t.EFF(47,"warning"),t.k0s(),t.EFF(48," Report Issue "),t.k0s()()()()}if(2&r){const e=t.XpG();t.R7$(3),t.SpI(" Active Delivery - Order #",e.currentAssignment.orderNumber," "),t.R7$(1),t.xc7("background-color",e.getStatusColor(e.currentAssignment.status)),t.R7$(2),t.JRh(e.getStatusIcon(e.currentAssignment.status)),t.R7$(1),t.SpI(" ",e.currentAssignment.status," "),t.R7$(5),t.Y8G("completed","ASSIGNED"!==e.currentAssignment.status),t.R7$(2),t.Y8G("completed",t.lJ4(13,wt).includes(e.currentAssignment.status)),t.R7$(2),t.Y8G("completed","DELIVERED"===e.currentAssignment.status),t.R7$(2),t.Y8G("ngIf",t.lJ4(14,It).includes(e.currentAssignment.status)),t.R7$(1),t.Y8G("ngIf",t.lJ4(15,jt).includes(e.currentAssignment.status)),t.R7$(6),t.SpI("Distance: ",e.currentAssignment.distance," km"),t.R7$(5),t.SpI("Est. Time: ",e.currentAssignment.estimatedTime,""),t.R7$(5),t.SpI("Earnings: \u20b9",e.currentAssignment.earnings,"")}}function Tt(r,o){if(1&r){const e=t.RV6();t.j41(0,"mat-card",37)(1,"mat-card-header")(2,"mat-card-title"),t.EFF(3),t.j41(4,"mat-chip",38),t.EFF(5,"New"),t.k0s()()(),t.j41(6,"mat-card-content")(7,"div",39)(8,"div",40)(9,"mat-icon"),t.EFF(10,"store"),t.k0s(),t.j41(11,"span"),t.EFF(12),t.k0s()(),t.j41(13,"div",40)(14,"mat-icon"),t.EFF(15,"home"),t.k0s(),t.j41(16,"span"),t.EFF(17),t.k0s()(),t.j41(18,"div",40)(19,"mat-icon"),t.EFF(20,"route"),t.k0s(),t.j41(21,"span"),t.EFF(22),t.k0s(),t.j41(23,"mat-icon"),t.EFF(24,"schedule"),t.k0s(),t.j41(25,"span"),t.EFF(26),t.k0s()(),t.j41(27,"div",41)(28,"mat-icon"),t.EFF(29,"payments"),t.k0s(),t.j41(30,"strong"),t.EFF(31),t.k0s()()()(),t.j41(32,"mat-card-actions")(33,"button",30),t.bIt("click",function(){const a=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.acceptAssignment(a))}),t.j41(34,"mat-icon"),t.EFF(35,"check"),t.k0s(),t.EFF(36," Accept "),t.k0s(),t.j41(37,"button",25),t.bIt("click",function(){const a=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.rejectAssignment(a))}),t.j41(38,"mat-icon"),t.EFF(39,"close"),t.k0s(),t.EFF(40," Decline "),t.k0s()()()}if(2&r){const e=o.$implicit;t.R7$(3),t.SpI(" Order #",e.orderNumber," "),t.R7$(9),t.JRh(e.pickupAddress),t.R7$(5),t.JRh(e.deliveryAddress),t.R7$(5),t.SpI("",e.distance," km"),t.R7$(4),t.JRh(e.estimatedTime),t.R7$(5),t.SpI("\u20b9",e.earnings,"")}}function Rt(r,o){1&r&&(t.j41(0,"div",42)(1,"mat-icon"),t.EFF(2,"inbox"),t.k0s(),t.j41(3,"p"),t.EFF(4,"No deliveries available"),t.k0s(),t.j41(5,"p",43),t.EFF(6,"New deliveries will appear here automatically"),t.k0s()())}function At(r,o){if(1&r&&(t.j41(0,"div")(1,"h2"),t.EFF(2,"Available Deliveries"),t.k0s(),t.j41(3,"div",34),t.DNE(4,Tt,41,6,"mat-card",35),t.DNE(5,Rt,7,0,"div",36),t.k0s()()),2&r){const e=t.XpG();t.R7$(4),t.Y8G("ngForOf",e.availableAssignments),t.R7$(1),t.Y8G("ngIf",0===e.availableAssignments.length)}}function $t(r,o){if(1&r){const e=t.RV6();t.j41(0,"div",44)(1,"mat-card")(2,"mat-card-content")(3,"mat-icon"),t.EFF(4,"wifi_off"),t.k0s(),t.j41(5,"h3"),t.EFF(6,"You are Offline"),t.k0s(),t.j41(7,"p"),t.EFF(8,"Go online to receive delivery requests"),t.k0s(),t.j41(9,"button",30),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.toggleOnlineStatus())}),t.j41(10,"mat-icon"),t.EFF(11,"wifi"),t.k0s(),t.EFF(12," Go Online "),t.k0s()()()()}}function Nt(r,o){if(1&r&&(t.j41(0,"mat-list-item")(1,"mat-icon",47),t.EFF(2,"done_all"),t.k0s(),t.j41(3,"div",48),t.EFF(4),t.k0s(),t.j41(5,"div",49),t.EFF(6),t.nI1(7,"date"),t.k0s(),t.j41(8,"span",50),t.EFF(9),t.k0s()()),2&r){const e=o.$implicit;t.R7$(4),t.SpI("Order #",e.orderNumber,""),t.R7$(2),t.JRh(t.i5U(7,3,e.actualDeliveryTime,"short")),t.R7$(3),t.SpI("\u20b9",e.earnings,"")}}function Lt(r,o){if(1&r&&(t.j41(0,"div",45)(1,"h3"),t.EFF(2,"Today's Completed Deliveries"),t.k0s(),t.j41(3,"mat-list"),t.DNE(4,Nt,10,6,"mat-list-item",46),t.k0s()()),2&r){const e=t.XpG();t.R7$(4),t.Y8G("ngForOf",e.completedAssignments)}}let Gt=(()=>{class r{constructor(e){this.deliveryService=e,this.destroy$=new L.B,this.partnerId=1,this.isOnline=!1,this.currentAssignment=null,this.availableAssignments=[],this.completedAssignments=[],this.todayEarnings={totalEarnings:0,completedDeliveries:0,pendingEarnings:0,averageRating:0},this.otpInput="",this.currentLocation={latitude:0,longitude:0},this.selectedTab=0,this.loading=!1}ngOnInit(){this.loadPartnerId(),this.loadCurrentAssignment(),this.loadAssignments(),this.loadEarnings(),this.startLocationTracking()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadPartnerId(){const e=localStorage.getItem("currentUser");if(e){const n=JSON.parse(e);this.partnerId=n.partnerId||n.id||1}}toggleOnlineStatus(){this.isOnline=!this.isOnline,this.deliveryService.toggleOnlineStatus(this.partnerId,this.isOnline).pipe((0,d.Q)(this.destroy$)).subscribe({next:()=>{this.isOnline&&this.loadAssignments()},error:e=>{console.error("Error toggling status:",e),this.isOnline=!this.isOnline}})}loadCurrentAssignment(){this.deliveryService.currentAssignment$.pipe((0,d.Q)(this.destroy$)).subscribe(e=>{this.currentAssignment=e})}loadAssignments(){this.isOnline&&(this.loading=!0,this.deliveryService.getPartnerAssignments(this.partnerId,"PENDING").pipe((0,d.Q)(this.destroy$)).subscribe(e=>{this.availableAssignments=e,this.loading=!1,e.length>0&&(this.playNotificationSound(),_().fire({title:"New Delivery Available!",text:`${e.length} new delivery request${e.length>1?"s":""}`,icon:"info",toast:!0,position:"top-end",timer:5e3,showConfirmButton:!1}))}),this.deliveryService.getPartnerAssignments(this.partnerId,"DELIVERED").pipe((0,d.Q)(this.destroy$)).subscribe(e=>{this.completedAssignments=e}))}loadEarnings(){this.deliveryService.getPartnerEarnings(this.partnerId,"today").pipe((0,d.Q)(this.destroy$)).subscribe(e=>{this.todayEarnings=e})}acceptAssignment(e){_().fire({title:"Accept Delivery?",html:`\n        <div>\n          <p><strong>Order:</strong> #${e.orderNumber}</p>\n          <p><strong>Distance:</strong> ${e.distance} km</p>\n          <p><strong>Earnings:</strong> \u20b9${e.earnings}</p>\n        </div>\n      `,icon:"question",showCancelButton:!0,confirmButtonText:"Accept",cancelButtonText:"Decline"}).then(n=>{n.isConfirmed&&this.deliveryService.acceptAssignment(e.id).pipe((0,d.Q)(this.destroy$)).subscribe({next:i=>{this.currentAssignment=i,this.loadAssignments()},error:i=>{console.error("Error accepting assignment:",i)}})})}rejectAssignment(e){_().fire({title:"Decline Delivery?",input:"select",inputOptions:{"Too far":"Too far","Vehicle issue":"Vehicle issue","Personal reason":"Personal reason",Other:"Other"},inputPlaceholder:"Select reason",showCancelButton:!0,confirmButtonText:"Decline",cancelButtonText:"Cancel"}).then(n=>{n.isConfirmed&&n.value&&this.deliveryService.rejectAssignment(e.id,n.value).pipe((0,d.Q)(this.destroy$)).subscribe({next:()=>{this.loadAssignments()},error:i=>{console.error("Error rejecting assignment:",i)}})})}startPickup(){this.currentAssignment&&this.deliveryService.startPickup(this.currentAssignment.id).pipe((0,d.Q)(this.destroy$)).subscribe({next:e=>{this.currentAssignment=e,this.openNavigation(this.currentAssignment.pickupAddress)},error:e=>{console.error("Error starting pickup:",e)}})}verifyPickupOTP(){this.currentAssignment&&this.otpInput?this.deliveryService.verifyPickupOTP(this.currentAssignment.id,this.otpInput).pipe((0,d.Q)(this.destroy$)).subscribe({next:e=>{this.currentAssignment=e,this.otpInput=""},error:e=>{console.error("Error verifying OTP:",e),_().fire("Invalid OTP","Please check the OTP and try again","error")}}):_().fire("Error","Please enter the OTP","error")}startDelivery(){this.currentAssignment&&this.deliveryService.startDelivery(this.currentAssignment.id).pipe((0,d.Q)(this.destroy$)).subscribe({next:e=>{this.currentAssignment=e,this.openNavigation(this.currentAssignment.deliveryAddress)},error:e=>{console.error("Error starting delivery:",e)}})}verifyDeliveryOTP(){this.currentAssignment&&this.otpInput?_().fire({title:"Delivery Confirmation",text:"Would you like to capture proof of delivery?",icon:"question",showCancelButton:!0,confirmButtonText:"Yes, capture",cancelButtonText:"No, proceed"}).then(e=>{e.isConfirmed?this.captureDeliveryProof():this.completeDelivery()}):_().fire("Error","Please enter the OTP","error")}completeDelivery(e){this.currentAssignment&&this.deliveryService.verifyDeliveryOTP(this.currentAssignment.id,this.otpInput,e).pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{this.currentAssignment=null,this.otpInput="",this.loadAssignments(),this.loadEarnings()},error:n=>{console.error("Error completing delivery:",n),_().fire("Invalid OTP","Please check the OTP and try again","error")}})}captureDeliveryProof(){const e=document.createElement("input");e.type="file",e.accept="image/*",e.capture="environment",e.onchange=n=>{const i=n.target.files[0];i&&this.completeDelivery(i)},e.click()}reportIssue(){this.currentAssignment&&_().fire({title:"Report Issue",input:"select",inputOptions:{"Cannot find address":"Cannot find address","Customer not available":"Customer not available","Wrong order":"Wrong order","Vehicle breakdown":"Vehicle breakdown",Accident:"Accident",Other:"Other"},inputPlaceholder:"Select issue type",showCancelButton:!0,confirmButtonText:"Report",preConfirm:e=>_().fire({title:"Issue Description",input:"textarea",inputPlaceholder:"Describe the issue...",showCancelButton:!0}).then(n=>n.isConfirmed?{issue:e,description:n.value}:null)}).then(e=>{e.isConfirmed&&e.value&&this.deliveryService.reportIssue(this.currentAssignment.id,e.value.issue,e.value.description).pipe((0,d.Q)(this.destroy$)).subscribe({next:()=>{console.log("Issue reported")},error:n=>{console.error("Error reporting issue:",n)}})})}callCustomer(){this.currentAssignment&&(window.location.href=`tel:${this.currentAssignment.partnerPhone}`)}openNavigation(e){const n=encodeURIComponent(e);window.open(`https://www.google.com/maps/search/?api=1&query=${n}`,"_blank")}startLocationTracking(){navigator.geolocation?(0,G.Y)(3e4).pipe((0,d.Q)(this.destroy$)).subscribe(()=>{navigator.geolocation.getCurrentPosition(e=>{this.currentLocation={latitude:e.coords.latitude,longitude:e.coords.longitude},this.isOnline&&this.deliveryService.updateLocation(this.partnerId,this.currentLocation.latitude,this.currentLocation.longitude).subscribe()},e=>{console.error("Error getting location:",e)})}):console.error("Geolocation is not supported")}playNotificationSound(){new Audio("/assets/sounds/notification.mp3").play().catch(n=>console.error("Error playing sound:",n))}getStatusColor(e){switch(e){case"ASSIGNED":return"#ff9800";case"ACCEPTED":return"#2196f3";case"PICKUP_STARTED":return"#9c27b0";case"PICKED_UP":return"#4caf50";case"DELIVERY_STARTED":return"#ff5722";case"DELIVERED":return"#8bc34a";default:return"#757575"}}getStatusIcon(e){switch(e){case"ASSIGNED":return"assignment";case"ACCEPTED":return"check_circle";case"PICKUP_STARTED":return"directions_bike";case"PICKED_UP":return"inventory";case"DELIVERY_STARTED":return"delivery_dining";case"DELIVERED":return"done_all";default:return"help"}}static{this.\u0275fac=function(n){return new(n||r)(t.rXU(ct))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-delivery-dashboard"]],decls:23,vars:10,consts:[[1,"delivery-dashboard"],[1,"dashboard-header"],[1,"online-toggle"],["color","primary",3,"ngModel","ngModelChange","change"],["class","online-status",4,"ngIf"],["class","offline-status",4,"ngIf"],[1,"earnings-summary"],["color","primary"],["class","current-assignment",4,"ngIf"],[4,"ngIf"],["class","offline-message",4,"ngIf"],["class","completed-section",4,"ngIf"],[1,"online-status"],[1,"offline-status"],[1,"current-assignment"],[1,"progress-tracker"],["linear","","selectedIndex","0"],["stepper",""],[3,"completed"],["matStepLabel",""],["class","location-info",4,"ngIf"],[1,"assignment-details"],[1,"detail-item"],[1,"quick-actions"],["mat-button","",3,"click"],["mat-button","","color","warn",3,"click"],[1,"location-info"],[1,"action-buttons"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],["class","otp-section",4,"ngIf"],["mat-raised-button","","color","primary",3,"click"],[1,"otp-section"],["matInput","","placeholder","6-digit OTP","maxlength","6",3,"ngModel","ngModelChange"],["mat-raised-button","","color","accent",3,"click"],[1,"assignments-list"],["class","assignment-card",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],[1,"assignment-card"],["color","accent"],[1,"assignment-info"],[1,"info-row"],[1,"info-row","earnings"],[1,"empty-state"],[1,"hint"],[1,"offline-message"],[1,"completed-section"],[4,"ngFor","ngForOf"],["matListItemIcon",""],["matListItemTitle",""],["matListItemLine",""],["matListItemMeta",""]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-slide-toggle",3),t.bIt("ngModelChange",function(s){return i.isOnline=s})("change",function(){return i.toggleOnlineStatus()}),t.DNE(4,Pt,4,0,"span",4),t.DNE(5,vt,4,0,"span",5),t.k0s()(),t.j41(6,"div",6)(7,"mat-chip",7)(8,"mat-icon"),t.EFF(9,"payments"),t.k0s(),t.EFF(10),t.k0s(),t.j41(11,"mat-chip")(12,"mat-icon"),t.EFF(13,"delivery_dining"),t.k0s(),t.EFF(14),t.k0s(),t.j41(15,"mat-chip")(16,"mat-icon"),t.EFF(17,"star"),t.k0s(),t.EFF(18),t.k0s()()(),t.DNE(19,St,49,16,"mat-card",8),t.DNE(20,At,6,2,"div",9),t.DNE(21,$t,13,0,"div",10),t.DNE(22,Lt,5,1,"div",11),t.k0s()),2&n&&(t.R7$(3),t.Y8G("ngModel",i.isOnline),t.R7$(1),t.Y8G("ngIf",i.isOnline),t.R7$(1),t.Y8G("ngIf",!i.isOnline),t.R7$(5),t.SpI(" Today: \u20b9",i.todayEarnings.totalEarnings," "),t.R7$(4),t.SpI(" ",i.todayEarnings.completedDeliveries," Deliveries "),t.R7$(4),t.SpI(" ",i.todayEarnings.averageRating,"/5 "),t.R7$(1),t.Y8G("ngIf",i.currentAssignment),t.R7$(1),t.Y8G("ngIf",!i.currentAssignment&&i.isOnline),t.R7$(1),t.Y8G("ngIf",!i.isOnline),t.R7$(1),t.Y8G("ngIf",i.completedAssignments.length>0))},dependencies:[h.Sq,h.bT,g.me,g.BC,g.tU,g.vS,p.RN,p.YY,p.m2,p.MM,p.dh,v.$z,M.rl,M.nJ,T.fg,k.An,F.Jl,tt.sG,Q.V5,Q.Ti,Q.M6,A.jt,A.YE,A.ZV,A.C_,A.yE,A.BJ,h.vh],styles:[".delivery-dashboard[_ngcontent-%COMP%]{padding:20px}.delivery-dashboard[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:30px}.delivery-dashboard[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin-bottom:12px}.delivery-dashboard[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-icon.active[_ngcontent-%COMP%]{background:#2196f3;color:#fff}.delivery-dashboard[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-icon.completed[_ngcontent-%COMP%]{background:#4caf50;color:#fff}.delivery-dashboard[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-icon.pending[_ngcontent-%COMP%]{background:#ff9800;color:#fff}.delivery-dashboard[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-icon.earnings[_ngcontent-%COMP%]{background:#10b981;color:#fff}.delivery-dashboard[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px}.delivery-dashboard[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 4px;font-size:24px;font-weight:600}.delivery-dashboard[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666;font-size:14px}.delivery-dashboard[_ngcontent-%COMP%]   .dashboard-tabs[_ngcontent-%COMP%]   .tab-icon[_ngcontent-%COMP%]{margin-right:8px}.delivery-dashboard[_ngcontent-%COMP%]   .dashboard-tabs[_ngcontent-%COMP%]   .assignments-list[_ngcontent-%COMP%]{margin-top:20px}.delivery-dashboard[_ngcontent-%COMP%]   .dashboard-tabs[_ngcontent-%COMP%]   .assignments-list[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]{margin-bottom:16px}.delivery-dashboard[_ngcontent-%COMP%]   .dashboard-tabs[_ngcontent-%COMP%]   .assignments-list[_ngcontent-%COMP%]   .assignment-card.active[_ngcontent-%COMP%]{border-left:4px solid #2196f3}.delivery-dashboard[_ngcontent-%COMP%]   .dashboard-tabs[_ngcontent-%COMP%]   .assignments-list[_ngcontent-%COMP%]   .assignment-card.completed[_ngcontent-%COMP%]{border-left:4px solid #4caf50}.delivery-dashboard[_ngcontent-%COMP%]   .dashboard-tabs[_ngcontent-%COMP%]   .assignments-list[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .assignment-info[_ngcontent-%COMP%]{margin-bottom:16px}.delivery-dashboard[_ngcontent-%COMP%]   .dashboard-tabs[_ngcontent-%COMP%]   .assignments-list[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .assignment-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0;display:flex;align-items:center;gap:8px}.delivery-dashboard[_ngcontent-%COMP%]   .dashboard-tabs[_ngcontent-%COMP%]   .assignments-list[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .assignment-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#666;font-size:18px;width:18px;height:18px}.delivery-dashboard[_ngcontent-%COMP%]   .dashboard-tabs[_ngcontent-%COMP%]   .assignments-list[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .assignment-status[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.delivery-dashboard[_ngcontent-%COMP%]   .dashboard-tabs[_ngcontent-%COMP%]   .assignments-list[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .assignment-status[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:16px;font-size:12px;font-weight:500}.delivery-dashboard[_ngcontent-%COMP%]   .dashboard-tabs[_ngcontent-%COMP%]   .assignments-list[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .assignment-status[_ngcontent-%COMP%]   .status-badge.active[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2}.delivery-dashboard[_ngcontent-%COMP%]   .dashboard-tabs[_ngcontent-%COMP%]   .assignments-list[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .assignment-status[_ngcontent-%COMP%]   .status-badge.completed[_ngcontent-%COMP%]{background:#e8f5e8;color:#2e7d32}.delivery-dashboard[_ngcontent-%COMP%]   .dashboard-tabs[_ngcontent-%COMP%]   .assignments-list[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .assignment-status[_ngcontent-%COMP%]   .status-badge.pending[_ngcontent-%COMP%]{background:#fff3e0;color:#f57c00}.delivery-dashboard[_ngcontent-%COMP%]   .dashboard-tabs[_ngcontent-%COMP%]   .assignments-list[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap}.delivery-dashboard[_ngcontent-%COMP%]   .dashboard-tabs[_ngcontent-%COMP%]   .assignments-list[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:auto}.delivery-dashboard[_ngcontent-%COMP%]   .dashboard-tabs[_ngcontent-%COMP%]   .assignments-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:#666}.delivery-dashboard[_ngcontent-%COMP%]   .dashboard-tabs[_ngcontent-%COMP%]   .assignments-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#ddd;margin-bottom:16px}.delivery-dashboard[_ngcontent-%COMP%]   .dashboard-tabs[_ngcontent-%COMP%]   .assignments-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;color:#999}.delivery-dashboard[_ngcontent-%COMP%]   .dashboard-tabs[_ngcontent-%COMP%]   .assignments-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 16px}.delivery-dashboard[_ngcontent-%COMP%]   .recent-activities[_ngcontent-%COMP%]   mat-list[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto}.delivery-dashboard[_ngcontent-%COMP%]   .recent-activities[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{border-bottom:1px solid #eee}.delivery-dashboard[_ngcontent-%COMP%]   .recent-activities[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.delivery-dashboard[_ngcontent-%COMP%]   .recent-activities[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   .activity-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;width:100%}.delivery-dashboard[_ngcontent-%COMP%]   .recent-activities[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   .activity-content[_ngcontent-%COMP%]   .activity-icon[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0}.delivery-dashboard[_ngcontent-%COMP%]   .recent-activities[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   .activity-content[_ngcontent-%COMP%]   .activity-icon.pickup[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2}.delivery-dashboard[_ngcontent-%COMP%]   .recent-activities[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   .activity-content[_ngcontent-%COMP%]   .activity-icon.delivery[_ngcontent-%COMP%]{background:#e8f5e8;color:#2e7d32}.delivery-dashboard[_ngcontent-%COMP%]   .recent-activities[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   .activity-content[_ngcontent-%COMP%]   .activity-icon.issue[_ngcontent-%COMP%]{background:#ffebee;color:#d32f2f}.delivery-dashboard[_ngcontent-%COMP%]   .recent-activities[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   .activity-content[_ngcontent-%COMP%]   .activity-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.delivery-dashboard[_ngcontent-%COMP%]   .recent-activities[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   .activity-content[_ngcontent-%COMP%]   .activity-details[_ngcontent-%COMP%]{flex-grow:1}.delivery-dashboard[_ngcontent-%COMP%]   .recent-activities[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   .activity-content[_ngcontent-%COMP%]   .activity-details[_ngcontent-%COMP%]   .activity-title[_ngcontent-%COMP%]{font-weight:500;margin:0 0 2px}.delivery-dashboard[_ngcontent-%COMP%]   .recent-activities[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   .activity-content[_ngcontent-%COMP%]   .activity-details[_ngcontent-%COMP%]   .activity-time[_ngcontent-%COMP%]{font-size:12px;color:#666;margin:0}.delivery-dashboard[_ngcontent-%COMP%]   .quick-actions[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-top:20px}.delivery-dashboard[_ngcontent-%COMP%]   .quick-actions[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]{text-align:center;padding:20px;cursor:pointer;transition:all .2s ease}.delivery-dashboard[_ngcontent-%COMP%]   .quick-actions[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 8px #0000001a}.delivery-dashboard[_ngcontent-%COMP%]   .quick-actions[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 12px;background:#f5f5f5}.delivery-dashboard[_ngcontent-%COMP%]   .quick-actions[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   .action-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px;color:#666}.delivery-dashboard[_ngcontent-%COMP%]   .quick-actions[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 4px;font-size:16px}.delivery-dashboard[_ngcontent-%COMP%]   .quick-actions[_ngcontent-%COMP%]   .action-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:12px;color:#666}@media (max-width: 768px){.delivery-dashboard[_ngcontent-%COMP%]{padding:16px}.delivery-dashboard[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.delivery-dashboard[_ngcontent-%COMP%]   .assignments-list[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:12px;padding:8px 12px}.delivery-dashboard[_ngcontent-%COMP%]   .quick-actions[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}"]})}}return r})();var f=l(3904),Y=l(2150),D=l(1985);let z=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${j.c.apiUrl}/delivery/assignments`}assignOrder(e){return this.http.post(this.apiUrl,e)}getAssignmentById(e){const n={id:e,orderId:12345,orderNumber:"ORD-2025-001",partnerId:1,partnerName:"Raj Kumar",partnerPhone:"+91 9876543210",assignedAt:new Date,assignmentType:"AUTO",status:"IN_TRANSIT",acceptedAt:new Date(Date.now()-18e5),pickupTime:new Date(Date.now()-12e5),deliveryLatitude:12.9716,deliveryLongitude:77.5946,deliveryFee:45,partnerCommission:25,currentLatitude:12.97,currentLongitude:77.593,lastLocationUpdate:new Date(Date.now()-12e4),distanceToDestination:2.5,estimatedArrivalTime:new Date(Date.now()+9e5),totalTimeMinutes:45,deliveryTimeMinutes:25,isDelayed:!1,createdAt:new Date,updatedAt:new Date,shopName:"Raj Electronics",customerName:"Priya Sharma",customerPhone:"+91 9123456789",deliveryAddress:"123, MG Road, Bangalore, Karnataka 560001",distance:5.2,estimatedTime:15,timeRemaining:15};return new D.c(i=>{setTimeout(()=>{i.next({statusCode:"SUCCESS",message:"Assignment retrieved successfully",data:n,timestamp:(new Date).toISOString()}),i.complete()},500)})}getAssignmentsByOrder(e){return this.http.get(`${this.apiUrl}/order/${e}`)}getAssignmentsByPartner(e,n=0,i=10){const a=(new P.Nl).set("page",n.toString()).set("size",i.toString());return this.http.get(`${this.apiUrl}/partner/${e}`,{params:a})}getActiveAssignmentsByPartner(e){return this.http.get(`${this.apiUrl}/partner/${e}/active`)}getAssignmentsByStatus(e){return this.http.get(`${this.apiUrl}/status/${e}`)}acceptAssignment(e,n){return this.http.put(`${this.apiUrl}/${e}/accept`,{partnerId:n})}rejectAssignment(e,n,i){return this.http.put(`${this.apiUrl}/${e}/reject`,{partnerId:n,reason:i})}markPickedUp(e,n){return this.http.put(`${this.apiUrl}/${e}/pickup`,{partnerId:n})}startDelivery(e,n){return this.http.put(`${this.apiUrl}/${e}/start-delivery`,{partnerId:n})}completeDelivery(e,n,i){return this.http.put(`${this.apiUrl}/${e}/complete`,{partnerId:n,notes:i})}markFailed(e,n,i){return this.http.put(`${this.apiUrl}/${e}/fail`,{partnerId:n,reason:i})}processExpiredAssignments(){return this.http.post(`${this.apiUrl}/process-expired`,{})}getAvailableOrders(){return new D.c(e=>{e.next({statusCode:"SUCCESS",message:"Available orders retrieved",data:[],timestamp:(new Date).toISOString()}),e.complete()})}getStatusColor(e){switch(e){case"ASSIGNED":case"PICKED_UP":case"DELIVERED":return"primary";case"ACCEPTED":case"IN_TRANSIT":return"accent";case"REJECTED":case"FAILED":case"CANCELLED":return"warn";default:return"basic"}}getStatusIcon(e){switch(e){case"ASSIGNED":return"assignment";case"ACCEPTED":return"check_circle";case"PICKED_UP":return"shopping_cart";case"IN_TRANSIT":return"local_shipping";case"DELIVERED":return"check_circle_outline";case"REJECTED":case"CANCELLED":return"cancel";case"FAILED":return"error";default:return"help"}}formatTimeRemaining(e){const n=new Date,i=new Date(e),a=Math.floor((n.getTime()-i.getTime())/6e4);return Math.max(0,15-a)}isAssignmentExpired(e){return 0===this.formatTimeRemaining(e)}canAcceptAssignment(e){return"ASSIGNED"===e.status&&!this.isAssignmentExpired(e.assignedAt)}canRejectAssignment(e){return"ASSIGNED"===e.status}canMarkPickedUp(e){return"ACCEPTED"===e.status}canStartDelivery(e){return"PICKED_UP"===e.status}canCompleteDelivery(e){return"IN_TRANSIT"===e.status}getPartnerOrders(){return new D.c(e=>{e.next([]),e.complete()})}updateOrderStatus(e,n){return this.http.put(`${this.apiUrl}/order/${e}/status`,{status:n})}static{this.\u0275fac=function(n){return new(n||r)(t.KVO(P.Qq))}}static{this.\u0275prov=t.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var Vt=l(8010),X=l(467);let Bt=(()=>{class r{constructor(){}getCurrentPosition(e){return new Promise((n,i)=>{if(!navigator.geolocation)return void i(new Error("Geolocation is not supported by this browser"));const a={enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5,...e};navigator.geolocation.getCurrentPosition(s=>{n({coords:{latitude:s.coords.latitude,longitude:s.coords.longitude,accuracy:s.coords.accuracy,altitude:s.coords.altitude||void 0,altitudeAccuracy:s.coords.altitudeAccuracy||void 0,heading:s.coords.heading||void 0,speed:s.coords.speed||void 0},timestamp:s.timestamp})},s=>{i(this.getGeolocationError(s))},a)})}watchPosition(e,n,i){if(!navigator.geolocation)throw new Error("Geolocation is not supported by this browser");const a={enableHighAccuracy:!0,timeout:1e4,maximumAge:3e4,...i};return navigator.geolocation.watchPosition(s=>{e({coords:{latitude:s.coords.latitude,longitude:s.coords.longitude,accuracy:s.coords.accuracy,altitude:s.coords.altitude||void 0,altitudeAccuracy:s.coords.altitudeAccuracy||void 0,heading:s.coords.heading||void 0,speed:s.coords.speed||void 0},timestamp:s.timestamp})},n?s=>n(s):void 0,a)}clearWatch(e){navigator.geolocation.clearWatch(e)}isSupported(){return!!navigator.geolocation}calculateDistance(e,n,i,a){const c=this.toRadians(i-e),m=this.toRadians(a-n),C=Math.sin(c/2)*Math.sin(c/2)+Math.cos(this.toRadians(e))*Math.cos(this.toRadians(i))*Math.sin(m/2)*Math.sin(m/2),V=2*Math.atan2(Math.sqrt(C),Math.sqrt(1-C))*6371;return Math.round(100*V)/100}toRadians(e){return e*(Math.PI/180)}getGeolocationError(e){switch(e.code){case e.PERMISSION_DENIED:return new Error("Location access denied by user");case e.POSITION_UNAVAILABLE:return new Error("Location information is unavailable");case e.TIMEOUT:return new Error("Location request timed out");default:return new Error("An unknown error occurred while retrieving location")}}getErrorMessage(e){switch(e.code){case e.PERMISSION_DENIED:return"Please allow location access to enable delivery tracking";case e.POSITION_UNAVAILABLE:return"Your location could not be determined. Please check your GPS settings";case e.TIMEOUT:return"Location request took too long. Please try again";default:return"Unable to get your location. Please try again"}}requestPermission(){return(0,X.A)(function*(){if(!navigator.permissions)throw new Error("Permissions API not supported");try{return(yield navigator.permissions.query({name:"geolocation"})).state}catch{throw new Error("Failed to query location permission")}})()}calculateBearing(e,n,i,a){const s=this.toRadians(a-n),c=this.toRadians(e),m=this.toRadians(i),C=Math.sin(s)*Math.cos(m),y=Math.cos(c)*Math.sin(m)-Math.sin(c)*Math.cos(m)*Math.cos(s);return(180*Math.atan2(C,y)/Math.PI+360)%360}formatDistance(e){return e<1?`${Math.round(1e3*e)}m`:`${e.toFixed(1)}km`}isPositionRecent(e,n=5){return Date.now()-e<=60*n*1e3}calculateETA(e,n=25){const a=e/n*60*60*1e3;return new Date(Date.now()+a)}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275prov=t.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})(),Ut=(()=>{class r{constructor(){this.totalEarnings=0,this.todayEarnings=0,this.weeklyEarnings=0,this.monthlyEarnings=0}ngOnInit(){this.loadEarningsData()}loadEarningsData(){this.totalEarnings=15420,this.todayEarnings=850,this.weeklyEarnings=4200,this.monthlyEarnings=12500}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-earnings-overview"]],inputs:{partnerId:"partnerId",totalEarnings:"totalEarnings"},decls:32,vars:4,consts:[[1,"earnings-overview"],[1,"earnings-cards"],[1,"earning-card"],[1,"amount"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"h3"),t.EFF(2,"Earnings Overview"),t.k0s(),t.j41(3,"div",1)(4,"mat-card",2)(5,"mat-card-header")(6,"mat-card-title"),t.EFF(7,"Today"),t.k0s()(),t.j41(8,"mat-card-content")(9,"div",3),t.EFF(10),t.k0s()()(),t.j41(11,"mat-card",2)(12,"mat-card-header")(13,"mat-card-title"),t.EFF(14,"This Week"),t.k0s()(),t.j41(15,"mat-card-content")(16,"div",3),t.EFF(17),t.k0s()()(),t.j41(18,"mat-card",2)(19,"mat-card-header")(20,"mat-card-title"),t.EFF(21,"This Month"),t.k0s()(),t.j41(22,"mat-card-content")(23,"div",3),t.EFF(24),t.k0s()()(),t.j41(25,"mat-card",2)(26,"mat-card-header")(27,"mat-card-title"),t.EFF(28,"Total"),t.k0s()(),t.j41(29,"mat-card-content")(30,"div",3),t.EFF(31),t.k0s()()()()()),2&n&&(t.R7$(10),t.SpI("\u20b9",i.todayEarnings,""),t.R7$(7),t.SpI("\u20b9",i.weeklyEarnings,""),t.R7$(7),t.SpI("\u20b9",i.monthlyEarnings,""),t.R7$(7),t.SpI("\u20b9",i.totalEarnings,""))},dependencies:[p.RN,p.m2,p.MM,p.dh],styles:[".earnings-overview[_ngcontent-%COMP%]{margin-bottom:2rem}.earnings-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-top:1rem}.earning-card[_ngcontent-%COMP%]{text-align:center}.earning-card[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#4caf50}"]})}}return r})();function Yt(r,o){if(1&r){const e=t.RV6();t.j41(0,"div",10)(1,"mat-slide-toggle",11),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG(2);return t.Njj(a.isAvailable=i)})("change",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.toggleAvailability())}),t.j41(2,"span"),t.EFF(3),t.k0s()()()}if(2&r){const e=t.XpG(2);t.R7$(1),t.Y8G("ngModel",e.isAvailable),t.R7$(1),t.AVh("available",e.isAvailable)("unavailable",!e.isAvailable),t.R7$(1),t.SpI(" ",e.isAvailable?"Available":"Busy"," ")}}function zt(r,o){if(1&r&&(t.j41(0,"span",41),t.EFF(1),t.k0s()),2&r){const e=t.XpG(3);t.R7$(1),t.JRh(e.activeOrders.length)}}function Xt(r,o){if(1&r&&(t.j41(0,"mat-icon"),t.EFF(1,"assignment"),t.k0s(),t.EFF(2," Active Orders "),t.DNE(3,zt,2,1,"span",40)),2&r){const e=t.XpG(2);t.R7$(3),t.Y8G("ngIf",e.activeOrders.length>0)}}function Jt(r,o){1&r&&(t.j41(0,"div",42)(1,"mat-icon",43),t.EFF(2,"assignment_late"),t.k0s(),t.j41(3,"h3"),t.EFF(4,"No Active Orders"),t.k0s(),t.j41(5,"p"),t.EFF(6,"You don't have any active deliveries at the moment."),t.k0s()())}function Kt(r,o){if(1&r&&(t.j41(0,"div",49)(1,"mat-icon"),t.EFF(2,"navigation"),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s()()),2&r){const e=t.XpG().$implicit,n=t.XpG(3);t.R7$(4),t.JRh(n.formatDistance(e.distanceToDestination))}}function Wt(r,o){if(1&r){const e=t.RV6();t.j41(0,"button",55),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,a=t.XpG(3);return t.Njj(a.markPickedUp(i.id))}),t.j41(1,"mat-icon"),t.EFF(2,"shopping_cart"),t.k0s(),t.EFF(3," Mark Picked Up "),t.k0s()}}function qt(r,o){if(1&r){const e=t.RV6();t.j41(0,"button",55),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,a=t.XpG(3);return t.Njj(a.startDelivery(i.id))}),t.j41(1,"mat-icon"),t.EFF(2,"local_shipping"),t.k0s(),t.EFF(3," Start Delivery "),t.k0s()}}function Ht(r,o){if(1&r){const e=t.RV6();t.j41(0,"button",56),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,a=t.XpG(3);return t.Njj(a.completeDelivery(i.id))}),t.j41(1,"mat-icon"),t.EFF(2,"check_circle"),t.k0s(),t.EFF(3," Complete "),t.k0s()}}const Qt=function(r){return["/delivery/tracking",r]};function Zt(r,o){if(1&r&&(t.j41(0,"mat-card",46)(1,"mat-card-header")(2,"div",47)(3,"mat-icon"),t.EFF(4,"shopping_bag"),t.k0s()(),t.j41(5,"mat-card-title"),t.EFF(6),t.k0s(),t.j41(7,"mat-card-subtitle")(8,"mat-chip",36),t.EFF(9),t.k0s()()(),t.j41(10,"mat-card-content")(11,"div",48)(12,"div",49)(13,"mat-icon"),t.EFF(14,"store"),t.k0s(),t.j41(15,"span"),t.EFF(16),t.k0s()(),t.j41(17,"div",49)(18,"mat-icon"),t.EFF(19,"location_on"),t.k0s(),t.j41(20,"span"),t.EFF(21),t.k0s()(),t.j41(22,"div",49)(23,"mat-icon"),t.EFF(24,"phone"),t.k0s(),t.j41(25,"span"),t.EFF(26),t.k0s()(),t.j41(27,"div",49)(28,"mat-icon"),t.EFF(29,"currency_rupee"),t.k0s(),t.j41(30,"span"),t.EFF(31),t.k0s()(),t.DNE(32,Kt,5,1,"div",50),t.k0s()(),t.j41(33,"mat-card-actions",51),t.DNE(34,Wt,4,0,"button",52),t.DNE(35,qt,4,0,"button",52),t.DNE(36,Ht,4,0,"button",53),t.j41(37,"button",54)(38,"mat-icon"),t.EFF(39,"map"),t.k0s(),t.EFF(40," Track "),t.k0s()()()),2&r){const e=o.$implicit,n=t.XpG(3);t.R7$(6),t.SpI("Order #",e.orderNumber,""),t.R7$(2),t.Y8G("color",n.getStatusColor(e.status)),t.R7$(1),t.SpI(" ",e.status," "),t.R7$(7),t.JRh(e.shopName),t.R7$(5),t.JRh(e.deliveryAddress),t.R7$(5),t.JRh(e.customerPhone),t.R7$(5),t.JRh(n.formatEarnings(e.deliveryFee)),t.R7$(1),t.Y8G("ngIf",e.distanceToDestination),t.R7$(2),t.Y8G("ngIf","ACCEPTED"===e.status),t.R7$(1),t.Y8G("ngIf","PICKED_UP"===e.status),t.R7$(1),t.Y8G("ngIf","IN_TRANSIT"===e.status),t.R7$(1),t.Y8G("routerLink",t.eq3(12,Qt,e.id))}}function te(r,o){if(1&r&&(t.j41(0,"div",44),t.DNE(1,Zt,41,14,"mat-card",45),t.k0s()),2&r){const e=t.XpG(2);t.R7$(1),t.Y8G("ngForOf",e.activeOrders)}}function ee(r,o){if(1&r&&(t.j41(0,"span",41),t.EFF(1),t.k0s()),2&r){const e=t.XpG(4);t.R7$(1),t.JRh(e.availableOrders.length)}}function ne(r,o){if(1&r&&(t.j41(0,"mat-icon"),t.EFF(1,"notifications"),t.k0s(),t.EFF(2," Available "),t.DNE(3,ee,2,1,"span",40)),2&r){const e=t.XpG(3);t.R7$(3),t.Y8G("ngIf",e.availableOrders.length>0)}}function re(r,o){1&r&&(t.j41(0,"div",42)(1,"mat-icon",43),t.EFF(2,"search"),t.k0s(),t.j41(3,"h3"),t.EFF(4,"No Orders Available"),t.k0s(),t.j41(5,"p"),t.EFF(6,"No new orders are available for pickup at the moment."),t.k0s()())}function ie(r,o){if(1&r){const e=t.RV6();t.j41(0,"mat-card",59)(1,"mat-card-header")(2,"div",47)(3,"mat-icon"),t.EFF(4,"new_releases"),t.k0s()(),t.j41(5,"mat-card-title"),t.EFF(6),t.k0s(),t.j41(7,"mat-card-subtitle")(8,"span",60),t.EFF(9),t.k0s()()(),t.j41(10,"mat-card-content")(11,"div",48)(12,"div",49)(13,"mat-icon"),t.EFF(14,"store"),t.k0s(),t.j41(15,"span"),t.EFF(16),t.k0s()(),t.j41(17,"div",49)(18,"mat-icon"),t.EFF(19,"location_on"),t.k0s(),t.j41(20,"span"),t.EFF(21),t.k0s()(),t.j41(22,"div",49)(23,"mat-icon"),t.EFF(24,"currency_rupee"),t.k0s(),t.j41(25,"span"),t.EFF(26),t.k0s()(),t.j41(27,"div",49)(28,"mat-icon"),t.EFF(29,"navigation"),t.k0s(),t.j41(30,"span"),t.EFF(31),t.k0s()(),t.j41(32,"div",49)(33,"mat-icon"),t.EFF(34,"schedule"),t.k0s(),t.j41(35,"span"),t.EFF(36),t.k0s()()()(),t.j41(37,"mat-card-actions",51)(38,"button",61),t.bIt("click",function(){const a=t.eBV(e).$implicit,s=t.XpG(4);return t.Njj(s.rejectOrder(a.id))}),t.j41(39,"mat-icon"),t.EFF(40,"close"),t.k0s(),t.EFF(41," Reject "),t.k0s(),t.j41(42,"button",55),t.bIt("click",function(){const a=t.eBV(e).$implicit,s=t.XpG(4);return t.Njj(s.acceptOrder(a.id))}),t.j41(43,"mat-icon"),t.EFF(44,"check"),t.k0s(),t.EFF(45," Accept "),t.k0s()()()}if(2&r){const e=o.$implicit,n=t.XpG(4);t.R7$(6),t.SpI("New Order #",e.orderNumber,""),t.R7$(3),t.SpI("",e.timeRemaining," mins to accept"),t.R7$(7),t.JRh(e.shopName),t.R7$(5),t.JRh(e.deliveryAddress),t.R7$(5),t.JRh(n.formatEarnings(e.deliveryFee)),t.R7$(5),t.JRh(n.formatDistance(e.distance)),t.R7$(5),t.SpI("",e.estimatedTime," mins")}}function ae(r,o){if(1&r&&(t.j41(0,"div",44),t.DNE(1,ie,46,7,"mat-card",58),t.k0s()),2&r){const e=t.XpG(3);t.R7$(1),t.Y8G("ngForOf",e.availableOrders)}}function oe(r,o){if(1&r&&(t.j41(0,"mat-tab",57),t.DNE(1,ne,4,1,"ng-template",24),t.j41(2,"div",25),t.DNE(3,re,7,0,"div",26),t.DNE(4,ae,2,1,"div",27),t.k0s()()),2&r){const e=t.XpG(2);t.R7$(3),t.Y8G("ngIf",0===e.availableOrders.length),t.R7$(1),t.Y8G("ngIf",e.availableOrders.length>0)}}function se(r,o){1&r&&(t.j41(0,"mat-icon"),t.EFF(1,"account_balance_wallet"),t.k0s(),t.EFF(2," Earnings "))}function ce(r,o){1&r&&(t.j41(0,"mat-icon"),t.EFF(1,"person"),t.k0s(),t.EFF(2," Profile "))}function le(r,o){if(1&r&&(t.j41(0,"span",64),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&r){const e=t.XpG(3);t.R7$(1),t.SpI(" Last updated: ",t.i5U(2,1,e.lastLocationUpdate,"short")," ")}}function de(r,o){if(1&r&&(t.j41(0,"div",62)(1,"mat-icon"),t.EFF(2),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s(),t.DNE(5,le,3,4,"span",63),t.k0s()),2&r){const e=t.XpG(2);t.R7$(1),t.AVh("enabled",e.isLocationEnabled)("disabled",!e.isLocationEnabled),t.R7$(1),t.SpI(" ",e.isLocationEnabled?"location_on":"location_off"," "),t.R7$(2),t.SpI(" ",e.isLocationEnabled?"Location tracking enabled":"Location tracking disabled"," "),t.R7$(1),t.Y8G("ngIf",e.lastLocationUpdate)}}function ge(r,o){if(1&r){const e=t.RV6();t.j41(0,"div",2)(1,"mat-toolbar",3)(2,"div",4)(3,"div",5)(4,"mat-icon",6),t.EFF(5,"account_circle"),t.k0s(),t.j41(6,"div",7)(7,"h2"),t.EFF(8),t.k0s(),t.j41(9,"span",8),t.EFF(10),t.k0s()()(),t.j41(11,"div",9)(12,"div",10)(13,"mat-slide-toggle",11),t.bIt("ngModelChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.isOnline=i)})("change",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.toggleOnlineStatus())}),t.j41(14,"span"),t.EFF(15),t.k0s()()(),t.DNE(16,Yt,4,6,"div",12),t.k0s()()(),t.j41(17,"div",13)(18,"mat-card",14)(19,"mat-card-content")(20,"div",15)(21,"mat-icon"),t.EFF(22,"local_shipping"),t.k0s()(),t.j41(23,"div",16)(24,"div",17),t.EFF(25),t.k0s(),t.j41(26,"div",18),t.EFF(27,"Today's Deliveries"),t.k0s()()()(),t.j41(28,"mat-card",19)(29,"mat-card-content")(30,"div",15)(31,"mat-icon"),t.EFF(32,"currency_rupee"),t.k0s()(),t.j41(33,"div",16)(34,"div",17),t.EFF(35),t.k0s(),t.j41(36,"div",18),t.EFF(37,"Today's Earnings"),t.k0s()()()(),t.j41(38,"mat-card",20)(39,"mat-card-content")(40,"div",15)(41,"mat-icon"),t.EFF(42,"star"),t.k0s()(),t.j41(43,"div",16)(44,"div",17),t.EFF(45),t.k0s(),t.j41(46,"div",18),t.EFF(47,"Current Rating"),t.k0s()()()(),t.j41(48,"mat-card",21)(49,"mat-card-content")(50,"div",15)(51,"mat-icon"),t.EFF(52,"schedule"),t.k0s()(),t.j41(53,"div",16)(54,"div",17),t.EFF(55),t.k0s(),t.j41(56,"div",18),t.EFF(57,"Hours Worked"),t.k0s()()()()(),t.j41(58,"mat-tab-group",22),t.bIt("selectedIndexChange",function(i){t.eBV(e);const a=t.XpG();return t.Njj(a.currentTab=i)}),t.j41(59,"mat-tab",23),t.DNE(60,Xt,4,1,"ng-template",24),t.j41(61,"div",25),t.DNE(62,Jt,7,0,"div",26),t.DNE(63,te,2,1,"div",27),t.k0s()(),t.DNE(64,oe,5,2,"mat-tab",28),t.j41(65,"mat-tab",29),t.DNE(66,se,3,0,"ng-template",24),t.j41(67,"div",25),t.nrm(68,"app-earnings-overview",30),t.k0s()(),t.j41(69,"mat-tab",31),t.DNE(70,ce,3,0,"ng-template",24),t.j41(71,"div",25)(72,"div",32)(73,"mat-card",33)(74,"mat-card-header")(75,"mat-card-title"),t.EFF(76,"Personal Information"),t.k0s()(),t.j41(77,"mat-card-content")(78,"div",34)(79,"div",35)(80,"label"),t.EFF(81,"Name:"),t.k0s(),t.j41(82,"span"),t.EFF(83),t.k0s()(),t.j41(84,"div",35)(85,"label"),t.EFF(86,"Email:"),t.k0s(),t.j41(87,"span"),t.EFF(88),t.k0s()(),t.j41(89,"div",35)(90,"label"),t.EFF(91,"Phone:"),t.k0s(),t.j41(92,"span"),t.EFF(93),t.k0s()(),t.j41(94,"div",35)(95,"label"),t.EFF(96,"Vehicle:"),t.k0s(),t.j41(97,"span")(98,"mat-icon"),t.EFF(99),t.k0s(),t.EFF(100),t.k0s()(),t.j41(101,"div",35)(102,"label"),t.EFF(103,"Status:"),t.k0s(),t.j41(104,"mat-chip",36),t.EFF(105),t.k0s()(),t.j41(106,"div",35)(107,"label"),t.EFF(108,"Rating:"),t.k0s(),t.j41(109,"span"),t.EFF(110),t.k0s()()()()(),t.j41(111,"mat-card",33)(112,"mat-card-header")(113,"mat-card-title"),t.EFF(114,"Performance Stats"),t.k0s()(),t.j41(115,"mat-card-content")(116,"div",13)(117,"div",37)(118,"div",38),t.EFF(119),t.k0s(),t.j41(120,"div",18),t.EFF(121,"Total Deliveries"),t.k0s()(),t.j41(122,"div",37)(123,"div",38),t.EFF(124),t.k0s(),t.j41(125,"div",18),t.EFF(126,"Successful"),t.k0s()(),t.j41(127,"div",37)(128,"div",38),t.EFF(129),t.k0s(),t.j41(130,"div",18),t.EFF(131,"Success Rate"),t.k0s()(),t.j41(132,"div",37)(133,"div",38),t.EFF(134),t.k0s(),t.j41(135,"div",18),t.EFF(136,"Total Earnings"),t.k0s()()()()()()()()(),t.DNE(137,de,6,7,"div",39),t.k0s()}if(2&r){const e=t.XpG();t.R7$(8),t.JRh(null==e.partner?null:e.partner.fullName),t.R7$(2),t.JRh(null==e.partner?null:e.partner.partnerId),t.R7$(3),t.Y8G("ngModel",e.isOnline),t.R7$(1),t.AVh("online",e.isOnline)("offline",!e.isOnline),t.R7$(1),t.SpI(" ",e.isOnline?"Online":"Offline"," "),t.R7$(1),t.Y8G("ngIf",e.isOnline),t.R7$(9),t.JRh(e.todayStats.deliveries),t.R7$(10),t.JRh(e.formatEarnings(e.todayStats.earnings)),t.R7$(10),t.JRh(e.formatRating(e.todayStats.rating)),t.R7$(10),t.SpI("",e.todayStats.hoursWorked,"h"),t.R7$(3),t.Y8G("selectedIndex",e.currentTab),t.R7$(4),t.Y8G("ngIf",0===e.activeOrders.length),t.R7$(1),t.Y8G("ngIf",e.activeOrders.length>0),t.R7$(1),t.Y8G("ngIf",e.isOnline&&e.isAvailable),t.R7$(4),t.Y8G("partnerId",null==e.partner?null:e.partner.id)("totalEarnings",(null==e.partner?null:e.partner.totalEarnings)||0),t.R7$(15),t.JRh(null==e.partner?null:e.partner.fullName),t.R7$(5),t.JRh(null==e.partner?null:e.partner.email),t.R7$(5),t.JRh(null==e.partner?null:e.partner.phoneNumber),t.R7$(6),t.JRh(e.getVehicleIcon((null==e.partner?null:e.partner.vehicleType)||"")),t.R7$(1),t.Lme(" ",null==e.partner?null:e.partner.vehicleType," - ",null==e.partner?null:e.partner.vehicleNumber," "),t.R7$(4),t.Y8G("color",e.getStatusColor((null==e.partner?null:e.partner.status)||"")),t.R7$(1),t.SpI(" ",null==e.partner?null:e.partner.status," "),t.R7$(5),t.SpI("",e.formatRating((null==e.partner?null:e.partner.rating)||0)," \u2b50"),t.R7$(9),t.JRh((null==e.partner?null:e.partner.totalDeliveries)||0),t.R7$(5),t.JRh((null==e.partner?null:e.partner.successfulDeliveries)||0),t.R7$(5),t.SpI("",e.formatRating((null==e.partner?null:e.partner.successRate)||0),"%"),t.R7$(5),t.JRh(e.formatEarnings((null==e.partner?null:e.partner.totalEarnings)||0)),t.R7$(3),t.Y8G("ngIf",e.isOnline)}}function pe(r,o){1&r&&(t.j41(0,"div",65),t.nrm(1,"mat-spinner"),t.j41(2,"p"),t.EFF(3,"Loading dashboard..."),t.k0s()())}let me=(()=>{class r{constructor(e,n,i,a,s){this.partnerService=e,this.assignmentService=n,this.authService=i,this.geolocationService=a,this.snackBar=s,this.destroy$=new L.B,this.partner=null,this.isLoading=!0,this.todayStats={deliveries:0,earnings:0,rating:0,hoursWorked:0},this.activeOrders=[],this.availableOrders=[],this.isOnline=!1,this.isAvailable=!1,this.isLocationEnabled=!1,this.lastLocationUpdate=null,this.currentTab=0,this.showEarningsDetails=!1}ngOnInit(){this.loadPartnerData(),this.loadActiveOrders(),this.loadAvailableOrders(),this.startLocationTracking(),this.setupPeriodicUpdates()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadPartnerData(){const e=this.authService.getCurrentUser();e?this.partnerService.getPartnerByUserId(e.id).pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{f.c.isSuccess(n)&&n.data?(this.partner=n.data,this.isOnline=n.data.isOnline,this.isAvailable=n.data.isAvailable,this.loadTodayStats()):this.snackBar.open("Failed to load partner data","Close",{duration:3e3}),this.isLoading=!1},error:n=>{console.error("Error loading partner data:",n),this.snackBar.open("Error loading partner data","Close",{duration:3e3}),this.isLoading=!1}}):this.snackBar.open("User not found","Close",{duration:3e3})}loadActiveOrders(){this.partner&&this.assignmentService.getActiveAssignmentsByPartner(this.partner.id).pipe((0,d.Q)(this.destroy$)).subscribe({next:e=>{f.c.isSuccess(e)&&e.data&&(this.activeOrders=e.data)},error:e=>{console.error("Error loading active orders:",e)}})}loadAvailableOrders(){this.assignmentService.getAvailableOrders().pipe((0,d.Q)(this.destroy$)).subscribe({next:e=>{f.c.isSuccess(e)&&e.data&&(this.availableOrders=e.data)},error:e=>{console.error("Error loading available orders:",e)}})}loadTodayStats(){this.partner&&(this.todayStats={deliveries:5,earnings:450,rating:4.8,hoursWorked:6.5})}toggleOnlineStatus(){this.partner&&this.partnerService.updateOnlineStatus(this.partner.id,!this.isOnline).pipe((0,d.Q)(this.destroy$)).subscribe({next:e=>{f.c.isSuccess(e)&&e.data&&(this.isOnline=e.data.isOnline,this.isAvailable=e.data.isAvailable,this.snackBar.open(this.isOnline?"You are now online":"You are now offline","Close",{duration:3e3}),this.isOnline&&this.requestLocationPermission())},error:e=>{console.error("Error updating online status:",e),this.snackBar.open("Failed to update status","Close",{duration:3e3})}})}toggleAvailability(){!this.partner||!this.isOnline||this.partnerService.updateAvailability(this.partner.id,!this.isAvailable).pipe((0,d.Q)(this.destroy$)).subscribe({next:e=>{f.c.isSuccess(e)&&e.data&&(this.isAvailable=e.data.isAvailable,this.snackBar.open(this.isAvailable?"You are now available for orders":"You are now unavailable","Close",{duration:3e3}))},error:e=>{console.error("Error updating availability:",e),this.snackBar.open("Failed to update availability","Close",{duration:3e3})}})}requestLocationPermission(){this.geolocationService.getCurrentPosition().then(e=>{this.isLocationEnabled=!0,this.updateLocation(e.coords.latitude,e.coords.longitude)}).catch(e=>{console.error("Error getting location:",e),this.snackBar.open("Location access required for delivery tracking","Enable",{duration:5e3}).onAction().subscribe(()=>{this.requestLocationPermission()})})}updateLocation(e,n){this.partner&&this.partnerService.updateLocation(this.partner.id,e,n).pipe((0,d.Q)(this.destroy$)).subscribe({next:i=>{f.c.isSuccess(i)&&(this.lastLocationUpdate=new Date)},error:i=>{console.error("Error updating location:",i)}})}startLocationTracking(){(0,G.Y)(3e4).pipe((0,d.Q)(this.destroy$)).subscribe(()=>{this.isOnline&&this.isLocationEnabled&&this.geolocationService.getCurrentPosition().then(e=>{this.updateLocation(e.coords.latitude,e.coords.longitude)}).catch(e=>{console.error("Error getting location for tracking:",e)})})}setupPeriodicUpdates(){(0,G.Y)(12e4).pipe((0,d.Q)(this.destroy$)).subscribe(()=>{this.isOnline&&(this.loadActiveOrders(),this.loadAvailableOrders())})}acceptOrder(e){this.partner&&this.assignmentService.acceptAssignment(e,this.partner.id).pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{f.c.isSuccess(n)&&(this.snackBar.open("Order accepted successfully","Close",{duration:3e3}),this.loadActiveOrders(),this.loadAvailableOrders())},error:n=>{console.error("Error accepting order:",n),this.snackBar.open("Failed to accept order","Close",{duration:3e3})}})}rejectOrder(e){this.partner&&this.assignmentService.rejectAssignment(e,this.partner.id,"Unable to deliver at this time").pipe((0,d.Q)(this.destroy$)).subscribe({next:i=>{f.c.isSuccess(i)&&(this.snackBar.open("Order rejected","Close",{duration:3e3}),this.loadAvailableOrders())},error:i=>{console.error("Error rejecting order:",i),this.snackBar.open("Failed to reject order","Close",{duration:3e3})}})}markPickedUp(e){this.partner&&this.assignmentService.markPickedUp(e,this.partner.id).pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{f.c.isSuccess(n)&&(this.snackBar.open("Order marked as picked up","Close",{duration:3e3}),this.loadActiveOrders())},error:n=>{console.error("Error marking pickup:",n),this.snackBar.open("Failed to mark as picked up","Close",{duration:3e3})}})}startDelivery(e){this.partner&&this.assignmentService.startDelivery(e,this.partner.id).pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{f.c.isSuccess(n)&&(this.snackBar.open("Delivery started","Close",{duration:3e3}),this.loadActiveOrders())},error:n=>{console.error("Error starting delivery:",n),this.snackBar.open("Failed to start delivery","Close",{duration:3e3})}})}completeDelivery(e){this.partner&&this.assignmentService.completeDelivery(e,this.partner.id,"Delivered successfully").pipe((0,d.Q)(this.destroy$)).subscribe({next:i=>{f.c.isSuccess(i)&&(this.snackBar.open("Delivery completed successfully!","Close",{duration:3e3}),this.loadActiveOrders(),this.loadTodayStats())},error:i=>{console.error("Error completing delivery:",i),this.snackBar.open("Failed to complete delivery","Close",{duration:3e3})}})}getStatusColor(e){return this.partnerService.getStatusColor(e)}getVehicleIcon(e){return this.partnerService.getVehicleIcon(e)}formatDistance(e){return e?`${e.toFixed(1)} km`:"N/A"}formatEarnings(e){return`\u20b9${e.toFixed(2)}`}formatRating(e){return e.toFixed(1)}static{this.\u0275fac=function(n){return new(n||r)(t.rXU(Y.WS),t.rXU(z),t.rXU(Vt.u),t.rXU(Bt),t.rXU(x.UG))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-delivery-partner-dashboard"]],decls:2,vars:2,consts:[["class","delivery-dashboard",4,"ngIf"],["class","loading-container",4,"ngIf"],[1,"delivery-dashboard"],["color","primary",1,"dashboard-header"],[1,"header-content"],[1,"partner-info"],[1,"partner-avatar"],[1,"partner-details"],[1,"partner-id"],[1,"status-controls"],[1,"status-toggle"],["color","accent",3,"ngModel","ngModelChange","change"],["class","status-toggle",4,"ngIf"],[1,"stats-grid"],[1,"stat-card","deliveries"],[1,"stat-icon"],[1,"stat-info"],[1,"stat-value"],[1,"stat-label"],[1,"stat-card","earnings"],[1,"stat-card","rating"],[1,"stat-card","hours"],["animationDuration","0ms",3,"selectedIndex","selectedIndexChange"],["label","Active Orders"],["mat-tab-label",""],[1,"tab-content"],["class","empty-state",4,"ngIf"],["class","orders-list",4,"ngIf"],["label","Available Orders",4,"ngIf"],["label","Earnings"],[3,"partnerId","totalEarnings"],["label","Profile"],[1,"profile-section"],[1,"profile-card"],[1,"profile-grid"],[1,"profile-item"],["selected","",3,"color"],[1,"stat-item"],[1,"stat-number"],["class","location-status",4,"ngIf"],["class","tab-badge",4,"ngIf"],[1,"tab-badge"],[1,"empty-state"],[1,"empty-icon"],[1,"orders-list"],["class","order-card",4,"ngFor","ngForOf"],[1,"order-card"],["mat-card-avatar","",1,"order-avatar"],[1,"order-details"],[1,"detail-row"],["class","detail-row",4,"ngIf"],["align","end"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],["mat-raised-button","","color","accent",3,"click",4,"ngIf"],["mat-button","",3,"routerLink"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","accent",3,"click"],["label","Available Orders"],["class","order-card available-order",4,"ngFor","ngForOf"],[1,"order-card","available-order"],[1,"time-remaining"],["mat-button","","color","warn",3,"click"],[1,"location-status"],["class","last-update",4,"ngIf"],[1,"last-update"],[1,"loading-container"]],template:function(n,i){1&n&&(t.DNE(0,ge,138,33,"div",0),t.DNE(1,pe,4,0,"div",1)),2&n&&(t.Y8G("ngIf",!i.isLoading),t.R7$(1),t.Y8G("ngIf",i.isLoading))},dependencies:[h.Sq,h.bT,g.BC,g.vS,$.Wk,Z.KQ,p.RN,p.YY,p.QG,p.m2,p.MM,p.Lc,p.dh,v.$z,k.An,F.Jl,w.LG,H.ES,H.mq,H.T8,tt.sG,Ut,h.vh],styles:[".delivery-dashboard[_ngcontent-%COMP%]{min-height:100vh;background-color:#f5f5f5}.dashboard-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;box-shadow:0 4px 8px #0000001a}.dashboard-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%;max-width:1200px;margin:0 auto}.dashboard-header[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.dashboard-header[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   .partner-avatar[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px}.dashboard-header[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   .partner-details[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:24px;font-weight:500}.dashboard-header[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   .partner-details[_ngcontent-%COMP%]   .partner-id[_ngcontent-%COMP%]{font-size:14px;opacity:.8}.dashboard-header[_ngcontent-%COMP%]   .status-controls[_ngcontent-%COMP%]{display:flex;gap:24px;align-items:center}.dashboard-header[_ngcontent-%COMP%]   .status-controls[_ngcontent-%COMP%]   .status-toggle[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.dashboard-header[_ngcontent-%COMP%]   .status-controls[_ngcontent-%COMP%]   .status-toggle[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-top:4px;font-size:12px;font-weight:500}.dashboard-header[_ngcontent-%COMP%]   .status-controls[_ngcontent-%COMP%]   .status-toggle[_ngcontent-%COMP%]   span.online[_ngcontent-%COMP%], .dashboard-header[_ngcontent-%COMP%]   .status-controls[_ngcontent-%COMP%]   .status-toggle[_ngcontent-%COMP%]   span.available[_ngcontent-%COMP%]{color:#4caf50}.dashboard-header[_ngcontent-%COMP%]   .status-controls[_ngcontent-%COMP%]   .status-toggle[_ngcontent-%COMP%]   span.offline[_ngcontent-%COMP%], .dashboard-header[_ngcontent-%COMP%]   .status-controls[_ngcontent-%COMP%]   .status-toggle[_ngcontent-%COMP%]   span.unavailable[_ngcontent-%COMP%]{color:#f44336}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;padding:20px;max-width:1200px;margin:0 auto}.stats-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]{background:white;border-radius:12px;box-shadow:0 2px 8px #0000001a;transition:transform .2s ease,box-shadow .2s ease}.stats-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 16px #00000026}.stats-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:20px!important}.stats-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:50px;height:50px;border-radius:50%}.stats-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px;color:#fff}.stats-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-info[_ngcontent-%COMP%]{flex:1}.stats-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-info[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:28px;font-weight:600;line-height:1;margin-bottom:4px}.stats-grid[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-info[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:14px;color:#666;font-weight:500}.stats-grid[_ngcontent-%COMP%]   .stat-card.deliveries[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)}.stats-grid[_ngcontent-%COMP%]   .stat-card.earnings[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%)}.stats-grid[_ngcontent-%COMP%]   .stat-card.rating[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4facfe 0%,#00f2fe 100%)}.stats-grid[_ngcontent-%COMP%]   .stat-card.hours[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#43e97b 0%,#38f9d7 100%)}.tab-content[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto}.tab-badge[_ngcontent-%COMP%]{background:#ff4444;color:#fff;border-radius:10px;padding:2px 8px;font-size:12px;margin-left:8px}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:#666}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;margin-bottom:16px;opacity:.5}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:8px;font-weight:500}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}.orders-list[_ngcontent-%COMP%]{display:grid;gap:16px}.orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]{background:white;border-radius:12px;box-shadow:0 2px 8px #0000001a;transition:transform .2s ease,box-shadow .2s ease}.orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #00000026}.orders-list[_ngcontent-%COMP%]   .order-card.available-order[_ngcontent-%COMP%]{border-left:4px solid #4CAF50}.orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   .order-avatar[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;display:flex;align-items:center;justify-content:center}.orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   .order-avatar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px}.orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]{display:grid;gap:8px;margin:16px 0}.orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:14px}.orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#666}.orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   .time-remaining[_ngcontent-%COMP%]{color:#ff9800;font-weight:500}.orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]{padding:16px!important;gap:8px}.orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:120px}.profile-section[_ngcontent-%COMP%]   .profile-card[_ngcontent-%COMP%]{margin-bottom:20px;background:white;border-radius:12px;box-shadow:0 2px 8px #0000001a}.profile-section[_ngcontent-%COMP%]   .profile-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px}.profile-section[_ngcontent-%COMP%]   .profile-grid[_ngcontent-%COMP%]   .profile-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.profile-section[_ngcontent-%COMP%]   .profile-grid[_ngcontent-%COMP%]   .profile-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#666;font-size:14px}.profile-section[_ngcontent-%COMP%]   .profile-grid[_ngcontent-%COMP%]   .profile-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px;display:flex;align-items:center;gap:8px}.profile-section[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:20px;padding:0}.profile-section[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{text-align:center}.profile-section[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-number[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:#333;margin-bottom:4px}.profile-section[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:14px;color:#666}.location-status[_ngcontent-%COMP%]{position:fixed;bottom:20px;right:20px;background:white;padding:12px 16px;border-radius:8px;box-shadow:0 2px 8px #0000001a;display:flex;align-items:center;gap:8px;font-size:14px;z-index:100}.location-status[_ngcontent-%COMP%]   mat-icon.enabled[_ngcontent-%COMP%]{color:#4caf50}.location-status[_ngcontent-%COMP%]   mat-icon.disabled[_ngcontent-%COMP%]{color:#f44336}.location-status[_ngcontent-%COMP%]   .last-update[_ngcontent-%COMP%]{color:#666;margin-left:8px;font-size:12px}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;gap:20px}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;font-size:16px}@media (max-width: 768px){.dashboard-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex-direction:column;gap:16px;text-align:center}.stats-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;padding:16px}.tab-content[_ngcontent-%COMP%]{padding:16px}.orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]{flex-direction:column}.orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}.location-status[_ngcontent-%COMP%]{position:relative;bottom:auto;right:auto;margin:20px;justify-content:center}}  .mat-mdc-tab-group .mat-mdc-tab-header{border-bottom:1px solid #e0e0e0}  .mat-mdc-tab-group .mat-mdc-tab-label{min-width:120px}  .mat-mdc-tab-group .mat-mdc-tab-label .mat-mdc-tab-label-content{display:flex;align-items:center;gap:8px}  .mat-mdc-slide-toggle{--mdc-switch-selected-track-color: #4CAF50;--mdc-switch-selected-handle-color: #4CAF50}  .mat-mdc-chip.mat-mdc-standard-chip.mat-primary{--mdc-chip-elevated-container-color: #2196F3;color:#fff}  .mat-mdc-chip.mat-mdc-standard-chip.mat-accent{--mdc-chip-elevated-container-color: #4CAF50;color:#fff}  .mat-mdc-chip.mat-mdc-standard-chip.mat-warn{--mdc-chip-elevated-container-color: #f44336;color:#fff}"]})}}return r})();function ue(r,o){1&r&&(t.j41(0,"mat-error"),t.EFF(1,"Name is required"),t.k0s())}function he(r,o){1&r&&(t.j41(0,"mat-error"),t.EFF(1,"Enter valid email"),t.k0s())}function _e(r,o){1&r&&(t.j41(0,"mat-error"),t.EFF(1,"Enter valid 10-digit phone number"),t.k0s())}function fe(r,o){if(1&r&&(t.j41(0,"mat-option",21),t.EFF(1),t.k0s()),2&r){const e=o.$implicit;t.Y8G("value",e),t.R7$(1),t.JRh(e)}}function Ce(r,o){1&r&&(t.j41(0,"mat-error"),t.EFF(1,"Enter valid 12-digit Aadhar number"),t.k0s())}function Pe(r,o){1&r&&(t.j41(0,"mat-icon"),t.EFF(1,"hourglass_empty"),t.k0s())}let ve=(()=>{class r{constructor(e,n,i,a){this.fb=e,this.router=n,this.snackBar=i,this.deliveryPartnerService=a,this.isLoading=!1,this.vehicleTypes=["BIKE","SCOOTER","CAR","BICYCLE"],this.registrationForm=this.fb.group({name:["",[g.k0.required,g.k0.minLength(2)]],email:["",[g.k0.required,g.k0.email]],phone:["",[g.k0.required,g.k0.pattern(/^\d{10}$/)]],address:["",[g.k0.required]],vehicleType:["",[g.k0.required]],vehicleNumber:["",[g.k0.required]],licenseNumber:["",[g.k0.required]],aadharNumber:["",[g.k0.required,g.k0.pattern(/^\d{12}$/)]],bankAccountNumber:["",[g.k0.required]],ifscCode:["",[g.k0.required]]})}ngOnInit(){}onSubmit(){this.registrationForm.valid&&(this.isLoading=!0,this.deliveryPartnerService.registerPartner(this.registrationForm.value).subscribe({next:e=>{this.snackBar.open("Registration submitted successfully!","Close",{duration:3e3}),this.router.navigate(["/delivery/partner/dashboard"]),this.isLoading=!1},error:e=>{this.snackBar.open("Registration failed. Please try again.","Close",{duration:3e3}),this.isLoading=!1}}))}static{this.\u0275fac=function(n){return new(n||r)(t.rXU(g.ok),t.rXU($.Ix),t.rXU(x.UG),t.rXU(Y.WS))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-partner-registration"]],decls:64,vars:9,consts:[[1,"partner-registration-container"],[1,"registration-card"],[3,"formGroup","ngSubmit"],[1,"form-row"],["appearance","outline"],["matInput","","formControlName","name","required",""],[4,"ngIf"],["matInput","","type","email","formControlName","email","required",""],["matInput","","formControlName","phone","required",""],["formControlName","vehicleType","required",""],[3,"value",4,"ngFor","ngForOf"],["appearance","outline",1,"full-width"],["matInput","","formControlName","address","rows","3","required",""],["matInput","","formControlName","vehicleNumber","required",""],["matInput","","formControlName","licenseNumber","required",""],["matInput","","formControlName","aadharNumber","required",""],["matInput","","formControlName","bankAccountNumber","required",""],["matInput","","formControlName","ifscCode","required",""],[1,"form-actions"],["mat-raised-button","","type","button","color","secondary",3,"click"],["mat-raised-button","","type","submit","color","primary",3,"disabled"],[3,"value"]],template:function(n,i){if(1&n&&(t.j41(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"mat-card-title"),t.EFF(4,"Delivery Partner Registration"),t.k0s(),t.j41(5,"mat-card-subtitle"),t.EFF(6,"Join our delivery network"),t.k0s()(),t.j41(7,"mat-card-content")(8,"form",2),t.bIt("ngSubmit",function(){return i.onSubmit()}),t.j41(9,"div",3)(10,"mat-form-field",4)(11,"mat-label"),t.EFF(12,"Full Name"),t.k0s(),t.nrm(13,"input",5),t.DNE(14,ue,2,0,"mat-error",6),t.k0s(),t.j41(15,"mat-form-field",4)(16,"mat-label"),t.EFF(17,"Email"),t.k0s(),t.nrm(18,"input",7),t.DNE(19,he,2,0,"mat-error",6),t.k0s()(),t.j41(20,"div",3)(21,"mat-form-field",4)(22,"mat-label"),t.EFF(23,"Phone Number"),t.k0s(),t.nrm(24,"input",8),t.DNE(25,_e,2,0,"mat-error",6),t.k0s(),t.j41(26,"mat-form-field",4)(27,"mat-label"),t.EFF(28,"Vehicle Type"),t.k0s(),t.j41(29,"mat-select",9),t.DNE(30,fe,2,2,"mat-option",10),t.k0s()()(),t.j41(31,"mat-form-field",11)(32,"mat-label"),t.EFF(33,"Address"),t.k0s(),t.nrm(34,"textarea",12),t.k0s(),t.j41(35,"div",3)(36,"mat-form-field",4)(37,"mat-label"),t.EFF(38,"Vehicle Number"),t.k0s(),t.nrm(39,"input",13),t.k0s(),t.j41(40,"mat-form-field",4)(41,"mat-label"),t.EFF(42,"License Number"),t.k0s(),t.nrm(43,"input",14),t.k0s()(),t.j41(44,"div",3)(45,"mat-form-field",4)(46,"mat-label"),t.EFF(47,"Aadhar Number"),t.k0s(),t.nrm(48,"input",15),t.DNE(49,Ce,2,0,"mat-error",6),t.k0s(),t.j41(50,"mat-form-field",4)(51,"mat-label"),t.EFF(52,"Bank Account Number"),t.k0s(),t.nrm(53,"input",16),t.k0s()(),t.j41(54,"mat-form-field",11)(55,"mat-label"),t.EFF(56,"IFSC Code"),t.k0s(),t.nrm(57,"input",17),t.k0s(),t.j41(58,"div",18)(59,"button",19),t.bIt("click",function(){return i.router.navigate(["/"])}),t.EFF(60,"Cancel"),t.k0s(),t.j41(61,"button",20),t.DNE(62,Pe,2,0,"mat-icon",6),t.EFF(63),t.k0s()()()()()()),2&n){let a,s,c,m;t.R7$(8),t.Y8G("formGroup",i.registrationForm),t.R7$(6),t.Y8G("ngIf",null==(a=i.registrationForm.get("name"))?null:a.hasError("required")),t.R7$(5),t.Y8G("ngIf",null==(s=i.registrationForm.get("email"))?null:s.hasError("email")),t.R7$(6),t.Y8G("ngIf",null==(c=i.registrationForm.get("phone"))?null:c.hasError("pattern")),t.R7$(5),t.Y8G("ngForOf",i.vehicleTypes),t.R7$(19),t.Y8G("ngIf",null==(m=i.registrationForm.get("aadharNumber"))?null:m.hasError("pattern")),t.R7$(12),t.Y8G("disabled",!i.registrationForm.valid||i.isLoading),t.R7$(1),t.Y8G("ngIf",i.isLoading),t.R7$(1),t.SpI(" ",i.isLoading?"Registering...":"Register"," ")}},dependencies:[h.Sq,h.bT,g.qT,g.me,g.BC,g.cb,g.YS,g.j4,g.JD,p.RN,p.m2,p.MM,p.Lc,p.dh,v.$z,M.rl,M.nJ,M.TL,T.fg,B.VO,J.wT,k.An],styles:[".partner-registration-container[_ngcontent-%COMP%]{max-width:800px;margin:2rem auto;padding:1rem}.registration-card[_ngcontent-%COMP%]{padding:2rem}.form-row[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1rem}.form-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;margin-top:2rem}@media (max-width: 768px){.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:0}}"]})}}return r})();function Oe(r,o){if(1&r&&(t.j41(0,"div",5)(1,"p")(2,"strong"),t.EFF(3,"Name:"),t.k0s(),t.EFF(4),t.k0s(),t.j41(5,"p")(6,"strong"),t.EFF(7,"Email:"),t.k0s(),t.EFF(8),t.k0s(),t.j41(9,"p")(10,"strong"),t.EFF(11,"Phone:"),t.k0s(),t.EFF(12),t.k0s(),t.j41(13,"p")(14,"strong"),t.EFF(15,"Vehicle Type:"),t.k0s(),t.EFF(16),t.k0s(),t.j41(17,"p")(18,"strong"),t.EFF(19,"Status:"),t.k0s(),t.EFF(20),t.k0s()()),2&r){const e=t.XpG();t.R7$(4),t.SpI(" ",e.data.partnerData.name,""),t.R7$(4),t.SpI(" ",e.data.partnerData.email,""),t.R7$(4),t.SpI(" ",e.data.partnerData.phone,""),t.R7$(4),t.SpI(" ",e.data.partnerData.vehicleType,""),t.R7$(4),t.SpI(" ",e.data.partnerData.status,"")}}let Me=(()=>{class r{constructor(e,n){this.dialogRef=e,this.data=n}onClose(){this.dialogRef.close()}static{this.\u0275fac=function(n){return new(n||r)(t.rXU(O.CP),t.rXU(O.Vh))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-partner-details-dialog"]],decls:7,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["class","partner-info",4,"ngIf"],["mat-dialog-actions","","align","end"],["mat-button","",3,"click"],[1,"partner-info"]],template:function(n,i){1&n&&(t.j41(0,"h2",0),t.EFF(1,"Partner Details"),t.k0s(),t.j41(2,"div",1),t.DNE(3,Oe,21,5,"div",2),t.k0s(),t.j41(4,"div",3)(5,"button",4),t.bIt("click",function(){return i.onClose()}),t.EFF(6,"Close"),t.k0s()()),2&n&&(t.R7$(3),t.Y8G("ngIf",i.data.partnerData))},dependencies:[h.bT,v.$z,O.BI,O.Yi,O.E7],styles:[".partner-info[_ngcontent-%COMP%]{padding:1rem 0}.partner-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.5rem 0}"]})}}return r})();function be(r,o){if(1&r&&(t.j41(0,"div",10)(1,"p")(2,"strong"),t.EFF(3),t.k0s(),t.EFF(4),t.k0s()()),2&r){const e=o.$implicit;t.R7$(3),t.SpI("",e.type,":"),t.R7$(1),t.SpI(" ",e.status,"")}}function ke(r,o){if(1&r&&(t.j41(0,"div",8),t.DNE(1,be,5,2,"div",9),t.k0s()),2&r){const e=t.XpG();t.R7$(1),t.Y8G("ngForOf",e.data.documents)}}function Fe(r,o){1&r&&(t.j41(0,"p"),t.EFF(1,"No documents available for verification."),t.k0s())}let ye=(()=>{class r{constructor(e,n){this.dialogRef=e,this.data=n}onApprove(){this.dialogRef.close({action:"approve"})}onReject(){this.dialogRef.close({action:"reject"})}onClose(){this.dialogRef.close()}static{this.\u0275fac=function(n){return new(n||r)(t.rXU(O.CP),t.rXU(O.Vh))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-document-verification-dialog"]],decls:13,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["class","documents-list",4,"ngIf","ngIfElse"],["noDocuments",""],["mat-dialog-actions","","align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","primary",3,"click"],[1,"documents-list"],["class","document-item",4,"ngFor","ngForOf"],[1,"document-item"]],template:function(n,i){if(1&n&&(t.j41(0,"h2",0),t.EFF(1,"Document Verification"),t.k0s(),t.j41(2,"div",1),t.DNE(3,ke,2,1,"div",2),t.DNE(4,Fe,2,0,"ng-template",null,3,t.C5r),t.k0s(),t.j41(6,"div",4)(7,"button",5),t.bIt("click",function(){return i.onClose()}),t.EFF(8,"Cancel"),t.k0s(),t.j41(9,"button",6),t.bIt("click",function(){return i.onReject()}),t.EFF(10,"Reject"),t.k0s(),t.j41(11,"button",7),t.bIt("click",function(){return i.onApprove()}),t.EFF(12,"Approve"),t.k0s()()),2&n){const a=t.sdS(5);t.R7$(3),t.Y8G("ngIf",null==i.data.documents?null:i.data.documents.length)("ngIfElse",a)}},dependencies:[h.Sq,h.bT,v.$z,O.BI,O.Yi,O.E7],styles:[".documents-list[_ngcontent-%COMP%]{padding:1rem 0}.document-item[_ngcontent-%COMP%]{padding:.5rem 0;border-bottom:1px solid #eee}.document-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.document-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}"]})}}return r})();var lt=l(8370);function xe(r,o){if(1&r){const e=t.RV6();t.j41(0,"div",52)(1,"mat-icon",49),t.EFF(2,"emergency"),t.k0s(),t.j41(3,"div",53)(4,"div",54),t.EFF(5),t.k0s(),t.j41(6,"div",55),t.EFF(7),t.nI1(8,"date"),t.k0s()(),t.j41(9,"button",56),t.bIt("click",function(){const a=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.viewEmergencyDetails(a))}),t.j41(10,"mat-icon"),t.EFF(11,"visibility"),t.k0s()()()}if(2&r){const e=o.$implicit;t.R7$(5),t.Lme("",e.partnerName," - ",e.type,""),t.R7$(2),t.JRh(t.i5U(8,3,e.timestamp,"short"))}}function Ee(r,o){if(1&r&&(t.j41(0,"mat-expansion-panel",48)(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"mat-icon",49),t.EFF(4,"warning"),t.k0s(),t.EFF(5),t.k0s()(),t.j41(6,"div",50),t.DNE(7,xe,12,6,"div",51),t.k0s()()),2&r){const e=t.XpG();t.R7$(5),t.SpI(" Emergency Alerts (",e.emergencyAlerts.length,") "),t.R7$(2),t.Y8G("ngForOf",e.emergencyAlerts)}}function De(r,o){1&r&&(t.j41(0,"th",57),t.EFF(1,"Partner ID"),t.k0s())}function we(r,o){if(1&r&&(t.j41(0,"td",58)(1,"span",59),t.EFF(2),t.k0s()()),2&r){const e=o.$implicit;t.R7$(2),t.JRh(e.partnerId)}}function Ie(r,o){1&r&&(t.j41(0,"th",57),t.EFF(1,"Name"),t.k0s())}function je(r,o){if(1&r&&(t.j41(0,"td",58)(1,"div",60)(2,"mat-icon",61),t.EFF(3,"account_circle"),t.k0s(),t.EFF(4),t.k0s()()),2&r){const e=o.$implicit;t.R7$(4),t.SpI(" ",e.fullName," ")}}function Se(r,o){1&r&&(t.j41(0,"th",62),t.EFF(1,"Phone"),t.k0s())}function Te(r,o){if(1&r&&(t.j41(0,"td",58)(1,"a",63),t.EFF(2),t.k0s()()),2&r){const e=o.$implicit;t.R7$(1),t.Mz_("href","tel:",e.phoneNumber,"",t.B4B),t.R7$(1),t.JRh(e.phoneNumber)}}function Re(r,o){1&r&&(t.j41(0,"th",57),t.EFF(1,"Vehicle"),t.k0s())}function Ae(r,o){if(1&r&&(t.j41(0,"td",58)(1,"div",64)(2,"mat-icon"),t.EFF(3),t.k0s(),t.EFF(4),t.k0s()()),2&r){const e=o.$implicit,n=t.XpG();t.R7$(3),t.JRh(n.getVehicleIcon(e.vehicleType)),t.R7$(1),t.SpI(" ",e.vehicleType," ")}}function $e(r,o){1&r&&(t.j41(0,"th",57),t.EFF(1,"Status"),t.k0s())}function Ne(r,o){if(1&r&&(t.j41(0,"td",58)(1,"mat-chip",65),t.EFF(2),t.k0s()()),2&r){const e=o.$implicit,n=t.XpG();t.R7$(1),t.Y8G("color",n.getStatusColor(e.status)),t.R7$(1),t.SpI(" ",e.status," ")}}function Le(r,o){1&r&&(t.j41(0,"th",57),t.EFF(1,"Verification"),t.k0s())}function Ge(r,o){if(1&r&&(t.j41(0,"td",58)(1,"div",66)(2,"mat-icon",67),t.EFF(3),t.k0s(),t.EFF(4),t.k0s()()),2&r){const e=o.$implicit,n=t.XpG();t.R7$(2),t.Y8G("color","VERIFIED"===e.verificationStatus?"primary":"warn"),t.R7$(1),t.SpI(" ",n.getVerificationIcon(e.verificationStatus)," "),t.R7$(1),t.SpI(" ",e.verificationStatus," ")}}function Ve(r,o){1&r&&(t.j41(0,"th",57),t.EFF(1,"Rating"),t.k0s())}function Be(r,o){if(1&r&&(t.j41(0,"td",58)(1,"div",68)(2,"mat-icon",69),t.EFF(3,"star"),t.k0s(),t.EFF(4),t.nI1(5,"number"),t.k0s()()),2&r){const e=o.$implicit;t.R7$(4),t.SpI(" ",t.i5U(5,1,e.rating,"1.1-1")," ")}}function Ue(r,o){1&r&&(t.j41(0,"th",57),t.EFF(1,"Deliveries"),t.k0s())}function Ye(r,o){if(1&r&&(t.j41(0,"td",58),t.EFF(1),t.k0s()),2&r){const e=o.$implicit;t.R7$(1),t.JRh(e.totalDeliveries)}}function ze(r,o){1&r&&(t.j41(0,"th",62),t.EFF(1,"Online"),t.k0s())}function Xe(r,o){if(1&r&&(t.j41(0,"td",58)(1,"mat-icon"),t.EFF(2),t.k0s()()),2&r){const e=o.$implicit;t.R7$(1),t.AVh("online",e.isOnline)("offline",!e.isOnline),t.R7$(1),t.SpI(" ",e.isOnline?"wifi":"wifi_off"," ")}}function Je(r,o){1&r&&(t.j41(0,"th",62),t.EFF(1,"Actions"),t.k0s())}function Ke(r,o){if(1&r){const e=t.RV6();t.j41(0,"button",72),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,a=t.XpG();return t.Njj(a.verifyDocuments(i))}),t.j41(1,"mat-icon"),t.EFF(2,"verified_user"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Verify Documents"),t.k0s()()}}function We(r,o){if(1&r){const e=t.RV6();t.j41(0,"button",72),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,a=t.XpG();return t.Njj(a.approvePartner(i))}),t.j41(1,"mat-icon",74),t.EFF(2,"check_circle"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Approve"),t.k0s()()}}function qe(r,o){if(1&r){const e=t.RV6();t.j41(0,"button",72),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,a=t.XpG();return t.Njj(a.rejectPartner(i))}),t.j41(1,"mat-icon",49),t.EFF(2,"cancel"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Reject"),t.k0s()()}}function He(r,o){if(1&r){const e=t.RV6();t.j41(0,"button",72),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,a=t.XpG();return t.Njj(a.activatePartner(i))}),t.j41(1,"mat-icon",74),t.EFF(2,"play_circle"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Activate"),t.k0s()()}}function Qe(r,o){if(1&r){const e=t.RV6();t.j41(0,"button",72),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,a=t.XpG();return t.Njj(a.suspendPartner(i))}),t.j41(1,"mat-icon",49),t.EFF(2,"pause_circle"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Suspend"),t.k0s()()}}function Ze(r,o){if(1&r){const e=t.RV6();t.j41(0,"button",72),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,a=t.XpG();return t.Njj(a.blockPartner(i))}),t.j41(1,"mat-icon",49),t.EFF(2,"block"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Block"),t.k0s()()}}function tn(r,o){if(1&r){const e=t.RV6();t.j41(0,"td",58)(1,"button",70)(2,"mat-icon"),t.EFF(3,"more_vert"),t.k0s()(),t.j41(4,"mat-menu",null,71)(6,"button",72),t.bIt("click",function(){const a=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.viewPartnerDetails(a))}),t.j41(7,"mat-icon"),t.EFF(8,"visibility"),t.k0s(),t.j41(9,"span"),t.EFF(10,"View Details"),t.k0s()(),t.DNE(11,Ke,5,0,"button",73),t.nrm(12,"mat-divider"),t.DNE(13,We,5,0,"button",73),t.DNE(14,qe,5,0,"button",73),t.DNE(15,He,5,0,"button",73),t.DNE(16,Qe,5,0,"button",73),t.DNE(17,Ze,5,0,"button",73),t.k0s()()}if(2&r){const e=o.$implicit,n=t.sdS(5),i=t.XpG();t.R7$(1),t.Y8G("matMenuTriggerFor",n)("disabled",i.isProcessing),t.R7$(10),t.Y8G("ngIf","VERIFIED"!==e.verificationStatus),t.R7$(2),t.Y8G("ngIf","PENDING"===e.status),t.R7$(1),t.Y8G("ngIf","PENDING"===e.status),t.R7$(1),t.Y8G("ngIf","SUSPENDED"===e.status),t.R7$(1),t.Y8G("ngIf","ACTIVE"===e.status),t.R7$(1),t.Y8G("ngIf","BLOCKED"!==e.status)}}function en(r,o){1&r&&t.nrm(0,"tr",75)}function nn(r,o){if(1&r&&t.nrm(0,"tr",76),2&r){const e=o.$implicit;t.AVh("pending-row","PENDING"===e.status)("suspended-row","SUSPENDED"===e.status)}}function rn(r,o){1&r&&(t.j41(0,"div",77),t.nrm(1,"mat-spinner"),t.k0s())}const an=function(){return[10,25,50,100]};let on=(()=>{class r{constructor(e,n,i,a){this.partnerService=e,this.webSocketService=n,this.dialog=i,this.snackBar=a,this.destroy$=new L.B,this.displayedColumns=["partnerId","fullName","phoneNumber","vehicleType","status","verificationStatus","rating","totalDeliveries","isOnline","actions"],this.statusFilter="ALL",this.verificationFilter="ALL",this.searchTerm="",this.stats={total:0,active:0,pending:0,suspended:0,online:0,verified:0},this.isLoading=!0,this.isProcessing=!1,this.onlinePartners=new Set,this.emergencyAlerts=[],this.dataSource=new u.I6([])}ngOnInit(){this.loadPartners(),this.loadStatistics(),this.setupWebSocketSubscriptions(),this.setupFilters()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadPartners(){this.isLoading=!0,this.dataSource.data=[{id:1,partnerId:"DP001",fullName:"John Smith",phoneNumber:"+91 9876543210",email:"john.smith@delivery.com",vehicleType:"BIKE",vehicleNumber:"KA-01-AB-1234",status:"ACTIVE",verificationStatus:"VERIFIED",rating:4.5,totalDeliveries:156,isOnline:!0,isAvailable:!0,currentLocation:{lat:12.9716,lng:77.5946},serviceAreas:["Koramangala","BTM Layout","HSR Layout"],createdAt:new Date("2024-01-15"),updatedAt:new Date},{id:2,partnerId:"DP002",fullName:"Sarah Wilson",phoneNumber:"+91 9876543211",email:"sarah.wilson@delivery.com",vehicleType:"SCOOTER",vehicleNumber:"KA-05-CD-5678",status:"ACTIVE",verificationStatus:"VERIFIED",rating:4.8,totalDeliveries:289,isOnline:!0,isAvailable:!1,currentLocation:{lat:12.9816,lng:77.6046},serviceAreas:["Indiranagar","Domlur","Old Airport Road"],createdAt:new Date("2024-02-20"),updatedAt:new Date},{id:3,partnerId:"DP003",fullName:"Mike Johnson",phoneNumber:"+91 9876543212",email:"mike.johnson@delivery.com",vehicleType:"CAR",vehicleNumber:"KA-03-EF-9012",status:"PENDING",verificationStatus:"PENDING",rating:0,totalDeliveries:0,isOnline:!1,isAvailable:!1,currentLocation:null,serviceAreas:["Whitefield","Marathahalli"],createdAt:new Date("2024-03-10"),updatedAt:new Date}],this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.updateOnlineStatus(),this.isLoading=!1,this.stats={total:3,active:2,pending:1,suspended:0,online:2,verified:2}}loadStatistics(){this.partnerService.getPartnerCounts().pipe((0,d.Q)(this.destroy$)).subscribe({next:e=>{f.c.isSuccess(e)&&e.data&&(this.stats={total:Object.values(e.data).reduce((n,i)=>n+i,0),active:e.data.ACTIVE||0,pending:e.data.PENDING||0,suspended:e.data.SUSPENDED||0,online:this.onlinePartners.size,verified:this.dataSource.data.filter(n=>"VERIFIED"===n.verificationStatus).length})},error:e=>{console.error("Error loading statistics:",e)}})}setupWebSocketSubscriptions(){this.webSocketService.subscribe("/topic/delivery/admin/partner-status").pipe((0,d.Q)(this.destroy$)).subscribe(e=>{e.isOnline?this.onlinePartners.add(e.partnerId):this.onlinePartners.delete(e.partnerId),this.updateOnlineStatus(),this.stats.online=this.onlinePartners.size}),this.webSocketService.subscribeToEmergencyAlerts().pipe((0,d.Q)(this.destroy$)).subscribe(e=>{this.emergencyAlerts.unshift(e),this.showEmergencyAlert(e)})}setupFilters(){this.dataSource.filterPredicate=(e,n)=>{const i=n.toLowerCase();return!("ALL"!==this.statusFilter&&e.status!==this.statusFilter||"ALL"!==this.verificationFilter&&e.verificationStatus!==this.verificationFilter)&&(!i||e.fullName.toLowerCase().includes(i)||e.partnerId.toLowerCase().includes(i)||e.phoneNumber.includes(i)||e.email.toLowerCase().includes(i))}}applyFilter(){this.dataSource.filter=this.searchTerm.trim().toLowerCase()}onStatusFilterChange(){this.applyFilter()}onVerificationFilterChange(){this.applyFilter()}viewPartnerDetails(e){this.dialog.open(Me,{width:"800px",data:e})}verifyDocuments(e){this.dialog.open(ye,{width:"900px",data:e}).afterClosed().subscribe(i=>{i&&this.loadPartners()})}approvePartner(e){e.allDocumentsVerified?(this.isProcessing=!0,this.partnerService.updatePartnerStatus(e.id,"ACTIVE").pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{f.c.isSuccess(n)&&this.partnerService.updateVerificationStatus(e.id,"VERIFIED").subscribe(()=>{this.snackBar.open("Partner approved successfully","Close",{duration:3e3}),this.loadPartners(),this.loadStatistics()}),this.isProcessing=!1},error:n=>{console.error("Error approving partner:",n),this.snackBar.open("Failed to approve partner","Close",{duration:3e3}),this.isProcessing=!1}})):this.snackBar.open("Please verify all documents before approval","Close",{duration:3e3})}rejectPartner(e){this.isProcessing=!0,this.partnerService.updateVerificationStatus(e.id,"REJECTED").pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{f.c.isSuccess(n)&&(this.snackBar.open("Partner rejected","Close",{duration:3e3}),this.loadPartners(),this.loadStatistics()),this.isProcessing=!1},error:n=>{console.error("Error rejecting partner:",n),this.snackBar.open("Failed to reject partner","Close",{duration:3e3}),this.isProcessing=!1}})}suspendPartner(e){this.isProcessing=!0,this.partnerService.updatePartnerStatus(e.id,"SUSPENDED").pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{f.c.isSuccess(n)&&(this.snackBar.open("Partner suspended","Close",{duration:3e3}),this.loadPartners(),this.loadStatistics()),this.isProcessing=!1},error:n=>{console.error("Error suspending partner:",n),this.snackBar.open("Failed to suspend partner","Close",{duration:3e3}),this.isProcessing=!1}})}activatePartner(e){this.isProcessing=!0,this.partnerService.updatePartnerStatus(e.id,"ACTIVE").pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{f.c.isSuccess(n)&&(this.snackBar.open("Partner activated","Close",{duration:3e3}),this.loadPartners(),this.loadStatistics()),this.isProcessing=!1},error:n=>{console.error("Error activating partner:",n),this.snackBar.open("Failed to activate partner","Close",{duration:3e3}),this.isProcessing=!1}})}blockPartner(e){confirm("Are you sure you want to block this partner? This action cannot be easily reversed.")&&(this.isProcessing=!0,this.partnerService.updatePartnerStatus(e.id,"BLOCKED").pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{f.c.isSuccess(n)&&(this.snackBar.open("Partner blocked","Close",{duration:3e3}),this.loadPartners(),this.loadStatistics()),this.isProcessing=!1},error:n=>{console.error("Error blocking partner:",n),this.snackBar.open("Failed to block partner","Close",{duration:3e3}),this.isProcessing=!1}}))}updateOnlineStatus(){this.dataSource.data.forEach(e=>{e.isOnline=this.onlinePartners.has(e.id)}),this.dataSource._updateChangeSubscription()}showEmergencyAlert(e){this.snackBar.open(`EMERGENCY: Partner ${e.partnerName} - ${e.type}`,"View",{duration:1e4,panelClass:"emergency-snackbar"}).onAction().subscribe(()=>{this.viewEmergencyDetails(e)})}viewEmergencyDetails(e){console.log("Emergency details:",e)}exportPartnerData(){const e=this.convertToCSV(this.dataSource.data);this.downloadCSV(e,"partners.csv")}convertToCSV(e){return[["Partner ID","Name","Phone","Email","Vehicle","Status","Rating","Deliveries"],...e.map(a=>[a.partnerId,a.fullName,a.phoneNumber,a.email,a.vehicleType,a.status,a.rating,a.totalDeliveries])].map(a=>a.join(",")).join("\n")}downloadCSV(e,n){const i=new Blob([e],{type:"text/csv"}),a=window.URL.createObjectURL(i),s=document.createElement("a");s.href=a,s.download=n,s.click(),window.URL.revokeObjectURL(a)}refreshData(){this.loadPartners(),this.loadStatistics()}getStatusColor(e){return this.partnerService.getStatusColor(e)}getVerificationIcon(e){switch(e){case"VERIFIED":return"verified";case"PENDING":return"pending";case"REJECTED":return"cancel";default:return"help"}}getVehicleIcon(e){return this.partnerService.getVehicleIcon(e)}static{this.\u0275fac=function(n){return new(n||r)(t.rXU(Y.WS),t.rXU(lt.V),t.rXU(O.bZ),t.rXU(x.UG))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-admin-partners"]],viewQuery:function(n,i){if(1&n&&(t.GBs(K.iy,5),t.GBs(R.B4,5)),2&n){let a;t.mGM(a=t.lsd())&&(i.paginator=a.first),t.mGM(a=t.lsd())&&(i.sort=a.first)}},decls:127,vars:16,consts:[[1,"admin-partners-container"],[1,"page-header"],[1,"spacer"],["mat-icon-button","",3,"disabled","click"],["mat-raised-button","","color","primary",3,"click"],[1,"stats-container"],[1,"stat-card"],[1,"stat-value"],[1,"stat-label"],[1,"stat-icon"],[1,"stat-card","active"],[1,"stat-card","pending"],[1,"stat-card","online"],[1,"stat-card","verified"],["class","emergency-panel",4,"ngIf"],[1,"filters-card"],[1,"filters-row"],["appearance","outline"],["matInput","","placeholder","Name, ID, Phone, or Email",3,"ngModel","ngModelChange","keyup"],["matPrefix",""],[3,"ngModel","ngModelChange","selectionChange"],["value","ALL"],["value","ACTIVE"],["value","PENDING"],["value","SUSPENDED"],["value","BLOCKED"],["value","VERIFIED"],["value","REJECTED"],[1,"table-card"],[1,"table-container"],["mat-table","","matSort","",1,"partners-table",3,"dataSource"],["matColumnDef","partnerId"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","fullName"],["matColumnDef","phoneNumber"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","vehicleType"],["matColumnDef","status"],["matColumnDef","verificationStatus"],["matColumnDef","rating"],["matColumnDef","totalDeliveries"],["matColumnDef","isOnline"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"pending-row","suspended-row",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["class","loading-overlay",4,"ngIf"],[1,"emergency-panel"],["color","warn"],[1,"emergency-list"],["class","emergency-item",4,"ngFor","ngForOf"],[1,"emergency-item"],[1,"alert-details"],[1,"alert-partner"],[1,"alert-time"],["mat-icon-button","",3,"click"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"partner-id"],[1,"partner-name"],[1,"avatar-icon"],["mat-header-cell",""],[3,"href"],[1,"vehicle-info"],["selected","",3,"color"],[1,"verification-status"],[3,"color"],[1,"rating"],[1,"star-icon"],["mat-icon-button","",3,"matMenuTriggerFor","disabled"],["menu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],["color","primary"],["mat-header-row",""],["mat-row",""],[1,"loading-overlay"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"mat-toolbar",1)(2,"h1"),t.EFF(3,"Delivery Partner Management"),t.k0s(),t.nrm(4,"span",2),t.j41(5,"button",3),t.bIt("click",function(){return i.refreshData()}),t.j41(6,"mat-icon"),t.EFF(7,"refresh"),t.k0s()(),t.j41(8,"button",4),t.bIt("click",function(){return i.exportPartnerData()}),t.j41(9,"mat-icon"),t.EFF(10,"download"),t.k0s(),t.EFF(11," Export Data "),t.k0s()(),t.j41(12,"div",5)(13,"mat-card",6)(14,"mat-card-content")(15,"div",7),t.EFF(16),t.k0s(),t.j41(17,"div",8),t.EFF(18,"Total Partners"),t.k0s(),t.j41(19,"mat-icon",9),t.EFF(20,"group"),t.k0s()()(),t.j41(21,"mat-card",10)(22,"mat-card-content")(23,"div",7),t.EFF(24),t.k0s(),t.j41(25,"div",8),t.EFF(26,"Active"),t.k0s(),t.j41(27,"mat-icon",9),t.EFF(28,"check_circle"),t.k0s()()(),t.j41(29,"mat-card",11)(30,"mat-card-content")(31,"div",7),t.EFF(32),t.k0s(),t.j41(33,"div",8),t.EFF(34,"Pending Approval"),t.k0s(),t.j41(35,"mat-icon",9),t.EFF(36,"pending"),t.k0s()()(),t.j41(37,"mat-card",12)(38,"mat-card-content")(39,"div",7),t.EFF(40),t.k0s(),t.j41(41,"div",8),t.EFF(42,"Currently Online"),t.k0s(),t.j41(43,"mat-icon",9),t.EFF(44,"wifi"),t.k0s()()(),t.j41(45,"mat-card",13)(46,"mat-card-content")(47,"div",7),t.EFF(48),t.k0s(),t.j41(49,"div",8),t.EFF(50,"Verified"),t.k0s(),t.j41(51,"mat-icon",9),t.EFF(52,"verified_user"),t.k0s()()()(),t.DNE(53,Ee,8,2,"mat-expansion-panel",14),t.j41(54,"mat-card",15)(55,"mat-card-content")(56,"div",16)(57,"mat-form-field",17)(58,"mat-label"),t.EFF(59,"Search Partners"),t.k0s(),t.j41(60,"input",18),t.bIt("ngModelChange",function(s){return i.searchTerm=s})("keyup",function(){return i.applyFilter()}),t.k0s(),t.j41(61,"mat-icon",19),t.EFF(62,"search"),t.k0s()(),t.j41(63,"mat-form-field",17)(64,"mat-label"),t.EFF(65,"Status Filter"),t.k0s(),t.j41(66,"mat-select",20),t.bIt("ngModelChange",function(s){return i.statusFilter=s})("selectionChange",function(){return i.onStatusFilterChange()}),t.j41(67,"mat-option",21),t.EFF(68,"All Status"),t.k0s(),t.j41(69,"mat-option",22),t.EFF(70,"Active"),t.k0s(),t.j41(71,"mat-option",23),t.EFF(72,"Pending"),t.k0s(),t.j41(73,"mat-option",24),t.EFF(74,"Suspended"),t.k0s(),t.j41(75,"mat-option",25),t.EFF(76,"Blocked"),t.k0s()()(),t.j41(77,"mat-form-field",17)(78,"mat-label"),t.EFF(79,"Verification Filter"),t.k0s(),t.j41(80,"mat-select",20),t.bIt("ngModelChange",function(s){return i.verificationFilter=s})("selectionChange",function(){return i.onVerificationFilterChange()}),t.j41(81,"mat-option",21),t.EFF(82,"All Verification"),t.k0s(),t.j41(83,"mat-option",26),t.EFF(84,"Verified"),t.k0s(),t.j41(85,"mat-option",23),t.EFF(86,"Pending"),t.k0s(),t.j41(87,"mat-option",27),t.EFF(88,"Rejected"),t.k0s()()()()()(),t.j41(89,"mat-card",28)(90,"mat-card-content")(91,"div",29)(92,"table",30),t.qex(93,31),t.DNE(94,De,2,0,"th",32),t.DNE(95,we,3,1,"td",33),t.bVm(),t.qex(96,34),t.DNE(97,Ie,2,0,"th",32),t.DNE(98,je,5,1,"td",33),t.bVm(),t.qex(99,35),t.DNE(100,Se,2,0,"th",36),t.DNE(101,Te,3,2,"td",33),t.bVm(),t.qex(102,37),t.DNE(103,Re,2,0,"th",32),t.DNE(104,Ae,5,2,"td",33),t.bVm(),t.qex(105,38),t.DNE(106,$e,2,0,"th",32),t.DNE(107,Ne,3,2,"td",33),t.bVm(),t.qex(108,39),t.DNE(109,Le,2,0,"th",32),t.DNE(110,Ge,5,3,"td",33),t.bVm(),t.qex(111,40),t.DNE(112,Ve,2,0,"th",32),t.DNE(113,Be,6,4,"td",33),t.bVm(),t.qex(114,41),t.DNE(115,Ue,2,0,"th",32),t.DNE(116,Ye,2,1,"td",33),t.bVm(),t.qex(117,42),t.DNE(118,ze,2,0,"th",36),t.DNE(119,Xe,3,5,"td",33),t.bVm(),t.qex(120,43),t.DNE(121,Je,2,0,"th",36),t.DNE(122,tn,18,8,"td",33),t.bVm(),t.DNE(123,en,1,0,"tr",44),t.DNE(124,nn,1,4,"tr",45),t.k0s()(),t.nrm(125,"mat-paginator",46),t.k0s()(),t.DNE(126,rn,2,0,"div",47),t.k0s()),2&n&&(t.R7$(5),t.Y8G("disabled",i.isLoading),t.R7$(11),t.JRh(i.stats.total),t.R7$(8),t.JRh(i.stats.active),t.R7$(8),t.JRh(i.stats.pending),t.R7$(8),t.JRh(i.stats.online),t.R7$(8),t.JRh(i.stats.verified),t.R7$(5),t.Y8G("ngIf",i.emergencyAlerts.length>0),t.R7$(7),t.Y8G("ngModel",i.searchTerm),t.R7$(6),t.Y8G("ngModel",i.statusFilter),t.R7$(14),t.Y8G("ngModel",i.verificationFilter),t.R7$(12),t.Y8G("dataSource",i.dataSource),t.R7$(31),t.Y8G("matHeaderRowDef",i.displayedColumns),t.R7$(1),t.Y8G("matRowDefColumns",i.displayedColumns),t.R7$(1),t.Y8G("pageSizeOptions",t.lJ4(15,an)),t.R7$(1),t.Y8G("ngIf",i.isLoading))},dependencies:[h.Sq,h.bT,g.me,g.BC,g.vS,Z.KQ,p.RN,p.m2,v.$z,v.iY,M.rl,M.nJ,M.JW,T.fg,B.VO,J.wT,u.Zl,u.tL,u.ji,u.cC,u.YV,u.iL,u.KS,u.$R,u.YZ,u.NB,K.iy,R.B4,R.aE,k.An,F.Jl,w.LG,q.GK,q.Z2,q.WN,I.kk,I.fb,I.Cp,nt.q,h.QX,h.vh],styles:[".admin-partners-container[_ngcontent-%COMP%]{padding:20px 24px;max-width:1400px;margin:0 auto}.page-header[_ngcontent-%COMP%]{background:transparent;padding:0;margin-bottom:20px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:20px;font-weight:500;color:#333}.page-header[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{flex:1}.partners-header[_ngcontent-%COMP%]{margin-bottom:24px}.header-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:1rem}.filter-section[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center;flex-wrap:wrap}.stats-container[_ngcontent-%COMP%], .partners-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);gap:16px;margin-bottom:24px}.stat-card[_ngcontent-%COMP%]{text-align:center;border-radius:12px;box-shadow:0 2px 8px #00000014;border:none;padding:16px 8px;transition:transform .2s,box-shadow .2s}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000001f}.stat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:4px}.stat-card[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%], .stat-card[_ngcontent-%COMP%]   .stat-number[_ngcontent-%COMP%]{font-size:32px;font-weight:700;color:#333}.stat-card[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{color:#666;font-size:13px;font-weight:500}.stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px;margin-top:4px}.stat-card.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e8f5e9,#c8e6c9)}.stat-card.active[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#2e7d32}.stat-card.active[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{color:#388e3c}.stat-card.active[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{color:#4caf50}.stat-card.pending[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff3e0,#ffe0b2)}.stat-card.pending[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#e65100}.stat-card.pending[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{color:#f57c00}.stat-card.pending[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{color:#ff9800}.stat-card.online[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e3f2fd,#bbdefb)}.stat-card.online[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#1565c0}.stat-card.online[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{color:#1976d2}.stat-card.online[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{color:#2196f3}.stat-card.verified[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f3e5f5,#e1bee7)}.stat-card.verified[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#6a1b9a}.stat-card.verified[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{color:#7b1fa2}.stat-card.verified[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{color:#9c27b0}.emergency-panel[_ngcontent-%COMP%]{margin-bottom:16px}.emergency-list[_ngcontent-%COMP%]   .emergency-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:8px 0;border-bottom:1px solid #f0f0f0}.emergency-list[_ngcontent-%COMP%]   .emergency-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.emergency-list[_ngcontent-%COMP%]   .alert-details[_ngcontent-%COMP%]{flex:1}.emergency-list[_ngcontent-%COMP%]   .alert-details[_ngcontent-%COMP%]   .alert-partner[_ngcontent-%COMP%]{font-weight:500}.emergency-list[_ngcontent-%COMP%]   .alert-details[_ngcontent-%COMP%]   .alert-time[_ngcontent-%COMP%]{font-size:12px;color:#999}.partners-table-container[_ngcontent-%COMP%]{background:white;border-radius:8px;box-shadow:0 2px 8px #00000014;overflow:hidden;margin-top:16px}.partners-table[_ngcontent-%COMP%]{width:100%}.status-chip[_ngcontent-%COMP%]{text-transform:capitalize}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem}.no-data[_ngcontent-%COMP%]{text-align:center;padding:48px;color:#666}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:1rem;color:#ccc}@media (max-width: 1024px){.stats-container[_ngcontent-%COMP%], .partners-stats[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}@media (max-width: 768px){.admin-partners-container[_ngcontent-%COMP%]{padding:12px 16px}.stats-container[_ngcontent-%COMP%], .partners-stats[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.header-actions[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;align-items:stretch}.filter-section[_ngcontent-%COMP%]{justify-content:center}}"]})}}return r})(),it=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${j.c.apiUrl}/delivery/tracking`}updateLocation(e){return this.http.post(`${this.apiUrl}/update-location`,e)}getLatestTracking(e){const n={id:1,assignmentId:e,orderNumber:"ORD-2025-001",latitude:12.97,longitude:77.593,accuracy:5,speed:25,heading:45,trackedAt:new Date(Date.now()-12e4),batteryLevel:85,isMoving:!0,estimatedArrivalTime:new Date(Date.now()+9e5),distanceToDestination:2.5,partnerName:"Raj Kumar",partnerPhone:"+91 9876543210",vehicleType:"BIKE",vehicleNumber:"KA05AB1234",customerName:"Priya Sharma",customerPhone:"+91 9123456789",deliveryAddress:"123, MG Road, Bangalore, Karnataka 560001",orderStatus:"CONFIRMED",assignmentStatus:"IN_TRANSIT",totalDistance:5.2,estimatedTimeMinutes:15,isDelayed:!1};return new D.c(i=>{setTimeout(()=>{i.next({statusCode:"SUCCESS",message:"Tracking data retrieved successfully",data:n,timestamp:(new Date).toISOString()}),i.complete()},300)})}getTrackingHistory(e){const n=[{id:3,assignmentId:e,orderNumber:"ORD-2025-001",latitude:12.968,longitude:77.591,trackedAt:new Date(Date.now()-6e5),isMoving:!0,partnerName:"Raj Kumar",partnerPhone:"+91 9876543210",vehicleType:"BIKE",vehicleNumber:"KA05AB1234",customerName:"Priya Sharma",customerPhone:"+91 9123456789",deliveryAddress:"123, MG Road, Bangalore, Karnataka 560001",orderStatus:"CONFIRMED",assignmentStatus:"IN_TRANSIT",isDelayed:!1},{id:2,assignmentId:e,orderNumber:"ORD-2025-001",latitude:12.969,longitude:77.592,trackedAt:new Date(Date.now()-3e5),isMoving:!0,partnerName:"Raj Kumar",partnerPhone:"+91 9876543210",vehicleType:"BIKE",vehicleNumber:"KA05AB1234",customerName:"Priya Sharma",customerPhone:"+91 9123456789",deliveryAddress:"123, MG Road, Bangalore, Karnataka 560001",orderStatus:"CONFIRMED",assignmentStatus:"IN_TRANSIT",isDelayed:!1}];return new D.c(i=>{setTimeout(()=>{i.next({statusCode:"SUCCESS",message:"Tracking history retrieved successfully",data:n,timestamp:(new Date).toISOString()}),i.complete()},200)})}getTrackingWithHistory(e){return this.http.get(`${this.apiUrl}/assignment/${e}/full`)}getTrackingByTimeRange(e,n,i){const a=(new P.Nl).set("startTime",n.toISOString()).set("endTime",i.toISOString());return this.http.get(`${this.apiUrl}/assignment/${e}/range`,{params:a})}getRecentPartnerTracking(e,n=60){const i=(new P.Nl).set("minutes",n.toString());return this.http.get(`${this.apiUrl}/partner/${e}/recent`,{params:i})}getTrackingPointCount(e){return this.http.get(`${this.apiUrl}/assignment/${e}/count`)}getLowBatteryAlerts(){return this.http.get(`${this.apiUrl}/alerts/low-battery`)}updatePartnerOnlineStatus(e,n){return this.http.post(`${this.apiUrl}/partner/${e}/online-status`,{isOnline:n})}isPartnerMoving(e){return this.http.get(`${this.apiUrl}/assignment/${e}/is-moving`)}isTrackingRecent(e,n=5){const i=(new P.Nl).set("minutes",n.toString());return this.http.get(`${this.apiUrl}/assignment/${e}/is-recent`,{params:i})}cleanupOldTrackingData(e=30){const n=(new P.Nl).set("daysToKeep",e.toString());return this.http.post(`${this.apiUrl}/cleanup`,{},{params:n})}formatTrackingTime(e){const n=new Date(e),a=(new Date).getTime()-n.getTime(),s=Math.floor(a/6e4);if(s<1)return"Just now";if(s<60)return`${s} minutes ago`;if(s<1440){const c=Math.floor(s/60);return`${c} hour${c>1?"s":""} ago`}return n.toLocaleDateString()}isTrackingDataRecent(e,n=5){const i=new Date(e);return((new Date).getTime()-i.getTime())/6e4<=n}calculateDistance(e,n,i,a){const c=this.toRadians(i-e),m=this.toRadians(a-n),C=Math.sin(c/2)*Math.sin(c/2)+Math.cos(this.toRadians(e))*Math.cos(this.toRadians(i))*Math.sin(m/2)*Math.sin(m/2),V=2*Math.atan2(Math.sqrt(C),Math.sqrt(1-C))*6371;return Math.round(100*V)/100}toRadians(e){return e*(Math.PI/180)}formatDistance(e){return e<1?`${Math.round(1e3*e)}m`:`${e.toFixed(1)}km`}formatSpeed(e){return`${Math.round(e)}km/h`}formatBatteryLevel(e){return`${e}%`}getMovementStatus(e,n){return e?n?n<5?"Moving slowly":n<20?"Moving":"Moving fast":"Moving":"Stationary"}getAccuracyStatus(e){return e<=5?"High":e<=15?"Medium":"Low"}estimateArrivalTime(e,n,i,a,s=25){const C=this.calculateDistance(e,n,i,a)/s*60*60*1e3;return new Date(Date.now()+C)}isDelayed(e,n=15){if(!e)return!1;const i=new Date,a=new Date(e);return i.getTime()-a.getTime()-60*n*1e3>0}static{this.\u0275fac=function(n){return new(n||r)(t.KVO(P.Qq))}}static{this.\u0275prov=t.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var at=l(5558),sn=l(7048);let dt=(()=>{class r{constructor(e){this.ngZone=e,this.mapLoadedSubject=new rt.t(!1),this.mapLoaded$=this.mapLoadedSubject.asObservable(),this.markers=new Map,this.infoWindows=new Map,this.loadGoogleMaps()}loadGoogleMaps(){if(typeof google<"u"&&google.maps)return void this.mapLoadedSubject.next(!0);const e=()=>{typeof google<"u"&&google.maps?this.ngZone.run(()=>{this.mapLoadedSubject.next(!0)}):setTimeout(e,100)};e()}initializeMap(e,n){return new D.c(i=>{this.mapLoaded$.subscribe(a=>{a&&(this.map=new google.maps.Map(e,{center:n.center,zoom:n.zoom,styles:n.styles||this.getDefaultMapStyles(),mapTypeId:n.mapTypeId||google.maps.MapTypeId.ROADMAP,zoomControl:!0,mapTypeControl:!1,scaleControl:!0,streetViewControl:!1,rotateControl:!1,fullscreenControl:!0}),this.directionsService=new google.maps.DirectionsService,this.directionsRenderer=new google.maps.DirectionsRenderer({suppressMarkers:!1,polylineOptions:{strokeColor:"#4285f4",strokeWeight:4,strokeOpacity:.8}}),this.directionsRenderer.setMap(this.map),i.next(this.map),i.complete())})})}addMarker(e){if(!this.map)return null;const n=new google.maps.Marker({position:e.position,map:this.map,title:e.title,icon:e.icon||this.getDefaultMarkerIcon("red"),animation:e.animation||null});if(e.info){const i=new google.maps.InfoWindow({content:e.info});n.addListener("click",()=>{this.infoWindows.forEach(a=>a.close()),i.open(this.map,n)}),this.infoWindows.set(e.id,i)}return this.markers.set(e.id,n),n}updateMarkerPosition(e,n){const i=this.markers.get(e);i&&i.setPosition(n)}removeMarker(e){const n=this.markers.get(e);n&&(n.setMap(null),this.markers.delete(e));const i=this.infoWindows.get(e);i&&(i.close(),this.infoWindows.delete(e))}clearMarkers(){this.markers.forEach(e=>e.setMap(null)),this.markers.clear(),this.infoWindows.forEach(e=>e.close()),this.infoWindows.clear()}calculateRoute(e){return new D.c(n=>{if(!this.directionsService)return void n.error("Directions service not initialized");const i={origin:e.origin,destination:e.destination,waypoints:e.waypoints?.map(a=>({location:a,stopover:!0}))||[],optimizeWaypoints:e.optimizeWaypoints||!1,travelMode:google.maps.TravelMode[e.travelMode||"DRIVING"]};this.directionsService.route(i,(a,s)=>{"OK"===s?(this.directionsRenderer.setDirections(a),n.next(a),n.complete()):n.error(`Directions request failed: ${s}`)})})}clearRoute(){this.directionsRenderer&&this.directionsRenderer.setDirections({routes:[]})}fitBounds(e){if(!this.map||0===e.length)return;const n=new google.maps.LatLngBounds;e.forEach(i=>{n.extend(new google.maps.LatLng(i.lat,i.lng))}),this.map.fitBounds(n)}setCenter(e,n){this.map&&(this.map.setCenter(e),n&&this.map.setZoom(n))}calculateDistance(e,n){if(typeof google<"u"&&google.maps?.geometry){const C=new google.maps.LatLng(e.lat,e.lng),y=new google.maps.LatLng(n.lat,n.lng);return google.maps.geometry.spherical.computeDistanceBetween(C,y)/1e3}const a=(n.lat-e.lat)*Math.PI/180,s=(n.lng-e.lng)*Math.PI/180,c=Math.sin(a/2)*Math.sin(a/2)+Math.cos(e.lat*Math.PI/180)*Math.cos(n.lat*Math.PI/180)*Math.sin(s/2)*Math.sin(s/2);return 2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))*6371}getCurrentLocation(){return new Promise((e,n)=>{navigator.geolocation?"permissions"in navigator?navigator.permissions.query({name:"geolocation"}).then(i=>{"denied"!==i.state?this.requestLocation(e,n):n("Geolocation permission denied. Please enable location access in your browser.")}).catch(()=>{this.requestLocation(e,n)}):this.requestLocation(e,n):n("Geolocation is not supported by this browser")})}requestLocation(e,n){navigator.geolocation.getCurrentPosition(i=>{e({lat:i.coords.latitude,lng:i.coords.longitude})},i=>{let a="Location access failed: ";switch(i.code){case i.PERMISSION_DENIED:a+="Permission denied. Please enable location access.";break;case i.POSITION_UNAVAILABLE:a+="Location information unavailable.";break;case i.TIMEOUT:a+="Location request timed out.";break;default:a+=i.message}n(a)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})}watchPosition(e,n){return navigator.geolocation?navigator.geolocation.watchPosition(i=>{e({lat:i.coords.latitude,lng:i.coords.longitude})},i=>{n&&n(`Location tracking error: ${i.message}`)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4}):(n&&n("Geolocation is not supported"),-1)}stopWatchingPosition(e){e>=0&&navigator.geolocation.clearWatch(e)}geocodeAddress(e){return(0,X.A)(function*(){return google?.maps?.Geocoder?new Promise(n=>{(new google.maps.Geocoder).geocode({address:e},(a,s)=>{if("OK"===s&&a.length>0){const c=a[0].geometry.location;n({lat:c.lat(),lng:c.lng(),address:a[0].formatted_address})}else n(null)})}):(console.log("Geocoding not available:",e),null)})()}reverseGeocode(e,n){return(0,X.A)(function*(){return google?.maps?.Geocoder?new Promise(i=>{(new google.maps.Geocoder).geocode({location:{lat:e,lng:n}},(c,m)=>{i("OK"===m&&c.length>0?c[0].formatted_address:`${e}, ${n}`)})}):`${e}, ${n}`})()}getDefaultMarkerIcon(e){return google?.maps?{url:`https://maps.google.com/mapfiles/ms/icons/${e}-dot.png`,scaledSize:new google.maps.Size(32,32),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(16,32)}:null}getDeliveryPartnerIcon(){return{url:"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent('\n        <svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">\n          <circle cx="16" cy="16" r="12" fill="#4285f4" stroke="#ffffff" stroke-width="2"/>\n          <path d="M12 16l4-4 4 4" stroke="#ffffff" stroke-width="2" fill="none"/>\n        </svg>\n      '),scaledSize:new google.maps.Size(32,32),anchor:new google.maps.Point(16,16)}}getCustomerIcon(){return{url:"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent('\n        <svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">\n          <circle cx="16" cy="26" r="4" fill="#34a853"/>\n          <path d="M16 2 L22 14 L10 14 Z" fill="#ea4335" stroke="#ffffff" stroke-width="1"/>\n          <circle cx="16" cy="8" r="3" fill="#ffffff"/>\n        </svg>\n      '),scaledSize:new google.maps.Size(32,32),anchor:new google.maps.Point(16,30)}}getShopIcon(){return{url:"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent('\n        <svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">\n          <rect x="8" y="12" width="16" height="16" fill="#ff9800" stroke="#ffffff" stroke-width="2"/>\n          <path d="M6 12 L16 4 L26 12" fill="#ff9800" stroke="#ffffff" stroke-width="2"/>\n          <rect x="14" y="20" width="4" height="8" fill="#ffffff"/>\n        </svg>\n      '),scaledSize:new google.maps.Size(32,32),anchor:new google.maps.Point(16,28)}}getDefaultMapStyles(){return[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit.station",elementType:"labels",stylers:[{visibility:"off"}]}]}calculateDetailedRoute(e){return new D.c(n=>{if(!this.directionsService)return void n.error("Directions service not initialized");const i={origin:e.origin,destination:e.destination,waypoints:e.waypoints?.map(a=>({location:a,stopover:!0}))||[],optimizeWaypoints:e.optimizeWaypoints||!1,travelMode:google.maps.TravelMode[e.travelMode||"DRIVING"],avoidTolls:e.avoidTolls||!1,avoidHighways:e.avoidHighways||!1,provideRouteAlternatives:e.provideRouteAlternatives||!1,unitSystem:google.maps.UnitSystem.METRIC};this.directionsService.route(i,(a,s)=>{if("OK"===s){this.directionsRenderer.setDirections(a);const c=a.routes[0],m=c.legs[0];n.next({distance:m.distance,duration:m.duration,steps:m.steps,overview_path:c.overview_path,bounds:c.bounds,warnings:c.warnings,waypoint_order:c.waypoint_order}),n.complete()}else n.error(`Directions request failed: ${s}`)})})}getStepByStepDirections(e,n){return this.calculateDetailedRoute({origin:e,destination:n,travelMode:"DRIVING"}).pipe((0,at.n)(i=>[i.steps.map((s,c)=>({stepNumber:c+1,instruction:s.instructions.replace(/<[^>]*>/g,""),distance:s.distance.text,duration:s.duration.text,maneuver:s.maneuver||"",startLocation:{lat:s.start_location.lat(),lng:s.start_location.lng()},endLocation:{lat:s.end_location.lat(),lng:s.end_location.lng()}}))]))}searchNearbyPlaces(e,n,i){return new Promise((a,s)=>{if(!google?.maps?.places?.PlacesService)return void s("Places service not available");const c=new google.maps.places.PlacesService(this.map),m={location:new google.maps.LatLng(e.lat,e.lng),radius:n,type:i};c.nearbySearch(m,(C,y)=>{y===google.maps.places.PlacesServiceStatus.OK?a(C):s(`Places search failed: ${y}`)})})}searchPlacesByText(e,n){return new Promise((i,a)=>{if(!google?.maps?.places?.PlacesService)return void a("Places service not available");const s=new google.maps.places.PlacesService(this.map),c={query:e};n&&(c.location=new google.maps.LatLng(n.lat,n.lng),c.radius=5e4),s.textSearch(c,(m,C)=>{C===google.maps.places.PlacesServiceStatus.OK?i(m):a(`Places text search failed: ${C}`)})})}getPlaceDetails(e){return new Promise((n,i)=>{google?.maps?.places?.PlacesService?new google.maps.places.PlacesService(this.map).getDetails({placeId:e,fields:["name","formatted_address","geometry","place_id","photos","rating","reviews","formatted_phone_number","website"]},(c,m)=>{m===google.maps.places.PlacesServiceStatus.OK?n(c):i(`Place details request failed: ${m}`)}):i("Places service not available")})}requestLocationPermission(){var e=this;return(0,X.A)(function*(){if(!("geolocation"in navigator))throw new Error("Geolocation not supported");if("permissions"in navigator)try{const n=yield navigator.permissions.query({name:"geolocation"});if("granted"===n.state)return!0;if("prompt"!==n.state)return!1;try{return yield e.getCurrentLocation(),!0}catch{return!1}}catch{try{return yield e.getCurrentLocation(),!0}catch{return!1}}else try{return yield e.getCurrentLocation(),!0}catch{return!1}})()}createAdvancedAutocomplete(e,n){if(!google?.maps?.places?.Autocomplete)return console.log("Autocomplete not available"),null;const i={fields:["place_id","formatted_address","geometry","name"],...n},a=new google.maps.places.Autocomplete(e,i);return this.map&&a.bindTo("bounds",this.map),a}startNavigation(e,n,i){return new D.c(a=>{this.getStepByStepDirections(e,n).subscribe({next:s=>{let c=0;const m=this.watchPosition(C=>{c<s.length&&this.calculateDistance(C,s[c].endLocation)<.05&&(c++,c<s.length?i(s[c]):(this.stopWatchingPosition(m),a.complete())),a.next({currentLocation:C,currentStep:s[c],progress:c/s.length,remainingSteps:s.length-c})},C=>a.error(C));s.length>0&&i(s[0])},error:s=>a.error(s)})})}loadMaps(){return this.mapLoaded$}createMap(e,n){return this.initializeMap(e,{center:n.center||j.c.defaultMapCenter,zoom:n.zoom||j.c.defaultMapZoom,styles:n.styles}).subscribe(),this.map}createMarker(e){const n={id:e.id||"marker_"+Date.now(),position:e.position,title:e.title||"",icon:e.icon,info:e.info};return this.addMarker(n)}createInfoWindow(e){return new google.maps.InfoWindow(e)}createAutocomplete(e,n){return google?.maps?.places?.Autocomplete?new google.maps.places.Autocomplete(e,n):(console.log("Autocomplete not available"),null)}isLoaded$(){return this.mapLoaded$}static{this.\u0275fac=function(n){return new(n||r)(t.KVO(t.SKi))}}static{this.\u0275prov=t.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})(),cn=(()=>{class r{constructor(e,n,i,a){this.http=e,this.ngZone=n,this.mapsService=i,this.webSocketService=a,this.trackingSubject=new rt.t([]),this.partnerLocations$=this.trackingSubject.asObservable(),this.activeSessions=new Map,this.partnerMarkers=new Map,this.animationFrames=new Map,this.initializeWebSocketUpdates()}startTracking(e,n){const i={orderId:e,partnerId:n,isActive:!0};return this.activeSessions.set(e,i),this.trackingSubscription=(0,G.Y)(j.c.trackingUpdateInterval).pipe((0,at.n)(()=>this.fetchPartnerLocation(n)),(0,sn.v)(()=>i.isActive),(0,b.W)(a=>(console.error("Tracking error:",a),[]))).subscribe(a=>{a&&(this.updatePartnerLocation(a),this.animateMarkerMovement(a))}),this.fetchPartnerLocation(n).subscribe(a=>{a&&(this.updatePartnerLocation(a),this.createOrUpdateMarker(a))}),this.partnerLocations$.pipe((0,at.n)(a=>a.filter(s=>s.partnerId===n)))}stopTracking(e){const n=this.activeSessions.get(e);if(n){n.isActive=!1,this.activeSessions.delete(e),this.partnerMarkers.get(n.partnerId)&&(this.mapsService.removeMarker(n.partnerId),this.partnerMarkers.delete(n.partnerId));const a=this.animationFrames.get(n.partnerId);a&&(cancelAnimationFrame(a),this.animationFrames.delete(n.partnerId))}this.trackingSubscription&&this.trackingSubscription.unsubscribe()}fetchPartnerLocation(e){const n={partnerId:e,partnerName:"Raj Kumar",lat:12.97+.001*(Math.random()-.5),lng:77.593+.001*(Math.random()-.5),heading:360*Math.random(),speed:20+10*Math.random(),accuracy:5,timestamp:new Date,orderId:"1",status:"BUSY"};return new D.c(i=>{setTimeout(()=>{i.next(n),i.complete()},200)})}updatePartnerLocation(e){const n=this.trackingSubject.value,i=n.findIndex(a=>a.partnerId===e.partnerId);i>=0?n[i]=e:n.push(e),this.trackingSubject.next([...n])}createOrUpdateMarker(e){const n=e.partnerId;if(this.partnerMarkers.get(n))this.animateMarkerMovement(e);else{const a={id:n,position:{lat:e.lat,lng:e.lng},title:`${e.partnerName} - ${e.status}`,icon:this.getPartnerIcon(e.status),info:this.createInfoWindowContent(e)},s=this.mapsService.addMarker(a);this.partnerMarkers.set(n,s)}}animateMarkerMovement(e){const n=e.partnerId,i=this.partnerMarkers.get(n);if(!i)return;const a=i.getPosition();if(!a)return;const s=a.lat(),c=a.lng(),m=e.lat,C=e.lng,y=this.animationFrames.get(n);y&&cancelAnimationFrame(y);const V=this.calculateDistance(s,c,m,C),ni=Math.min(Math.max(1e3*V,2e3),8e3);let ot;const gt=pt=>{ot||(ot=pt);const mt=Math.min((pt-ot)/ni,1),ut=this.easeInOutCubic(mt),ai=s+(m-s)*ut,oi=c+(C-c)*ut;if(this.ngZone.runOutsideAngular(()=>{i.setPosition({lat:ai,lng:oi})}),mt<1){const si=requestAnimationFrame(gt);this.animationFrames.set(n,si)}else this.animationFrames.delete(n),this.updateMarkerInfo(n,e)},ri=requestAnimationFrame(gt);this.animationFrames.set(n,ri)}easeInOutCubic(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1}updateMarkerInfo(e,n){const i=this.partnerMarkers.get(e);i&&i.setTitle(`${n.partnerName} - ${n.status}`)}calculateDistance(e,n,i,a){const c=(i-e)*Math.PI/180,m=(a-n)*Math.PI/180,C=Math.sin(c/2)*Math.sin(c/2)+Math.cos(e*Math.PI/180)*Math.cos(i*Math.PI/180)*Math.sin(m/2)*Math.sin(m/2);return 2*Math.atan2(Math.sqrt(C),Math.sqrt(1-C))*6371}getPartnerIcon(e){switch(e){case"ONLINE":default:return this.mapsService.getDeliveryPartnerIcon();case"BUSY":return{...this.mapsService.getDeliveryPartnerIcon(),url:this.mapsService.getDeliveryPartnerIcon().url.replace("#4285f4","#ff9800")};case"OFFLINE":return{...this.mapsService.getDeliveryPartnerIcon(),url:this.mapsService.getDeliveryPartnerIcon().url.replace("#4285f4","#9e9e9e")}}}createInfoWindowContent(e){const n=new Date(e.timestamp).toLocaleTimeString(),i=e.speed?`${Math.round(e.speed)} km/h`:"Unknown";return`\n      <div style="padding: 10px; min-width: 200px;">\n        <h3 style="margin: 0 0 10px 0; color: #333;">${e.partnerName}</h3>\n        <div style="margin: 5px 0;">\n          <strong>Status:</strong> \n          <span style="color: ${this.getStatusColor(e.status)};">${e.status}</span>\n        </div>\n        <div style="margin: 5px 0;"><strong>Speed:</strong> ${i}</div>\n        <div style="margin: 5px 0;"><strong>Last Update:</strong> ${n}</div>\n        ${e.orderId?`<div style="margin: 5px 0;"><strong>Order:</strong> #${e.orderId}</div>`:""}\n      </div>\n    `}getStatusColor(e){switch(e){case"ONLINE":return"#4caf50";case"BUSY":return"#ff9800";case"OFFLINE":return"#9e9e9e";default:return"#333"}}initializeWebSocketUpdates(){this.webSocketService.subscribe("/topic/delivery/location/updates").subscribe(e=>{const n=JSON.parse(e.body);this.updatePartnerLocation(n),this.animateMarkerMovement(n)})}getCurrentPartnerLocation(e){return this.trackingSubject.value.find(i=>i.partnerId===e)||null}getAllActivePartners(){return this.trackingSubject.value.filter(e=>"OFFLINE"!==e.status)}setTrackingSession(e,n){const i=this.activeSessions.get(e);i&&Object.assign(i,n)}getTrackingSession(e){return this.activeSessions.get(e)}destroy(){this.trackingSubscription&&this.trackingSubscription.unsubscribe(),this.animationFrames.forEach(e=>cancelAnimationFrame(e)),this.animationFrames.clear(),this.partnerMarkers.clear(),this.activeSessions.clear()}static{this.\u0275fac=function(n){return new(n||r)(t.KVO(P.Qq),t.KVO(t.SKi),t.KVO(dt),t.KVO(lt.V))}}static{this.\u0275prov=t.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();const ln=["mapContainer"];function dn(r,o){if(1&r&&(t.j41(0,"mat-card-subtitle"),t.EFF(1),t.k0s()),2&r){const e=t.XpG(2);t.R7$(1),t.Lme(" Order #",e.assignment.orderNumber," \u2022 ",e.assignment.partnerName," ")}}function gn(r,o){if(1&r&&(t.j41(0,"mat-chip",23)(1,"mat-icon",8),t.EFF(2,"speed"),t.k0s(),t.EFF(3),t.k0s()),2&r){const e=t.XpG(2);t.R7$(3),t.SpI(" ",e.currentSpeed," ")}}function pn(r,o){if(1&r&&(t.j41(0,"mat-chip",24)(1,"mat-icon",8),t.EFF(2,"schedule"),t.k0s(),t.EFF(3),t.k0s()),2&r){const e=t.XpG(2);t.R7$(3),t.SpI(" ETA: ",e.estimatedArrival," ")}}function mn(r,o){if(1&r){const e=t.RV6();t.j41(0,"button",25),t.bIt("click",function(){t.eBV(e);const i=t.XpG(2);return t.Njj(i.callPartner())}),t.j41(1,"mat-icon"),t.EFF(2,"phone"),t.k0s(),t.EFF(3," Call Partner "),t.k0s()}}function un(r,o){1&r&&(t.j41(0,"div",17),t.nrm(1,"div",26),t.j41(2,"span"),t.EFF(3,"Your Location"),t.k0s()())}function hn(r,o){if(1&r&&(t.j41(0,"div",29)(1,"mat-icon"),t.EFF(2,"phone"),t.k0s(),t.j41(3,"span",30),t.EFF(4,"Phone:"),t.k0s(),t.j41(5,"span",31),t.EFF(6),t.k0s()()),2&r){const e=t.XpG(3);t.R7$(6),t.JRh(e.assignment.partnerPhone)}}function _n(r,o){if(1&r&&(t.j41(0,"mat-card",27)(1,"mat-card-header")(2,"mat-card-title")(3,"mat-icon"),t.EFF(4,"person"),t.k0s(),t.EFF(5," Delivery Partner Details "),t.k0s()(),t.j41(6,"mat-card-content")(7,"div",28)(8,"div",29)(9,"mat-icon"),t.EFF(10,"person"),t.k0s(),t.j41(11,"span",30),t.EFF(12,"Partner:"),t.k0s(),t.j41(13,"span",31),t.EFF(14),t.k0s()(),t.DNE(15,hn,7,1,"div",32),t.k0s()()()),2&r){const e=t.XpG(2);t.R7$(14),t.JRh(e.assignment.partnerName),t.R7$(1),t.Y8G("ngIf",null==e.assignment?null:e.assignment.partnerPhone)}}function fn(r,o){if(1&r&&(t.j41(0,"mat-card",33)(1,"mat-card-header")(2,"mat-card-title")(3,"mat-icon"),t.EFF(4,"shopping_bag"),t.k0s(),t.EFF(5," Order Information "),t.k0s()(),t.j41(6,"mat-card-content")(7,"div",34)(8,"div",29)(9,"mat-icon"),t.EFF(10,"confirmation_number"),t.k0s(),t.j41(11,"span",30),t.EFF(12,"Order Number:"),t.k0s(),t.j41(13,"span",31),t.EFF(14),t.k0s()(),t.j41(15,"div",29)(16,"mat-icon"),t.EFF(17,"location_on"),t.k0s(),t.j41(18,"span",30),t.EFF(19,"Delivery Address:"),t.k0s(),t.j41(20,"span",31),t.EFF(21),t.k0s()()()()()),2&r){const e=t.XpG(2);t.R7$(14),t.SpI("#",e.assignment.orderNumber,""),t.R7$(7),t.JRh(e.assignment.deliveryAddress)}}function Cn(r,o){if(1&r){const e=t.RV6();t.j41(0,"div",3)(1,"mat-card",4)(2,"mat-card-header")(3,"mat-card-title")(4,"mat-icon"),t.EFF(5,"local_shipping"),t.k0s(),t.EFF(6," Order Tracking "),t.k0s(),t.DNE(7,dn,2,2,"mat-card-subtitle",5),t.k0s(),t.j41(8,"mat-card-content")(9,"div",6)(10,"mat-chip-set")(11,"mat-chip",7)(12,"mat-icon",8),t.EFF(13),t.k0s(),t.EFF(14),t.k0s(),t.DNE(15,gn,4,1,"mat-chip",9),t.DNE(16,pn,4,1,"mat-chip",10),t.j41(17,"mat-chip",7)(18,"mat-icon",8),t.EFF(19),t.k0s(),t.EFF(20),t.k0s()()()(),t.j41(21,"mat-card-actions"),t.DNE(22,mn,4,0,"button",11),t.j41(23,"button",12),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.refreshTracking())}),t.j41(24,"mat-icon"),t.EFF(25,"refresh"),t.k0s(),t.EFF(26," Refresh "),t.k0s(),t.j41(27,"button",12),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.shareLocation())}),t.j41(28,"mat-icon"),t.EFF(29,"share"),t.k0s(),t.EFF(30," Share "),t.k0s()()(),t.j41(31,"mat-card",13)(32,"mat-card-header")(33,"mat-card-title")(34,"mat-icon"),t.EFF(35,"map"),t.k0s(),t.EFF(36," Live Tracking Map "),t.k0s()(),t.j41(37,"mat-card-content"),t.nrm(38,"div",14,15),t.j41(40,"div",16)(41,"div",17),t.nrm(42,"div",18),t.j41(43,"span"),t.EFF(44,"Delivery Partner"),t.k0s()(),t.j41(45,"div",17),t.nrm(46,"div",19),t.j41(47,"span"),t.EFF(48,"Delivery Location"),t.k0s()(),t.DNE(49,un,4,0,"div",20),t.k0s()()(),t.DNE(50,_n,16,2,"mat-card",21),t.DNE(51,fn,22,2,"mat-card",22),t.k0s()}if(2&r){const e=t.XpG();t.R7$(7),t.Y8G("ngIf",e.assignment),t.R7$(4),t.Y8G("color",e.trackingStatusColor),t.R7$(2),t.JRh(e.isTrackingActive?"gps_fixed":"gps_off"),t.R7$(1),t.SpI(" ",e.trackingStatusText," "),t.R7$(1),t.Y8G("ngIf",e.currentPartnerLocation),t.R7$(1),t.Y8G("ngIf",e.isTrackingActive),t.R7$(1),t.Y8G("color",e.locationStatusColor),t.R7$(2),t.JRh(e.isLocationPermissionGranted?"location_on":"location_off"),t.R7$(1),t.SpI(" ",e.locationStatusText," "),t.R7$(2),t.Y8G("ngIf",null==e.assignment?null:e.assignment.partnerPhone),t.R7$(16),t.xc7("height",400,"px")("width","100%"),t.R7$(11),t.Y8G("ngIf",e.userLocation),t.R7$(1),t.Y8G("ngIf",e.assignment),t.R7$(1),t.Y8G("ngIf",e.assignment)}}function Pn(r,o){1&r&&(t.j41(0,"div",35)(1,"mat-card")(2,"mat-card-content")(3,"div",36),t.nrm(4,"mat-spinner",37),t.j41(5,"h3"),t.EFF(6,"Loading tracking information..."),t.k0s(),t.j41(7,"p"),t.EFF(8,"Please wait while we fetch the latest delivery details."),t.k0s()()()()())}function vn(r,o){if(1&r){const e=t.RV6();t.j41(0,"div",38)(1,"mat-card")(2,"mat-card-content")(3,"div",39)(4,"mat-icon",40),t.EFF(5,"error_outline"),t.k0s(),t.j41(6,"h3"),t.EFF(7,"Order Not Found"),t.k0s(),t.j41(8,"p"),t.EFF(9,"We couldn't find the tracking information for this order."),t.k0s(),t.j41(10,"button",25),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.loadAssignmentData())}),t.j41(11,"mat-icon"),t.EFF(12,"refresh"),t.k0s(),t.EFF(13," Try Again "),t.k0s()()()()()}}let On=(()=>{class r{constructor(e,n,i,a,s,c){this.route=e,this.trackingService=n,this.assignmentService=i,this.liveTrackingService=a,this.googleMapsService=s,this.snackBar=c,this.destroy$=new L.B,this.assignmentId=0,this.assignment=null,this.tracking=null,this.trackingHistory=[],this.isLoading=!0,this.isTrackingActive=!1,this.lastUpdateTime=null,this.mapCenter={lat:12.9716,lng:77.5946},this.mapZoom=13,this.partnerLocation=null,this.deliveryLocation=null,this.currentPartnerLocation=null,this.map=null,this.isMapLoaded=!1,this.userLocation=null,this.isLocationPermissionGranted=!1,this.locationWatchId=-1,this.showDirections=!1,this.statusSteps=[{key:"ASSIGNED",label:"Order Assigned",icon:"assignment",completed:!1},{key:"ACCEPTED",label:"Accepted by Partner",icon:"check_circle",completed:!1},{key:"PICKED_UP",label:"Picked Up",icon:"shopping_cart",completed:!1},{key:"IN_TRANSIT",label:"On the Way",icon:"local_shipping",completed:!1},{key:"DELIVERED",label:"Delivered",icon:"check_circle_outline",completed:!1}]}ngOnInit(){this.route.params.pipe((0,d.Q)(this.destroy$)).subscribe(e=>{const n=parseInt(e.assignmentId,10);isNaN(n)?(console.log("No assignment ID provided, showing mock tracking dashboard"),this.showMockTrackingDashboard()):(this.assignmentId=n,this.loadAssignmentData())})}ngAfterViewInit(){this.initializeMap(),this.requestLocationPermission()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.stopRealTimeTracking(),this.assignment?.partnerId&&this.liveTrackingService.stopTracking(this.assignmentId.toString()),this.locationWatchId>=0&&this.googleMapsService.stopWatchingPosition(this.locationWatchId)}showMockTrackingDashboard(){this.isLoading=!1,this.assignmentId=1,this.assignment={id:1,orderId:101,partnerId:1,status:"IN_TRANSIT",assignmentType:"MANUAL",acceptedAt:new Date,pickedUpAt:new Date,deliveredAt:null,estimatedDeliveryTime:new Date(Date.now()+18e5),deliveryNotes:"Customer requested contactless delivery",customerOTP:"1234",deliveryOTP:"5678",deliveryLatitude:12.9716,deliveryLongitude:77.5946,pickupLatitude:12.9616,pickupLongitude:77.5846,createdAt:new Date,updatedAt:new Date},this.tracking={id:1,assignmentId:1,currentStatus:"IN_TRANSIT",currentLatitude:12.9666,currentLongitude:77.5896,lastUpdateTime:new Date,totalDistance:5.2,estimatedTimeRemaining:15,isActive:!0,deliveryProofUrl:null,customerSignatureUrl:null,createdAt:new Date,updatedAt:new Date},this.trackingHistory=[{status:"ASSIGNED",timestamp:new Date(Date.now()-36e5),location:"Order assigned to delivery partner"},{status:"ACCEPTED",timestamp:new Date(Date.now()-3e6),location:"Partner accepted the order"},{status:"PICKED_UP",timestamp:new Date(Date.now()-24e5),location:"Order picked up from shop"},{status:"IN_TRANSIT",timestamp:new Date(Date.now()-12e5),location:"On the way to delivery location"}],this.updateStatusSteps(),this.setupMapWithMockData()}setupMapWithMockData(){this.mapCenter={lat:12.9716,lng:77.5946},this.partnerLocation={lat:12.9666,lng:77.5896},this.deliveryLocation={lat:12.9716,lng:77.5946},this.isMapLoaded=!0,this.lastUpdateTime=new Date}loadAssignmentData(){this.assignmentService.getAssignmentById(this.assignmentId).pipe((0,d.Q)(this.destroy$)).subscribe({next:e=>{f.c.isSuccess(e)&&e.data?(this.assignment=e.data,this.updateStatusSteps(),this.loadTrackingData(),this.assignment.deliveryLatitude&&this.assignment.deliveryLongitude&&(this.deliveryLocation={lat:this.assignment.deliveryLatitude,lng:this.assignment.deliveryLongitude},this.mapCenter=this.deliveryLocation,this.addDeliveryLocationMarker()),this.assignment.partnerId&&this.isDeliveryInProgress()&&this.startLiveTracking()):this.snackBar.open("Assignment not found","Close",{duration:3e3}),this.isLoading=!1},error:e=>{console.error("Error loading assignment:",e),this.snackBar.open("Error loading tracking information","Close",{duration:3e3}),this.isLoading=!1}})}loadTrackingData(){this.assignmentId&&(this.trackingService.getLatestTracking(this.assignmentId).pipe((0,d.Q)(this.destroy$)).subscribe({next:e=>{f.c.isSuccess(e)&&e.data&&(this.tracking=e.data,this.lastUpdateTime=new Date,this.tracking.latitude&&this.tracking.longitude&&(this.partnerLocation={lat:this.tracking.latitude,lng:this.tracking.longitude}),this.isTrackingActive=this.isTrackingRecent())},error:e=>{console.error("Error loading tracking data:",e)}}),this.trackingService.getTrackingHistory(this.assignmentId).pipe((0,d.Q)(this.destroy$)).subscribe({next:e=>{f.c.isSuccess(e)&&e.data&&(this.trackingHistory=e.data)},error:e=>{console.error("Error loading tracking history:",e)}}))}updateStatusSteps(){if(!this.assignment)return;const i=["ASSIGNED","ACCEPTED","PICKED_UP","IN_TRANSIT","DELIVERED"].indexOf(this.assignment.status);this.statusSteps.forEach((a,s)=>{a.completed=s<=i})}startRealTimeTracking(){this.trackingInterval=(0,G.Y)(12e4).pipe((0,d.Q)(this.destroy$)).subscribe(()=>{this.assignment&&this.isDeliveryInProgress()&&this.loadTrackingData()})}stopRealTimeTracking(){this.trackingInterval&&clearInterval(this.trackingInterval)}isDeliveryInProgress(){return!!this.assignment&&["ACCEPTED","PICKED_UP","IN_TRANSIT"].includes(this.assignment.status)}isTrackingRecent(){if(!this.tracking||!this.tracking.trackedAt)return!1;const e=new Date,n=new Date(this.tracking.trackedAt);return(e.getTime()-n.getTime())/6e4<=5}refreshTracking(){this.loadTrackingData(),this.snackBar.open("Tracking data refreshed","Close",{duration:2e3})}getStatusColor(e){switch(e){case"ASSIGNED":case"PICKED_UP":case"DELIVERED":return"primary";case"ACCEPTED":case"IN_TRANSIT":return"accent";default:return"basic"}}getStatusIcon(e){switch(e){case"ASSIGNED":return"assignment";case"ACCEPTED":return"check_circle";case"PICKED_UP":return"shopping_cart";case"IN_TRANSIT":return"local_shipping";case"DELIVERED":return"check_circle_outline";default:return"help"}}formatTime(e){return e?new Date(e).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}):"N/A"}formatDistance(e){return e?e<1?`${Math.round(1e3*e)}m`:`${e.toFixed(1)}km`:"N/A"}formatSpeed(e){return e?`${Math.round(e)}km/h`:"N/A"}formatEarnings(e){return`\u20b9${e.toFixed(2)}`}getVehicleIcon(e){switch(e?.toUpperCase()){case"BIKE":return"motorcycle";case"SCOOTER":return"electric_scooter";case"BICYCLE":return"pedal_bike";case"CAR":return"directions_car";case"AUTO":return"local_taxi";default:return"directions"}}getBatteryIcon(e){return e?e>80?"battery_full":e>60?"battery_6_bar":e>40?"battery_4_bar":e>20?"battery_2_bar":"battery_alert":"battery_unknown"}getBatteryColor(e){return e?e>20?"green":"red":"gray"}callPartner(){this.assignment?.partnerPhone&&window.open(`tel:${this.assignment.partnerPhone}`)}shareLocation(){navigator.share&&this.assignmentId?navigator.share({title:"Order Tracking",text:`Track my order #${this.assignment?.orderNumber}`,url:window.location.href}).catch(console.error):navigator.clipboard.writeText(window.location.href).then(()=>{this.snackBar.open("Tracking link copied to clipboard","Close",{duration:3e3})})}initializeMap(){this.mapContainer&&this.googleMapsService.initializeMap(this.mapContainer.nativeElement,{center:this.mapCenter,zoom:this.mapZoom}).subscribe({next:n=>{this.map=n,this.isMapLoaded=!0,this.addInitialMarkers()},error:n=>{console.error("Error initializing map:",n),this.snackBar.open("Error loading map","Close",{duration:3e3})}})}addInitialMarkers(){this.isMapLoaded&&(this.addDeliveryLocationMarker(),this.partnerLocation&&this.addPartnerLocationMarker())}addDeliveryLocationMarker(){if(!this.isMapLoaded||!this.deliveryLocation)return;const e={id:"delivery-location",position:this.deliveryLocation,title:"Delivery Location",icon:this.googleMapsService.getCustomerIcon(),info:`\n        <div style="padding: 10px;">\n          <h3 style="margin: 0 0 10px 0;">Delivery Address</h3>\n          <p style="margin: 0;">${this.assignment?.deliveryAddress||"Delivery Location"}</p>\n        </div>\n      `};this.googleMapsService.addMarker(e)}addPartnerLocationMarker(){if(!this.isMapLoaded||!this.partnerLocation)return;const e={id:"partner-location",position:this.partnerLocation,title:"Delivery Partner",icon:this.googleMapsService.getDeliveryPartnerIcon(),info:`\n        <div style="padding: 10px;">\n          <h3 style="margin: 0 0 10px 0;">${this.assignment?.partnerName||"Delivery Partner"}</h3>\n          <p style="margin: 5px 0;"><strong>Phone:</strong> ${this.assignment?.partnerPhone||"N/A"}</p>\n          <p style="margin: 5px 0;"><strong>Vehicle:</strong> N/A</p>\n        </div>\n      `};this.googleMapsService.addMarker(e)}startLiveTracking(){this.assignment?.partnerId&&this.liveTrackingService.startTracking(this.assignmentId.toString(),this.assignment.partnerId.toString()).pipe((0,d.Q)(this.destroy$)).subscribe({next:e=>{this.currentPartnerLocation=e,this.updatePartnerLocationOnMap(e),this.updateTrackingInfo(e)},error:e=>{console.error("Live tracking error:",e),this.startRealTimeTracking()}})}updatePartnerLocationOnMap(e){this.isMapLoaded&&(this.partnerLocation={lat:e.lat,lng:e.lng},this.deliveryLocation?this.googleMapsService.fitBounds([this.partnerLocation,this.deliveryLocation]):this.googleMapsService.setCenter(this.partnerLocation,15),this.deliveryLocation&&this.googleMapsService.calculateRoute({origin:this.partnerLocation,destination:this.deliveryLocation,travelMode:"DRIVING"}).subscribe({next:n=>{},error:n=>{console.error("Error calculating route:",n)}}))}updateTrackingInfo(e){this.lastUpdateTime=new Date(e.timestamp),this.isTrackingActive=!0,this.tracking&&(this.tracking.latitude=e.lat,this.tracking.longitude=e.lng,this.tracking.trackedAt=e.timestamp,this.tracking.speed=e.speed)}getTrackingStatusText(){if(!this.isTrackingActive)return"Tracking Offline";if(!this.currentPartnerLocation)return"Waiting for Location";const e=Date.now()-new Date(this.currentPartnerLocation.timestamp).getTime(),n=Math.floor(e/6e4);return n<1?"Live Tracking":n<5?`Updated ${n}m ago`:"Location Outdated"}getTrackingStatusColor(){if(!this.isTrackingActive)return"warn";if(!this.currentPartnerLocation)return"basic";const e=Date.now()-new Date(this.currentPartnerLocation.timestamp).getTime(),n=Math.floor(e/6e4);return n<2?"primary":n<5?"accent":"warn"}getCurrentSpeed(){return this.currentPartnerLocation?.speed?`${Math.round(this.currentPartnerLocation.speed)} km/h`:this.formatSpeed(this.tracking?.speed)}getEstimatedArrival(){if(!this.currentPartnerLocation||!this.deliveryLocation)return"Calculating...";const e=this.googleMapsService.calculateDistance({lat:this.currentPartnerLocation.lat,lng:this.currentPartnerLocation.lng},this.deliveryLocation),a=Math.round(e/(this.currentPartnerLocation.speed||30)*60);return a<1?"Arriving now":a<60?`${a} minutes`:`${Math.floor(a/60)}h ${a%60}m`}requestLocationPermission(){var e=this;return(0,X.A)(function*(){try{e.isLocationPermissionGranted=yield e.googleMapsService.requestLocationPermission(),e.isLocationPermissionGranted&&e.startLocationTracking()}catch(n){console.warn("Location permission not granted:",n),e.snackBar.open("Location access not available","Close",{duration:3e3})}})()}startLocationTracking(){this.isLocationPermissionGranted&&(this.locationWatchId=this.googleMapsService.watchPosition(e=>{this.userLocation=e,this.updateUserLocationOnMap()},e=>{console.error("Location tracking error:",e)}))}updateUserLocationOnMap(){if(!this.isMapLoaded||!this.userLocation)return;const e={id:"user-location",position:this.userLocation,title:"Your Location",icon:{url:"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent('\n          <svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">\n            <circle cx="16" cy="16" r="8" fill="#4285f4" stroke="#ffffff" stroke-width="4"/>\n            <circle cx="16" cy="16" r="3" fill="#ffffff"/>\n          </svg>\n        '),scaledSize:{width:32,height:32},anchor:{x:16,y:16}},info:'\n        <div style="padding: 10px;">\n          <h3 style="margin: 0 0 10px 0;">Your Location</h3>\n          <p style="margin: 0;">Current position</p>\n        </div>\n      '};if(this.googleMapsService.addMarker(e),this.deliveryLocation||this.partnerLocation){const n=[this.userLocation];this.deliveryLocation&&n.push(this.deliveryLocation),this.partnerLocation&&n.push(this.partnerLocation),this.googleMapsService.fitBounds(n)}}toggleDirections(){this.showDirections=!this.showDirections,this.showDirections&&this.userLocation&&this.deliveryLocation?this.getDirectionsToDelivery():this.googleMapsService.clearRoute()}getDirectionsToDelivery(){!this.userLocation||!this.deliveryLocation||this.googleMapsService.calculateDetailedRoute({origin:this.userLocation,destination:this.deliveryLocation,travelMode:"DRIVING"}).subscribe({next:e=>{this.snackBar.open(`Route calculated: ${e.distance.text}, ${e.duration.text}`,"Close",{duration:5e3})},error:e=>{console.error("Failed to calculate route:",e),this.snackBar.open("Failed to calculate directions","Close",{duration:3e3})}})}getDirectionsToLocation(){this.userLocation&&this.deliveryLocation?window.open(`https://www.google.com/maps/dir/${this.userLocation.lat},${this.userLocation.lng}/${this.deliveryLocation.lat},${this.deliveryLocation.lng}`,"_blank"):this.snackBar.open("Location not available for directions","Close",{duration:3e3})}centerMapOnUser(){this.userLocation&&this.isMapLoaded?this.googleMapsService.setCenter(this.userLocation,16):this.snackBar.open("Your location is not available","Close",{duration:3e3})}searchNearbyPlaces(e){var n=this;return(0,X.A)(function*(){if(n.deliveryLocation)try{const i=yield n.googleMapsService.searchNearbyPlaces(n.deliveryLocation,1e3,e);i.slice(0,5).forEach((a,s)=>{const c={id:`nearby-${e}-${s}`,position:{lat:a.geometry.location.lat(),lng:a.geometry.location.lng()},title:a.name,icon:n.getPlaceTypeIcon(e),info:`\n            <div style="padding: 10px;">\n              <h3 style="margin: 0 0 10px 0;">${a.name}</h3>\n              <p style="margin: 0 0 5px 0;">${a.vicinity}</p>\n              <p style="margin: 0; font-size: 12px; color: #666;">\n                Rating: ${a.rating||"N/A"} \u2b50\n              </p>\n            </div>\n          `};n.googleMapsService.addMarker(c)}),n.snackBar.open(`Found ${i.length} nearby ${e}s`,"Close",{duration:3e3})}catch(i){console.error("Failed to search nearby places:",i),n.snackBar.open(`Failed to find nearby ${e}s`,"Close",{duration:3e3})}else n.snackBar.open("Delivery location not available","Close",{duration:3e3})})()}getPlaceTypeIcon(e){return{url:`https://maps.google.com/mapfiles/ms/icons/${"restaurant"===e?"restaurant":"blue"}-dot.png`,scaledSize:{width:32,height:32},origin:{x:0,y:0},anchor:{x:16,y:32}}}getDistanceToDelivery(){if(!this.userLocation||!this.deliveryLocation)return"N/A";const e=this.googleMapsService.calculateDistance(this.userLocation,this.deliveryLocation);return this.formatDistance(e)}getDistanceToPartner(){if(!this.userLocation||!this.partnerLocation)return"N/A";const e=this.googleMapsService.calculateDistance(this.userLocation,this.partnerLocation);return this.formatDistance(e)}getLocationStatusText(){return this.isLocationPermissionGranted?this.userLocation?"Location active":"Getting your location...":"Location access denied"}getLocationStatusColor(){return this.isLocationPermissionGranted?this.userLocation?"primary":"accent":"warn"}get remainingDistance(){if(!this.partnerLocation||!this.deliveryLocation)return"N/A";const e=this.googleMapsService.calculateDistance(this.partnerLocation,this.deliveryLocation);return this.formatDistance(e)}get distanceToDelivery(){return this.getDistanceToDelivery()}get distanceToPartner(){return this.getDistanceToPartner()}get currentSpeed(){return this.getCurrentSpeed()}get estimatedArrival(){return this.getEstimatedArrival()}get trackingStatusText(){return this.getTrackingStatusText()}get trackingStatusColor(){return this.getTrackingStatusColor()}get locationStatusText(){return this.getLocationStatusText()}get locationStatusColor(){return this.getLocationStatusColor()}static{this.\u0275fac=function(n){return new(n||r)(t.rXU($.nX),t.rXU(it),t.rXU(z),t.rXU(cn),t.rXU(dt),t.rXU(x.UG))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-order-tracking"]],viewQuery:function(n,i){if(1&n&&t.GBs(ln,5),2&n){let a;t.mGM(a=t.lsd())&&(i.mapContainer=a.first)}},decls:3,vars:3,consts:[["class","tracking-container",4,"ngIf"],["class","loading-container",4,"ngIf"],["class","error-container",4,"ngIf"],[1,"tracking-container"],[1,"tracking-header"],[4,"ngIf"],[1,"tracking-status"],["selected","",3,"color"],["matChipAvatar",""],["color","accent","selected","",4,"ngIf"],["color","primary","selected","",4,"ngIf"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],["mat-button","",3,"click"],[1,"map-container"],[1,"google-map"],["mapContainer",""],[1,"map-legend"],[1,"legend-item"],[1,"legend-marker","partner"],[1,"legend-marker","customer"],["class","legend-item",4,"ngIf"],["class","partner-info",4,"ngIf"],["class","order-details",4,"ngIf"],["color","accent","selected",""],["color","primary","selected",""],["mat-raised-button","","color","primary",3,"click"],[1,"legend-marker","user"],[1,"partner-info"],[1,"partner-details"],[1,"detail-row"],[1,"label"],[1,"value"],["class","detail-row",4,"ngIf"],[1,"order-details"],[1,"order-info"],[1,"loading-container"],[1,"loading-content"],["diameter","50"],[1,"error-container"],[1,"error-content"],["color","warn"]],template:function(n,i){1&n&&(t.DNE(0,Cn,52,17,"div",0),t.DNE(1,Pn,9,0,"div",1),t.DNE(2,vn,14,0,"div",2)),2&n&&(t.Y8G("ngIf",!i.isLoading),t.R7$(1),t.Y8G("ngIf",i.isLoading),t.R7$(1),t.Y8G("ngIf",!i.isLoading&&!i.assignment))},dependencies:[h.bT,p.RN,p.YY,p.m2,p.MM,p.Lc,p.dh,v.$z,k.An,F.Jl,F.yZ,F.Jo,w.LG],styles:[".tracking-container[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto;display:flex;flex-direction:column;gap:20px}@media (max-width: 768px){.tracking-container[_ngcontent-%COMP%]{padding:10px;gap:15px}}.tracking-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff}.tracking-header[_ngcontent-%COMP%]     .mat-card-header-text{color:#fff}.tracking-header[_ngcontent-%COMP%]     .mat-card-title{display:flex;align-items:center;gap:10px;font-size:1.5rem;font-weight:600}.tracking-header[_ngcontent-%COMP%]     .mat-card-subtitle{opacity:.9;margin-top:8px}.tracking-header[_ngcontent-%COMP%]   .tracking-status[_ngcontent-%COMP%]{margin:15px 0}.tracking-header[_ngcontent-%COMP%]   .tracking-status[_ngcontent-%COMP%]   mat-chip-set[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.tracking-header[_ngcontent-%COMP%]   .tracking-status[_ngcontent-%COMP%]     .mat-mdc-chip{background-color:#ffffff26;color:#fff;border:1px solid rgba(255,255,255,.3)}.tracking-header[_ngcontent-%COMP%]   .tracking-status[_ngcontent-%COMP%]     .mat-mdc-chip .mat-icon{color:#fff}.tracking-header[_ngcontent-%COMP%]     .mat-card-actions{padding:16px;gap:10px;display:flex;flex-wrap:wrap}.tracking-header[_ngcontent-%COMP%]     .mat-card-actions .mat-raised-button{background-color:#ffffff26;color:#fff;border:1px solid rgba(255,255,255,.3)}.tracking-header[_ngcontent-%COMP%]     .mat-card-actions .mat-raised-button:hover{background-color:#ffffff40}.tracking-header[_ngcontent-%COMP%]     .mat-card-actions .mat-button{color:#fffc}.tracking-header[_ngcontent-%COMP%]     .mat-card-actions .mat-button:hover{background-color:#ffffff1a}.map-container[_ngcontent-%COMP%]{overflow:hidden}.map-container[_ngcontent-%COMP%]   .mat-card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.map-container[_ngcontent-%COMP%]   .mat-card-header[_ngcontent-%COMP%]   .map-controls[_ngcontent-%COMP%]{display:flex;gap:8px}.map-container[_ngcontent-%COMP%]   .google-map[_ngcontent-%COMP%]{border-radius:8px;overflow:hidden;box-shadow:0 2px 8px #0000001a}.map-container[_ngcontent-%COMP%]   .map-legend[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:20px;margin-top:15px;padding:10px;background-color:#f5f5f5;border-radius:8px;flex-wrap:wrap}.map-container[_ngcontent-%COMP%]   .map-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:14px;color:#666}.map-container[_ngcontent-%COMP%]   .map-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-marker[_ngcontent-%COMP%]{width:16px;height:16px;border-radius:50%;border:2px solid white;box-shadow:0 1px 3px #0000004d}.map-container[_ngcontent-%COMP%]   .map-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-marker.partner[_ngcontent-%COMP%]{background-color:#4285f4}.map-container[_ngcontent-%COMP%]   .map-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-marker.customer[_ngcontent-%COMP%]{background-color:#ea4335}.map-container[_ngcontent-%COMP%]   .map-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-marker.user[_ngcontent-%COMP%]{background-color:#4285f4;border:2px solid white;box-shadow:0 0 0 2px #4285f4}.map-container[_ngcontent-%COMP%]   .map-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-line[_ngcontent-%COMP%]{width:20px;height:3px;background-color:#4285f4;border-radius:2px}.map-container[_ngcontent-%COMP%]   .map-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-line.directions[_ngcontent-%COMP%]{background:linear-gradient(90deg,#4285f4 0%,#34a853 50%,#fbbc04 100%);height:4px}.status-progress[_ngcontent-%COMP%]   .progress-stepper[_ngcontent-%COMP%]{position:relative;padding:20px 0}.status-progress[_ngcontent-%COMP%]   .progress-stepper[_ngcontent-%COMP%]   .step[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:30px;position:relative}.status-progress[_ngcontent-%COMP%]   .progress-stepper[_ngcontent-%COMP%]   .step[_ngcontent-%COMP%]:last-child{margin-bottom:0}.status-progress[_ngcontent-%COMP%]   .progress-stepper[_ngcontent-%COMP%]   .step.completed[_ngcontent-%COMP%]   .step-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#4caf50}.status-progress[_ngcontent-%COMP%]   .progress-stepper[_ngcontent-%COMP%]   .step.completed[_ngcontent-%COMP%]   .step-label[_ngcontent-%COMP%]{color:#333;font-weight:500}.status-progress[_ngcontent-%COMP%]   .progress-stepper[_ngcontent-%COMP%]   .step.current[_ngcontent-%COMP%]   .step-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#2196f3;animation:_ngcontent-%COMP%_pulse 2s infinite}.status-progress[_ngcontent-%COMP%]   .progress-stepper[_ngcontent-%COMP%]   .step.current[_ngcontent-%COMP%]   .step-label[_ngcontent-%COMP%]{color:#2196f3;font-weight:600}.status-progress[_ngcontent-%COMP%]   .progress-stepper[_ngcontent-%COMP%]   .step[_ngcontent-%COMP%]   .step-icon[_ngcontent-%COMP%]{width:48px;height:48px;display:flex;align-items:center;justify-content:center;background-color:#f5f5f5;border-radius:50%;margin-right:16px;z-index:1}.status-progress[_ngcontent-%COMP%]   .progress-stepper[_ngcontent-%COMP%]   .step[_ngcontent-%COMP%]   .step-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.status-progress[_ngcontent-%COMP%]   .progress-stepper[_ngcontent-%COMP%]   .step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]{flex:1}.status-progress[_ngcontent-%COMP%]   .progress-stepper[_ngcontent-%COMP%]   .step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-label[_ngcontent-%COMP%]{font-size:16px;color:#666;margin-bottom:4px}.status-progress[_ngcontent-%COMP%]   .progress-stepper[_ngcontent-%COMP%]   .step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   .step-time[_ngcontent-%COMP%]{font-size:12px;color:#999}.status-progress[_ngcontent-%COMP%]   .progress-stepper[_ngcontent-%COMP%]   .step[_ngcontent-%COMP%]   .step-connector[_ngcontent-%COMP%]{position:absolute;left:23px;top:48px;width:2px;height:30px;background-color:#e0e0e0}.status-progress[_ngcontent-%COMP%]   .progress-stepper[_ngcontent-%COMP%]   .step[_ngcontent-%COMP%]   .step-connector.completed[_ngcontent-%COMP%]{background-color:#4caf50}.partner-info[_ngcontent-%COMP%]   .partner-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.partner-info[_ngcontent-%COMP%]   .partner-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.partner-info[_ngcontent-%COMP%]   .partner-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#666;width:20px;height:20px;font-size:20px}.partner-info[_ngcontent-%COMP%]   .partner-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#666;min-width:100px}.partner-info[_ngcontent-%COMP%]   .partner-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#333;font-weight:400}.tracking-stats[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px}.tracking-stats[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{text-align:center;padding:20px;background:linear-gradient(135deg,#f5f7fa 0%,#c3cfe2 100%);border-radius:12px;border:1px solid #e0e0e0}.tracking-stats[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px;color:#2196f3;margin-bottom:10px}.tracking-stats[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:#333;margin-bottom:5px}.tracking-stats[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:14px;color:#666;font-weight:500}.order-details[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.order-details[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px;padding:10px 0;border-bottom:1px solid #f0f0f0}.order-details[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.order-details[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#666;width:20px;height:20px;font-size:20px;margin-top:2px}.order-details[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#666;min-width:140px}.order-details[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#333;font-weight:400;flex:1;word-break:break-word}.emergency-section[_ngcontent-%COMP%]{background-color:#fff3e0;border:2px solid #ffb74d}.emergency-section[_ngcontent-%COMP%]   .emergency-actions[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap;justify-content:center}@media (max-width: 768px){.emergency-section[_ngcontent-%COMP%]   .emergency-actions[_ngcontent-%COMP%]{flex-direction:column}}.emergency-section[_ngcontent-%COMP%]   .emergency-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:150px;padding:12px 24px}.loading-container[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:400px;padding:40px}.loading-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{text-align:center;max-width:400px;width:100%}.loading-container[_ngcontent-%COMP%]   .loading-content[_ngcontent-%COMP%], .loading-container[_ngcontent-%COMP%]   .error-content[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]   .loading-content[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]   .error-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:20px}.loading-container[_ngcontent-%COMP%]   .loading-content[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .loading-container[_ngcontent-%COMP%]   .error-content[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]   .loading-content[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]   .error-content[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px}.loading-container[_ngcontent-%COMP%]   .loading-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .loading-container[_ngcontent-%COMP%]   .error-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]   .loading-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]   .error-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#333}.loading-container[_ngcontent-%COMP%]   .loading-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .loading-container[_ngcontent-%COMP%]   .error-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]   .loading-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]   .error-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1);opacity:1}50%{transform:scale(1.1);opacity:.7}to{transform:scale(1);opacity:1}}@media (max-width: 768px){.tracking-header[_ngcontent-%COMP%]     .mat-card-title{font-size:1.2rem}.tracking-header[_ngcontent-%COMP%]     .mat-card-actions{flex-direction:column}.tracking-header[_ngcontent-%COMP%]     .mat-card-actions button{width:100%}.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:15px}.stats-grid[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{padding:15px}.stats-grid[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:1.2rem}.partner-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%], .order-info[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.partner-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .order-info[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{min-width:auto;font-size:14px}.partner-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .order-info[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{padding-left:32px}}@media (prefers-contrast: high){.tracking-header[_ngcontent-%COMP%]{background:#000;color:#fff}.map-legend[_ngcontent-%COMP%]{background-color:#f0f0f0;border:1px solid #000}.stat-item[_ngcontent-%COMP%]{border:2px solid #000}}@media (prefers-color-scheme: dark){.tracking-container[_ngcontent-%COMP%]{background-color:#121212}mat-card[_ngcontent-%COMP%]{background-color:#1e1e1e;color:#fff}.map-legend[_ngcontent-%COMP%]{background-color:#2e2e2e;color:#fff}.stat-item[_ngcontent-%COMP%]{background:linear-gradient(135deg,#2e2e2e 0%,#1e1e1e 100%);color:#fff}.detail-row[_ngcontent-%COMP%]{border-bottom-color:#333}.detail-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#bbb}.detail-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#fff}}  .places-menu .mat-mdc-menu-item{min-height:48px}  .places-menu .mat-mdc-menu-item .mat-icon{margin-right:16px;color:#666}  .places-menu .mat-mdc-menu-item:hover .mat-icon{color:#2196f3}"]})}}return r})();var Mn=l(7468);function bn(r,o){if(1&r){const e=t.RV6();t.j41(0,"mat-chip-option",20),t.bIt("click",function(){const a=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.filterByStatus(a.value))}),t.j41(1,"mat-icon",21),t.EFF(2),t.k0s(),t.EFF(3),t.k0s()}if(2&r){const e=o.$implicit,n=t.XpG();t.Y8G("selected",n.selectedStatus===e.value),t.R7$(2),t.JRh(e.icon),t.R7$(1),t.SpI(" ",e.label," ")}}function kn(r,o){1&r&&(t.j41(0,"div",22),t.nrm(1,"mat-spinner",23),t.j41(2,"p"),t.EFF(3,"Loading active deliveries..."),t.k0s()())}function Fn(r,o){1&r&&(t.j41(0,"p"),t.EFF(1,"There are no active deliveries at the moment."),t.k0s())}function yn(r,o){if(1&r&&(t.j41(0,"p"),t.EFF(1),t.k0s()),2&r){const e=t.XpG(3);t.R7$(1),t.SpI('No deliveries with status "',e.formatStatus(e.selectedStatus),'".')}}function xn(r,o){if(1&r){const e=t.RV6();t.j41(0,"button",30),t.bIt("click",function(){t.eBV(e);const i=t.XpG(3);return t.Njj(i.filterByStatus("ALL"))}),t.EFF(1," Show All "),t.k0s()}}function En(r,o){if(1&r&&(t.j41(0,"div",27)(1,"mat-icon"),t.EFF(2,"local_shipping"),t.k0s(),t.j41(3,"h3"),t.EFF(4,"No Active Deliveries"),t.k0s(),t.DNE(5,Fn,2,0,"p",28),t.DNE(6,yn,2,1,"p",28),t.DNE(7,xn,2,0,"button",29),t.k0s()),2&r){const e=t.XpG(2);t.R7$(5),t.Y8G("ngIf","ALL"===e.selectedStatus),t.R7$(1),t.Y8G("ngIf","ALL"!==e.selectedStatus),t.R7$(1),t.Y8G("ngIf","ALL"!==e.selectedStatus)}}function Dn(r,o){if(1&r&&(t.j41(0,"div",38)(1,"mat-icon",39),t.EFF(2,"person"),t.k0s(),t.j41(3,"span",40),t.EFF(4,"Partner:"),t.k0s(),t.j41(5,"span",41),t.EFF(6),t.k0s()()),2&r){const e=t.XpG().$implicit;t.R7$(6),t.JRh(e.partnerName)}}function wn(r,o){if(1&r&&(t.j41(0,"div",38)(1,"mat-icon",39),t.EFF(2,"person_outline"),t.k0s(),t.j41(3,"span",40),t.EFF(4,"Customer:"),t.k0s(),t.j41(5,"span",41),t.EFF(6),t.k0s()()),2&r){const e=t.XpG().$implicit;t.R7$(6),t.JRh(e.customerName)}}function In(r,o){if(1&r&&(t.j41(0,"div",38)(1,"mat-icon",39),t.EFF(2,"location_on"),t.k0s(),t.j41(3,"span",40),t.EFF(4,"Address:"),t.k0s(),t.j41(5,"span",46),t.EFF(6),t.k0s()()),2&r){const e=t.XpG().$implicit;t.R7$(6),t.JRh(e.deliveryAddress)}}function jn(r,o){if(1&r&&(t.j41(0,"div",38)(1,"mat-icon",39),t.EFF(2,"straighten"),t.k0s(),t.j41(3,"span",40),t.EFF(4,"Distance:"),t.k0s(),t.j41(5,"span",41),t.EFF(6),t.k0s()()),2&r){const e=t.XpG().$implicit;t.R7$(6),t.SpI("",e.distanceToDestination," km remaining")}}function Sn(r,o){if(1&r){const e=t.RV6();t.j41(0,"button",47),t.bIt("click",function(i){t.eBV(e);const a=t.XpG().$implicit,s=t.XpG(2);return t.Njj(s.callPartner(a,i))}),t.j41(1,"mat-icon"),t.EFF(2,"phone"),t.k0s()()}}function Tn(r,o){if(1&r){const e=t.RV6();t.j41(0,"div",31),t.bIt("click",function(){const a=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.trackDelivery(a))}),t.nrm(1,"div",32),t.j41(2,"div",33)(3,"div",34)(4,"div",35)(5,"mat-icon"),t.EFF(6),t.k0s(),t.j41(7,"span"),t.EFF(8),t.k0s()(),t.j41(9,"span",36),t.EFF(10),t.k0s()(),t.j41(11,"div",37)(12,"div",38)(13,"mat-icon",39),t.EFF(14,"confirmation_number"),t.k0s(),t.j41(15,"span",40),t.EFF(16,"Order:"),t.k0s(),t.j41(17,"span",41),t.EFF(18),t.k0s()(),t.DNE(19,Dn,7,1,"div",42),t.DNE(20,wn,7,1,"div",42),t.DNE(21,In,7,1,"div",42),t.DNE(22,jn,7,1,"div",42),t.k0s(),t.j41(23,"div",43)(24,"button",44),t.bIt("click",function(i){const s=t.eBV(e).$implicit;return t.XpG(2).trackDelivery(s),t.Njj(i.stopPropagation())}),t.j41(25,"mat-icon"),t.EFF(26,"map"),t.k0s()(),t.DNE(27,Sn,3,0,"button",45),t.k0s()()()}if(2&r){const e=o.$implicit,n=t.XpG(2);t.R7$(1),t.xc7("background-color",n.getStatusColor(e.status)),t.R7$(3),t.xc7("background-color",n.getStatusColor(e.status)),t.R7$(2),t.JRh(n.getStatusIcon(e.status)),t.R7$(2),t.JRh(n.formatStatus(e.status)),t.R7$(2),t.JRh(n.formatTimeAgo(e.updatedAt)),t.R7$(8),t.SpI("#",e.orderNumber||e.orderId,""),t.R7$(1),t.Y8G("ngIf",e.partnerName),t.R7$(1),t.Y8G("ngIf",e.customerName),t.R7$(1),t.Y8G("ngIf",e.deliveryAddress),t.R7$(1),t.Y8G("ngIf",e.distanceToDestination),t.R7$(5),t.Y8G("ngIf",e.partnerPhone)}}function Rn(r,o){if(1&r&&(t.j41(0,"div",24),t.DNE(1,En,8,3,"div",25),t.DNE(2,Tn,28,13,"div",26),t.k0s()),2&r){const e=t.XpG();t.R7$(1),t.Y8G("ngIf",0===e.filteredAssignments.length),t.R7$(1),t.Y8G("ngForOf",e.filteredAssignments)}}let An=(()=>{class r{constructor(e,n,i,a){this.assignmentService=e,this.trackingService=n,this.router=i,this.snackBar=a,this.destroy$=new L.B,this.activeAssignments=[],this.filteredAssignments=[],this.isLoading=!0,this.lastRefresh=new Date,this.selectedStatus="ALL",this.stats={totalActive:0,inTransit:0,pickedUp:0,assigned:0,deliveredToday:0},this.statusFilters=[{value:"ALL",label:"All Active",icon:"list"},{value:"IN_TRANSIT",label:"In Transit",icon:"local_shipping"},{value:"PICKED_UP",label:"Picked Up",icon:"shopping_cart"},{value:"ACCEPTED",label:"Accepted",icon:"check_circle"},{value:"ASSIGNED",label:"Assigned",icon:"assignment"}],this.displayedColumns=["status","orderNumber","partnerName","customerName","deliveryAddress","time","actions"]}ngOnInit(){this.loadActiveDeliveries(),(0,G.Y)(3e4).pipe((0,d.Q)(this.destroy$)).subscribe(()=>this.loadActiveDeliveries())}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadActiveDeliveries(){(0,Mn.p)(["ASSIGNED","ACCEPTED","PICKED_UP","IN_TRANSIT"].map(n=>this.assignmentService.getAssignmentsByStatus(n).pipe((0,b.W)(()=>(0,U.of)({statusCode:"SUCCESS",message:"",data:[],timestamp:""}))))).pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{this.activeAssignments=[],n.forEach(i=>{const a=i?.data||i?.content||[];Array.isArray(a)&&this.activeAssignments.push(...a)}),this.activeAssignments.sort((i,a)=>new Date(a.updatedAt).getTime()-new Date(i.updatedAt).getTime()),this.calculateStats(),this.applyFilter(),this.lastRefresh=new Date,this.isLoading=!1},error:()=>{this.isLoading=!1,this.snackBar.open("Failed to load active deliveries","Close",{duration:3e3})}})}calculateStats(){this.stats.totalActive=this.activeAssignments.length,this.stats.inTransit=this.activeAssignments.filter(e=>"IN_TRANSIT"===e.status).length,this.stats.pickedUp=this.activeAssignments.filter(e=>"PICKED_UP"===e.status).length,this.stats.assigned=this.activeAssignments.filter(e=>"ASSIGNED"===e.status||"ACCEPTED"===e.status).length,this.stats.deliveredToday=0}applyFilter(){this.filteredAssignments="ALL"===this.selectedStatus?[...this.activeAssignments]:this.activeAssignments.filter(e=>e.status===this.selectedStatus)}filterByStatus(e){this.selectedStatus=e,this.applyFilter()}trackDelivery(e){this.router.navigate(["/delivery/tracking",e.id])}refreshData(){this.isLoading=!0,this.loadActiveDeliveries(),this.snackBar.open("Refreshing tracking data...","Close",{duration:1500})}getStatusColor(e){switch(e){case"ASSIGNED":return"#ff9800";case"ACCEPTED":return"#2196f3";case"PICKED_UP":return"#9c27b0";case"IN_TRANSIT":return"#4caf50";case"DELIVERED":return"#00bcd4";default:return"#757575"}}getStatusIcon(e){switch(e){case"ASSIGNED":return"assignment";case"ACCEPTED":return"check_circle";case"PICKED_UP":return"shopping_cart";case"IN_TRANSIT":return"local_shipping";case"DELIVERED":return"check_circle_outline";default:return"help"}}formatStatus(e){return e.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase())}formatTimeAgo(e){if(!e)return"N/A";const n=new Date,i=new Date(e),a=n.getTime()-i.getTime(),s=Math.floor(a/6e4);if(s<1)return"Just now";if(s<60)return`${s}m ago`;const c=Math.floor(s/60);return c<24?`${c}h ago`:i.toLocaleDateString("en-IN",{day:"2-digit",month:"short"})}formatTime(e){return e?new Date(e).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}):"--:--"}callPartner(e,n){n.stopPropagation(),e.partnerPhone&&window.open(`tel:${e.partnerPhone}`)}static{this.\u0275fac=function(n){return new(n||r)(t.rXU(z),t.rXU(it),t.rXU($.Ix),t.rXU(x.UG))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-admin-tracking"]],decls:58,vars:9,consts:[[1,"admin-tracking-container"],[1,"page-header"],[1,"header-left"],[1,"header-icon"],[1,"subtitle"],[1,"header-right"],[1,"last-refresh"],["mat-raised-button","","color","primary",3,"click"],[1,"stats-grid"],[1,"stat-card","total",3,"click"],[1,"stat-value"],[1,"stat-label"],[1,"stat-card","in-transit",3,"click"],[1,"stat-card","picked-up",3,"click"],[1,"stat-card","assigned",3,"click"],[1,"stat-card","delivered",3,"click"],[1,"filter-bar"],[3,"selected","click",4,"ngFor","ngForOf"],["class","loading-state",4,"ngIf"],["class","deliveries-list",4,"ngIf"],[3,"selected","click"],["matChipAvatar",""],[1,"loading-state"],["diameter","40"],[1,"deliveries-list"],["class","empty-state",4,"ngIf"],["class","delivery-card",3,"click",4,"ngFor","ngForOf"],[1,"empty-state"],[4,"ngIf"],["mat-stroked-button","","color","primary",3,"click",4,"ngIf"],["mat-stroked-button","","color","primary",3,"click"],[1,"delivery-card",3,"click"],[1,"card-status-bar"],[1,"card-content"],[1,"card-top"],[1,"status-badge"],[1,"time-info"],[1,"card-body"],[1,"info-row"],[1,"row-icon"],[1,"info-label"],[1,"info-value"],["class","info-row",4,"ngIf"],[1,"card-actions"],["mat-icon-button","","color","primary","matTooltip","Track on Map",3,"click"],["mat-icon-button","","matTooltip","Call Partner",3,"click",4,"ngIf"],[1,"info-value","address"],["mat-icon-button","","matTooltip","Call Partner",3,"click"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-icon",3),t.EFF(4,"gps_fixed"),t.k0s(),t.j41(5,"div")(6,"h1"),t.EFF(7,"Live Tracking Dashboard"),t.k0s(),t.j41(8,"p",4),t.EFF(9,"Monitor active deliveries in real-time"),t.k0s()()(),t.j41(10,"div",5)(11,"span",6),t.EFF(12),t.k0s(),t.j41(13,"button",7),t.bIt("click",function(){return i.refreshData()}),t.j41(14,"mat-icon"),t.EFF(15,"refresh"),t.k0s(),t.EFF(16," Refresh "),t.k0s()()(),t.j41(17,"div",8)(18,"div",9),t.bIt("click",function(){return i.filterByStatus("ALL")}),t.j41(19,"mat-icon"),t.EFF(20,"delivery_dining"),t.k0s(),t.j41(21,"div",10),t.EFF(22),t.k0s(),t.j41(23,"div",11),t.EFF(24,"Active Deliveries"),t.k0s()(),t.j41(25,"div",12),t.bIt("click",function(){return i.filterByStatus("IN_TRANSIT")}),t.j41(26,"mat-icon"),t.EFF(27,"local_shipping"),t.k0s(),t.j41(28,"div",10),t.EFF(29),t.k0s(),t.j41(30,"div",11),t.EFF(31,"In Transit"),t.k0s()(),t.j41(32,"div",13),t.bIt("click",function(){return i.filterByStatus("PICKED_UP")}),t.j41(33,"mat-icon"),t.EFF(34,"shopping_cart"),t.k0s(),t.j41(35,"div",10),t.EFF(36),t.k0s(),t.j41(37,"div",11),t.EFF(38,"Picked Up"),t.k0s()(),t.j41(39,"div",14),t.bIt("click",function(){return i.filterByStatus("ASSIGNED")}),t.j41(40,"mat-icon"),t.EFF(41,"assignment"),t.k0s(),t.j41(42,"div",10),t.EFF(43),t.k0s(),t.j41(44,"div",11),t.EFF(45,"Assigned / Accepted"),t.k0s()(),t.j41(46,"div",15),t.bIt("click",function(){return i.filterByStatus("ALL")}),t.j41(47,"mat-icon"),t.EFF(48,"check_circle"),t.k0s(),t.j41(49,"div",10),t.EFF(50),t.k0s(),t.j41(51,"div",11),t.EFF(52,"Delivered Today"),t.k0s()()(),t.j41(53,"div",16)(54,"mat-chip-listbox"),t.DNE(55,bn,4,3,"mat-chip-option",17),t.k0s()(),t.DNE(56,kn,4,0,"div",18),t.DNE(57,Rn,3,2,"div",19),t.k0s()),2&n&&(t.R7$(12),t.SpI("Last updated: ",i.formatTime(i.lastRefresh),""),t.R7$(10),t.JRh(i.stats.totalActive),t.R7$(7),t.JRh(i.stats.inTransit),t.R7$(7),t.JRh(i.stats.pickedUp),t.R7$(7),t.JRh(i.stats.assigned),t.R7$(7),t.JRh(i.stats.deliveredToday),t.R7$(5),t.Y8G("ngForOf",i.statusFilters),t.R7$(1),t.Y8G("ngIf",i.isLoading),t.R7$(1),t.Y8G("ngIf",!i.isLoading))},dependencies:[h.Sq,h.bT,v.$z,v.iY,k.An,F.yZ,F.uI,F.gq,w.LG,et.oV],styles:[".admin-tracking-container[_ngcontent-%COMP%]{padding:20px 24px;max-width:1400px;margin:0 auto}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;flex-wrap:wrap;gap:16px}.page-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.page-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px;color:#4caf50}.page-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:22px;font-weight:600;color:#333;margin:0}.page-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:13px;color:#888;margin:2px 0 0}.page-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.page-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .last-refresh[_ngcontent-%COMP%]{font-size:12px;color:#999}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);gap:16px;margin-bottom:24px}.stat-card[_ngcontent-%COMP%]{text-align:center;border-radius:12px;padding:20px 12px;cursor:pointer;transition:transform .2s,box-shadow .2s;box-shadow:0 2px 8px #00000014}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 6px 16px #0000001f}.stat-card[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px;margin-bottom:8px}.stat-card[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:32px;font-weight:700;line-height:1;margin-bottom:4px}.stat-card[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:12px;font-weight:500;text-transform:uppercase;letter-spacing:.5px}.stat-card.total[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e3f2fd,#bbdefb)}.stat-card.total[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#1565c0}.stat-card.total[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#1565c0}.stat-card.total[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{color:#1976d2}.stat-card.in-transit[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e8f5e9,#c8e6c9)}.stat-card.in-transit[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#2e7d32}.stat-card.in-transit[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#2e7d32}.stat-card.in-transit[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{color:#388e3c}.stat-card.picked-up[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f3e5f5,#e1bee7)}.stat-card.picked-up[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#6a1b9a}.stat-card.picked-up[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#6a1b9a}.stat-card.picked-up[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{color:#7b1fa2}.stat-card.assigned[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff3e0,#ffe0b2)}.stat-card.assigned[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#e65100}.stat-card.assigned[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#e65100}.stat-card.assigned[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{color:#f57c00}.stat-card.delivered[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e0f7fa,#b2ebf2)}.stat-card.delivered[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#00838f}.stat-card.delivered[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#00838f}.stat-card.delivered[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{color:#0097a7}.filter-bar[_ngcontent-%COMP%]{margin-bottom:20px}.filter-bar[_ngcontent-%COMP%]   mat-chip-listbox[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.loading-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;gap:16px}.loading-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#888;font-size:14px}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;background:white;border-radius:12px;box-shadow:0 2px 8px #0000000f}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#ccc;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;color:#555;margin:0 0 8px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#999;font-size:14px;margin:0 0 16px}.deliveries-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.delivery-card[_ngcontent-%COMP%]{background:white;border-radius:10px;box-shadow:0 2px 8px #0000000f;overflow:hidden;cursor:pointer;transition:box-shadow .2s,transform .15s;display:flex}.delivery-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 16px #0000001f;transform:translate(4px)}.delivery-card[_ngcontent-%COMP%]   .card-status-bar[_ngcontent-%COMP%]{width:5px;flex-shrink:0}.delivery-card[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{flex:1;padding:16px 20px;display:flex;flex-direction:column;gap:12px}.card-top[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.card-top[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:4px 12px;border-radius:16px;color:#fff;font-size:12px;font-weight:600}.card-top[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.card-top[_ngcontent-%COMP%]   .time-info[_ngcontent-%COMP%]{font-size:12px;color:#999}.card-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.info-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:13px}.info-row[_ngcontent-%COMP%]   .row-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#aaa;flex-shrink:0}.info-row[_ngcontent-%COMP%]   .info-label[_ngcontent-%COMP%]{color:#888;font-weight:500;min-width:70px;flex-shrink:0}.info-row[_ngcontent-%COMP%]   .info-value[_ngcontent-%COMP%]{color:#333;font-weight:400}.info-row[_ngcontent-%COMP%]   .info-value.address[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:400px}.card-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:4px;margin-top:4px;border-top:1px solid #f5f5f5;padding-top:8px}@media (max-width: 1024px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}@media (max-width: 768px){.admin-tracking-container[_ngcontent-%COMP%]{padding:12px 16px}.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.page-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{width:100%;justify-content:space-between}.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.info-row[_ngcontent-%COMP%]   .info-value.address[_ngcontent-%COMP%]{max-width:200px}.delivery-card[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{padding:12px 16px}}@media (max-width: 480px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:10px}.stat-card[_ngcontent-%COMP%]{padding:14px 8px}.stat-card[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:24px}}"]})}}return r})();function $n(r,o){1&r&&(t.j41(0,"div",4),t.nrm(1,"mat-spinner"),t.j41(2,"p"),t.EFF(3,"Loading orders..."),t.k0s()())}function Nn(r,o){1&r&&(t.j41(0,"mat-header-cell"),t.EFF(1,"Order ID"),t.k0s())}function Ln(r,o){if(1&r&&(t.j41(0,"mat-cell"),t.EFF(1),t.k0s()),2&r){const e=o.$implicit;t.R7$(1),t.SpI("#",e.orderId,"")}}function Gn(r,o){1&r&&(t.j41(0,"mat-header-cell"),t.EFF(1,"Customer"),t.k0s())}function Vn(r,o){if(1&r&&(t.j41(0,"mat-cell"),t.EFF(1),t.k0s()),2&r){const e=o.$implicit;t.R7$(1),t.JRh(e.customerName)}}function Bn(r,o){1&r&&(t.j41(0,"mat-header-cell"),t.EFF(1,"Pickup"),t.k0s())}function Un(r,o){if(1&r&&(t.j41(0,"mat-cell"),t.EFF(1),t.k0s()),2&r){const e=o.$implicit;t.R7$(1),t.JRh(e.pickupAddress)}}function Yn(r,o){1&r&&(t.j41(0,"mat-header-cell"),t.EFF(1,"Delivery"),t.k0s())}function zn(r,o){if(1&r&&(t.j41(0,"mat-cell"),t.EFF(1),t.k0s()),2&r){const e=o.$implicit;t.R7$(1),t.JRh(e.deliveryAddress)}}function Xn(r,o){1&r&&(t.j41(0,"mat-header-cell"),t.EFF(1,"Status"),t.k0s())}function Jn(r,o){if(1&r&&(t.j41(0,"mat-cell")(1,"mat-chip",18),t.EFF(2),t.nI1(3,"titlecase"),t.k0s()()),2&r){const e=o.$implicit,n=t.XpG(2);t.R7$(1),t.Y8G("color",n.getStatusColor(e.status)),t.R7$(1),t.SpI(" ",t.bMT(3,2,e.status)," ")}}function Kn(r,o){1&r&&(t.j41(0,"mat-header-cell"),t.EFF(1,"Amount"),t.k0s())}function Wn(r,o){if(1&r&&(t.j41(0,"mat-cell"),t.EFF(1),t.k0s()),2&r){const e=o.$implicit;t.R7$(1),t.SpI("\u20b9",e.amount,"")}}function qn(r,o){1&r&&(t.j41(0,"mat-header-cell"),t.EFF(1,"Actions"),t.k0s())}function Hn(r,o){if(1&r){const e=t.RV6();t.j41(0,"button",21),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,a=t.XpG(2);return t.Njj(a.startDelivery(i.orderId))}),t.j41(1,"mat-icon"),t.EFF(2,"local_shipping"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Start Delivery"),t.k0s()()}}function Qn(r,o){if(1&r){const e=t.RV6();t.j41(0,"button",21),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,a=t.XpG(2);return t.Njj(a.completeDelivery(i.orderId))}),t.j41(1,"mat-icon"),t.EFF(2,"check_circle"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Mark Delivered"),t.k0s()()}}function Zn(r,o){if(1&r){const e=t.RV6();t.j41(0,"mat-cell")(1,"button",19)(2,"mat-icon"),t.EFF(3,"more_vert"),t.k0s()(),t.j41(4,"mat-menu",null,20)(6,"button",21),t.bIt("click",function(){const a=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.viewOrderDetails(a.orderId))}),t.j41(7,"mat-icon"),t.EFF(8,"visibility"),t.k0s(),t.j41(9,"span"),t.EFF(10,"View Details"),t.k0s()(),t.DNE(11,Hn,5,0,"button",22),t.DNE(12,Qn,5,0,"button",22),t.k0s()()}if(2&r){const e=o.$implicit,n=t.sdS(5);t.R7$(1),t.Y8G("matMenuTriggerFor",n),t.R7$(10),t.Y8G("ngIf","ASSIGNED"===e.status),t.R7$(1),t.Y8G("ngIf","PICKED_UP"===e.status||"IN_TRANSIT"===e.status)}}function tr(r,o){1&r&&t.nrm(0,"mat-header-row")}function er(r,o){1&r&&t.nrm(0,"mat-row")}function nr(r,o){1&r&&(t.j41(0,"div",23)(1,"mat-icon"),t.EFF(2,"assignment"),t.k0s(),t.j41(3,"p"),t.EFF(4,"No orders assigned yet"),t.k0s()())}function rr(r,o){if(1&r&&(t.j41(0,"div")(1,"mat-table",5),t.qex(2,6),t.DNE(3,Nn,2,0,"mat-header-cell",7),t.DNE(4,Ln,2,1,"mat-cell",8),t.bVm(),t.qex(5,9),t.DNE(6,Gn,2,0,"mat-header-cell",7),t.DNE(7,Vn,2,1,"mat-cell",8),t.bVm(),t.qex(8,10),t.DNE(9,Bn,2,0,"mat-header-cell",7),t.DNE(10,Un,2,1,"mat-cell",8),t.bVm(),t.qex(11,11),t.DNE(12,Yn,2,0,"mat-header-cell",7),t.DNE(13,zn,2,1,"mat-cell",8),t.bVm(),t.qex(14,12),t.DNE(15,Xn,2,0,"mat-header-cell",7),t.DNE(16,Jn,4,4,"mat-cell",8),t.bVm(),t.qex(17,13),t.DNE(18,Kn,2,0,"mat-header-cell",7),t.DNE(19,Wn,2,1,"mat-cell",8),t.bVm(),t.qex(20,14),t.DNE(21,qn,2,0,"mat-header-cell",7),t.DNE(22,Zn,13,3,"mat-cell",8),t.bVm(),t.DNE(23,tr,1,0,"mat-header-row",15),t.DNE(24,er,1,0,"mat-row",16),t.k0s(),t.DNE(25,nr,5,0,"div",17),t.k0s()),2&r){const e=t.XpG();t.R7$(1),t.Y8G("dataSource",e.dataSource),t.R7$(22),t.Y8G("matHeaderRowDef",e.displayedColumns),t.R7$(1),t.Y8G("matRowDefColumns",e.displayedColumns),t.R7$(1),t.Y8G("ngIf",0===e.dataSource.data.length)}}let ir=(()=>{class r{constructor(e,n){this.orderAssignmentService=e,this.snackBar=n,this.displayedColumns=["orderId","customerName","pickupAddress","deliveryAddress","status","amount","actions"],this.dataSource=new u.I6([]),this.isLoading=!0,this.statusColors={ASSIGNED:"primary",PICKED_UP:"accent",IN_TRANSIT:"warn",DELIVERED:"success",CANCELLED:"error"}}ngOnInit(){this.loadPartnerOrders()}loadPartnerOrders(){this.isLoading=!0,this.orderAssignmentService.getPartnerOrders().subscribe({next:e=>{this.dataSource.data=e,this.isLoading=!1},error:e=>{this.snackBar.open("Failed to load orders","Close",{duration:3e3}),this.isLoading=!1}})}updateOrderStatus(e,n){this.orderAssignmentService.updateOrderStatus(e,n).subscribe({next:()=>{this.snackBar.open("Order status updated successfully","Close",{duration:3e3}),this.loadPartnerOrders()},error:i=>{this.snackBar.open("Failed to update order status","Close",{duration:3e3})}})}getStatusColor(e){return this.statusColors[e]||"primary"}viewOrderDetails(e){console.log("View order details:",e)}startDelivery(e){this.updateOrderStatus(e,"PICKED_UP")}completeDelivery(e){this.updateOrderStatus(e,"DELIVERED")}static{this.\u0275fac=function(n){return new(n||r)(t.rXU(z),t.rXU(x.UG))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-partner-orders"]],decls:10,vars:2,consts:[[1,"partner-orders-container"],[1,"orders-card"],["class","loading-container",4,"ngIf"],[4,"ngIf"],[1,"loading-container"],[1,"orders-table",3,"dataSource"],["matColumnDef","orderId"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","customerName"],["matColumnDef","pickupAddress"],["matColumnDef","deliveryAddress"],["matColumnDef","status"],["matColumnDef","amount"],["matColumnDef","actions"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],["class","no-orders",4,"ngIf"],["selected","",3,"color"],["mat-icon-button","",3,"matMenuTriggerFor"],["actionMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],[1,"no-orders"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"mat-card-title"),t.EFF(4,"My Orders"),t.k0s(),t.j41(5,"mat-card-subtitle"),t.EFF(6,"Manage your assigned deliveries"),t.k0s()(),t.j41(7,"mat-card-content"),t.DNE(8,$n,4,0,"div",2),t.DNE(9,rr,26,4,"div",3),t.k0s()()()),2&n&&(t.R7$(8),t.Y8G("ngIf",i.isLoading),t.R7$(1),t.Y8G("ngIf",!i.isLoading))},dependencies:[h.bT,p.RN,p.m2,p.MM,p.Lc,p.dh,v.iY,u.Zl,u.tL,u.ji,u.cC,u.YV,u.iL,u.KS,u.$R,u.YZ,u.NB,k.An,F.Jl,w.LG,I.kk,I.fb,I.Cp,h.PV],styles:[".partner-orders-container[_ngcontent-%COMP%]{padding:1rem}.orders-card[_ngcontent-%COMP%]{margin-bottom:2rem}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:2rem}.loading-container[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin-bottom:1rem}.orders-table[_ngcontent-%COMP%]{width:100%;margin-top:1rem}.no-orders[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:2rem;text-align:center;color:#666}.no-orders[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:1rem}"]})}}return r})(),ar=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${j.c.apiUrl}/delivery/analytics`}getKeyMetrics(e,n){const i=(new P.Nl).set("startDate",e.toISOString()).set("endDate",n.toISOString());return this.http.get(`${this.apiUrl}/metrics`,{params:i})}getDeliveryTrends(e,n,i="day"){const a=(new P.Nl).set("startDate",e.toISOString()).set("endDate",n.toISOString()).set("groupBy",i);return this.http.get(`${this.apiUrl}/trends`,{params:a})}getTopPartners(e=10){const n=(new P.Nl).set("limit",e.toString());return this.http.get(`${this.apiUrl}/partners/top`,{params:n})}getPartnerPerformance(e,n,i){const a=(new P.Nl).set("startDate",n.toISOString()).set("endDate",i.toISOString());return this.http.get(`${this.apiUrl}/partners/${e}`,{params:a})}getZonePerformance(){return this.http.get(`${this.apiUrl}/zones`)}getZoneDetails(e,n,i){const a=(new P.Nl).set("startDate",n.toISOString()).set("endDate",i.toISOString());return this.http.get(`${this.apiUrl}/zones/${e}`,{params:a})}getStatusDistribution(e,n){const i=(new P.Nl).set("startDate",e.toISOString()).set("endDate",n.toISOString());return this.http.get(`${this.apiUrl}/status-distribution`,{params:i})}getPeakHours(){return this.http.get(`${this.apiUrl}/peak-hours`)}getRevenueAnalytics(e,n){const i=(new P.Nl).set("startDate",e.toISOString()).set("endDate",n.toISOString());return this.http.get(`${this.apiUrl}/revenue`,{params:i})}getCustomerSatisfaction(){return this.http.get(`${this.apiUrl}/customer-satisfaction`)}getVehicleTypePerformance(){return this.http.get(`${this.apiUrl}/vehicle-types`)}getDeliveryTimeAnalysis(e,n){const i=(new P.Nl).set("startDate",e.toISOString()).set("endDate",n.toISOString());return this.http.get(`${this.apiUrl}/delivery-times`,{params:i})}getFailedDeliveryAnalysis(e,n){const i=(new P.Nl).set("startDate",e.toISOString()).set("endDate",n.toISOString());return this.http.get(`${this.apiUrl}/failed-deliveries`,{params:i})}getZones(){return this.http.get(`${this.apiUrl}/filters/zones`)}getPartners(){return this.http.get(`${this.apiUrl}/filters/partners`)}exportReport(e,n,i){const a=(new P.Nl).set("format",e).set("startDate",n.toISOString()).set("endDate",i.toISOString());return this.http.get(`${this.apiUrl}/export`,{params:a,responseType:"blob"})}getDashboardStats(){return this.http.get(`${this.apiUrl}/dashboard`)}getDemandForecast(e=7){const n=(new P.Nl).set("days",e.toString());return this.http.get(`${this.apiUrl}/forecast`,{params:n})}getPartnerUtilization(){return this.http.get(`${this.apiUrl}/partner-utilization`)}getRouteEfficiency(e,n){const i=(new P.Nl).set("startDate",e.toISOString()).set("endDate",n.toISOString());return this.http.get(`${this.apiUrl}/route-efficiency`,{params:i})}mockResponse(e){return new D.c(n=>{setTimeout(()=>{n.next({statusCode:"SUCCESS",message:"Data retrieved successfully",data:e,timestamp:(new Date).toISOString()}),n.complete()},500)})}static{this.\u0275fac=function(n){return new(n||r)(t.KVO(P.Qq))}}static{this.\u0275prov=t.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})(),or=(()=>{class r{constructor(e,n){this.analyticsService=e,this.snackBar=n,this.destroy$=new L.B,this.startDate=new Date((new Date).setDate((new Date).getDate()-30)),this.endDate=new Date,this.selectedPeriod="30days",this.isLoading=!0,this.metrics={totalDeliveries:0,successRate:0,avgDeliveryTime:0,totalRevenue:0,activePartners:0,avgRating:0,onTimeDeliveryRate:0,totalDistance:0},this.deliveryTrendChartData={labels:[],datasets:[{data:[],label:"Deliveries",borderColor:"#667eea",backgroundColor:"rgba(102, 126, 234, 0.1)",tension:.4}]},this.deliveryTrendChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0},tooltip:{callbacks:{label:i=>`Deliveries: ${i.parsed.y}`}}},scales:{y:{beginAtZero:!0}}},this.partnerPerformanceData=[],this.partnerColumns=["rank","partnerName","deliveries","successRate","avgTime","rating","earnings"],this.zonePerformanceData=[],this.statusDistributionData={labels:["Delivered","In Transit","Failed","Cancelled"],datasets:[{data:[],backgroundColor:["#4CAF50","#2196F3","#f44336","#FF9800"]}]},this.peakHoursChartData={labels:[],datasets:[{data:[],label:"Orders",backgroundColor:"#667eea"}]},this.revenueChartData={labels:[],datasets:[{data:[],label:"Revenue",borderColor:"#4CAF50",backgroundColor:"rgba(76, 175, 80, 0.1)",tension:.4},{data:[],label:"Commission",borderColor:"#FF9800",backgroundColor:"rgba(255, 152, 0, 0.1)",tension:.4}]},this.satisfactionData={avgRating:0,totalReviews:0,distribution:{5:0,4:0,3:0,2:0,1:0}},this.selectedZone="all",this.selectedPartner="all",this.selectedVehicleType="all",this.zones=[],this.partners=[],this.vehicleTypes=["BIKE","SCOOTER","BICYCLE","CAR","AUTO"]}ngOnInit(){this.loadAnalytics(),this.loadFilters()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadAnalytics(){this.isLoading=!0,Promise.all([this.loadKeyMetrics(),this.loadDeliveryTrends(),this.loadPartnerPerformance(),this.loadZonePerformance(),this.loadStatusDistribution(),this.loadPeakHours(),this.loadRevenueData(),this.loadCustomerSatisfaction()]).then(()=>{this.isLoading=!1}).catch(e=>{console.error("Error loading analytics:",e),this.snackBar.open("Failed to load analytics","Close",{duration:3e3}),this.isLoading=!1})}loadKeyMetrics(){return new Promise(e=>{this.analyticsService.getKeyMetrics(this.startDate,this.endDate).pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{f.c.isSuccess(n)&&n.data&&(this.metrics=n.data),e()},error:()=>e()})})}loadDeliveryTrends(){return new Promise(e=>{this.analyticsService.getDeliveryTrends(this.startDate,this.endDate).pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{f.c.isSuccess(n)&&n.data&&(this.deliveryTrendChartData.labels=n.data.labels,this.deliveryTrendChartData.datasets[0].data=n.data.values),e()},error:()=>e()})})}loadPartnerPerformance(){return new Promise(e=>{this.analyticsService.getTopPartners(10).pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{f.c.isSuccess(n)&&n.data&&(this.partnerPerformanceData=n.data.map((i,a)=>({...i,rank:a+1}))),e()},error:()=>e()})})}loadZonePerformance(){return new Promise(e=>{this.analyticsService.getZonePerformance().pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{f.c.isSuccess(n)&&n.data&&(this.zonePerformanceData=n.data),e()},error:()=>e()})})}loadStatusDistribution(){return new Promise(e=>{this.analyticsService.getStatusDistribution(this.startDate,this.endDate).pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{f.c.isSuccess(n)&&n.data&&(this.statusDistributionData.datasets[0].data=[n.data.delivered,n.data.inTransit,n.data.failed,n.data.cancelled]),e()},error:()=>e()})})}loadPeakHours(){return new Promise(e=>{this.analyticsService.getPeakHours().pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{f.c.isSuccess(n)&&n.data&&(this.peakHoursChartData.labels=n.data.hours,this.peakHoursChartData.datasets[0].data=n.data.orders),e()},error:()=>e()})})}loadRevenueData(){return new Promise(e=>{this.analyticsService.getRevenueAnalytics(this.startDate,this.endDate).pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{f.c.isSuccess(n)&&n.data&&(this.revenueChartData.labels=n.data.labels,this.revenueChartData.datasets[0].data=n.data.revenue,this.revenueChartData.datasets[1].data=n.data.commission),e()},error:()=>e()})})}loadCustomerSatisfaction(){return new Promise(e=>{this.analyticsService.getCustomerSatisfaction().pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{f.c.isSuccess(n)&&n.data&&(this.satisfactionData=n.data),e()},error:()=>e()})})}loadFilters(){this.analyticsService.getZones().pipe((0,d.Q)(this.destroy$)).subscribe({next:e=>{f.c.isSuccess(e)&&(this.zones=e.data)}}),this.analyticsService.getPartners().pipe((0,d.Q)(this.destroy$)).subscribe({next:e=>{f.c.isSuccess(e)&&(this.partners=e.data)}})}onPeriodChange(){const e=new Date;switch(this.selectedPeriod){case"7days":this.startDate=new Date(e.setDate(e.getDate()-7));break;case"30days":this.startDate=new Date(e.setDate(e.getDate()-30));break;case"90days":this.startDate=new Date(e.setDate(e.getDate()-90))}this.loadAnalytics()}onDateRangeChange(){this.startDate&&this.endDate&&(this.selectedPeriod="custom",this.loadAnalytics())}onFilterChange(){this.loadAnalytics()}exportReport(e){this.analyticsService.exportReport(e,this.startDate,this.endDate).pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{const i=window.URL.createObjectURL(n),a=document.createElement("a");a.href=i,a.download=`delivery-analytics-${(new Date).toISOString().split("T")[0]}.${e}`,a.click(),window.URL.revokeObjectURL(i),this.snackBar.open("Report exported successfully","Close",{duration:3e3})},error:n=>{console.error("Error exporting report:",n),this.snackBar.open("Failed to export report","Close",{duration:3e3})}})}refreshData(){this.loadAnalytics()}formatCurrency(e){return`\u20b9${e.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`}formatPercentage(e){return`${e.toFixed(1)}%`}formatTime(e){return e<60?`${Math.round(e)} mins`:`${Math.floor(e/60)}h ${Math.round(e%60)}m`}formatDistance(e){return`${e.toFixed(1)} km`}getRatingStars(e){const n=Math.floor(e),i=e%1>=.5,a=[];for(let s=0;s<n;s++)a.push("star");for(i&&a.length<5&&a.push("star_half");a.length<5;)a.push("star_border");return a}getMetricIcon(e){switch(e){case"deliveries":return"local_shipping";case"success":return"check_circle";case"time":return"schedule";case"revenue":return"currency_rupee";case"partners":return"group";case"rating":return"star";case"ontime":return"timer";case"distance":return"navigation";default:return"analytics"}}getMetricColor(e){switch(e){case"deliveries":case"revenue":return"primary";case"success":case"rating":return"accent";default:return"basic"}}static{this.\u0275fac=function(n){return new(n||r)(t.rXU(ar),t.rXU(x.UG))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-delivery-analytics"]],decls:84,vars:13,consts:[[1,"analytics-container"],[1,"analytics-header"],[1,"date-range-selector"],["appearance","outline"],["matInput","",3,"matDatepicker","ngModel","ngModelChange"],["matSuffix","",3,"for"],["startPicker",""],["endPicker",""],["mat-raised-button","","color","primary",3,"click"],[1,"metrics-grid"],[1,"metric-card"],[1,"metric-header"],[1,"metric-value"],[1,"charts-section"],[1,"chart-card"],[1,"chart-placeholder"]],template:function(n,i){if(1&n&&(t.j41(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"mat-card-title")(4,"mat-icon"),t.EFF(5,"analytics"),t.k0s(),t.EFF(6," Delivery Analytics Dashboard "),t.k0s(),t.j41(7,"mat-card-subtitle"),t.EFF(8,"Performance metrics and insights"),t.k0s()(),t.j41(9,"mat-card-content")(10,"div",2)(11,"mat-form-field",3)(12,"mat-label"),t.EFF(13,"Start Date"),t.k0s(),t.j41(14,"input",4),t.bIt("ngModelChange",function(s){return i.startDate=s}),t.k0s(),t.nrm(15,"mat-datepicker-toggle",5)(16,"mat-datepicker",null,6),t.k0s(),t.j41(18,"mat-form-field",3)(19,"mat-label"),t.EFF(20,"End Date"),t.k0s(),t.j41(21,"input",4),t.bIt("ngModelChange",function(s){return i.endDate=s}),t.k0s(),t.nrm(22,"mat-datepicker-toggle",5)(23,"mat-datepicker",null,7),t.k0s(),t.j41(25,"button",8),t.bIt("click",function(){return i.loadAnalytics()}),t.j41(26,"mat-icon"),t.EFF(27,"refresh"),t.k0s(),t.EFF(28," Refresh Data "),t.k0s()()()(),t.j41(29,"div",9)(30,"mat-card",10)(31,"mat-card-content")(32,"div",11)(33,"mat-icon"),t.EFF(34,"local_shipping"),t.k0s(),t.j41(35,"span"),t.EFF(36,"Total Deliveries"),t.k0s()(),t.j41(37,"div",12),t.EFF(38),t.k0s()()(),t.j41(39,"mat-card",10)(40,"mat-card-content")(41,"div",11)(42,"mat-icon"),t.EFF(43,"check_circle"),t.k0s(),t.j41(44,"span"),t.EFF(45,"Success Rate"),t.k0s()(),t.j41(46,"div",12),t.EFF(47),t.nI1(48,"number"),t.k0s()()(),t.j41(49,"mat-card",10)(50,"mat-card-content")(51,"div",11)(52,"mat-icon"),t.EFF(53,"schedule"),t.k0s(),t.j41(54,"span"),t.EFF(55,"Avg Delivery Time"),t.k0s()(),t.j41(56,"div",12),t.EFF(57),t.k0s()()(),t.j41(58,"mat-card",10)(59,"mat-card-content")(60,"div",11)(61,"mat-icon"),t.EFF(62,"payments"),t.k0s(),t.j41(63,"span"),t.EFF(64,"Total Revenue"),t.k0s()(),t.j41(65,"div",12),t.EFF(66),t.k0s()()()(),t.j41(67,"div",13)(68,"mat-card",14)(69,"mat-card-header")(70,"mat-card-title"),t.EFF(71,"Delivery Trends"),t.k0s()(),t.j41(72,"mat-card-content")(73,"div",15)(74,"p"),t.EFF(75,"Chart will be implemented here"),t.k0s()()()(),t.j41(76,"mat-card",14)(77,"mat-card-header")(78,"mat-card-title"),t.EFF(79,"Partner Performance"),t.k0s()(),t.j41(80,"mat-card-content")(81,"div",15)(82,"p"),t.EFF(83,"Partner performance chart will be implemented here"),t.k0s()()()()()()),2&n){const a=t.sdS(17),s=t.sdS(24);t.R7$(14),t.Y8G("matDatepicker",a)("ngModel",i.startDate),t.R7$(1),t.Y8G("for",a),t.R7$(6),t.Y8G("matDatepicker",s)("ngModel",i.endDate),t.R7$(1),t.Y8G("for",s),t.R7$(16),t.JRh(i.metrics.totalDeliveries||0),t.R7$(9),t.SpI("",t.i5U(48,10,i.metrics.successRate||0,"1.1-1"),"%"),t.R7$(10),t.SpI("",i.metrics.avgDeliveryTime||0," min"),t.R7$(9),t.SpI("\u20b9",i.metrics.totalRevenue||0,"")}},dependencies:[g.me,g.BC,g.vS,p.RN,p.m2,p.MM,p.Lc,p.dh,v.$z,M.rl,M.nJ,M.yw,T.fg,W.Vh,W.bZ,W.bU,k.An,h.QX],styles:[".analytics-container[_ngcontent-%COMP%]{padding:1rem}.analytics-header[_ngcontent-%COMP%]{margin-bottom:2rem}.date-range-selector[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center;flex-wrap:wrap}.metrics-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1rem;margin-bottom:2rem}.metric-card[_ngcontent-%COMP%]   .metric-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:1rem;color:#666}.metric-card[_ngcontent-%COMP%]   .metric-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px}.metric-card[_ngcontent-%COMP%]   .metric-value[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#2196f3}.charts-section[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:2rem}.chart-card[_ngcontent-%COMP%]{min-height:300px}.chart-placeholder[_ngcontent-%COMP%]{height:200px;display:flex;align-items:center;justify-content:center;background-color:#f5f5f5;border-radius:4px;color:#666}"]})}}return r})();function sr(r,o){1&r&&(t.j41(0,"div",6),t.nrm(1,"mat-spinner"),t.j41(2,"p"),t.EFF(3,"Loading documents..."),t.k0s()())}function cr(r,o){1&r&&(t.j41(0,"div",7)(1,"mat-icon"),t.EFF(2,"folder_open"),t.k0s(),t.j41(3,"h3"),t.EFF(4,"No Documents Found"),t.k0s(),t.j41(5,"p"),t.EFF(6,"This delivery partner hasn't uploaded any documents yet."),t.k0s()())}function lr(r,o){if(1&r&&(t.j41(0,"p")(1,"strong"),t.EFF(2,"License Number:"),t.k0s(),t.EFF(3),t.k0s()),2&r){const e=t.XpG(2).$implicit;t.R7$(3),t.SpI(" ",e.licenseNumber,"")}}function dr(r,o){if(1&r&&(t.j41(0,"p")(1,"strong"),t.EFF(2,"Vehicle Number:"),t.k0s(),t.EFF(3),t.k0s()),2&r){const e=t.XpG(2).$implicit;t.R7$(3),t.SpI(" ",e.vehicleNumber,"")}}function gr(r,o){if(1&r&&(t.j41(0,"div",20),t.DNE(1,lr,4,1,"p",21),t.DNE(2,dr,4,1,"p",21),t.k0s()),2&r){const e=t.XpG().$implicit;t.R7$(1),t.Y8G("ngIf",e.licenseNumber),t.R7$(1),t.Y8G("ngIf",e.vehicleNumber)}}function pr(r,o){if(1&r){const e=t.RV6();t.j41(0,"img",22),t.bIt("error",function(i){t.eBV(e);const a=t.XpG().$implicit,s=t.XpG(2);return t.Njj(s.onImageError(i,a))}),t.k0s()}if(2&r){const e=t.XpG().$implicit,n=t.XpG(2);t.Y8G("src",n.getDocumentUrl(e),t.B4B)("alt",e.documentName)}}function mr(r,o){if(1&r&&(t.j41(0,"div",23)(1,"mat-icon"),t.EFF(2,"description"),t.k0s(),t.j41(3,"p"),t.EFF(4),t.k0s(),t.j41(5,"a",18)(6,"mat-icon"),t.EFF(7,"download"),t.k0s(),t.EFF(8," Download "),t.k0s()()),2&r){const e=t.XpG().$implicit,n=t.XpG(2);t.R7$(4),t.JRh(e.fileType),t.R7$(1),t.Y8G("href",n.getDocumentUrl(e),t.B4B)}}function ur(r,o){if(1&r&&(t.j41(0,"div",10)(1,"div",11)(2,"h3"),t.EFF(3),t.k0s(),t.j41(4,"mat-chip"),t.EFF(5),t.k0s()(),t.j41(6,"div",12)(7,"p")(8,"strong"),t.EFF(9,"Filename:"),t.k0s(),t.EFF(10),t.k0s(),t.j41(11,"p")(12,"strong"),t.EFF(13,"Size:"),t.k0s(),t.EFF(14),t.k0s(),t.j41(15,"p")(16,"strong"),t.EFF(17,"Uploaded:"),t.k0s(),t.EFF(18),t.nI1(19,"date"),t.k0s(),t.DNE(20,gr,3,2,"div",13),t.k0s(),t.j41(21,"div",14),t.DNE(22,pr,1,2,"img",15),t.DNE(23,mr,9,2,"div",16),t.k0s(),t.j41(24,"div",17)(25,"a",18)(26,"mat-icon"),t.EFF(27,"open_in_new"),t.k0s(),t.EFF(28," Open Full Size "),t.k0s(),t.j41(29,"a",19)(30,"mat-icon"),t.EFF(31,"download"),t.k0s(),t.EFF(32," Download "),t.k0s()()()),2&r){const e=o.$implicit,n=t.XpG(2);t.R7$(3),t.JRh(n.getDocumentDisplayName(e.documentType)),t.R7$(1),t.HbH("status-chip status-"+e.verificationStatus.toLowerCase()),t.R7$(1),t.SpI(" ",e.verificationStatus," "),t.R7$(5),t.SpI(" ",e.originalFilename,""),t.R7$(4),t.SpI(" ",n.formatFileSize(e.fileSize),""),t.R7$(4),t.SpI(" ",t.i5U(19,12,e.createdAt,"dd/MM/yyyy HH:mm"),""),t.R7$(2),t.Y8G("ngIf",e.licenseNumber||e.vehicleNumber),t.R7$(2),t.Y8G("ngIf",n.isImageFile(e.fileType)),t.R7$(1),t.Y8G("ngIf",!n.isImageFile(e.fileType)),t.R7$(2),t.Y8G("href",n.getDocumentUrl(e),t.B4B),t.R7$(4),t.Y8G("href",n.getDocumentUrl(e),t.B4B)}}function hr(r,o){if(1&r&&(t.j41(0,"div",8),t.DNE(1,ur,33,15,"div",9),t.k0s()),2&r){const e=t.XpG();t.R7$(1),t.Y8G("ngForOf",e.documents)}}let _r=(()=>{class r{constructor(e,n){this.route=e,this.deliveryPartnerService=n,this.partnerName="",this.documents=[],this.loading=!0}ngOnInit(){this.route.params.subscribe(e=>{this.partnerId=+e.id,this.partnerName=e.name||"Delivery Partner",this.loadDocuments()})}loadDocuments(){this.loading=!0,this.deliveryPartnerService.getPartnerDocuments(this.partnerId).subscribe({next:e=>{this.documents=e.data||[],this.loading=!1},error:e=>{console.error("Error loading documents:",e),this.loading=!1}})}getDocumentDisplayName(e){return{DRIVER_PHOTO:"Driver Photo",DRIVING_LICENSE:"Driving License",VEHICLE_PHOTO:"Vehicle Photo",RC_BOOK:"RC Book"}[e]||e.replace("_"," ")}getDocumentUrl(e){return`${j.c.apiUrl||"http://localhost:8080/api"}/delivery/partners/documents/${e.id}/view`}isImageFile(e){return!!e&&e.startsWith("image/")}formatFileSize(e){if(0===e)return"0 Bytes";const a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]}onImageError(e,n){console.error("Image load error for document:",n.id),e.target.alt="Image could not be loaded",e.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2VlZWVlZSIvPgo8dGV4dCB4PSI1MCUiIHk9IjUwJSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmaWxsPSIjOTk5IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iMC4zZW0iPkltYWdlIG5vdCBhdmFpbGFibGU8L3RleHQ+Cjwvc3ZnPg=="}goBack(){window.history.back()}static{this.\u0275fac=function(n){return new(n||r)(t.rXU($.nX),t.rXU(Y.WS))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-simple-document-viewer"]],decls:11,vars:4,consts:[[1,"simple-viewer-container"],[1,"header"],["mat-raised-button","","color","primary",3,"click"],["class","loading",4,"ngIf"],["class","no-documents",4,"ngIf"],["class","documents-grid",4,"ngIf"],[1,"loading"],[1,"no-documents"],[1,"documents-grid"],["class","document-item",4,"ngFor","ngForOf"],[1,"document-item"],[1,"document-header"],[1,"document-info"],["class","metadata",4,"ngIf"],[1,"document-preview"],["class","document-image",3,"src","alt","error",4,"ngIf"],["class","non-image-file",4,"ngIf"],[1,"document-actions"],["target","_blank","mat-raised-button","","color","primary",3,"href"],["download","","mat-raised-button","","color","accent",3,"href"],[1,"metadata"],[4,"ngIf"],[1,"document-image",3,"src","alt","error"],[1,"non-image-file"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"h2"),t.EFF(3),t.k0s(),t.j41(4,"button",2),t.bIt("click",function(){return i.goBack()}),t.j41(5,"mat-icon"),t.EFF(6,"arrow_back"),t.k0s(),t.EFF(7," Back to Users "),t.k0s()(),t.DNE(8,sr,4,0,"div",3),t.DNE(9,cr,7,0,"div",4),t.DNE(10,hr,2,1,"div",5),t.k0s()),2&n&&(t.R7$(3),t.SpI("\u{1f4c4} ",i.partnerName," - Uploaded Documents"),t.R7$(5),t.Y8G("ngIf",i.loading),t.R7$(1),t.Y8G("ngIf",!i.loading&&0===i.documents.length),t.R7$(1),t.Y8G("ngIf",!i.loading&&i.documents.length>0))},dependencies:[h.Sq,h.bT,v.It,v.$z,k.An,F.Jl,w.LG,h.vh],styles:[".simple-viewer-container[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;padding-bottom:20px;border-bottom:2px solid #e0e0e0}.header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;color:#333}.loading[_ngcontent-%COMP%]{text-align:center;padding:40px}.loading[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin:0 auto 20px}.no-documents[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#666}.no-documents[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;margin-bottom:20px;color:#ccc}.documents-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:30px;margin-top:20px}.document-item[_ngcontent-%COMP%]{border:1px solid #ddd;border-radius:12px;padding:20px;background:white;box-shadow:0 2px 8px #0000001a}.document-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}.document-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#333;font-size:18px}.status-chip[_ngcontent-%COMP%]{font-size:12px;padding:4px 12px;border-radius:16px}.status-chip.status-verified[_ngcontent-%COMP%]{background:#e8f5e8;color:#2e7d32}.status-chip.status-pending[_ngcontent-%COMP%]{background:#fff3e0;color:#f57c00}.status-chip.status-rejected[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.document-info[_ngcontent-%COMP%]{margin-bottom:20px}.document-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0;font-size:14px;color:#666}.metadata[_ngcontent-%COMP%]{margin-top:10px;padding-top:10px;border-top:1px solid #eee}.document-preview[_ngcontent-%COMP%]{margin-bottom:20px;text-align:center;min-height:200px;display:flex;align-items:center;justify-content:center;background:#f8f9fa;border-radius:8px;padding:20px}.document-image[_ngcontent-%COMP%]{max-width:100%;max-height:300px;border-radius:8px;box-shadow:0 2px 8px #0000001a}.non-image-file[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:10px;color:#666}.non-image-file[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px}.document-actions[_ngcontent-%COMP%]{display:flex;gap:10px;justify-content:center}.document-actions[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}"]})}}return r})();function fr(r,o){1&r&&(t.j41(0,"th",64),t.EFF(1,"Partner ID"),t.k0s())}function Cr(r,o){if(1&r&&(t.j41(0,"td",65)(1,"span",66),t.EFF(2),t.k0s()()),2&r){const e=o.$implicit;t.R7$(2),t.JRh(e.partnerId)}}function Pr(r,o){1&r&&(t.j41(0,"th",64),t.EFF(1,"Name"),t.k0s())}function vr(r,o){if(1&r&&(t.j41(0,"td",65)(1,"div",67)(2,"mat-icon",68),t.EFF(3,"person"),t.k0s(),t.j41(4,"span",69),t.EFF(5),t.k0s()()()),2&r){const e=o.$implicit;t.R7$(5),t.JRh(e.partnerName)}}function Or(r,o){1&r&&(t.j41(0,"th",64),t.EFF(1,"Phone"),t.k0s())}function Mr(r,o){if(1&r&&(t.j41(0,"td",65)(1,"a",70),t.EFF(2),t.k0s()()),2&r){const e=o.$implicit;t.R7$(1),t.Mz_("href","tel:",e.phone,"",t.B4B),t.R7$(1),t.JRh(e.phone)}}function br(r,o){1&r&&(t.j41(0,"th",64),t.EFF(1,"Vehicle"),t.k0s())}function kr(r,o){if(1&r&&(t.j41(0,"td",65)(1,"div",71)(2,"mat-icon",72),t.EFF(3),t.k0s(),t.j41(4,"span"),t.EFF(5),t.k0s()()()),2&r){const e=o.$implicit,n=t.XpG();t.R7$(3),t.JRh(n.getVehicleIcon(e.vehicle)),t.R7$(2),t.JRh(e.vehicle)}}function Fr(r,o){1&r&&(t.j41(0,"th",64),t.EFF(1,"Status"),t.k0s())}function yr(r,o){if(1&r&&(t.j41(0,"td",65)(1,"span",73),t.EFF(2),t.k0s()()),2&r){const e=o.$implicit,n=t.XpG();t.R7$(1),t.Y8G("ngClass",n.getStatusClass(e.status)),t.R7$(1),t.SpI(" ",e.status," ")}}function xr(r,o){1&r&&(t.j41(0,"th",64),t.EFF(1,"Verification"),t.k0s())}function Er(r,o){if(1&r&&(t.j41(0,"td",65)(1,"div",74)(2,"mat-icon",75),t.EFF(3),t.k0s(),t.j41(4,"span"),t.EFF(5),t.k0s()()()),2&r){const e=o.$implicit,n=t.XpG();t.R7$(2),t.Y8G("ngClass",n.getVerificationClass(e.verification)),t.R7$(1),t.SpI(" ","VERIFIED"===e.verification?"verified":"PENDING"===e.verification?"pending":"cancel"," "),t.R7$(2),t.JRh(e.verification)}}function Dr(r,o){1&r&&(t.j41(0,"th",64),t.EFF(1,"Rating"),t.k0s())}function wr(r,o){if(1&r&&(t.j41(0,"td",65)(1,"div",76)(2,"mat-icon",77),t.EFF(3,"star"),t.k0s(),t.j41(4,"span"),t.EFF(5),t.nI1(6,"number"),t.k0s()()()),2&r){const e=o.$implicit;t.R7$(5),t.JRh(t.i5U(6,1,e.rating,"1.1-1"))}}function Ir(r,o){1&r&&(t.j41(0,"th",64),t.EFF(1,"Deliveries"),t.k0s())}function jr(r,o){if(1&r&&(t.j41(0,"td",65)(1,"span",78),t.EFF(2),t.k0s()()),2&r){const e=o.$implicit;t.R7$(2),t.JRh(e.deliveries)}}function Sr(r,o){1&r&&(t.j41(0,"th",79),t.EFF(1,"Online"),t.k0s())}function Tr(r,o){if(1&r&&(t.j41(0,"td",65)(1,"mat-icon",80),t.EFF(2),t.k0s()()),2&r){const e=o.$implicit;t.R7$(1),t.Y8G("ngClass",e.isOnline?"online":"offline"),t.R7$(1),t.SpI(" ",e.isOnline?"wifi":"wifi_off"," ")}}function Rr(r,o){1&r&&(t.j41(0,"th",79),t.EFF(1,"Actions"),t.k0s())}function Ar(r,o){if(1&r){const e=t.RV6();t.j41(0,"td",65)(1,"button",81)(2,"mat-icon"),t.EFF(3,"more_horiz"),t.k0s()(),t.j41(4,"mat-menu",null,82)(6,"button",83),t.bIt("click",function(){const a=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.viewPartnerDetails(a))}),t.j41(7,"mat-icon"),t.EFF(8,"visibility"),t.k0s(),t.j41(9,"span"),t.EFF(10,"View Details"),t.k0s()(),t.j41(11,"button",84),t.bIt("click",function(){const a=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.assignOrder(a))}),t.j41(12,"mat-icon"),t.EFF(13,"assignment"),t.k0s(),t.j41(14,"span"),t.EFF(15,"Assign Order"),t.k0s()(),t.j41(16,"button",83),t.bIt("click",function(){const a=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.callPartner(a.phone))}),t.j41(17,"mat-icon"),t.EFF(18,"phone"),t.k0s(),t.j41(19,"span"),t.EFF(20,"Call Partner"),t.k0s()(),t.j41(21,"button",83),t.bIt("click",function(){const a=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.messagePartner(a))}),t.j41(22,"mat-icon"),t.EFF(23,"message"),t.k0s(),t.j41(24,"span"),t.EFF(25,"Send Message"),t.k0s()(),t.j41(26,"button",84),t.bIt("click",function(){const a=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.trackPartner(a))}),t.j41(27,"mat-icon"),t.EFF(28,"location_on"),t.k0s(),t.j41(29,"span"),t.EFF(30,"Track Location"),t.k0s()(),t.nrm(31,"mat-divider"),t.j41(32,"button",85),t.bIt("click",function(){const a=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.togglePartnerStatus(a))}),t.j41(33,"mat-icon"),t.EFF(34),t.k0s(),t.j41(35,"span"),t.EFF(36),t.k0s()()()()}if(2&r){const e=o.$implicit,n=t.sdS(5);t.R7$(1),t.Y8G("matMenuTriggerFor",n),t.R7$(10),t.Y8G("disabled",!e.isOnline),t.R7$(15),t.Y8G("disabled",!e.isOnline),t.R7$(6),t.Y8G("ngClass","ACTIVE"===e.status?"danger":"success"),t.R7$(2),t.JRh("ACTIVE"===e.status?"block":"check_circle"),t.R7$(2),t.JRh("ACTIVE"===e.status?"Suspend":"Activate")}}function $r(r,o){1&r&&t.nrm(0,"tr",86)}const Nr=function(r,o){return{"online-row":r,"offline-row":o}};function Lr(r,o){if(1&r&&t.nrm(0,"tr",87),2&r){const e=o.$implicit;t.Y8G("ngClass",t.l_i(1,Nr,e.isOnline,!e.isOnline))}}function Gr(r,o){1&r&&(t.j41(0,"div",88),t.nrm(1,"mat-spinner",89),t.j41(2,"p"),t.EFF(3,"Loading partners..."),t.k0s()())}function Vr(r,o){1&r&&(t.j41(0,"div",90)(1,"mat-icon"),t.EFF(2,"group_off"),t.k0s(),t.j41(3,"h3"),t.EFF(4,"No Partners Found"),t.k0s(),t.j41(5,"p"),t.EFF(6,"No delivery partners match your current filters."),t.k0s()())}const Br=function(){return[10,25,50,100]};let Ur=(()=>{class r{constructor(e,n,i,a){this.partnerService=e,this.assignmentService=n,this.dialog=i,this.snackBar=a,this.destroy$=new L.B,this.displayedColumns=["partnerId","name","phone","vehicle","status","verification","rating","deliveries","online","actions"],this.statusFilter="All Status",this.verificationFilter="All Verification",this.searchTerm="",this.isLoading=!0,this.isProcessing=!1,this.totalPartners=0,this.onlinePartners=0,this.activeAssignments=0,this.dataSource=new u.I6([])}ngOnInit(){this.loadAssignmentData(),this.setupAutoRefresh(),this.setupFilters()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadAssignmentData(){this.isLoading=!0;const e=[{partnerId:"DP001",partnerName:"John Smith",phone:"+91 9876543210",vehicle:"BIKE",status:"ACTIVE",verification:"VERIFIED",rating:4.5,deliveries:156,isOnline:!0,currentOrderId:"ORD-2025-001",lastActiveTime:new Date,earnings:12500},{partnerId:"DP002",partnerName:"Sarah Wilson",phone:"+91 9876543211",vehicle:"SCOOTER",status:"ACTIVE",verification:"VERIFIED",rating:4.8,deliveries:289,isOnline:!0,currentOrderId:"ORD-2025-002",lastActiveTime:new Date,earnings:18750},{partnerId:"DP003",partnerName:"Mike Johnson",phone:"+91 9876543212",vehicle:"CAR",status:"PENDING",verification:"PENDING",rating:0,deliveries:0,isOnline:!1,lastActiveTime:new Date(Date.now()-3e4),earnings:0}];setTimeout(()=>{this.dataSource.data=e,this.totalPartners=e.length,this.onlinePartners=e.filter(n=>n.isOnline).length,this.activeAssignments=e.filter(n=>n.currentOrderId).length,this.isLoading=!1},1e3)}setupAutoRefresh(){(0,G.Y)(3e4).pipe((0,d.Q)(this.destroy$)).subscribe(()=>{this.refreshData()})}setupFilters(){this.dataSource.filterPredicate=(e,n)=>{const i=this.searchTerm.toLowerCase(),a="All Status"===this.statusFilter||e.status===this.statusFilter,s="All Verification"===this.verificationFilter||e.verification===this.verificationFilter,c=!i||e.partnerId.toLowerCase().includes(i)||e.partnerName.toLowerCase().includes(i)||e.phone.includes(i);return a&&s&&c}}onStatusFilterChange(){this.applyFilter()}onVerificationFilterChange(){this.applyFilter()}applyFilter(){this.dataSource.filter=Math.random().toString()}refreshData(){this.loadAssignmentData()}getStatusClass(e){return`status-${e.toLowerCase()}`}getVerificationClass(e){return`verification-${e.toLowerCase()}`}getVehicleIcon(e){switch(e){case"BIKE":return"two_wheeler";case"SCOOTER":return"scooter";case"CAR":return"directions_car";default:return"delivery_dining"}}viewPartnerDetails(e){this.snackBar.open(`Viewing details for ${e.partnerName}`,"Close",{duration:2e3})}assignOrder(e){this.snackBar.open(`Assigning order to ${e.partnerName}`,"Close",{duration:2e3})}callPartner(e){window.open(`tel:${e}`,"_blank")}messagePartner(e){this.snackBar.open(`Opening message for ${e.partnerName}`,"Close",{duration:2e3})}trackPartner(e){this.snackBar.open(`Tracking ${e.partnerName}`,"Close",{duration:2e3})}togglePartnerStatus(e){this.isProcessing=!0,setTimeout(()=>{const n="ACTIVE"===e.status?"SUSPENDED":"ACTIVE";e.status=n,this.snackBar.open(`Partner ${n.toLowerCase()}`,"Close",{duration:2e3}),this.isProcessing=!1},1e3)}exportData(){this.snackBar.open("Exporting assignment data...","Close",{duration:2e3})}static{this.\u0275fac=function(n){return new(n||r)(t.rXU(Y.WS),t.rXU(z),t.rXU(O.bZ),t.rXU(x.UG))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-order-assignments"]],viewQuery:function(n,i){if(1&n&&(t.GBs(K.iy,5),t.GBs(R.B4,5)),2&n){let a;t.mGM(a=t.lsd())&&(i.paginator=a.first),t.mGM(a=t.lsd())&&(i.sort=a.first)}},decls:157,vars:17,consts:[[1,"order-assignments-container"],[1,"page-header"],[1,"header-left"],[1,"breadcrumb"],[1,"header-right"],[1,"search-container"],["appearance","outline",1,"search-field"],["matInput","","placeholder","Search...",3,"ngModel","ngModelChange","keyup"],["matPrefix",""],[1,"notifications"],["mat-icon-button","",1,"notification-btn"],[1,"notification-badge"],[1,"user-menu"],["mat-icon-button",""],[1,"user-avatar"],[1,"stats-row"],[1,"stat-item"],[1,"stat-content"],[1,"stat-number"],[1,"stat-label"],[1,"stat-item","online"],[1,"stat-item","active"],[1,"alert-banner"],[1,"alert-icon"],[1,"alert-text"],[1,"alert-count"],[1,"filters-container"],[1,"filter-group"],["appearance","outline",1,"filter-field"],[1,"filter-label"],["appearance","outline",1,"filter-select"],[3,"ngModel","ngModelChange","selectionChange"],["value","All Status"],["value","ACTIVE"],["value","PENDING"],["value","SUSPENDED"],["value","BLOCKED"],["value","All Verification"],["value","VERIFIED"],["value","REJECTED"],[1,"filter-actions"],["mat-raised-button","","color","primary",3,"disabled","click"],["mat-stroked-button","",3,"click"],[1,"table-container"],["mat-table","","matSort","",1,"partners-table",3,"dataSource"],["matColumnDef","partnerId"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","phone"],["matColumnDef","vehicle"],["matColumnDef","status"],["matColumnDef","verification"],["matColumnDef","rating"],["matColumnDef","deliveries"],["matColumnDef","online"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"ngClass",4,"matRowDef","matRowDefColumns"],["class","loading-container",4,"ngIf"],["class","empty-state",4,"ngIf"],["showFirstLastButtons","",1,"table-paginator",3,"pageSizeOptions","pageSize"],[1,"table-info"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"partner-id"],[1,"name-cell"],[1,"user-icon"],[1,"partner-name"],[1,"phone-link",3,"href"],[1,"vehicle-cell"],[1,"vehicle-icon"],[1,"status-badge",3,"ngClass"],[1,"verification-cell"],[3,"ngClass"],[1,"rating-cell"],[1,"star-icon"],[1,"deliveries-count"],["mat-header-cell",""],[1,"online-status",3,"ngClass"],["mat-icon-button","",1,"actions-btn",3,"matMenuTriggerFor"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"disabled","click"],["mat-menu-item","",3,"ngClass","click"],["mat-header-row",""],["mat-row","",3,"ngClass"],[1,"loading-container"],["diameter","40"],[1,"empty-state"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),t.EFF(4,"Order Assignments"),t.k0s(),t.j41(5,"div",3)(6,"span"),t.EFF(7,"Home"),t.k0s(),t.j41(8,"mat-icon"),t.EFF(9,"chevron_right"),t.k0s(),t.j41(10,"span"),t.EFF(11,"Delivery"),t.k0s(),t.j41(12,"mat-icon"),t.EFF(13,"chevron_right"),t.k0s(),t.j41(14,"span"),t.EFF(15,"Admin"),t.k0s(),t.j41(16,"mat-icon"),t.EFF(17,"chevron_right"),t.k0s(),t.j41(18,"span"),t.EFF(19,"Assignments"),t.k0s()()(),t.j41(20,"div",4)(21,"div",5)(22,"mat-form-field",6)(23,"mat-label"),t.EFF(24,"Search shops, products, orders"),t.k0s(),t.j41(25,"input",7),t.bIt("ngModelChange",function(s){return i.searchTerm=s})("keyup",function(){return i.applyFilter()}),t.k0s(),t.j41(26,"mat-icon",8),t.EFF(27,"search"),t.k0s()()(),t.j41(28,"div",9)(29,"button",10)(30,"mat-icon"),t.EFF(31,"notifications"),t.k0s(),t.j41(32,"span",11),t.EFF(33,"3"),t.k0s()()(),t.j41(34,"div",12)(35,"button",13)(36,"mat-icon"),t.EFF(37,"settings"),t.k0s()(),t.j41(38,"div",14),t.EFF(39,"TH"),t.k0s()()()(),t.j41(40,"div",15)(41,"div",16)(42,"mat-icon"),t.EFF(43,"group"),t.k0s(),t.j41(44,"div",17)(45,"span",18),t.EFF(46),t.k0s(),t.j41(47,"span",19),t.EFF(48,"Total Partners"),t.k0s()()(),t.j41(49,"div",20)(50,"mat-icon"),t.EFF(51,"wifi"),t.k0s(),t.j41(52,"div",17)(53,"span",18),t.EFF(54),t.k0s(),t.j41(55,"span",19),t.EFF(56,"Online Now"),t.k0s()()(),t.j41(57,"div",21)(58,"mat-icon"),t.EFF(59,"local_shipping"),t.k0s(),t.j41(60,"div",17)(61,"span",18),t.EFF(62),t.k0s(),t.j41(63,"span",19),t.EFF(64,"Active Assignments"),t.k0s()()()(),t.j41(65,"div",22)(66,"mat-icon",23),t.EFF(67,"warning"),t.k0s(),t.j41(68,"span",24),t.EFF(69,"Order Issues"),t.k0s(),t.j41(70,"span",25),t.EFF(71,"3"),t.k0s()(),t.j41(72,"div",26)(73,"div",27)(74,"mat-form-field",28)(75,"mat-label"),t.EFF(76,"Search Partners"),t.k0s(),t.j41(77,"input",7),t.bIt("ngModelChange",function(s){return i.searchTerm=s})("keyup",function(){return i.applyFilter()}),t.k0s(),t.j41(78,"mat-icon",8),t.EFF(79,"search"),t.k0s()()(),t.j41(80,"div",27)(81,"span",29),t.EFF(82,"Status Filter"),t.k0s(),t.j41(83,"mat-form-field",30)(84,"mat-select",31),t.bIt("ngModelChange",function(s){return i.statusFilter=s})("selectionChange",function(){return i.onStatusFilterChange()}),t.j41(85,"mat-option",32),t.EFF(86,"All Status"),t.k0s(),t.j41(87,"mat-option",33),t.EFF(88,"Active"),t.k0s(),t.j41(89,"mat-option",34),t.EFF(90,"Pending"),t.k0s(),t.j41(91,"mat-option",35),t.EFF(92,"Suspended"),t.k0s(),t.j41(93,"mat-option",36),t.EFF(94,"Blocked"),t.k0s()()()(),t.j41(95,"div",27)(96,"span",29),t.EFF(97,"Verification Filter"),t.k0s(),t.j41(98,"mat-form-field",30)(99,"mat-select",31),t.bIt("ngModelChange",function(s){return i.verificationFilter=s})("selectionChange",function(){return i.onVerificationFilterChange()}),t.j41(100,"mat-option",37),t.EFF(101,"All Verification"),t.k0s(),t.j41(102,"mat-option",38),t.EFF(103,"Verified"),t.k0s(),t.j41(104,"mat-option",34),t.EFF(105,"Pending"),t.k0s(),t.j41(106,"mat-option",39),t.EFF(107,"Rejected"),t.k0s()()()(),t.j41(108,"div",40)(109,"button",41),t.bIt("click",function(){return i.refreshData()}),t.j41(110,"mat-icon"),t.EFF(111,"refresh"),t.k0s(),t.EFF(112," Refresh "),t.k0s(),t.j41(113,"button",42),t.bIt("click",function(){return i.exportData()}),t.j41(114,"mat-icon"),t.EFF(115,"download"),t.k0s(),t.EFF(116," Export "),t.k0s()()(),t.j41(117,"div",43)(118,"table",44),t.qex(119,45),t.DNE(120,fr,2,0,"th",46),t.DNE(121,Cr,3,1,"td",47),t.bVm(),t.qex(122,48),t.DNE(123,Pr,2,0,"th",46),t.DNE(124,vr,6,1,"td",47),t.bVm(),t.qex(125,49),t.DNE(126,Or,2,0,"th",46),t.DNE(127,Mr,3,2,"td",47),t.bVm(),t.qex(128,50),t.DNE(129,br,2,0,"th",46),t.DNE(130,kr,6,2,"td",47),t.bVm(),t.qex(131,51),t.DNE(132,Fr,2,0,"th",46),t.DNE(133,yr,3,2,"td",47),t.bVm(),t.qex(134,52),t.DNE(135,xr,2,0,"th",46),t.DNE(136,Er,6,3,"td",47),t.bVm(),t.qex(137,53),t.DNE(138,Dr,2,0,"th",46),t.DNE(139,wr,7,4,"td",47),t.bVm(),t.qex(140,54),t.DNE(141,Ir,2,0,"th",46),t.DNE(142,jr,3,1,"td",47),t.bVm(),t.qex(143,55),t.DNE(144,Sr,2,0,"th",56),t.DNE(145,Tr,3,2,"td",47),t.bVm(),t.qex(146,57),t.DNE(147,Rr,2,0,"th",56),t.DNE(148,Ar,37,6,"td",47),t.bVm(),t.DNE(149,$r,1,0,"tr",58),t.DNE(150,Lr,1,4,"tr",59),t.k0s(),t.DNE(151,Gr,4,0,"div",60),t.DNE(152,Vr,7,0,"div",61),t.k0s(),t.nrm(153,"mat-paginator",62),t.j41(154,"div",63)(155,"span"),t.EFF(156),t.k0s()()()),2&n&&(t.R7$(25),t.Y8G("ngModel",i.searchTerm),t.R7$(21),t.JRh(i.totalPartners),t.R7$(8),t.JRh(i.onlinePartners),t.R7$(8),t.JRh(i.activeAssignments),t.R7$(15),t.Y8G("ngModel",i.searchTerm),t.R7$(7),t.Y8G("ngModel",i.statusFilter),t.R7$(15),t.Y8G("ngModel",i.verificationFilter),t.R7$(10),t.Y8G("disabled",i.isLoading),t.R7$(9),t.Y8G("dataSource",i.dataSource),t.R7$(31),t.Y8G("matHeaderRowDef",i.displayedColumns),t.R7$(1),t.Y8G("matRowDefColumns",i.displayedColumns),t.R7$(1),t.Y8G("ngIf",i.isLoading),t.R7$(1),t.Y8G("ngIf",!i.isLoading&&0===i.dataSource.data.length),t.R7$(1),t.Y8G("pageSizeOptions",t.lJ4(16,Br))("pageSize",10),t.R7$(3),t.JRh("0 of 0"))},dependencies:[h.YU,h.bT,g.me,g.BC,g.vS,v.$z,v.iY,M.rl,M.nJ,M.JW,T.fg,B.VO,J.wT,u.Zl,u.tL,u.ji,u.cC,u.YV,u.iL,u.KS,u.$R,u.YZ,u.NB,K.iy,R.B4,R.aE,k.An,w.LG,I.kk,I.fb,I.Cp,nt.q,h.QX],styles:[".order-assignments-container[_ngcontent-%COMP%]{padding:0;background:#f8fafc;min-height:100vh}.order-assignments-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;padding:20px 24px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 2px 8px #0000001a}.order-assignments-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 8px;font-size:28px;font-weight:600}.order-assignments-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .breadcrumb[_ngcontent-%COMP%]{display:flex;align-items:center;opacity:.9;font-size:14px}.order-assignments-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .breadcrumb[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;margin:0 8px}.order-assignments-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.order-assignments-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]{width:350px}.order-assignments-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]     .mat-mdc-form-field-subscript-wrapper{display:none}.order-assignments-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]     .mdc-outlined-text-field{background:rgba(255,255,255,.1);border-radius:8px}.order-assignments-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]     .mat-mdc-form-field-outline{color:#ffffff4d}.order-assignments-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]     .mat-mdc-form-field-label{color:#fffc}.order-assignments-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]     input{color:#fff}.order-assignments-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .notifications[_ngcontent-%COMP%]{position:relative}.order-assignments-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .notifications[_ngcontent-%COMP%]   .notification-btn[_ngcontent-%COMP%]{position:relative;color:#fff}.order-assignments-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .notifications[_ngcontent-%COMP%]   .notification-btn[_ngcontent-%COMP%]   .notification-badge[_ngcontent-%COMP%]{position:absolute;top:-2px;right:-2px;background:#ff4757;color:#fff;border-radius:50%;width:18px;height:18px;font-size:10px;display:flex;align-items:center;justify-content:center;font-weight:600}.order-assignments-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.order-assignments-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#fff}.order-assignments-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .user-avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:rgba(255,255,255,.2);display:flex;align-items:center;justify-content:center;font-weight:600;font-size:14px;color:#fff}.order-assignments-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]{display:flex;gap:16px;padding:24px}.order-assignments-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{background:white;border-radius:12px;padding:20px;display:flex;align-items:center;gap:16px;box-shadow:0 1px 3px #0000001a;min-width:200px}.order-assignments-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:48px;height:48px;font-size:24px;background:#f1f5f9;border-radius:12px;display:flex;align-items:center;justify-content:center;color:#64748b}.order-assignments-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-content[_ngcontent-%COMP%]   .stat-number[_ngcontent-%COMP%]{display:block;font-size:24px;font-weight:700;color:#1e293b;line-height:1.2}.order-assignments-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-content[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:14px;color:#64748b;font-weight:500}.order-assignments-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-item.online[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{background:#dcfce7;color:#16a34a}.order-assignments-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-item.active[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{background:#dbeafe;color:#2563eb}.order-assignments-container[_ngcontent-%COMP%]   .alert-banner[_ngcontent-%COMP%]{margin:0 24px 24px;background:#fef3c7;border:1px solid #f59e0b;border-radius:8px;padding:12px 16px;display:flex;align-items:center;gap:12px}.order-assignments-container[_ngcontent-%COMP%]   .alert-banner[_ngcontent-%COMP%]   .alert-icon[_ngcontent-%COMP%]{color:#d97706}.order-assignments-container[_ngcontent-%COMP%]   .alert-banner[_ngcontent-%COMP%]   .alert-text[_ngcontent-%COMP%]{font-weight:500;color:#92400e}.order-assignments-container[_ngcontent-%COMP%]   .alert-banner[_ngcontent-%COMP%]   .alert-count[_ngcontent-%COMP%]{background:#dc2626;color:#fff;border-radius:12px;padding:4px 8px;font-size:12px;font-weight:600;min-width:20px;text-align:center}.order-assignments-container[_ngcontent-%COMP%]   .filters-container[_ngcontent-%COMP%]{background:white;margin:0 24px 24px;padding:20px;border-radius:12px;box-shadow:0 1px 3px #0000001a;display:flex;align-items:center;gap:20px;flex-wrap:wrap}.order-assignments-container[_ngcontent-%COMP%]   .filters-container[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.order-assignments-container[_ngcontent-%COMP%]   .filters-container[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-label[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#374151}.order-assignments-container[_ngcontent-%COMP%]   .filters-container[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-field[_ngcontent-%COMP%], .order-assignments-container[_ngcontent-%COMP%]   .filters-container[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-select[_ngcontent-%COMP%]{min-width:200px}.order-assignments-container[_ngcontent-%COMP%]   .filters-container[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-field[_ngcontent-%COMP%]     .mat-mdc-form-field-subscript-wrapper, .order-assignments-container[_ngcontent-%COMP%]   .filters-container[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   .filter-select[_ngcontent-%COMP%]     .mat-mdc-form-field-subscript-wrapper{display:none}.order-assignments-container[_ngcontent-%COMP%]   .filters-container[_ngcontent-%COMP%]   .filter-actions[_ngcontent-%COMP%]{margin-left:auto;display:flex;gap:12px}.order-assignments-container[_ngcontent-%COMP%]   .filters-container[_ngcontent-%COMP%]   .filter-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:8px;font-weight:500}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{background:white;margin:0 24px;border-radius:12px;box-shadow:0 1px 3px #0000001a;overflow:hidden}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]{width:100%}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f8fafc;font-weight:600;color:#374151;border-bottom:1px solid #e5e7eb;padding:16px}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:16px;border-bottom:1px solid #f3f4f6}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .partner-id[_ngcontent-%COMP%]{font-family:Monaco,Menlo,monospace;font-weight:600;color:#6366f1;background:#eef2ff;padding:4px 8px;border-radius:6px;font-size:12px}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .name-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .name-cell[_ngcontent-%COMP%]   .user-icon[_ngcontent-%COMP%]{color:#6b7280}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .name-cell[_ngcontent-%COMP%]   .partner-name[_ngcontent-%COMP%]{font-weight:500;color:#111827}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .phone-link[_ngcontent-%COMP%]{color:#2563eb;text-decoration:none;font-weight:500}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .phone-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .vehicle-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .vehicle-cell[_ngcontent-%COMP%]   .vehicle-icon[_ngcontent-%COMP%]{color:#6b7280}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:16px;font-size:12px;font-weight:600;text-transform:uppercase}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .status-badge.status-active[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .status-badge.status-pending[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .status-badge.status-suspended[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .status-badge.status-blocked[_ngcontent-%COMP%]{background:#f3f4f6;color:#374151}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .verification-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .verification-cell[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .verification-cell[_ngcontent-%COMP%]   mat-icon.verification-verified[_ngcontent-%COMP%]{color:#059669}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .verification-cell[_ngcontent-%COMP%]   mat-icon.verification-pending[_ngcontent-%COMP%]{color:#d97706}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .verification-cell[_ngcontent-%COMP%]   mat-icon.verification-rejected[_ngcontent-%COMP%]{color:#dc2626}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .rating-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .rating-cell[_ngcontent-%COMP%]   .star-icon[_ngcontent-%COMP%]{color:#fbbf24;font-size:16px}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .deliveries-count[_ngcontent-%COMP%]{font-weight:600;color:#374151}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .online-status.online[_ngcontent-%COMP%]{color:#059669}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .online-status.offline[_ngcontent-%COMP%], .order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .actions-btn[_ngcontent-%COMP%]{color:#6b7280}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   .actions-btn[_ngcontent-%COMP%]:hover{color:#374151}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   tr.online-row[_ngcontent-%COMP%]:hover{background:#f0fdf4}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   tr.offline-row[_ngcontent-%COMP%]{opacity:.7}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .partners-table[_ngcontent-%COMP%]   tr.offline-row[_ngcontent-%COMP%]:hover{background:#f9fafb}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin-bottom:16px}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6b7280;margin:0}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;color:#d1d5db;margin-bottom:16px}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#374151;margin:0 0 8px}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6b7280;margin:0}.order-assignments-container[_ngcontent-%COMP%]   .table-paginator[_ngcontent-%COMP%]{background:white;margin:0 24px;border-radius:0 0 12px 12px}.order-assignments-container[_ngcontent-%COMP%]   .table-info[_ngcontent-%COMP%]{text-align:center;padding:16px;color:#6b7280;font-size:14px}  .mat-mdc-menu-panel .mat-mdc-menu-item.danger{color:#dc2626}  .mat-mdc-menu-panel .mat-mdc-menu-item.danger mat-icon{color:#dc2626}  .mat-mdc-menu-panel .mat-mdc-menu-item.success{color:#059669}  .mat-mdc-menu-panel .mat-mdc-menu-item.success mat-icon{color:#059669}@media (max-width: 768px){.order-assignments-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]{flex-direction:column;gap:16px;text-align:center}.order-assignments-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .search-container[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]{width:250px}.order-assignments-container[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]{flex-direction:column}.order-assignments-container[_ngcontent-%COMP%]   .filters-container[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.order-assignments-container[_ngcontent-%COMP%]   .filters-container[_ngcontent-%COMP%]   .filter-actions[_ngcontent-%COMP%]{margin-left:0;margin-top:16px}.order-assignments-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{overflow-x:auto}}"]})}}return r})();function Yr(r,o){if(1&r&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&r){const e=t.XpG();t.R7$(1),t.SpI(" Partner ",e.getPaymentDirection()," partner ")}}function zr(r,o){if(1&r&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&r){const e=t.XpG();t.R7$(1),t.SpI(" You will pay ",e.getPaymentDirection()," partner ")}}let Xr=(()=>{class r{constructor(e,n){this.dialogRef=e,this.data=n,this.paymentMethod="CASH",this.notes=""}onCancel(){this.dialogRef.close()}onConfirm(){this.dialogRef.close({paymentMethod:this.paymentMethod,notes:this.notes})}formatCurrency(e){return`\u20b9${Math.abs(e).toFixed(2)}`}getPaymentDirection(){return this.data.netAmount>0?"received from":"paid to"}static{this.\u0275fac=function(n){return new(n||r)(t.rXU(O.CP),t.rXU(O.Vh))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-payment-confirm-dialog"]],standalone:!0,features:[t.aNF],decls:61,vars:13,consts:[["mat-dialog-title",""],[1,"payment-summary"],[1,"partner-info"],[1,"amount-breakdown"],[1,"breakdown-row"],[1,"amount-collected"],[1,"amount-commission"],[1,"breakdown-divider"],[1,"breakdown-row","total-row"],[1,"payment-direction"],[4,"ngIf"],["appearance","outline",1,"full-width"],[3,"ngModel","ngModelChange"],["value","CASH"],["value","BANK_TRANSFER"],["value","UPI"],["value","CHEQUE"],["matInput","","placeholder","Add any notes about this payment...","rows","3",3,"ngModel","ngModelChange"],[1,"warning-box"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click"]],template:function(n,i){1&n&&(t.j41(0,"h2",0)(1,"mat-icon"),t.EFF(2,"payment"),t.k0s(),t.EFF(3," Confirm Payment Settlement\n"),t.k0s(),t.j41(4,"mat-dialog-content")(5,"div",1)(6,"div",2)(7,"h3"),t.EFF(8),t.k0s(),t.j41(9,"p"),t.EFF(10),t.k0s()(),t.j41(11,"div",3)(12,"div",4)(13,"span"),t.EFF(14,"Cash Collected (COD):"),t.k0s(),t.j41(15,"strong",5),t.EFF(16),t.k0s()(),t.j41(17,"div",4)(18,"span"),t.EFF(19,"Commission Owed:"),t.k0s(),t.j41(20,"strong",6),t.EFF(21),t.k0s()(),t.nrm(22,"div",7),t.j41(23,"div",8)(24,"span"),t.EFF(25,"Net Amount:"),t.k0s(),t.j41(26,"strong"),t.EFF(27),t.k0s()(),t.j41(28,"div",9)(29,"mat-icon"),t.EFF(30),t.k0s(),t.DNE(31,Yr,2,1,"span",10),t.DNE(32,zr,2,1,"span",10),t.k0s()(),t.j41(33,"mat-form-field",11)(34,"mat-label"),t.EFF(35,"Payment Method"),t.k0s(),t.j41(36,"mat-select",12),t.bIt("ngModelChange",function(s){return i.paymentMethod=s}),t.j41(37,"mat-option",13),t.EFF(38,"Cash"),t.k0s(),t.j41(39,"mat-option",14),t.EFF(40,"Bank Transfer"),t.k0s(),t.j41(41,"mat-option",15),t.EFF(42,"UPI"),t.k0s(),t.j41(43,"mat-option",16),t.EFF(44,"Cheque"),t.k0s()()(),t.j41(45,"mat-form-field",11)(46,"mat-label"),t.EFF(47,"Notes (Optional)"),t.k0s(),t.j41(48,"textarea",17),t.bIt("ngModelChange",function(s){return i.notes=s}),t.k0s()(),t.j41(49,"div",18)(50,"mat-icon"),t.EFF(51,"info"),t.k0s(),t.j41(52,"p"),t.EFF(53),t.k0s()()()(),t.j41(54,"mat-dialog-actions",19)(55,"button",20),t.bIt("click",function(){return i.onCancel()}),t.EFF(56,"Cancel"),t.k0s(),t.j41(57,"button",21),t.bIt("click",function(){return i.onConfirm()}),t.j41(58,"mat-icon"),t.EFF(59,"check_circle"),t.k0s(),t.EFF(60," Confirm Payment "),t.k0s()()),2&n&&(t.R7$(8),t.JRh(i.data.partnerName),t.R7$(2),t.JRh(i.data.partnerPhone),t.R7$(6),t.JRh(i.formatCurrency(i.data.cashCollected)),t.R7$(5),t.SpI("-",i.formatCurrency(i.data.commissionEarned),""),t.R7$(5),t.HbH(i.data.netAmount>0?"amount-positive":"amount-negative"),t.R7$(1),t.SpI(" ",i.formatCurrency(i.data.netAmount)," "),t.R7$(3),t.JRh(i.data.netAmount>0?"arrow_downward":"arrow_upward"),t.R7$(1),t.Y8G("ngIf",i.data.netAmount>0),t.R7$(1),t.Y8G("ngIf",i.data.netAmount<0),t.R7$(4),t.Y8G("ngModel",i.paymentMethod),t.R7$(12),t.Y8G("ngModel",i.notes),t.R7$(5),t.SpI("This action will mark the payment as settled. Make sure you have ",i.data.netAmount>0?"received":"paid"," the amount offline before confirming."))},dependencies:[h.MD,h.bT,O.hM,O.BI,O.Yi,O.E7,v.Hl,v.$z,M.RG,M.rl,M.nJ,T.fS,T.fg,B.Ve,B.VO,J.wT,k.m_,k.An,g.YN,g.me,g.BC,g.vS],styles:["h2[mat-dialog-title][_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin:0;padding:20px 24px;background-color:#f5f5f5;border-bottom:1px solid #e0e0e0}h2[mat-dialog-title][_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#1976d2}mat-dialog-content[_ngcontent-%COMP%]{padding:24px}.payment-summary[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]{margin-bottom:24px;padding-bottom:16px;border-bottom:2px solid #e0e0e0}.payment-summary[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:20px;font-weight:600;color:#333}.payment-summary[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666;font-size:14px}.payment-summary[_ngcontent-%COMP%]   .amount-breakdown[_ngcontent-%COMP%]{background-color:#f9f9f9;padding:20px;border-radius:8px;margin-bottom:24px}.payment-summary[_ngcontent-%COMP%]   .amount-breakdown[_ngcontent-%COMP%]   .breakdown-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;font-size:14px}.payment-summary[_ngcontent-%COMP%]   .amount-breakdown[_ngcontent-%COMP%]   .breakdown-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#666}.payment-summary[_ngcontent-%COMP%]   .amount-breakdown[_ngcontent-%COMP%]   .breakdown-row[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:16px;font-weight:600}.payment-summary[_ngcontent-%COMP%]   .amount-breakdown[_ngcontent-%COMP%]   .breakdown-row[_ngcontent-%COMP%]   strong.amount-collected[_ngcontent-%COMP%]{color:#2e7d32}.payment-summary[_ngcontent-%COMP%]   .amount-breakdown[_ngcontent-%COMP%]   .breakdown-row[_ngcontent-%COMP%]   strong.amount-commission[_ngcontent-%COMP%]{color:#f57c00}.payment-summary[_ngcontent-%COMP%]   .amount-breakdown[_ngcontent-%COMP%]   .breakdown-row[_ngcontent-%COMP%]   strong.amount-positive[_ngcontent-%COMP%]{color:#2e7d32}.payment-summary[_ngcontent-%COMP%]   .amount-breakdown[_ngcontent-%COMP%]   .breakdown-row[_ngcontent-%COMP%]   strong.amount-negative[_ngcontent-%COMP%]{color:#d32f2f}.payment-summary[_ngcontent-%COMP%]   .amount-breakdown[_ngcontent-%COMP%]   .breakdown-row.total-row[_ngcontent-%COMP%]{margin-top:16px;padding-top:16px;border-top:2px solid #e0e0e0;font-size:16px}.payment-summary[_ngcontent-%COMP%]   .amount-breakdown[_ngcontent-%COMP%]   .breakdown-row.total-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600;color:#333}.payment-summary[_ngcontent-%COMP%]   .amount-breakdown[_ngcontent-%COMP%]   .breakdown-row.total-row[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:24px}.payment-summary[_ngcontent-%COMP%]   .amount-breakdown[_ngcontent-%COMP%]   .breakdown-divider[_ngcontent-%COMP%]{height:1px;background-color:#e0e0e0;margin:16px 0}.payment-summary[_ngcontent-%COMP%]   .amount-breakdown[_ngcontent-%COMP%]   .payment-direction[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-top:12px;padding:12px;background-color:#e3f2fd;border-radius:6px;color:#1976d2;font-size:14px;font-weight:500}.payment-summary[_ngcontent-%COMP%]   .amount-breakdown[_ngcontent-%COMP%]   .payment-direction[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.payment-summary[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.payment-summary[_ngcontent-%COMP%]   .warning-box[_ngcontent-%COMP%]{display:flex;gap:12px;padding:16px;background-color:#fff3e0;border-left:4px solid #f57c00;border-radius:4px;margin-top:16px}.payment-summary[_ngcontent-%COMP%]   .warning-box[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#f57c00;font-size:24px;width:24px;height:24px;flex-shrink:0}.payment-summary[_ngcontent-%COMP%]   .warning-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#333;font-size:13px;line-height:1.5}mat-dialog-actions[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid #e0e0e0;background-color:#f5f5f5}mat-dialog-actions[_ngcontent-%COMP%]   button[mat-raised-button][_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px;font-size:18px;width:18px;height:18px}"]})}}return r})();function Jr(r,o){1&r&&(t.j41(0,"div",14),t.nrm(1,"mat-spinner"),t.k0s())}function Kr(r,o){1&r&&(t.j41(0,"div",15)(1,"p"),t.EFF(2,"\u2713 All payments settled"),t.k0s()())}function Wr(r,o){if(1&r){const e=t.RV6();t.j41(0,"div",18),t.bIt("click",function(){const a=t.eBV(e).$implicit,s=t.XpG(2);return t.Njj(s.viewDetails(a))}),t.j41(1,"div",19)(2,"div",20)(3,"div",21),t.EFF(4),t.k0s(),t.j41(5,"div",22),t.EFF(6),t.k0s()(),t.j41(7,"div",23)(8,"span",24),t.EFF(9),t.k0s()()(),t.j41(10,"div",25)(11,"div",26)(12,"span",27),t.EFF(13,"Cash Collected (COD only):"),t.k0s(),t.j41(14,"span",28),t.EFF(15),t.k0s()(),t.j41(16,"div",26)(17,"span",27),t.EFF(18,"Commission Earned (All):"),t.k0s(),t.j41(19,"span",29),t.EFF(20),t.k0s()(),t.j41(21,"div",30)(22,"span",27),t.EFF(23),t.k0s(),t.j41(24,"span"),t.EFF(25),t.k0s()()(),t.j41(26,"div",31)(27,"button",32),t.bIt("click",function(i){const s=t.eBV(e).$implicit;return t.XpG(2).markAsPaid(s),t.Njj(i.stopPropagation())}),t.EFF(28," \u{1f4b3} Settle Payment "),t.k0s()()()}if(2&r){const e=o.$implicit,n=t.XpG(2);t.R7$(4),t.JRh(e.partnerName),t.R7$(2),t.SpI("\u{1f4f1} ",e.partnerPhone,""),t.R7$(3),t.SpI("",e.totalOrders," orders"),t.R7$(6),t.JRh(n.formatCurrency(e.cashCollected)),t.R7$(5),t.JRh(n.formatCurrency(e.commissionEarned)),t.R7$(3),t.JRh(e.netAmount>=0?"To Deposit to Office:":"Office Owes Partner:"),t.R7$(1),t.HbH(e.netAmount>=0?"value positive":"value negative"),t.R7$(1),t.SpI(" ",n.formatCurrency(n.Math.abs(e.netAmount))," ")}}function qr(r,o){if(1&r&&(t.j41(0,"div",16),t.DNE(1,Wr,29,9,"div",17),t.k0s()),2&r){const e=t.XpG();t.R7$(1),t.Y8G("ngForOf",e.payments)}}const Qr=[{path:"dashboard",component:Gt,canActivate:[S.q],title:"Delivery Dashboard"},{path:"partner/register",component:ve,title:"Delivery Partner Registration"},{path:"partner/dashboard",component:me,canActivate:[S.q,N.K],data:{expectedRoles:["SUPER_ADMIN","DELIVERY_PARTNER"],title:"Delivery Partner Dashboard"}},{path:"partner/orders",component:ir,canActivate:[S.q,N.K],data:{expectedRoles:["SUPER_ADMIN","DELIVERY_PARTNER"],title:"My Orders"}},{path:"admin/partners",component:on,canActivate:[S.q,N.K],data:{expectedRoles:["SUPER_ADMIN","ADMIN","MANAGER"],title:"Manage Partners"}},{path:"tracking/:assignmentId",component:On,title:"Order Tracking"},{path:"analytics",component:or,canActivate:[S.q,N.K],data:{expectedRoles:["SUPER_ADMIN","ADMIN","MANAGER"],title:"Delivery Analytics"}},{path:"documents/view/:id/:name",component:_r,canActivate:[S.q],title:"View Documents"},{path:"admin/assignments",component:Ur,canActivate:[S.q,N.K],data:{expectedRoles:["SUPER_ADMIN","ADMIN","MANAGER"],title:"Order Assignments"}},{path:"admin/tracking",component:An,canActivate:[S.q,N.K],data:{expectedRoles:["SUPER_ADMIN","ADMIN","MANAGER"],title:"Live Tracking Dashboard"}},{path:"partner-payments",component:(()=>{class r{constructor(e,n,i){this.http=e,this.dialog=n,this.snackBar=i,this.Math=Math,this.displayedColumns=["partnerName","totalOrders","cashCollected","commissionEarned","netAmount","actions"],this.payments=[],this.loading=!1,this.totalPartners=0}ngOnInit(){this.loadPayments()}loadPayments(){this.loading=!0,this.http.get(`${j.c.apiUrl}/admin/delivery-partners/payments`).subscribe({next:e=>{e.success&&(this.payments=e.payments,this.totalPartners=e.totalPartners),this.loading=!1},error:e=>{console.error("Error loading payments:",e),this.snackBar.open("Error loading payments","Close",{duration:3e3}),this.loading=!1}})}markAsPaid(e){this.dialog.open(Xr,{width:"500px",data:e}).afterClosed().subscribe(i=>{i&&this.processPayment(e,i)})}processPayment(e,n){this.loading=!0,this.http.post(`${j.c.apiUrl}/admin/delivery-partners/${e.partnerId}/mark-paid`,{amount:e.netAmount,paymentMethod:n.paymentMethod,notes:n.notes}).subscribe({next:a=>{a.success&&(this.snackBar.open("Payment marked as paid successfully!","Close",{duration:3e3,panelClass:["success-snackbar"]}),this.loadPayments()),this.loading=!1},error:a=>{console.error("Error marking payment:",a),this.snackBar.open("Error processing payment","Close",{duration:3e3}),this.loading=!1}})}formatCurrency(e){return`\u20b9${e.toFixed(2)}`}getAmountClass(e){return e>0?"amount-positive":"amount-negative"}getAmountTooltip(e){return e>0?"Partner owes you this amount":e<0?"You owe partner this amount":"No pending amount"}getTotalCash(){return this.payments.reduce((e,n)=>e+n.cashCollected,0)}getTotalCommission(){return this.payments.reduce((e,n)=>e+n.commissionEarned,0)}viewDetails(e){console.log("View details for:",e.partnerName)}static{this.\u0275fac=function(n){return new(n||r)(t.rXU(P.Qq),t.rXU(O.bZ),t.rXU(x.UG))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-partner-payments"]],standalone:!0,features:[t.aNF],decls:40,vars:7,consts:[[1,"payment-dashboard"],[1,"summary-section"],[1,"summary-card"],[1,"card-icon","partners"],[1,"card-content"],[1,"card-label"],[1,"card-value"],[1,"card-icon","pending"],[1,"card-icon","cash"],[1,"card-icon","commission"],[1,"partners-section"],["class","loading",4,"ngIf"],["class","no-data",4,"ngIf"],["class","partner-list",4,"ngIf"],[1,"loading"],[1,"no-data"],[1,"partner-list"],["class","partner-card",3,"click",4,"ngFor","ngForOf"],[1,"partner-card",3,"click"],[1,"partner-header"],[1,"partner-info"],[1,"partner-name"],[1,"partner-contact"],[1,"partner-orders"],[1,"orders-badge"],[1,"partner-amounts"],[1,"amount-item"],[1,"label"],[1,"value"],[1,"value","commission"],[1,"amount-item","total"],[1,"partner-actions"],["mat-raised-button","","color","primary",3,"click"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t.EFF(4,"\u{1f465}"),t.k0s(),t.j41(5,"div",4)(6,"div",5),t.EFF(7,"Total Partners"),t.k0s(),t.j41(8,"div",6),t.EFF(9),t.k0s()()(),t.j41(10,"div",2)(11,"div",7),t.EFF(12,"\u23f3"),t.k0s(),t.j41(13,"div",4)(14,"div",5),t.EFF(15,"Pending Payments"),t.k0s(),t.j41(16,"div",6),t.EFF(17),t.k0s()()(),t.j41(18,"div",2)(19,"div",8),t.EFF(20,"\u{1f4b5}"),t.k0s(),t.j41(21,"div",4)(22,"div",5),t.EFF(23,"Cash with Partners (COD)"),t.k0s(),t.j41(24,"div",6),t.EFF(25),t.k0s()()(),t.j41(26,"div",2)(27,"div",9),t.EFF(28,"\u{1f4b0}"),t.k0s(),t.j41(29,"div",4)(30,"div",5),t.EFF(31,"Total Commission (All Orders)"),t.k0s(),t.j41(32,"div",6),t.EFF(33),t.k0s()()()(),t.j41(34,"div",10)(35,"h2"),t.EFF(36,"Delivery Partner Payments"),t.k0s(),t.DNE(37,Jr,2,0,"div",11),t.DNE(38,Kr,3,0,"div",12),t.DNE(39,qr,2,1,"div",13),t.k0s()()),2&n&&(t.R7$(9),t.JRh(i.totalPartners),t.R7$(8),t.JRh(i.payments.length),t.R7$(8),t.JRh(i.formatCurrency(i.getTotalCash())),t.R7$(8),t.JRh(i.formatCurrency(i.getTotalCommission())),t.R7$(4),t.Y8G("ngIf",i.loading),t.R7$(1),t.Y8G("ngIf",!i.loading&&0===i.payments.length),t.R7$(1),t.Y8G("ngIf",!i.loading&&i.payments.length>0))},dependencies:[h.MD,h.Sq,h.bT,u.tP,v.Hl,v.$z,k.m_,p.Hu,O.hM,x._T,w.D6,w.LG,F.YN,et.uc],styles:[".payment-dashboard[_ngcontent-%COMP%]{padding:20px;max-width:1400px;margin:0 auto;background:#f5f7fa;min-height:100vh}.summary-section[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:30px}.summary-card[_ngcontent-%COMP%]{background:white;border-radius:12px;padding:24px;display:flex;align-items:center;gap:16px;box-shadow:0 2px 8px #00000014;transition:transform .2s,box-shadow .2s}.summary-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 4px 16px #0000001f}.summary-card[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{font-size:48px;width:64px;height:64px;display:flex;align-items:center;justify-content:center;border-radius:12px}.summary-card[_ngcontent-%COMP%]   .card-icon.partners[_ngcontent-%COMP%]{background:#e3f2fd}.summary-card[_ngcontent-%COMP%]   .card-icon.pending[_ngcontent-%COMP%]{background:#fff3e0}.summary-card[_ngcontent-%COMP%]   .card-icon.cash[_ngcontent-%COMP%]{background:#e8f5e9}.summary-card[_ngcontent-%COMP%]   .card-icon.commission[_ngcontent-%COMP%]{background:#f3e5f5}.summary-card[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{flex:1}.summary-card[_ngcontent-%COMP%]   .card-label[_ngcontent-%COMP%]{font-size:13px;color:#666;text-transform:uppercase;letter-spacing:.5px;margin-bottom:8px}.summary-card[_ngcontent-%COMP%]   .card-value[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#333}.partners-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:22px;font-weight:600;color:#333;margin:0 0 20px}.loading[_ngcontent-%COMP%]{text-align:center;padding:60px;background:white;border-radius:12px}.no-data[_ngcontent-%COMP%]{text-align:center;padding:60px;background:white;border-radius:12px;color:#2e7d32;font-size:18px;font-weight:500}.partner-list[_ngcontent-%COMP%]{display:grid;gap:16px}.partner-card[_ngcontent-%COMP%]{background:white;border-radius:12px;padding:24px;box-shadow:0 2px 8px #0000000f;cursor:pointer;transition:all .2s}.partner-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 16px #0000001f;transform:translateY(-2px)}.partner-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:20px;padding-bottom:16px;border-bottom:2px solid #f0f0f0}.partner-info[_ngcontent-%COMP%]{flex:1}.partner-info[_ngcontent-%COMP%]   .partner-name[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#333;margin-bottom:6px}.partner-info[_ngcontent-%COMP%]   .partner-contact[_ngcontent-%COMP%]{font-size:14px;color:#666}.partner-orders[_ngcontent-%COMP%]   .orders-badge[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2;padding:6px 16px;border-radius:20px;font-size:13px;font-weight:600}.partner-amounts[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:20px}.amount-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:#f8f9fa;border-radius:8px}.amount-item.total[_ngcontent-%COMP%]{background:#e3f2fd}.amount-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:13px;color:#666;font-weight:500}.amount-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:#333}.amount-item[_ngcontent-%COMP%]   .value.commission[_ngcontent-%COMP%]{color:#f57c00}.amount-item[_ngcontent-%COMP%]   .value.positive[_ngcontent-%COMP%]{color:#2e7d32}.amount-item[_ngcontent-%COMP%]   .value.negative[_ngcontent-%COMP%]{color:#d32f2f}.partner-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.partner-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 24px;font-size:14px;font-weight:600}@media (max-width: 768px){.payment-dashboard[_ngcontent-%COMP%]{padding:12px}.summary-section[_ngcontent-%COMP%], .partner-amounts[_ngcontent-%COMP%]{grid-template-columns:1fr}.partner-header[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.card-value[_ngcontent-%COMP%]{font-size:24px!important}}"]})}}return r})(),canActivate:[S.q,N.K],data:{expectedRoles:["SUPER_ADMIN","ADMIN"],title:"Partner Payments"}},{path:"",redirectTo:"admin/partners",pathMatch:"full"}];let Zr=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=t.$C({type:r})}static{this.\u0275inj=t.G2t({imports:[$.iI.forChild(Qr),$.iI]})}}return r})();var ti=l(3887);let ei=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=t.$C({type:r})}static{this.\u0275inj=t.G2t({providers:[Y.WS,z,it,ct],imports:[h.MD,g.X1,g.YN,Zr,ti.G,Z.s5,p.Hu,v.Hl,M.RG,T.fS,B.Ve,W.X6,J.WX,u.tP,K.Ou,R.NQ,k.m_,F.YN,w.D6,x._T,O.hM,q.MY,H.RI,tt.mV,ht.PO,_t.Y,I.Cn,et.uc,Q.aP,nt.w,A.Fg]})}}return r})()}}]);