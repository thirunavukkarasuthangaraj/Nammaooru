(self.webpackChunkshop_management_frontend=self.webpackChunkshop_management_frontend||[]).push([[110],{110:(Mt,re,E)=>{"use strict";E.r(re),E.d(re,{ShopOwnerModule:()=>P3});var D=E(177),b=E(9417),j=E(5596),B=E(8834),H=E(9213),X=E(9183),me=E(1997),ae=E(9115),Me=E(1975),Ve=E(6471),ge=E(2102),Ee=E(9631),Ce=E(5416),_e=E(9159),lt=E(6695),$t=E(2042),ze=E(2798),_t=E(5571),Pe=E(5351),qe=E(4823),Et=E(5084),Bt=E(6600),Ze=E(5951),it=E(2765),Ue=E(6850),Ae=E(450),xt=E(6233),Je=E(3902),Ke=E(7575),rt=E(3887),Xe=E(1188),fe=E(467),_r=E(605),Oe=E(2525),e=E(7705),Gt=E(8010),Jt=E(272),qt=E(3455),At=E(8544),at=E(1259),gt=E(1626);function sr(n,o){if(1&n&&(e.j41(0,"span",12),e.EFF(1),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.SpI("Last synced: ",t.getTimeSinceSync(),"")}}function eo(n,o){if(1&n&&(e.j41(0,"div",9)(1,"mat-icon"),e.EFF(2,"cloud_off"),e.k0s(),e.j41(3,"span",10),e.EFF(4,"You're offline. Showing cached data."),e.k0s(),e.DNE(5,sr,2,1,"span",11),e.k0s()),2&n){const t=e.XpG();e.R7$(5),e.Y8G("ngIf",t.lastSyncTime)}}function Qn(n,o){1&n&&(e.j41(0,"div",13),e.nrm(1,"mat-spinner",14),e.k0s())}function Jn(n,o){1&n&&(e.j41(0,"span",62)(1,"mat-icon"),e.EFF(2,"trending_up"),e.k0s(),e.EFF(3," Active "),e.k0s())}function cr(n,o){if(1&n&&(e.j41(0,"div",63)(1,"mat-icon"),e.EFF(2,"notifications_active"),e.k0s(),e.j41(3,"span"),e.EFF(4),e.k0s(),e.j41(5,"mat-icon",64),e.EFF(6,"chevron_right"),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(4),e.SpI("",t.stats.lowStockProducts+t.stats.outOfStockProducts," items need attention")}}function li(n,o){if(1&n&&(e.j41(0,"div",15)(1,"div",16)(2,"div",17)(3,"div",18)(4,"mat-icon"),e.EFF(5,"shopping_bag"),e.k0s()(),e.j41(6,"div",19)(7,"span",20),e.EFF(8),e.k0s(),e.j41(9,"span",21),e.EFF(10,"Today's Orders"),e.k0s()()(),e.j41(11,"div",17)(12,"div",22)(13,"mat-icon"),e.EFF(14,"pending_actions"),e.k0s()(),e.j41(15,"div",19)(16,"span",20),e.EFF(17),e.k0s(),e.j41(18,"span",21),e.EFF(19,"Pending"),e.k0s()()(),e.j41(20,"div",17)(21,"div",23)(22,"mat-icon"),e.EFF(23,"check_circle"),e.k0s()(),e.j41(24,"div",19)(25,"span",20),e.EFF(26),e.k0s(),e.j41(27,"span",21),e.EFF(28,"Total Orders"),e.k0s()()(),e.j41(29,"div",24)(30,"div",25)(31,"mat-icon"),e.EFF(32,"currency_rupee"),e.k0s()(),e.j41(33,"div",19)(34,"span",20),e.EFF(35),e.k0s(),e.j41(36,"span",21),e.EFF(37,"Today's Revenue"),e.k0s()()()(),e.j41(38,"div",26)(39,"div",27)(40,"div",28)(41,"div",29)(42,"h2",30),e.EFF(43,"Revenue Overview"),e.k0s(),e.j41(44,"span",31),e.EFF(45,"This Month"),e.k0s()(),e.j41(46,"div",32)(47,"div",33)(48,"span",34),e.EFF(49,"Today"),e.k0s(),e.j41(50,"div",35)(51,"span",36),e.EFF(52,"\u20b9"),e.k0s(),e.j41(53,"span",37),e.EFF(54),e.k0s()(),e.DNE(55,Jn,4,0,"span",38),e.k0s(),e.nrm(56,"div",39),e.j41(57,"div",33)(58,"span",34),e.EFF(59,"This Month"),e.k0s(),e.j41(60,"div",35)(61,"span",36),e.EFF(62,"\u20b9"),e.k0s(),e.j41(63,"span",37),e.EFF(64),e.k0s()(),e.j41(65,"span",40)(66,"mat-icon"),e.EFF(67,"calendar_today"),e.k0s(),e.EFF(68," Monthly "),e.k0s()()()(),e.j41(69,"div",28)(70,"div",29)(71,"h2",30),e.EFF(72,"Inventory Status"),e.k0s(),e.j41(73,"button",41)(74,"mat-icon"),e.EFF(75,"arrow_forward"),e.k0s()()(),e.j41(76,"div",42)(77,"div",43)(78,"div",44)(79,"mat-icon"),e.EFF(80,"inventory_2"),e.k0s()(),e.j41(81,"span",45),e.EFF(82),e.k0s(),e.j41(83,"span",46),e.EFF(84,"Total Products"),e.k0s()(),e.j41(85,"div",43)(86,"div",47)(87,"mat-icon"),e.EFF(88,"warning_amber"),e.k0s()(),e.j41(89,"span",45),e.EFF(90),e.k0s(),e.j41(91,"span",46),e.EFF(92,"Low Stock"),e.k0s()(),e.j41(93,"div",43)(94,"div",48)(95,"mat-icon"),e.EFF(96,"error_outline"),e.k0s()(),e.j41(97,"span",45),e.EFF(98),e.k0s(),e.j41(99,"span",46),e.EFF(100,"Out of Stock"),e.k0s()()(),e.DNE(101,cr,7,1,"div",49),e.k0s()(),e.j41(102,"div",50)(103,"div",28)(104,"div",29)(105,"h2",30),e.EFF(106,"Quick Actions"),e.k0s()(),e.j41(107,"div",51)(108,"button",52)(109,"div",53)(110,"mat-icon"),e.EFF(111,"point_of_sale"),e.k0s()(),e.j41(112,"span",54),e.EFF(113,"POS Billing"),e.k0s(),e.j41(114,"mat-icon",55),e.EFF(115,"chevron_right"),e.k0s()(),e.j41(116,"button",56)(117,"div",57)(118,"mat-icon"),e.EFF(119,"receipt_long"),e.k0s()(),e.j41(120,"span",54),e.EFF(121,"View Orders"),e.k0s(),e.j41(122,"mat-icon",55),e.EFF(123,"chevron_right"),e.k0s()(),e.j41(124,"button",58)(125,"div",59)(126,"mat-icon"),e.EFF(127,"category"),e.k0s()(),e.j41(128,"span",54),e.EFF(129,"My Products"),e.k0s(),e.j41(130,"mat-icon",55),e.EFF(131,"chevron_right"),e.k0s()(),e.j41(132,"button",60)(133,"div",61)(134,"mat-icon"),e.EFF(135,"table_chart"),e.k0s()(),e.j41(136,"span",54),e.EFF(137,"Bulk Edit"),e.k0s(),e.j41(138,"mat-icon",55),e.EFF(139,"chevron_right"),e.k0s()()()()()()()),2&n){const t=e.XpG();e.R7$(8),e.JRh(t.stats.todayOrders),e.R7$(3),e.AVh("alert",t.stats.pendingOrders>0),e.R7$(6),e.JRh(t.stats.pendingOrders),e.R7$(9),e.JRh(t.stats.totalOrders),e.R7$(9),e.SpI("\u20b9",t.formatCurrency(t.stats.todayRevenue),""),e.R7$(19),e.JRh(t.formatCurrency(t.stats.todayRevenue)),e.R7$(1),e.Y8G("ngIf",t.stats.todayRevenue>0),e.R7$(9),e.JRh(t.formatCurrency(t.stats.monthlyRevenue)),e.R7$(18),e.JRh(t.stats.totalProducts),e.R7$(3),e.AVh("warning",t.stats.lowStockProducts>0),e.R7$(5),e.JRh(t.stats.lowStockProducts),e.R7$(3),e.AVh("danger",t.stats.outOfStockProducts>0),e.R7$(5),e.JRh(t.stats.outOfStockProducts),e.R7$(3),e.Y8G("ngIf",t.hasStockAlert)}}let Bc=(()=>{class n{constructor(t,r,i,a,s,l,u){this.authService=t,this.shopService=r,this.soundService=i,this.orderService=a,this.offlineStorage=s,this.http=l,this.router=u,this.isLoading=!0,this.unreadNotificationCount=0,this.isOffline=!1,this.lastSyncTime=null,this.currentShopId=null,this.stats={todayOrders:0,totalOrders:0,pendingOrders:0,todayRevenue:0,monthlyRevenue:0,totalProducts:0,lowStockProducts:0,outOfStockProducts:0},this.previousOrderCount=0,this.currentUser$=this.authService.currentUser$}get hasStockAlert(){return this.stats.lowStockProducts>0||this.stats.outOfStockProducts>0}getGreeting(){const t=(new Date).getHours();return t<12?"morning":t<17?"afternoon":"evening"}getCurrentDate(){return(new Date).toLocaleDateString("en-IN",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}ngOnInit(){this.isOffline=!navigator.onLine,window.addEventListener("online",()=>this.handleOnline()),window.addEventListener("offline",()=>this.handleOffline()),this.loadCachedStats(),this.loadDashboardData(),this.startAutoRefresh()}handleOnline(){console.log("Network online - refreshing dashboard"),this.isOffline=!1,this.loadDashboardData()}handleOffline(){console.log("Network offline - using cached data"),this.isOffline=!0}getTimeSinceSync(){if(!this.lastSyncTime)return"Never synced";const r=(new Date).getTime()-this.lastSyncTime.getTime(),i=Math.floor(r/6e4);if(i<1)return"Just now";if(1===i)return"1 minute ago";if(i<60)return`${i} minutes ago`;const a=Math.floor(i/60);if(1===a)return"1 hour ago";if(a<24)return`${a} hours ago`;const s=Math.floor(a/24);return 1===s?"1 day ago":`${s} days ago`}loadCachedStats(){var t=this;return(0,fe.A)(function*(){const r=localStorage.getItem("dashboard_stats");if(r)try{const a=JSON.parse(r);t.stats={todayOrders:a.todayOrders||0,totalOrders:a.totalOrders||0,pendingOrders:a.pendingOrders||0,todayRevenue:a.todayRevenue||0,monthlyRevenue:a.monthlyRevenue||0,totalProducts:a.totalProducts||0,lowStockProducts:a.lowStockProducts||0,outOfStockProducts:a.outOfStockProducts||0},t.isLoading=!1}catch(a){console.warn("Error parsing cached stats:",a)}const i=localStorage.getItem("current_shop_id");if(i){t.currentShopId=parseInt(i,10);try{const a=yield t.offlineStorage.getDashboardCache(t.currentShopId);a&&a.stats&&(t.stats=a.stats,t.lastSyncTime=new Date(a.cachedAt),t.isLoading=!1)}catch(a){console.warn("Error loading IndexedDB cache:",a)}}})()}saveCachedStats(){if(localStorage.setItem("dashboard_stats",JSON.stringify(this.stats)),this.currentShopId){const t={key:`dashboard_stats_${this.currentShopId}`,shopId:this.currentShopId,stats:this.stats,cachedAt:(new Date).toISOString()};this.offlineStorage.saveDashboardCache(t).then(()=>{this.lastSyncTime=new Date,console.log("Dashboard stats cached to IndexedDB")}).catch(r=>console.warn("Error saving to IndexedDB:",r))}}ngOnDestroy(){this.refreshSubscription&&this.refreshSubscription.unsubscribe()}loadDashboardData(){var r,t=this;if(!navigator.onLine)return console.log("Offline - using cached dashboard data"),this.isOffline=!0,void(this.isLoading=!1);this.isLoading=!0,this.http.get(`${Oe.c.apiUrl}/shops/my-shop`,{withCredentials:!0}).subscribe({next:r=>{r.data&&r.data.shopId?(r.data.id&&(localStorage.setItem("current_shop_id",r.data.id.toString()),this.currentShopId=r.data.id),localStorage.setItem("current_shop_string_id",r.data.shopId),this.fetchDashboardStats(r.data.shopId)):(console.error("No shop found for this user"),this.isLoading=!1)},error:(r=(0,fe.A)(function*(i){console.error("Error fetching shop:",i),t.isOffline=!0;const a=localStorage.getItem("current_shop_string_id");a?t.fetchDashboardStats(a):t.isLoading=!1}),function(a){return r.apply(this,arguments)})})}fetchDashboardStats(t){if(!navigator.onLine)return console.log("Offline - skipping API call for dashboard stats"),this.isOffline=!0,void(this.isLoading=!1);this.http.get(`${Oe.c.apiUrl}/shops/${t}/dashboard`,{withCredentials:!0}).subscribe({next:r=>{if("0000"===r.statusCode&&r.data){const i=r.data.orderMetrics||{},a=r.data.productMetrics||{};this.stats={todayOrders:i.todayOrders||0,totalOrders:i.totalOrders||0,pendingOrders:i.pendingOrders||0,todayRevenue:i.todayRevenue||0,monthlyRevenue:i.monthlyRevenue||0,totalProducts:a.totalProducts||0,lowStockProducts:a.lowStockProducts||0,outOfStockProducts:a.outOfStockProducts||0},this.unreadNotificationCount=this.stats.pendingOrders,this.isOffline=!1,this.stats.pendingOrders>this.previousOrderCount&&this.previousOrderCount>0&&this.soundService.playNotificationSound(),this.previousOrderCount=this.stats.pendingOrders,this.saveCachedStats()}this.isLoading=!1},error:()=>{console.log("API error - showing cached data"),this.isOffline=!0,this.isLoading=!1}})}refreshDashboard(){this.loadDashboardData()}formatCurrency(t){return t>=1e5?(t/1e5).toFixed(1)+"L":t>=1e3?(t/1e3).toFixed(1)+"K":t.toFixed(0)}startAutoRefresh(){this.refreshSubscription=(0,_r.Y)(3e4).subscribe(()=>{this.loadDashboardData()})}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(Gt.u),e.rXU(Jt.s),e.rXU(qt.p),e.rXU(At.Q),e.rXU(at.m),e.rXU(gt.Qq),e.rXU(Xe.Ix))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-shop-owner-dashboard"]],decls:15,vars:10,consts:[[1,"dashboard-wrapper"],["class","offline-banner",4,"ngIf"],[1,"welcome-section"],[1,"welcome-content"],[1,"greeting"],[1,"date-text"],[1,"refresh-btn",3,"disabled","click"],["class","loading-container",4,"ngIf"],["class","dashboard-content",4,"ngIf"],[1,"offline-banner"],[1,"offline-text"],["class","sync-time",4,"ngIf"],[1,"sync-time"],[1,"loading-container"],["diameter","40"],[1,"dashboard-content"],[1,"stats-grid"],["routerLink","/shop-owner/orders-management",1,"stat-card"],[1,"stat-icon","blue"],[1,"stat-info"],[1,"stat-value"],[1,"stat-label"],[1,"stat-icon","orange"],[1,"stat-icon","green"],[1,"stat-card","revenue-highlight"],[1,"stat-icon","dark-green"],[1,"content-grid"],[1,"main-column"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"period-badge"],[1,"revenue-stats"],[1,"revenue-item"],[1,"revenue-label"],[1,"revenue-amount"],[1,"currency"],[1,"amount"],["class","trend up",4,"ngIf"],[1,"revenue-divider"],[1,"trend","neutral"],["routerLink","/shop-owner/my-products",1,"card-action-btn"],[1,"inventory-grid"],[1,"inventory-item"],[1,"inv-icon","green"],[1,"inv-value"],[1,"inv-label"],[1,"inv-icon","yellow"],[1,"inv-icon","red"],["class","inventory-alert","routerLink","/shop-owner/my-products",4,"ngIf"],[1,"side-column"],[1,"actions-list"],["routerLink","/shop-owner/pos-billing",1,"action-btn"],[1,"action-icon","green"],[1,"action-text"],[1,"action-arrow"],["routerLink","/shop-owner/orders-management",1,"action-btn"],[1,"action-icon","blue"],["routerLink","/shop-owner/my-products",1,"action-btn"],[1,"action-icon","purple"],["routerLink","/shop-owner/bulk-edit",1,"action-btn"],[1,"action-icon","orange"],[1,"trend","up"],["routerLink","/shop-owner/my-products",1,"inventory-alert"],[1,"arrow"]],template:function(r,i){if(1&r&&(e.j41(0,"div",0),e.DNE(1,eo,6,1,"div",1),e.j41(2,"div",2)(3,"div",3)(4,"h1",4),e.EFF(5),e.nI1(6,"async"),e.k0s(),e.j41(7,"p",5),e.EFF(8),e.k0s()(),e.j41(9,"button",6),e.bIt("click",function(){return i.refreshDashboard()}),e.j41(10,"mat-icon"),e.EFF(11,"refresh"),e.k0s(),e.EFF(12),e.k0s()(),e.DNE(13,Qn,2,0,"div",7),e.DNE(14,li,140,17,"div",8),e.k0s()),2&r){let a;e.R7$(1),e.Y8G("ngIf",i.isOffline),e.R7$(4),e.Lme("Good ",i.getGreeting(),", ",null==(a=e.bMT(6,8,i.currentUser$))?null:a.username,"!"),e.R7$(3),e.JRh(i.getCurrentDate()),e.R7$(1),e.Y8G("disabled",i.isOffline),e.R7$(3),e.SpI(" ",i.isOffline?"Offline":"Refresh"," "),e.R7$(1),e.Y8G("ngIf",i.isLoading),e.R7$(1),e.Y8G("ngIf",!i.isLoading)}},dependencies:[D.bT,Xe.Wk,H.An,X.LG,D.Jj],styles:[".offline-banner[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 20px;background:linear-gradient(135deg,#fff3e0 0%,#ffe0b2 100%);border:1px solid #ffb74d;border-radius:8px;margin-bottom:16px;color:#e65100;font-weight:500}.offline-banner[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px;color:#e65100}.offline-banner[_ngcontent-%COMP%]   .offline-text[_ngcontent-%COMP%]{flex:1}.offline-banner[_ngcontent-%COMP%]   .sync-time[_ngcontent-%COMP%]{font-size:13px;color:#f57c00;background:rgba(255,255,255,.6);padding:4px 12px;border-radius:12px}.dashboard-wrapper[_ngcontent-%COMP%]{padding:24px;background:#f8fafc;min-height:calc(100vh - 64px)}.welcome-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:28px}.welcome-content[_ngcontent-%COMP%]   .greeting[_ngcontent-%COMP%]{font-size:26px;font-weight:700;color:#1e293b;margin:0 0 4px;letter-spacing:-.5px}.welcome-content[_ngcontent-%COMP%]   .date-text[_ngcontent-%COMP%]{font-size:14px;color:#64748b;margin:0;font-weight:500}.refresh-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 20px;border-radius:12px;border:1px solid #e2e8f0;background:white;color:#475569;font-weight:500;font-size:14px;cursor:pointer;transition:all .2s ease}.refresh-btn[_ngcontent-%COMP%]:hover{border-color:#4ade80;color:#16a34a;background:#f0fdf4}.refresh-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:80px}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin-bottom:28px}.stat-card[_ngcontent-%COMP%]{background:white;border-radius:16px;padding:20px;display:flex;align-items:center;gap:16px;border:1px solid #f1f5f9;box-shadow:0 1px 3px #0000000a;cursor:pointer;transition:all .2s ease}.stat-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #00000014;transform:translateY(-2px)}.stat-card.alert[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fffbeb 0%,#fef3c7 100%);border-color:#fcd34d}.stat-card.revenue-highlight[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f0fdf4 0%,#dcfce7 100%);border-color:#86efac}.stat-icon[_ngcontent-%COMP%]{width:52px;height:52px;border-radius:14px;display:flex;align-items:center;justify-content:center;flex-shrink:0}.stat-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px;color:#fff}.stat-icon.blue[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6 0%,#2563eb 100%)}.stat-icon.orange[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f59e0b 0%,#d97706 100%)}.stat-icon.green[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4ade80 0%,#22c55e 100%)}.stat-icon.dark-green[_ngcontent-%COMP%]{background:linear-gradient(135deg,#16a34a 0%,#15803d 100%)}.stat-icon.purple[_ngcontent-%COMP%]{background:linear-gradient(135deg,#8b5cf6 0%,#7c3aed 100%)}.stat-icon.yellow[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fbbf24 0%,#f59e0b 100%)}.stat-icon.red[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f87171 0%,#ef4444 100%)}.stat-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.stat-info[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#1e293b;letter-spacing:-.5px}.stat-info[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:13px;color:#64748b;font-weight:500}.content-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 380px;gap:24px}.main-column[_ngcontent-%COMP%], .side-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px}.card[_ngcontent-%COMP%]{background:white;border-radius:16px;border:1px solid #f1f5f9;box-shadow:0 1px 3px #0000000a;overflow:hidden}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px 24px 16px}.card-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#1e293b;margin:0;letter-spacing:-.2px}.period-badge[_ngcontent-%COMP%]{background:#f0fdf4;color:#16a34a;padding:6px 12px;border-radius:20px;font-size:12px;font-weight:600}.card-action-btn[_ngcontent-%COMP%]{width:36px;height:36px;background:#f8fafc;border:none;border-radius:10px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s ease}.card-action-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#64748b}.card-action-btn[_ngcontent-%COMP%]:hover{background:#f0fdf4}.card-action-btn[_ngcontent-%COMP%]:hover   mat-icon[_ngcontent-%COMP%]{color:#16a34a}.revenue-stats[_ngcontent-%COMP%]{display:flex;padding:0 24px 24px;gap:32px}.revenue-item[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:8px}.revenue-label[_ngcontent-%COMP%]{font-size:13px;color:#64748b;font-weight:500}.revenue-amount[_ngcontent-%COMP%]{display:flex;align-items:baseline}.revenue-amount[_ngcontent-%COMP%]   .currency[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#64748b;margin-right:2px}.revenue-amount[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-size:32px;font-weight:700;color:#1e293b;letter-spacing:-1px}.trend[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:12px;font-weight:600}.trend[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.trend.up[_ngcontent-%COMP%]{color:#16a34a}.trend.neutral[_ngcontent-%COMP%]{color:#64748b}.revenue-divider[_ngcontent-%COMP%]{width:1px;background:linear-gradient(180deg,transparent 0%,#e2e8f0 20%,#e2e8f0 80%,transparent 100%)}.inventory-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;padding:0 24px}.inventory-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:20px 16px;background:#f8fafc;border-radius:12px;transition:all .2s ease}.inventory-item.warning[_ngcontent-%COMP%]{background:#fffbeb}.inventory-item.warning[_ngcontent-%COMP%]   .inv-value[_ngcontent-%COMP%]{color:#d97706}.inventory-item.danger[_ngcontent-%COMP%]{background:#fef2f2}.inventory-item.danger[_ngcontent-%COMP%]   .inv-value[_ngcontent-%COMP%]{color:#dc2626}.inv-icon[_ngcontent-%COMP%]{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;margin-bottom:12px}.inv-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:22px;width:22px;height:22px;color:#fff}.inv-value[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#1e293b;letter-spacing:-.5px}.inv-label[_ngcontent-%COMP%]{font-size:12px;color:#64748b;font-weight:500;margin-top:4px}.inventory-alert[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin:20px 24px 24px;padding:14px 16px;background:linear-gradient(135deg,#fef3c7 0%,#fde68a 100%);border-radius:12px;cursor:pointer;transition:all .2s ease}.inventory-alert[_ngcontent-%COMP%]:hover{transform:translate(4px)}.inventory-alert[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#b45309;font-size:20px;width:20px;height:20px}.inventory-alert[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;font-size:13px;font-weight:600;color:#92400e}.inventory-alert[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.actions-list[_ngcontent-%COMP%]{padding:0 16px 16px;display:flex;flex-direction:column;gap:8px}.action-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:14px;width:100%;padding:14px 16px;background:#f8fafc;border:1px solid transparent;border-radius:12px;cursor:pointer;transition:all .2s ease}.action-btn[_ngcontent-%COMP%]:hover{background:white;border-color:#e2e8f0;box-shadow:0 2px 8px #0000000f}.action-btn[_ngcontent-%COMP%]:hover   .action-arrow[_ngcontent-%COMP%]{transform:translate(4px);color:#4ade80}.action-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:10px;display:flex;align-items:center;justify-content:center;flex-shrink:0}.action-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;color:#fff}.action-text[_ngcontent-%COMP%]{flex:1;font-size:14px;font-weight:600;color:#1e293b;text-align:left}.action-arrow[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#94a3b8;transition:all .2s ease}@media (max-width: 1200px){.content-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}@media (max-width: 900px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (max-width: 600px){.dashboard-wrapper[_ngcontent-%COMP%]{padding:16px}.welcome-section[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}.welcome-content[_ngcontent-%COMP%]   .greeting[_ngcontent-%COMP%]{font-size:22px}.stats-grid[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr;gap:12px}.stat-card[_ngcontent-%COMP%]{padding:16px}.stat-icon[_ngcontent-%COMP%]{width:44px;height:44px}.stat-info[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:20px}.inventory-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px;padding:0 16px}.revenue-stats[_ngcontent-%COMP%]{flex-direction:column;gap:20px;padding:0 16px 16px}.revenue-divider[_ngcontent-%COMP%]{width:100%;height:1px}.card-header[_ngcontent-%COMP%]{padding:16px 16px 12px}.inventory-alert[_ngcontent-%COMP%]{margin:16px}}"]})}}return n})();var Mr=E(7505),di=E(8244),$r=E(8633),ot=E(6977),qr=E(980),_n=E(1413),to=E(4412),ls=E(1807),ds=E(1985),wi=E(6354),vt=E(5558),wt=E(9437);let us=(()=>{class n{constructor(t){this.http=t,this.apiUrl=`${Oe.c.apiUrl}/business-hours`,this.availabilityUrl=`${Oe.c.apiUrl}/shop-availability`,this.statusSubject=new to.t(null),this.status$=this.statusSubject.asObservable(),this.scheduleSubject=new to.t([]),this.schedule$=this.scheduleSubject.asObservable(),this.startStatusPolling()}getBusinessHours(t){return this.http.get(`${this.apiUrl}/shop/${t}`)}createBusinessHour(t){return this.http.post(this.apiUrl,t)}updateBusinessHour(t,r){return this.http.put(`${this.apiUrl}/${t}`,r)}deleteBusinessHour(t){return this.http.delete(`${this.apiUrl}/${t}`)}createDefaultBusinessHours(t){return this.http.post(`${this.apiUrl}/shop/${t}/default`,{})}bulkUpdateBusinessHours(t,r){return this.http.put(`${this.apiUrl}/shop/${t}/bulk`,r)}getShopStatus(t){return this.http.get(`${this.apiUrl}/shop/${t}/status`).pipe((0,wi.T)(r=>(this.statusSubject.next(r),r)))}getWeeklySchedule(t){return this.http.get(`${this.apiUrl}/shop/${t}/schedule`).pipe((0,wi.T)(r=>(this.scheduleSubject.next(r),r)))}getAvailabilityStatus(t){return this.http.get(`${this.availabilityUrl}/${t}/status`)}forceUpdateAvailability(t){return this.http.post(`${this.availabilityUrl}/${t}/force-update`,{})}overrideAvailability(t,r,i){const a={isAvailable:r};return i&&(a.reason=i),this.http.post(`${this.availabilityUrl}/${t}/override`,null,{params:a})}clearAvailabilityOverride(t){return this.http.post(`${this.availabilityUrl}/${t}/clear-override`,{})}startStatusPolling(){(0,ls.O)(0,3e4).pipe((0,vt.n)(()=>this.getCurrentShopId()),(0,vt.n)(t=>t?this.getShopStatus(t):[]),(0,wt.W)(t=>(console.error("Status polling error:",t),[]))).subscribe()}getCurrentShopId(){return new ds.c(t=>{t.next(null),t.complete()})}convertToBackendFormat(t,r){const i={monday:"MONDAY",tuesday:"TUESDAY",wednesday:"WEDNESDAY",thursday:"THURSDAY",friday:"FRIDAY",saturday:"SATURDAY",sunday:"SUNDAY"};return r.map(a=>({shopId:t,dayOfWeek:i[a.day]||a.day.toUpperCase(),openTime:a.closed?null:a.open,closeTime:a.closed?null:a.close,isOpen:!a.closed,is24Hours:"00:00"===a.open&&"23:59"===a.close,breakStartTime:a.breakStart||null,breakEndTime:a.breakEnd||null,specialNote:a.specialNote||null}))}convertFromBackendFormat(t){const r={MONDAY:"monday",TUESDAY:"tuesday",WEDNESDAY:"wednesday",THURSDAY:"thursday",FRIDAY:"friday",SATURDAY:"saturday",SUNDAY:"sunday"},i={monday:"Monday",tuesday:"Tuesday",wednesday:"Wednesday",thursday:"Thursday",friday:"friday",saturday:"Saturday",sunday:"Sunday"};return t.map(a=>({id:a.id,day:r[a.dayOfWeek]||a.dayOfWeek.toLowerCase(),displayName:i[r[a.dayOfWeek]]||a.dayOfWeek,open:a.openTime||"09:00",close:a.closeTime||"18:00",closed:!a.isOpen,breakStart:a.breakStartTime,breakEnd:a.breakEndTime,specialNote:a.specialNote}))}formatTime(t){if(!t)return"";const[r,i]=t.split(":"),a=parseInt(r);return`${0===a?12:a>12?a-12:a}:${i} ${a>=12?"PM":"AM"}`}formatTimeRange(t,r){return t&&r?`${this.formatTime(t)} - ${this.formatTime(r)}`:"Closed"}isCurrentlyInBreak(t,r){if(!t||!r)return!1;const i=new Date,a=i.getHours().toString().padStart(2,"0")+":"+i.getMinutes().toString().padStart(2,"0");return a>=t&&a<=r}getStatusColor(t){switch(t){case"OPEN":return"#10b981";case"CLOSED":return"#ef4444";case"ON_BREAK":return"#f59e0b";case"OPENS_LATER":return"#3b82f6";default:return"#6b7280"}}getStatusIcon(t){switch(t){case"OPEN":return"check_circle";case"CLOSED":return"cancel";case"ON_BREAK":return"pause_circle";case"OPENS_LATER":return"schedule";case"CLOSED_FOR_DAY":return"block";default:return"help"}}static{this.\u0275fac=function(r){return new(r||n)(e.KVO(gt.Qq))}}static{this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function gs(n,o){if(1&n&&(e.j41(0,"div",25)(1,"mat-icon"),e.EFF(2),e.k0s(),e.j41(3,"span"),e.EFF(4),e.k0s()()),2&n){const t=e.XpG();e.xc7("background-color",t.getStatusBadge().color),e.R7$(2),e.JRh(t.getStatusBadge().icon),e.R7$(2),e.JRh(t.getStatusBadge().text)}}function Lc(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",31),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.overrideStatus(!0))}),e.j41(1,"mat-icon"),e.EFF(2,"lock_open"),e.k0s(),e.EFF(3," Open Now "),e.k0s()}}function ps(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",32),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.overrideStatus(!1))}),e.j41(1,"mat-icon"),e.EFF(2,"lock"),e.k0s(),e.EFF(3," Close Now "),e.k0s()}}function fs(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",33),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.clearOverride())}),e.j41(1,"mat-icon"),e.EFF(2,"schedule"),e.k0s(),e.EFF(3," Auto Mode "),e.k0s()}}function $c(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",26)(1,"button",27),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.forceUpdateStatus())}),e.j41(2,"mat-icon"),e.EFF(3,"refresh"),e.k0s(),e.EFF(4," Update Status "),e.k0s(),e.DNE(5,Lc,4,0,"button",28),e.DNE(6,ps,4,0,"button",29),e.DNE(7,fs,4,0,"button",30),e.k0s()}if(2&n){const t=e.XpG();e.R7$(5),e.Y8G("ngIf",!t.shopStatus.isOpen),e.R7$(1),e.Y8G("ngIf",t.shopStatus.isOpen),e.R7$(1),e.Y8G("ngIf",t.shopStatus&&(null==t.shopStatus.overallStatus?null:t.shopStatus.overallStatus.includes("MANUALLY")))}}function ms(n,o){1&n&&e.nrm(0,"mat-spinner",34)}function ia(n,o){1&n&&(e.j41(0,"mat-icon"),e.EFF(1,"save"),e.k0s())}function hs(n,o){if(1&n&&(e.j41(0,"div",37)(1,"span",38),e.EFF(2,"Current Time:"),e.k0s(),e.j41(3,"span",39),e.EFF(4),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(4),e.Lme("",t.shopStatus.currentTime," (",t.shopStatus.currentDay,")")}}function Gc(n,o){if(1&n&&(e.j41(0,"div",37)(1,"span",38),e.EFF(2,"Today's Hours:"),e.k0s(),e.j41(3,"span",39),e.EFF(4),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(4),e.Lme("",t.shopStatus.openTime," - ",t.shopStatus.closeTime,"")}}function no(n,o){if(1&n&&(e.j41(0,"div",37)(1,"span",38),e.EFF(2,"Next Open:"),e.k0s(),e.j41(3,"span",39),e.EFF(4),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(4),e.Lme("",t.shopStatus.nextOpenTime.dayOfWeek," at ",t.shopStatus.nextOpenTime.time,"")}}function Uc(n,o){if(1&n&&(e.j41(0,"div",37)(1,"span",38),e.EFF(2,"Break Ends:"),e.k0s(),e.j41(3,"span",39),e.EFF(4),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(4),e.JRh(t.shopStatus.breakEndTime)}}function zc(n,o){if(1&n&&(e.j41(0,"mat-card",35)(1,"mat-card-header")(2,"mat-card-title")(3,"mat-icon"),e.EFF(4,"info"),e.k0s(),e.EFF(5," Current Status "),e.k0s()(),e.j41(6,"mat-card-content")(7,"div",36)(8,"div",37)(9,"span",38),e.EFF(10,"Status:"),e.k0s(),e.j41(11,"span",39)(12,"mat-icon"),e.EFF(13),e.k0s(),e.EFF(14),e.k0s()(),e.DNE(15,hs,5,2,"div",40),e.DNE(16,Gc,5,2,"div",40),e.DNE(17,no,5,2,"div",40),e.DNE(18,Uc,5,1,"div",40),e.k0s()()()),2&n){const t=e.XpG();e.R7$(11),e.xc7("color",t.getStatusBadge().color),e.R7$(2),e.JRh(t.getStatusBadge().icon),e.R7$(1),e.SpI(" ",t.shopStatus.message," "),e.R7$(1),e.Y8G("ngIf",t.shopStatus.currentTime),e.R7$(1),e.Y8G("ngIf",t.shopStatus.openTime&&t.shopStatus.isOpen),e.R7$(1),e.Y8G("ngIf",(null==t.shopStatus.nextOpenTime?null:t.shopStatus.nextOpenTime.dateTime)&&!t.shopStatus.isOpen),e.R7$(1),e.Y8G("ngIf",t.shopStatus.breakEndTime)}}function _s(n,o){if(1&n&&(e.j41(0,"div",50)(1,"mat-icon"),e.EFF(2,"schedule"),e.k0s(),e.j41(3,"span"),e.EFF(4),e.k0s()()),2&n){const t=e.XpG().$implicit,r=e.XpG();e.R7$(4),e.JRh(r.formatTimeRange(t))}}function xs(n,o){1&n&&(e.j41(0,"div",51)(1,"mat-icon"),e.EFF(2,"block"),e.k0s(),e.j41(3,"span"),e.EFF(4,"Closed All Day"),e.k0s()())}const No=function(){return{standalone:!0}};function Vc(n,o){if(1&n){const t=e.RV6();e.j41(0,"mat-card",41)(1,"mat-card-header")(2,"mat-card-title")(3,"span",42),e.EFF(4),e.k0s(),e.j41(5,"mat-slide-toggle",43),e.bIt("ngModelChange",function(i){const s=e.eBV(t).$implicit;return e.Njj(s.closed=i)})("change",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.onDayToggle(a))}),e.EFF(6),e.k0s()()(),e.j41(7,"mat-card-content")(8,"div",44)(9,"mat-form-field",45)(10,"mat-label"),e.EFF(11,"Opening Time"),e.k0s(),e.j41(12,"input",46),e.bIt("ngModelChange",function(i){const s=e.eBV(t).$implicit;return e.Njj(s.open=i)}),e.k0s()(),e.j41(13,"span",47),e.EFF(14,"to"),e.k0s(),e.j41(15,"mat-form-field",45)(16,"mat-label"),e.EFF(17,"Closing Time"),e.k0s(),e.j41(18,"input",46),e.bIt("ngModelChange",function(i){const s=e.eBV(t).$implicit;return e.Njj(s.close=i)}),e.k0s()()(),e.DNE(19,_s,5,1,"div",48),e.DNE(20,xs,5,0,"div",49),e.k0s()()}if(2&n){const t=o.$implicit;e.R7$(4),e.JRh(t.displayName),e.R7$(1),e.Y8G("ngModel",t.closed)("ngModelOptions",e.lJ4(14,No)),e.R7$(1),e.SpI(" ",t.closed?"Closed":"Open"," "),e.R7$(2),e.AVh("disabled",t.closed),e.R7$(4),e.Y8G("ngModel",t.open)("ngModelOptions",e.lJ4(15,No))("disabled",t.closed),e.R7$(6),e.Y8G("ngModel",t.close)("ngModelOptions",e.lJ4(16,No))("disabled",t.closed),e.R7$(1),e.Y8G("ngIf",!t.closed),e.R7$(1),e.Y8G("ngIf",t.closed)}}function Yc(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",54)(1,"div",55)(2,"span",56),e.EFF(3),e.nI1(4,"date"),e.k0s(),e.j41(5,"span",57),e.EFF(6),e.k0s(),e.j41(7,"span",58),e.EFF(8),e.k0s()(),e.j41(9,"button",59),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.removeHoliday(a))}),e.j41(10,"mat-icon"),e.EFF(11,"delete"),e.k0s()()()}if(2&n){const t=o.$implicit;e.R7$(3),e.JRh(e.i5U(4,3,t.date,"MMM d, y")),e.R7$(3),e.JRh(t.name),e.R7$(2),e.JRh(t.closed?"Closed":t.hours)}}function Xc(n,o){if(1&n&&(e.j41(0,"div",52),e.DNE(1,Yc,12,6,"div",53),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.holidays)}}function Hc(n,o){if(1&n&&(e.j41(0,"div",60)(1,"span",61),e.EFF(2),e.k0s(),e.j41(3,"span",62),e.EFF(4),e.k0s()()),2&n){const t=o.$implicit,r=e.XpG();e.R7$(2),e.SpI("",t.displayName,":"),e.R7$(1),e.AVh("closed",t.closed),e.R7$(1),e.SpI(" ",t.closed?"Closed":r.formatTimeRange(t)," ")}}let Cs=(()=>{class n{constructor(t,r,i,a){this.fb=t,this.snackBar=r,this.shopService=i,this.businessHoursService=a,this.destroy$=new _n.B,this.currentShopId=null,this.shopStatus=null,this.loading=!1,this.businessHours=[{day:"monday",displayName:"Monday",open:"09:00",close:"18:00",closed:!1},{day:"tuesday",displayName:"Tuesday",open:"09:00",close:"18:00",closed:!1},{day:"wednesday",displayName:"Wednesday",open:"09:00",close:"18:00",closed:!1},{day:"thursday",displayName:"Thursday",open:"09:00",close:"18:00",closed:!1},{day:"friday",displayName:"Friday",open:"09:00",close:"18:00",closed:!1},{day:"saturday",displayName:"Saturday",open:"09:00",close:"18:00",closed:!1},{day:"sunday",displayName:"Sunday",open:"09:00",close:"18:00",closed:!0}],this.holidays=[],this.businessHoursForm=this.fb.group({})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngOnInit(){this.loadBusinessHours(),this.subscribeToStatusUpdates()}subscribeToStatusUpdates(){this.businessHoursService.status$.pipe((0,ot.Q)(this.destroy$)).subscribe(t=>{this.shopStatus=t})}loadBusinessHours(){this.loading=!0,this.shopService.getMyShop().pipe((0,qr.j)(()=>this.loading=!1)).subscribe({next:t=>{t&&(this.currentShopId=t.id,this.loadBusinessHoursFromAPI(t.id),this.loadShopStatus(t.id))},error:t=>{console.error("Error loading shop:",t),404===t.status?this.snackBar.open("No shop found. Please contact admin to assign a shop.","Close",{duration:5e3}):this.snackBar.open("Failed to load shop data.","Close",{duration:3e3})}})}loadBusinessHoursFromAPI(t){this.businessHoursService.getBusinessHours(t).subscribe({next:r=>{r&&r.length>0?this.businessHours=this.businessHoursService.convertFromBackendFormat(r):this.createDefaultBusinessHours(t)},error:r=>{console.error("Error loading business hours:",r),this.setDefaultHours(),this.snackBar.open("Failed to load business hours. Using defaults.","Close",{duration:3e3})}})}loadShopStatus(t){this.businessHoursService.getShopStatus(t).subscribe({next:r=>{this.shopStatus=r},error:r=>{console.error("Error loading shop status:",r)}})}createDefaultBusinessHours(t){this.businessHoursService.createDefaultBusinessHours(t).subscribe({next:r=>{this.businessHours=this.businessHoursService.convertFromBackendFormat(r),this.snackBar.open("Default business hours created. Please configure your schedule.","Close",{duration:3e3})},error:r=>{console.error("Error creating default hours:",r),this.setDefaultHours()}})}saveBusinessHours(){if(!this.currentShopId)return void this.snackBar.open("No shop found. Cannot save business hours.","Close",{duration:3e3});this.loading=!0;const t=this.businessHoursService.convertToBackendFormat(this.currentShopId,this.businessHours);this.businessHoursService.bulkUpdateBusinessHours(this.currentShopId,t).pipe((0,qr.j)(()=>this.loading=!1)).subscribe({next:r=>{this.businessHours=this.businessHoursService.convertFromBackendFormat(r),this.snackBar.open("Business hours saved successfully!","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),this.currentShopId&&this.loadShopStatus(this.currentShopId)},error:r=>{console.error("Error saving business hours:",r),this.snackBar.open("Failed to save business hours. Please try again.","Close",{duration:3e3})}})}onDayToggle(t){t.closed?(t.open="",t.close=""):(t.open="09:00",t.close="18:00")}copyToAllDays(){const t=this.businessHours[0];this.businessHours.forEach((r,i)=>{0!==i&&(r.open=t.open,r.close=t.close,r.closed=t.closed)}),this.snackBar.open("Monday hours copied to all days","Close",{duration:2e3})}setDefaultHours(){this.businessHours.forEach(t=>{t.open="09:00",t.close="18:00",t.closed=!1}),this.businessHours[6].closed=!0,this.snackBar.open("Default hours set (9 AM - 6 PM)","Close",{duration:2e3})}set24Hours(){this.businessHours.forEach(t=>{t.open="00:00",t.close="23:59",t.closed=!1}),this.snackBar.open("24-hour operation set for all days","Close",{duration:2e3})}closeWeekends(){this.businessHours[5].closed=!0,this.businessHours[6].closed=!0,this.snackBar.open("Weekends set to closed","Close",{duration:2e3})}openAllDays(){this.businessHours.forEach(t=>{t.closed=!1,t.open||(t.open="09:00"),t.close||(t.close="18:00")}),this.snackBar.open("All days set to open","Close",{duration:2e3})}formatTimeRange(t){return t.closed?"Closed":this.businessHoursService.formatTimeRange(t.open,t.close)}getStatusBadge(){return this.shopStatus?{text:this.shopStatus.status.replace("_"," "),color:this.businessHoursService.getStatusColor(this.shopStatus.status),icon:this.businessHoursService.getStatusIcon(this.shopStatus.status)}:{text:"Loading...",color:"#6b7280",icon:"help"}}forceUpdateStatus(){this.currentShopId&&this.businessHoursService.forceUpdateAvailability(this.currentShopId).subscribe({next:()=>{this.snackBar.open("Shop status updated!","Close",{duration:2e3}),this.loadShopStatus(this.currentShopId)},error:t=>{console.error("Error updating status:",t),this.snackBar.open("Failed to update status","Close",{duration:2e3})}})}overrideStatus(t){this.currentShopId&&this.businessHoursService.overrideAvailability(this.currentShopId,t,t?"Manual override: Opened by shop owner":"Manual override: Closed by shop owner").subscribe({next:()=>{this.snackBar.open(`Shop manually ${t?"opened":"closed"}!`,"Close",{duration:2e3}),this.loadShopStatus(this.currentShopId)},error:i=>{console.error("Error overriding status:",i),this.snackBar.open("Failed to override status","Close",{duration:2e3})}})}clearOverride(){this.currentShopId&&this.businessHoursService.clearAvailabilityOverride(this.currentShopId).subscribe({next:()=>{this.snackBar.open("Manual override cleared. Using automatic schedule.","Close",{duration:3e3}),this.loadShopStatus(this.currentShopId)},error:t=>{console.error("Error clearing override:",t),this.snackBar.open("Failed to clear override","Close",{duration:2e3})}})}formatTimeRangeLegacy(t){return t.closed?"Closed":this.businessHoursService.formatTimeRange(t.open,t.close)}removeHoliday(t){const r=this.holidays.indexOf(t);r>-1&&(this.holidays.splice(r,1),this.snackBar.open("Holiday removed","Close",{duration:2e3}))}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(b.ok),e.rXU(Ce.UG),e.rXU(Jt.s),e.rXU(us))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-business-hours"]],decls:72,vars:10,consts:[[1,"business-hours-container"],[1,"page-header"],[1,"header-content"],["class","status-badge",3,"background-color",4,"ngIf"],[1,"header-actions"],["class","status-controls",4,"ngIf"],["mat-stroked-button","",3,"click"],["mat-raised-button","","color","primary",3,"disabled","click"],["diameter","20",4,"ngIf"],[4,"ngIf"],["class","status-card",4,"ngIf"],[1,"hours-card"],[3,"formGroup"],[1,"hours-grid"],["class","day-card",4,"ngFor","ngForOf"],[1,"quick-actions"],[1,"action-buttons"],["mat-stroked-button","","type","button",3,"click"],[1,"holiday-settings"],[1,"holiday-info"],["mat-raised-button","","color","accent"],["class","holiday-list",4,"ngIf"],[1,"preview-card"],[1,"preview-list"],["class","preview-item",4,"ngFor","ngForOf"],[1,"status-badge"],[1,"status-controls"],["mat-stroked-button","","matTooltip","Force update shop status",3,"click"],["mat-stroked-button","","color","primary","matTooltip","Manually open shop now",3,"click",4,"ngIf"],["mat-stroked-button","","color","warn","matTooltip","Manually close shop now",3,"click",4,"ngIf"],["mat-stroked-button","","matTooltip","Return to automatic schedule",3,"click",4,"ngIf"],["mat-stroked-button","","color","primary","matTooltip","Manually open shop now",3,"click"],["mat-stroked-button","","color","warn","matTooltip","Manually close shop now",3,"click"],["mat-stroked-button","","matTooltip","Return to automatic schedule",3,"click"],["diameter","20"],[1,"status-card"],[1,"status-info"],[1,"status-item"],[1,"label"],[1,"value"],["class","status-item",4,"ngIf"],[1,"day-card"],[1,"day-name"],[3,"ngModel","ngModelOptions","ngModelChange","change"],[1,"time-inputs"],["appearance","outline"],["matInput","","type","time",3,"ngModel","ngModelOptions","disabled","ngModelChange"],[1,"time-separator"],["class","time-display",4,"ngIf"],["class","closed-display",4,"ngIf"],[1,"time-display"],[1,"closed-display"],[1,"holiday-list"],["class","holiday-item",4,"ngFor","ngForOf"],[1,"holiday-item"],[1,"holiday-details"],[1,"holiday-date"],[1,"holiday-name"],[1,"holiday-status"],["mat-icon-button","","color","warn",3,"click"],[1,"preview-item"],[1,"preview-day"],[1,"preview-hours"]],template:function(r,i){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),e.EFF(4,"Business Hours"),e.k0s(),e.j41(5,"p"),e.EFF(6,"Configure your shop's operating hours"),e.k0s(),e.DNE(7,gs,5,4,"div",3),e.k0s(),e.j41(8,"div",4),e.DNE(9,$c,8,3,"div",5),e.j41(10,"button",6),e.bIt("click",function(){return i.copyToAllDays()}),e.j41(11,"mat-icon"),e.EFF(12,"content_copy"),e.k0s(),e.EFF(13," Copy Monday to All "),e.k0s(),e.j41(14,"button",7),e.bIt("click",function(){return i.saveBusinessHours()}),e.DNE(15,ms,1,0,"mat-spinner",8),e.DNE(16,ia,2,0,"mat-icon",9),e.EFF(17," Save Changes "),e.k0s()()(),e.DNE(18,zc,19,8,"mat-card",10),e.j41(19,"mat-card",11)(20,"mat-card-content")(21,"form",12)(22,"div",13),e.DNE(23,Vc,21,17,"mat-card",14),e.k0s(),e.j41(24,"mat-card",15)(25,"mat-card-header")(26,"mat-card-title"),e.EFF(27,"Quick Actions"),e.k0s()(),e.j41(28,"mat-card-content")(29,"div",16)(30,"button",17),e.bIt("click",function(){return i.setDefaultHours()}),e.j41(31,"mat-icon"),e.EFF(32,"restore"),e.k0s(),e.EFF(33," Set Default Hours (9 AM - 6 PM) "),e.k0s(),e.j41(34,"button",17),e.bIt("click",function(){return i.set24Hours()}),e.j41(35,"mat-icon"),e.EFF(36,"access_time"),e.k0s(),e.EFF(37," Set 24 Hours "),e.k0s(),e.j41(38,"button",17),e.bIt("click",function(){return i.closeWeekends()}),e.j41(39,"mat-icon"),e.EFF(40,"weekend"),e.k0s(),e.EFF(41," Close Weekends "),e.k0s(),e.j41(42,"button",17),e.bIt("click",function(){return i.openAllDays()}),e.j41(43,"mat-icon"),e.EFF(44,"check_circle"),e.k0s(),e.EFF(45," Open All Days "),e.k0s()()()(),e.j41(46,"mat-card",18)(47,"mat-card-header")(48,"mat-card-title")(49,"mat-icon"),e.EFF(50,"event"),e.k0s(),e.EFF(51," Holiday Settings "),e.k0s()(),e.j41(52,"mat-card-content")(53,"div",19)(54,"p"),e.EFF(55,"Configure special hours for holidays and special occasions"),e.k0s(),e.j41(56,"button",20)(57,"mat-icon"),e.EFF(58,"add"),e.k0s(),e.EFF(59," Add Holiday "),e.k0s()(),e.DNE(60,Xc,2,1,"div",21),e.k0s()()()()(),e.j41(61,"mat-card",22)(62,"mat-card-header")(63,"mat-card-title")(64,"mat-icon"),e.EFF(65,"visibility"),e.k0s(),e.EFF(66," Preview "),e.k0s()(),e.j41(67,"mat-card-content")(68,"h3"),e.EFF(69,"Your shop will display these hours to customers:"),e.k0s(),e.j41(70,"div",23),e.DNE(71,Hc,5,4,"div",24),e.k0s()()()()),2&r&&(e.R7$(7),e.Y8G("ngIf",i.shopStatus),e.R7$(2),e.Y8G("ngIf",i.shopStatus),e.R7$(5),e.Y8G("disabled",i.loading),e.R7$(1),e.Y8G("ngIf",i.loading),e.R7$(1),e.Y8G("ngIf",!i.loading),e.R7$(2),e.Y8G("ngIf",i.shopStatus),e.R7$(3),e.Y8G("formGroup",i.businessHoursForm),e.R7$(2),e.Y8G("ngForOf",i.businessHours),e.R7$(37),e.Y8G("ngIf",i.holidays.length>0),e.R7$(11),e.Y8G("ngForOf",i.businessHours))},dependencies:[D.Sq,D.bT,b.qT,b.me,b.BC,b.cb,b.j4,b.vS,j.RN,j.m2,j.MM,j.dh,B.$z,B.iY,H.An,X.LG,ge.rl,ge.nJ,Ee.fg,qe.oV,Ae.sG,D.vh],styles:[".business-hours-container[_ngcontent-%COMP%]{padding:24px;background-color:#f5f5f5;min-height:calc(100vh - 64px)}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;background:white;padding:24px;border-radius:12px;box-shadow:0 2px 4px #0000001a}.header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 4px;font-size:2rem;font-weight:600;color:#1f2937}.header-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#6b7280}.header-actions[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center;flex-wrap:wrap}.status-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:6px 12px;border-radius:20px;color:#fff;font-size:.875rem;font-weight:500;margin-top:8px;box-shadow:0 2px 4px #0000001a}.status-badge[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;height:16px;width:16px}.status-controls[_ngcontent-%COMP%]{display:flex;gap:8px;margin-right:12px;border-right:1px solid #e5e7eb;padding-right:12px}.status-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #0000001a;margin-bottom:24px;border-left:4px solid #3b82f6}.status-info[_ngcontent-%COMP%]{display:grid;gap:12px}.status-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid #f3f4f6}.status-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.status-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#374151}.status-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-weight:600;color:#1f2937}.status-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;height:18px;width:18px}.hours-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #0000001a;margin-bottom:24px}.hours-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:16px;margin-bottom:24px}.day-card[_ngcontent-%COMP%]{border:1px solid #e5e7eb;border-radius:8px;transition:all .3s ease}.day-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0000001a;transform:translateY(-2px)}.day-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;border-radius:8px 8px 0 0;padding:12px 16px}.day-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin:0}.day-name[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:500}.time-inputs[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-top:16px}.time-inputs.disabled[_ngcontent-%COMP%]{opacity:.5;pointer-events:none}.time-separator[_ngcontent-%COMP%]{font-weight:500;color:#6b7280}.time-display[_ngcontent-%COMP%], .closed-display[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-top:12px;padding:8px 12px;border-radius:6px;font-size:.95rem}.time-display[_ngcontent-%COMP%]{background:#e0f2fe;color:#0284c7}.closed-display[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.quick-actions[_ngcontent-%COMP%], .holiday-settings[_ngcontent-%COMP%], .preview-card[_ngcontent-%COMP%]{margin-top:24px;border-radius:12px;box-shadow:0 2px 8px #0000001a}.action-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px}.holiday-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px;background:#f9fafb;border-radius:8px;margin-bottom:16px}.holiday-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#6b7280}.holiday-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.holiday-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px;border:1px solid #e5e7eb;border-radius:6px;background:white}.holiday-details[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center}.holiday-date[_ngcontent-%COMP%]{font-weight:500;color:#1f2937}.holiday-name[_ngcontent-%COMP%]{color:#6b7280}.holiday-status[_ngcontent-%COMP%]{padding:4px 8px;border-radius:4px;background:#fef3c7;color:#92400e;font-size:.875rem}.preview-list[_ngcontent-%COMP%]{display:grid;gap:12px;margin-top:16px}.preview-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:12px;border-bottom:1px solid #e5e7eb}.preview-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.preview-day[_ngcontent-%COMP%]{font-weight:500;color:#1f2937}.preview-hours[_ngcontent-%COMP%]{color:#059669;font-weight:500}.preview-hours.closed[_ngcontent-%COMP%]{color:#dc2626}mat-spinner[_ngcontent-%COMP%]{display:inline-block;margin-right:8px}@media (max-width: 768px){.business-hours-container[_ngcontent-%COMP%]{padding:16px}.page-header[_ngcontent-%COMP%]{flex-direction:column;gap:16px;text-align:center}.hours-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.time-inputs[_ngcontent-%COMP%]{flex-direction:column}.time-separator[_ngcontent-%COMP%]{display:none}.action-buttons[_ngcontent-%COMP%]{grid-template-columns:1fr}.holiday-details[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:4px}}"]})}}return n})();const Wc=["fileInput"];function oa(n,o){if(1&n&&(e.j41(0,"div",54)(1,"span",55),e.EFF(2),e.k0s(),e.j41(3,"span",56),e.EFF(4),e.k0s()()),2&n){const t=o.$implicit;e.R7$(2),e.JRh(t.value),e.R7$(2),e.JRh(t.label)}}function qc(n,o){if(1&n&&e.nrm(0,"img",57),2&n){const t=e.XpG();e.Y8G("src",t.shopLogoUrl,e.B4B)}}function Zc(n,o){1&n&&(e.j41(0,"div",58)(1,"mat-icon"),e.EFF(2,"store"),e.k0s(),e.j41(3,"span"),e.EFF(4,"Click to upload logo"),e.k0s()())}function Qc(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",59)(1,"button",60),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.triggerFileInput())}),e.j41(2,"mat-icon"),e.EFF(3,"edit"),e.k0s(),e.EFF(4," Change Logo "),e.k0s(),e.j41(5,"button",61),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.removeLogo())}),e.j41(6,"mat-icon"),e.EFF(7,"delete"),e.k0s(),e.EFF(8," Remove "),e.k0s()()}}function Jc(n,o){1&n&&(e.j41(0,"div",62),e.nrm(1,"mat-progress-bar",63),e.j41(2,"span"),e.EFF(3,"Uploading..."),e.k0s()())}function wr(n,o){if(1&n&&(e.j41(0,"mat-error"),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.R7$(1),e.JRh(t)}}function et(n,o){if(1&n&&(e.j41(0,"mat-form-field",38)(1,"mat-label"),e.EFF(2),e.k0s(),e.nrm(3,"input",67),e.j41(4,"mat-icon",68),e.EFF(5),e.k0s(),e.DNE(6,wr,2,1,"mat-error",69),e.k0s()),2&n){const t=e.XpG().$implicit,r=e.XpG();e.R7$(2),e.JRh(t.label),e.R7$(1),e.Y8G("formControlName",t.control)("readonly",!r.isEditMode),e.R7$(2),e.JRh(r.getFieldIcon(t.control)),e.R7$(1),e.Y8G("ngForOf",r.getFieldErrors(t.control))}}function vs(n,o){if(1&n&&(e.j41(0,"mat-error"),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.R7$(1),e.JRh(t)}}function Ps(n,o){if(1&n&&(e.j41(0,"mat-form-field",38)(1,"mat-label"),e.EFF(2),e.k0s(),e.nrm(3,"textarea",70),e.j41(4,"mat-icon",68),e.EFF(5),e.k0s(),e.DNE(6,vs,2,1,"mat-error",69),e.k0s()),2&n){const t=e.XpG().$implicit,r=e.XpG();e.R7$(2),e.JRh(t.label),e.R7$(1),e.Y8G("formControlName",t.control)("readonly",!r.isEditMode),e.R7$(2),e.JRh(r.getFieldIcon(t.control)),e.R7$(1),e.Y8G("ngForOf",r.getFieldErrors(t.control))}}function bs(n,o){if(1&n&&(e.j41(0,"mat-error"),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.R7$(1),e.JRh(t)}}function ks(n,o){if(1&n&&(e.j41(0,"mat-form-field",38)(1,"mat-label"),e.EFF(2),e.k0s(),e.nrm(3,"input",71),e.j41(4,"mat-icon",68),e.EFF(5),e.k0s(),e.DNE(6,bs,2,1,"mat-error",69),e.k0s()),2&n){const t=e.XpG().$implicit,r=e.XpG();e.R7$(2),e.JRh(t.label),e.R7$(1),e.Y8G("formControlName",t.control)("readonly",!r.isEditMode)("placeholder",t.placeholder),e.R7$(2),e.JRh(r.getFieldIcon(t.control)),e.R7$(1),e.Y8G("ngForOf",r.getFieldErrors(t.control))}}function aa(n,o){if(1&n&&(e.j41(0,"mat-form-field",38)(1,"mat-label"),e.EFF(2),e.k0s(),e.nrm(3,"input",72),e.j41(4,"mat-icon",68),e.EFF(5),e.k0s(),e.j41(6,"mat-icon",73),e.EFF(7,"lock"),e.k0s(),e.j41(8,"mat-hint"),e.EFF(9,"Email cannot be changed"),e.k0s()()),2&n){const t=e.XpG().$implicit,r=e.XpG();e.R7$(2),e.JRh(t.label),e.R7$(1),e.Y8G("formControlName",t.control),e.R7$(2),e.JRh(r.getFieldIcon(t.control))}}function Os(n,o){if(1&n&&(e.j41(0,"div",64)(1,"div",65),e.DNE(2,et,7,5,"mat-form-field",66),e.DNE(3,Ps,7,5,"mat-form-field",66),e.DNE(4,ks,7,6,"mat-form-field",66),e.DNE(5,aa,10,3,"mat-form-field",66),e.k0s()()),2&n){const t=o.$implicit;e.R7$(1),e.Y8G("ngSwitch",t.type),e.R7$(1),e.Y8G("ngSwitchCase","text"),e.R7$(1),e.Y8G("ngSwitchCase","textarea"),e.R7$(1),e.Y8G("ngSwitchCase","number"),e.R7$(1),e.Y8G("ngSwitchCase","email")}}function Fi(n,o){1&n&&(e.j41(0,"p",30),e.EFF(1,"No location set. Edit and click on the map to set your shop location."),e.k0s())}function ys(n,o){1&n&&e.nrm(0,"mat-spinner",79)}function Kc(n,o){1&n&&(e.j41(0,"mat-icon"),e.EFF(1,"save"),e.k0s())}function el(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",74)(1,"button",75),e.DNE(2,ys,1,0,"mat-spinner",76),e.DNE(3,Kc,2,0,"mat-icon",77),e.EFF(4),e.k0s(),e.j41(5,"button",78),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onReset())}),e.EFF(6,"Reset"),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(1),e.Y8G("disabled",t.shopForm.invalid||t.isLoading),e.R7$(1),e.Y8G("ngIf",t.isLoading),e.R7$(1),e.Y8G("ngIf",!t.isLoading),e.R7$(1),e.SpI(" ",t.isLoading?"Saving...":"Save Changes"," ")}}function tl(n,o){1&n&&(e.j41(0,"span",88),e.EFF(1,"Recurring"),e.k0s())}function nl(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",82)(1,"div",83)(2,"span",84),e.EFF(3),e.k0s(),e.j41(4,"span",85),e.EFF(5),e.nI1(6,"date"),e.k0s(),e.DNE(7,tl,2,0,"span",86),e.k0s(),e.j41(8,"button",87),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.removeHoliday(a))}),e.j41(9,"mat-icon"),e.EFF(10,"delete"),e.k0s()()()}if(2&n){const t=o.$implicit;e.R7$(3),e.JRh(t.name),e.R7$(2),e.JRh(e.i5U(6,3,t.date,"mediumDate")),e.R7$(2),e.Y8G("ngIf",t.recurring)}}function Ms(n,o){if(1&n&&(e.j41(0,"div",80),e.DNE(1,nl,11,6,"div",81),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.holidays)}}function rl(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",89)(1,"div",90)(2,"mat-icon"),e.EFF(3),e.k0s(),e.j41(4,"div",91)(5,"h4"),e.EFF(6),e.k0s(),e.j41(7,"p"),e.EFF(8),e.k0s()()(),e.j41(9,"mat-slide-toggle",92),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG();return e.Njj(l.onSettingChange(s.key,i.checked))}),e.k0s()()}if(2&n){const t=o.$implicit,r=e.XpG();e.R7$(3),e.JRh(t.icon),e.R7$(3),e.JRh(t.label),e.R7$(2),e.JRh(r.getSettingDescription(t.key)),e.R7$(1),e.Y8G("checked",t.value)}}let ro=(()=>{class n{constructor(t,r,i,a,s){this.fb=t,this.shopService=r,this.snackBar=i,this.router=a,this.shopContext=s,this.isLoading=!1,this.isEditMode=!1,this.shop=null,this.map=null,this.marker=null,this.radiusCircle=null,this.mapInitialized=!1,this.shopLogoUrl=null,this.shopLogoId=null,this.isUploadingImage=!1,this.shopStatus="Active",this.registrationDate=new Date,this.totalProducts=0,this.totalOrders=0,this.profileFieldsData=[],this.statisticsData=[],this.settingsData=[],this.selectedIndex=0,this.holidays=[],this.newHoliday={name:"",date:"",recurring:!1},this.shopForm=this.fb.group({name:["",[b.k0.required]],nameTamil:[""],description:[""],phone:["",[b.k0.required]],email:[{value:"",disabled:!0}],address:["",[b.k0.required]],city:["",[b.k0.required]],pincode:["",[b.k0.required]],upiId:[""],gstNumber:[""],panNumber:[""],fssaiCertificateNumber:[""],groceryLicenseNumber:[""],latitude:[null],longitude:[null],deliveryRadius:[5,[b.k0.required,b.k0.min(1),b.k0.max(50)]],minOrderAmount:[0],freeDeliveryAbove:[0]})}ngOnInit(){this.loadShopProfile(),this.setupProfileFieldsData(),this.setupStatisticsData(),this.setupSettingsData()}setupProfileFieldsData(){this.profileFieldsData=[{label:"Shop Name",control:"name",type:"text",placeholder:"Enter shop name"},{label:"Shop Name (Tamil)",control:"nameTamil",type:"text",placeholder:"\u0b95\u0b9f\u0bc8 \u0baa\u0bc6\u0baf\u0bb0\u0bcd \u0ba4\u0bae\u0bbf\u0bb4\u0bbf\u0bb2\u0bcd"},{label:"Description",control:"description",type:"textarea",placeholder:"Describe your shop",rows:3},{label:"Phone Number",control:"phone",type:"text",placeholder:"Enter phone number"},{label:"Email",control:"email",type:"email",placeholder:"Enter email"},{label:"Address",control:"address",type:"textarea",placeholder:"Enter shop address",rows:2},{label:"City",control:"city",type:"text",placeholder:"Enter city"},{label:"PIN Code",control:"pincode",type:"text",placeholder:"Enter PIN code"},{label:"UPI ID",control:"upiId",type:"text",placeholder:"e.g., yourname@upi"},{label:"GST Number",control:"gstNumber",type:"text",placeholder:"e.g., 22AAAAA0000A1Z5"},{label:"PAN Number",control:"panNumber",type:"text",placeholder:"e.g., ABCDE1234F"},{label:"FSSAI Certificate Number",control:"fssaiCertificateNumber",type:"text",placeholder:"e.g., 12345678901234"},{label:"Grocery License Number",control:"groceryLicenseNumber",type:"text",placeholder:"Enter grocery license number"},{label:"Latitude",control:"latitude",type:"number",placeholder:"e.g., 12.4962"},{label:"Longitude",control:"longitude",type:"number",placeholder:"e.g., 78.5722"},{label:"Delivery Radius (km)",control:"deliveryRadius",type:"number",placeholder:"e.g., 10"},{label:"Minimum Order Amount (\u20b9)",control:"minOrderAmount",type:"number",placeholder:"e.g., 100"},{label:"Free Delivery Above (\u20b9)",control:"freeDeliveryAbove",type:"number",placeholder:"e.g., 500"}]}setupStatisticsData(){this.statisticsData=[{label:"Current Status",value:this.shopStatus,icon:"info",class:"status-"+this.shopStatus.toLowerCase()},{label:"Registered On",value:this.registrationDate.toLocaleDateString(),icon:"calendar_today",class:""},{label:"Total Products",value:this.totalProducts.toString(),icon:"inventory",class:""},{label:"Total Orders",value:this.totalOrders.toString(),icon:"shopping_cart",class:""}]}toggleEditMode(){this.isEditMode=!this.isEditMode,this.isEditMode||this.onReset()}getFieldErrors(t){const r=this.shopForm.get(t),i=[];return r&&r.errors&&r.touched&&(r.errors.required&&i.push(`${this.getFieldLabel(t)} is required`),r.errors.email&&i.push("Please enter a valid email")),i}getFieldLabel(t){const r=this.profileFieldsData.find(i=>i.control===t);return r?r.label:t}setupSettingsData(){this.settingsData=[{label:"Online Ordering",key:"onlineOrdering",value:!0,type:"toggle",icon:"shopping_cart"},{label:"Delivery Service",key:"deliveryService",value:!0,type:"toggle",icon:"delivery_dining"},{label:"Pickup Service",key:"pickupService",value:!0,type:"toggle",icon:"store"},{label:"Accept Cash",key:"acceptCash",value:!0,type:"toggle",icon:"payments"},{label:"Accept Card",key:"acceptCard",value:!0,type:"toggle",icon:"credit_card"},{label:"Auto Accept Orders",key:"autoAcceptOrders",value:!1,type:"toggle",icon:"auto_mode"},{label:"SMS Notifications",key:"smsNotifications",value:!0,type:"toggle",icon:"sms"},{label:"Email Notifications",key:"emailNotifications",value:!0,type:"toggle",icon:"email"}]}onSettingChange(t,r){const i=this.settingsData.find(a=>a.key===t);i&&(i.value=r,console.log(`Setting ${t} changed to:`,r),this.snackBar.open(`${i.label} ${r?"enabled":"disabled"}`,"Close",{duration:2e3,horizontalPosition:"end",verticalPosition:"top"}))}getStatusIcon(){switch(this.shopStatus.toLowerCase()){case"active":return"check_circle";case"pending":return"schedule";case"suspended":return"block";default:return"info"}}getFieldIcon(t){return{name:"store",nameTamil:"translate",description:"description",phone:"phone",email:"email",address:"location_on",city:"location_city",pincode:"markunread_mailbox",upiId:"qr_code",gstNumber:"receipt",panNumber:"badge",fssaiCertificateNumber:"verified_user",groceryLicenseNumber:"description",latitude:"my_location",longitude:"my_location",deliveryRadius:"delivery_dining",minOrderAmount:"shopping_cart",freeDeliveryAbove:"local_shipping"}[t]||"info"}getSettingDescription(t){return{onlineOrdering:"Allow customers to place orders online",deliveryService:"Offer delivery to customer locations",pickupService:"Allow customers to pick up orders",acceptCash:"Accept cash payments for orders",acceptCard:"Accept card and digital payments",autoAcceptOrders:"Automatically accept new orders",smsNotifications:"Receive SMS alerts for orders",emailNotifications:"Receive email notifications"}[t]||"Configure this setting"}initMap(){if(!document.getElementById("shopMap")||this.mapInitialized)return;this.mapInitialized=!0;const r=di.icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),i=this.shopForm.value.latitude||12.4962,a=this.shopForm.value.longitude||78.5722;this.map=di.map("shopMap").setView([i,a],15),di.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap"}).addTo(this.map),this.shopForm.value.latitude&&this.shopForm.value.longitude&&(this.marker=di.marker([i,a],{icon:r}).addTo(this.map),this.marker.bindPopup("Shop Location").openPopup(),this.updateRadiusCircle([i,a])),this.shopForm.get("deliveryRadius")?.valueChanges.subscribe(()=>{this.marker&&this.updateRadiusCircle(this.marker.getLatLng())}),this.map.on("click",s=>{this.isEditMode||(this.isEditMode=!0);const{lat:l,lng:u}=s.latlng;this.shopForm.patchValue({latitude:parseFloat(l.toFixed(6)),longitude:parseFloat(u.toFixed(6))}),this.marker?this.marker.setLatLng(s.latlng):this.marker=di.marker(s.latlng,{icon:r}).addTo(this.map),this.marker.bindPopup("Shop Location").openPopup(),this.updateRadiusCircle(s.latlng)})}updateRadiusCircle(t){if(!this.map)return;const i=1e3*(this.shopForm.value.deliveryRadius||5);this.radiusCircle?(this.radiusCircle.setLatLng(t),this.radiusCircle.setRadius(i)):this.radiusCircle=di.circle(t,{radius:i,color:"#4CAF50",fillColor:"#4CAF50",fillOpacity:.1,weight:2,dashArray:"5, 10"}).addTo(this.map),this.map.fitBounds(this.radiusCircle.getBounds(),{padding:[20,20]})}navigateTo(t){this.router.navigate([t])}addHoliday(){if(this.newHoliday.name&&this.newHoliday.date){const t={id:Date.now(),name:this.newHoliday.name,date:new Date(this.newHoliday.date),recurring:this.newHoliday.recurring};this.holidays.push(t),this.newHoliday={name:"",date:"",recurring:!1},this.snackBar.open(`Holiday "${t.name}" added successfully`,"Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}),console.log("Holiday added:",t)}}removeHoliday(t){const r=this.holidays.indexOf(t);r>-1&&(this.holidays.splice(r,1),this.snackBar.open(`Holiday "${t.name}" removed`,"Close",{duration:2e3,horizontalPosition:"end",verticalPosition:"top"}),console.log("Holiday removed:",t))}loadShopProfile(){this.isLoading=!0,this.shopService.getMyShop().subscribe({next:t=>{t?(this.shop=t,console.log("Shop Profile data received:",t),this.shopForm.patchValue({name:t.name||"",nameTamil:t.nameTamil||"",description:t.description||"",phone:t.ownerPhone||t.phone||"",address:t.addressLine1||t.address||"",city:t.city||"",pincode:t.postalCode||t.pincode||"",upiId:t.upiId||"",gstNumber:t.gstNumber||"",panNumber:t.panNumber||"",fssaiCertificateNumber:t.fssaiCertificateNumber||"",groceryLicenseNumber:t.groceryLicenseNumber||"",latitude:t.latitude||null,longitude:t.longitude||null,deliveryRadius:t.deliveryRadius||5,minOrderAmount:t.minOrderAmount||0,freeDeliveryAbove:t.freeDeliveryAbove||0}),this.shopForm.get("email")?.setValue(t.ownerEmail||t.email||""),this.shopStatus=t.status||"ACTIVE",this.registrationDate=new Date(t.createdAt||new Date),this.totalProducts=t.productCount||0,this.totalOrders=t.totalOrders||0,this.loadShopStatistics(),this.loadShopLogo(),this.setupStatisticsData(),setTimeout(()=>this.initMap(),200)):this.handleNoShopFound(),this.isLoading=!1},error:t=>{console.error("Error loading shop profile:",t),this.isLoading=!1,404===t.status?this.handleNoShopFound():this.snackBar.open("Error loading shop profile. Please try again.","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["error-snackbar"]})}})}handleNoShopFound(){this.shopForm.patchValue({name:"",description:"",phone:"",address:"",city:"",pincode:""}),this.shopForm.get("email")?.setValue(""),this.snackBar.open("No shop found. Please contact admin to assign a shop.","Close",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["warning-snackbar"]})}loadShopStatistics(){this.shop&&this.shop.id&&(this.shopService.getTodaysOrderCount().subscribe({next:t=>{this.totalOrders=t,this.setupStatisticsData()}}),this.shopService.getTotalProductCount().subscribe({next:t=>{this.totalProducts=t,this.setupStatisticsData()}}))}onSave(){if(this.shopForm.valid&&this.shop){this.isLoading=!0;const t=this.shopForm.value.upiId;t&&t.trim()&&(localStorage.setItem("shop_upi_id",t.trim()),console.log("UPI ID saved to localStorage:",t.trim()));const r={...this.shop,name:this.shopForm.value.name,nameTamil:this.shopForm.value.nameTamil,description:this.shopForm.value.description,ownerPhone:this.shopForm.value.phone,addressLine1:this.shopForm.value.address,city:this.shopForm.value.city,postalCode:this.shopForm.value.pincode,upiId:this.shopForm.value.upiId,gstNumber:this.shopForm.value.gstNumber,panNumber:this.shopForm.value.panNumber,fssaiCertificateNumber:this.shopForm.value.fssaiCertificateNumber,groceryLicenseNumber:this.shopForm.value.groceryLicenseNumber,latitude:this.shopForm.value.latitude,longitude:this.shopForm.value.longitude,deliveryRadius:this.shopForm.value.deliveryRadius,minOrderAmount:this.shopForm.value.minOrderAmount,freeDeliveryAbove:this.shopForm.value.freeDeliveryAbove};this.shopService.updateShop(this.shop.id,r).subscribe({next:i=>{this.isLoading=!1,this.shop=i,this.isEditMode=!1,this.shopForm.patchValue({name:i.name||"",nameTamil:i.nameTamil||"",description:i.description||"",phone:i.ownerPhone||"",address:i.addressLine1||"",city:i.city||"",pincode:i.postalCode||"",upiId:i.upiId||"",gstNumber:i.gstNumber||"",panNumber:i.panNumber||"",fssaiCertificateNumber:i.fssaiCertificateNumber||"",groceryLicenseNumber:i.groceryLicenseNumber||"",latitude:i.latitude||null,longitude:i.longitude||null,deliveryRadius:i.deliveryRadius||5,minOrderAmount:i.minOrderAmount||0,freeDeliveryAbove:i.freeDeliveryAbove||0}),i.upiId&&localStorage.setItem("shop_upi_id",i.upiId),this.shopContext.refreshShop(),this.snackBar.open("Shop profile updated successfully!","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["success-snackbar"]})},error:i=>{this.isLoading=!1,console.error("Error updating shop profile:",i),this.snackBar.open("Error updating shop profile","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["error-snackbar"]})}})}}onReset(){this.loadShopProfile(),this.snackBar.open("Form reset to saved values","Close",{duration:2e3,horizontalPosition:"end",verticalPosition:"top"})}triggerFileInput(){this.fileInput.nativeElement.click()}onFileSelected(t){const r=t.target;if(r.files&&r.files.length>0){const i=r.files[0];if(!i.type.startsWith("image/"))return void this.snackBar.open("Please select an image file","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["error-snackbar"]});if(i.size>5242880)return void this.snackBar.open("Image size should be less than 5MB","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["error-snackbar"]});this.uploadImage(i)}}uploadImage(t){this.shop&&this.shop.id?(this.isUploadingImage=!0,this.shopService.uploadShopImage(this.shop.id,t,"LOGO").subscribe({next:r=>{this.isUploadingImage=!1,r&&r.imageUrl&&(this.shopLogoUrl=(0,Mr.V)(r.imageUrl),this.shopLogoId=r.id),this.snackBar.open("Shop logo uploaded successfully!","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["success-snackbar"]}),this.fileInput.nativeElement.value=""},error:r=>{this.isUploadingImage=!1,console.error("Error uploading image:",r),this.snackBar.open("Failed to upload logo. Please try again.","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["error-snackbar"]})}})):this.snackBar.open("Shop not found. Please refresh the page.","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["error-snackbar"]})}removeLogo(){!this.shop||!this.shop.id||!this.shopLogoId||(this.isUploadingImage=!0,this.shopService.deleteShopImage(this.shop.id,this.shopLogoId).subscribe({next:()=>{this.isUploadingImage=!1,this.shopLogoUrl=null,this.shopLogoId=null,this.snackBar.open("Shop logo removed successfully","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["success-snackbar"]})},error:t=>{this.isUploadingImage=!1,console.error("Error removing logo:",t),this.snackBar.open("Failed to remove logo. Please try again.","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["error-snackbar"]})}}))}loadShopLogo(){if(this.shop&&this.shop.images&&this.shop.images.length>0){const t=this.shop.images.find(r=>"LOGO"===r.imageType)||this.shop.images.find(r=>r.isPrimary)||this.shop.images[0];t&&(this.shopLogoUrl=(0,Mr.V)(t.imageUrl),this.shopLogoId=t.id)}}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(b.ok),e.rXU(Jt.s),e.rXU(Ce.UG),e.rXU(Xe.Ix),e.rXU($r.h))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-shop-profile"]],viewQuery:function(r,i){if(1&r&&e.GBs(Wc,5),2&r){let a;e.mGM(a=e.lsd())&&(i.fileInput=a.first)}},decls:161,vars:37,consts:[[1,"clean-shop-profile"],[1,"profile-header"],[1,"header-content"],[1,"shop-info"],[1,"status-badge",3,"ngClass"],[1,"header-stats"],["class","stat-item",4,"ngFor","ngForOf"],[1,"tab-navigation"],[1,"tab-button",3,"click"],[1,"tab-content-area"],[1,"tab-pane"],[1,"image-upload-section"],[1,"content-header"],[1,"logo-upload-container"],[1,"logo-preview",3,"click"],["alt","Shop Logo","class","logo-image",3,"src",4,"ngIf"],["class","logo-placeholder",4,"ngIf"],[1,"upload-overlay"],["type","file","accept","image/*",2,"display","none",3,"change"],["fileInput",""],[1,"logo-info"],[1,"logo-hint"],["class","logo-actions",4,"ngIf"],["class","upload-progress",4,"ngIf"],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"form-container"],[3,"formGroup","ngSubmit"],[1,"form-fields"],["class","field-row",4,"ngFor","ngForOf"],[1,"map-section"],[1,"map-hint"],["id","shopMap",1,"map-container",2,"height","350px"],["class","map-hint",4,"ngIf"],["class","form-actions",4,"ngIf"],[1,"hours-container"],[1,"hours-section"],[1,"holidays-section"],[1,"holiday-controls"],["appearance","outline"],["matInput","","placeholder","e.g., Christmas Day",3,"ngModel","ngModelChange"],["matInput","","type","date",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],["mat-raised-button","","color","primary",3,"click"],["class","holiday-list",4,"ngIf"],[1,"settings-container"],["class","setting-item",4,"ngFor","ngForOf"],[1,"actions-grid"],["mat-raised-button","",1,"action-button","dashboard-action",3,"click"],[1,"action-text"],["mat-raised-button","",1,"action-button","products-action",3,"click"],["mat-raised-button","",1,"action-button","orders-action",3,"click"],["mat-raised-button","",1,"action-button","customers-action",3,"click"],["mat-raised-button","",1,"action-button","analytics-action",3,"click"],["mat-raised-button","",1,"action-button","settings-action",3,"click"],[1,"stat-item"],[1,"stat-number"],[1,"stat-text"],["alt","Shop Logo",1,"logo-image",3,"src"],[1,"logo-placeholder"],[1,"logo-actions"],["mat-stroked-button","","color","primary",3,"click"],["mat-stroked-button","","color","warn",3,"click"],[1,"upload-progress"],["mode","indeterminate"],[1,"field-row"],[1,"field-group",3,"ngSwitch"],["appearance","outline",4,"ngSwitchCase"],["matInput","",3,"formControlName","readonly"],["matPrefix",""],[4,"ngFor","ngForOf"],["matInput","","rows","3",3,"formControlName","readonly"],["matInput","","type","number","step","0.000001",3,"formControlName","readonly","placeholder"],["matInput","","type","email","readonly","",3,"formControlName"],["matSuffix",""],[1,"form-actions"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["diameter","16",4,"ngIf"],[4,"ngIf"],["mat-button","","type","button",3,"click"],["diameter","16"],[1,"holiday-list"],["class","holiday-item",4,"ngFor","ngForOf"],[1,"holiday-item"],[1,"holiday-info"],[1,"holiday-name"],[1,"holiday-date"],["class","holiday-recurring",4,"ngIf"],["mat-icon-button","","color","warn",3,"click"],[1,"holiday-recurring"],[1,"setting-item"],[1,"setting-left"],[1,"setting-text"],[3,"checked","change"]],template:function(r,i){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1"),e.EFF(5),e.k0s(),e.j41(6,"p"),e.EFF(7),e.k0s(),e.j41(8,"span",4),e.EFF(9),e.k0s()(),e.j41(10,"div",5),e.DNE(11,oa,5,2,"div",6),e.k0s()()(),e.j41(12,"div",7)(13,"button",8),e.bIt("click",function(){return i.selectedIndex=0}),e.j41(14,"mat-icon"),e.EFF(15,"person"),e.k0s(),e.j41(16,"span"),e.EFF(17,"Profile"),e.k0s()(),e.j41(18,"button",8),e.bIt("click",function(){return i.selectedIndex=1}),e.j41(19,"mat-icon"),e.EFF(20,"schedule"),e.k0s(),e.j41(21,"span"),e.EFF(22,"Hours & Holidays"),e.k0s()(),e.j41(23,"button",8),e.bIt("click",function(){return i.selectedIndex=2}),e.j41(24,"mat-icon"),e.EFF(25,"settings"),e.k0s(),e.j41(26,"span"),e.EFF(27,"Settings"),e.k0s()(),e.j41(28,"button",8),e.bIt("click",function(){return i.selectedIndex=3}),e.j41(29,"mat-icon"),e.EFF(30,"dashboard"),e.k0s(),e.j41(31,"span"),e.EFF(32,"Quick Actions"),e.k0s()()(),e.j41(33,"div",9)(34,"div",10)(35,"div",11)(36,"div",12)(37,"h2"),e.EFF(38,"Shop Logo"),e.k0s()(),e.j41(39,"div",13)(40,"div",14),e.bIt("click",function(){return i.triggerFileInput()}),e.DNE(41,qc,1,1,"img",15),e.DNE(42,Zc,5,0,"div",16),e.j41(43,"div",17)(44,"mat-icon"),e.EFF(45,"cloud_upload"),e.k0s(),e.j41(46,"span"),e.EFF(47,"Upload New Logo"),e.k0s()()(),e.j41(48,"input",18,19),e.bIt("change",function(s){return i.onFileSelected(s)}),e.k0s(),e.j41(50,"div",20)(51,"p",21),e.EFF(52,"Recommended: 200x200 pixels, PNG or JPG format"),e.k0s(),e.DNE(53,Qc,9,0,"div",22),e.DNE(54,Jc,4,0,"div",23),e.k0s()()(),e.j41(55,"div",12)(56,"h2"),e.EFF(57,"Shop Information"),e.k0s(),e.j41(58,"button",24),e.bIt("click",function(){return i.toggleEditMode()}),e.j41(59,"mat-icon"),e.EFF(60),e.k0s(),e.EFF(61),e.k0s()(),e.j41(62,"div",25)(63,"form",26),e.bIt("ngSubmit",function(){return i.onSave()}),e.j41(64,"div",27),e.DNE(65,Os,6,5,"div",28),e.k0s(),e.j41(66,"div",29)(67,"h3"),e.EFF(68,"Shop Location on Map"),e.k0s(),e.j41(69,"p",30),e.EFF(70,"Click on the map to set your shop location. The latitude and longitude will update automatically."),e.k0s(),e.nrm(71,"div",31),e.DNE(72,Fi,2,0,"p",32),e.k0s(),e.DNE(73,el,7,4,"div",33),e.k0s()()(),e.j41(74,"div",10)(75,"div",12)(76,"h2"),e.EFF(77,"Business Hours & Holidays"),e.k0s()(),e.j41(78,"div",34)(79,"div",35)(80,"h3"),e.EFF(81,"Regular Hours"),e.k0s(),e.nrm(82,"app-business-hours"),e.k0s(),e.j41(83,"div",36)(84,"h3"),e.EFF(85,"Holiday Settings"),e.k0s(),e.j41(86,"div",37)(87,"mat-form-field",38)(88,"mat-label"),e.EFF(89,"Holiday Name"),e.k0s(),e.j41(90,"input",39),e.bIt("ngModelChange",function(s){return i.newHoliday.name=s}),e.k0s()(),e.j41(91,"mat-form-field",38)(92,"mat-label"),e.EFF(93,"Holiday Date"),e.k0s(),e.j41(94,"input",40),e.bIt("ngModelChange",function(s){return i.newHoliday.date=s}),e.k0s()(),e.j41(95,"mat-checkbox",41),e.bIt("ngModelChange",function(s){return i.newHoliday.recurring=s}),e.EFF(96,"Recurring Annually"),e.k0s(),e.j41(97,"button",42),e.bIt("click",function(){return i.addHoliday()}),e.j41(98,"mat-icon"),e.EFF(99,"add"),e.k0s(),e.EFF(100," Add Holiday "),e.k0s()(),e.DNE(101,Ms,2,1,"div",43),e.k0s()()(),e.j41(102,"div",10)(103,"div",12)(104,"h2"),e.EFF(105,"Shop Settings"),e.k0s()(),e.j41(106,"div",44),e.DNE(107,rl,10,4,"div",45),e.k0s()(),e.j41(108,"div",10)(109,"div",12)(110,"h2"),e.EFF(111,"Quick Actions"),e.k0s()(),e.j41(112,"div",46)(113,"button",47),e.bIt("click",function(){return i.navigateTo("/shop-owner/dashboard")}),e.j41(114,"mat-icon"),e.EFF(115,"dashboard"),e.k0s(),e.j41(116,"div",48)(117,"span"),e.EFF(118,"Dashboard"),e.k0s(),e.j41(119,"small"),e.EFF(120,"View analytics & overview"),e.k0s()()(),e.j41(121,"button",49),e.bIt("click",function(){return i.navigateTo("/shop-owner/my-products")}),e.j41(122,"mat-icon"),e.EFF(123,"inventory"),e.k0s(),e.j41(124,"div",48)(125,"span"),e.EFF(126,"My Products"),e.k0s(),e.j41(127,"small"),e.EFF(128,"Manage inventory"),e.k0s()()(),e.j41(129,"button",50),e.bIt("click",function(){return i.navigateTo("/shop-owner/orders-management")}),e.j41(130,"mat-icon"),e.EFF(131,"receipt_long"),e.k0s(),e.j41(132,"div",48)(133,"span"),e.EFF(134,"Orders"),e.k0s(),e.j41(135,"small"),e.EFF(136,"Track customer orders"),e.k0s()()(),e.j41(137,"button",51),e.bIt("click",function(){return i.navigateTo("/shop-owner/customers")}),e.j41(138,"mat-icon"),e.EFF(139,"people"),e.k0s(),e.j41(140,"div",48)(141,"span"),e.EFF(142,"Customers"),e.k0s(),e.j41(143,"small"),e.EFF(144,"Customer management"),e.k0s()()(),e.j41(145,"button",52),e.bIt("click",function(){return i.navigateTo("/shop-owner/analytics")}),e.j41(146,"mat-icon"),e.EFF(147,"analytics"),e.k0s(),e.j41(148,"div",48)(149,"span"),e.EFF(150,"Analytics"),e.k0s(),e.j41(151,"small"),e.EFF(152,"Business insights"),e.k0s()()(),e.j41(153,"button",53),e.bIt("click",function(){return i.navigateTo("/shop-owner/settings")}),e.j41(154,"mat-icon"),e.EFF(155,"settings"),e.k0s(),e.j41(156,"div",48)(157,"span"),e.EFF(158,"Settings"),e.k0s(),e.j41(159,"small"),e.EFF(160,"Shop configuration"),e.k0s()()()()()()()),2&r&&(e.R7$(5),e.JRh((null==i.shop?null:i.shop.name)||"My Shop"),e.R7$(2),e.JRh((null==i.shop?null:i.shop.description)||"Manage your shop profile and settings"),e.R7$(1),e.Y8G("ngClass","status-"+i.shopStatus.toLowerCase()),e.R7$(1),e.SpI(" ",i.shopStatus," "),e.R7$(2),e.Y8G("ngForOf",i.statisticsData),e.R7$(2),e.AVh("active",0===i.selectedIndex),e.R7$(5),e.AVh("active",1===i.selectedIndex),e.R7$(5),e.AVh("active",2===i.selectedIndex),e.R7$(5),e.AVh("active",3===i.selectedIndex),e.R7$(6),e.AVh("active",0===i.selectedIndex),e.R7$(7),e.Y8G("ngIf",i.shopLogoUrl),e.R7$(1),e.Y8G("ngIf",!i.shopLogoUrl),e.R7$(11),e.Y8G("ngIf",i.shopLogoUrl),e.R7$(1),e.Y8G("ngIf",i.isUploadingImage),e.R7$(4),e.Y8G("disabled",i.isLoading),e.R7$(2),e.JRh(i.isEditMode?"close":"edit"),e.R7$(1),e.SpI(" ",i.isEditMode?"Cancel":"Edit"," "),e.R7$(2),e.Y8G("formGroup",i.shopForm),e.R7$(2),e.Y8G("ngForOf",i.profileFieldsData),e.R7$(7),e.Y8G("ngIf",!i.shopForm.value.latitude),e.R7$(1),e.Y8G("ngIf",i.isEditMode),e.R7$(1),e.AVh("active",1===i.selectedIndex),e.R7$(16),e.Y8G("ngModel",i.newHoliday.name),e.R7$(4),e.Y8G("ngModel",i.newHoliday.date),e.R7$(1),e.Y8G("ngModel",i.newHoliday.recurring),e.R7$(6),e.Y8G("ngIf",i.holidays.length>0),e.R7$(1),e.AVh("active",2===i.selectedIndex),e.R7$(5),e.Y8G("ngForOf",i.settingsData),e.R7$(1),e.AVh("active",3===i.selectedIndex))},dependencies:[D.YU,D.Sq,D.bT,D.ux,D.e1,b.qT,b.me,b.Q0,b.BC,b.cb,b.j4,b.JD,b.vS,B.$z,B.iY,H.An,X.LG,ge.rl,ge.nJ,ge.MV,ge.TL,ge.JW,ge.yw,Ee.fg,it.So,Ae.sG,Ke.HM,Cs,D.vh],styles:[".clean-shop-profile[_ngcontent-%COMP%]{background:#f8fafc;min-height:100vh;padding:0;margin:-24px}.profile-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#16a34a 0%,#4ade80 100%);color:#fff;padding:24px}.header-content[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;display:flex;justify-content:space-between;align-items:center}.shop-info[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:600;margin:0 0 8px}.shop-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 12px;opacity:.9;font-size:.95rem}.status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:12px;font-size:.8rem;font-weight:500;background:rgba(255,255,255,.2)}.status-badge.status-active[_ngcontent-%COMP%]{background:rgba(34,197,94,.9)}.status-badge.status-pending[_ngcontent-%COMP%]{background:rgba(251,146,60,.9)}.status-badge.status-suspended[_ngcontent-%COMP%]{background:rgba(239,68,68,.9)}.header-stats[_ngcontent-%COMP%]{display:flex;gap:32px}.stat-item[_ngcontent-%COMP%]{text-align:center}.stat-number[_ngcontent-%COMP%]{display:block;font-size:1.5rem;font-weight:700;margin-bottom:4px}.stat-text[_ngcontent-%COMP%]{font-size:.8rem;opacity:.9}.tab-navigation[_ngcontent-%COMP%]{background:white;border-bottom:1px solid #e5e7eb;padding:0 24px;display:flex}.tab-button[_ngcontent-%COMP%]{background:none;border:none;padding:16px 24px;display:flex;align-items:center;gap:8px;cursor:pointer;color:#6b7280;font-weight:500;border-bottom:2px solid transparent;transition:all .2s ease}.tab-button[_ngcontent-%COMP%]:hover{color:#16a34a;background:#f0fdf4}.tab-button.active[_ngcontent-%COMP%]{color:#16a34a;border-bottom-color:#4ade80;background:#f0fdf4}.tab-content-area[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:24px}.tab-pane[_ngcontent-%COMP%]{display:none}.tab-pane.active[_ngcontent-%COMP%]{display:block}.content-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.content-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:#111827;margin:0}.form-container[_ngcontent-%COMP%]{background:white;border-radius:8px;box-shadow:0 1px 3px #0000001a;padding:24px}.form-fields[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:20px}.field-row[_ngcontent-%COMP%]{margin-bottom:16px}.field-group[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.form-actions[_ngcontent-%COMP%]{margin-top:24px;padding-top:24px;border-top:1px solid #e5e7eb;display:flex;gap:12px}.hours-container[_ngcontent-%COMP%]{background:white;border-radius:8px;box-shadow:0 1px 3px #0000001a;padding:24px}.hours-section[_ngcontent-%COMP%], .holidays-section[_ngcontent-%COMP%]{margin-bottom:32px}.hours-section[_ngcontent-%COMP%]:last-child, .holidays-section[_ngcontent-%COMP%]:last-child{margin-bottom:0}.hours-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .holidays-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:600;color:#111827;margin:0 0 16px}.holiday-controls[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr auto auto;gap:16px;align-items:end;margin-bottom:24px}.holiday-list[_ngcontent-%COMP%]{border:1px solid #e5e7eb;border-radius:6px;overflow:hidden}.holiday-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid #e5e7eb}.holiday-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.holiday-info[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center}.holiday-name[_ngcontent-%COMP%]{font-weight:500;color:#111827}.holiday-date[_ngcontent-%COMP%]{color:#6b7280;font-size:.9rem}.holiday-recurring[_ngcontent-%COMP%]{background:#dcfce7;color:#166534;padding:2px 8px;border-radius:4px;font-size:.8rem}.settings-container[_ngcontent-%COMP%]{background:white;border-radius:8px;box-shadow:0 1px 3px #0000001a;padding:24px}.setting-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 0;border-bottom:1px solid #e5e7eb}.setting-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.setting-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.setting-left[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#16a34a;width:20px;height:20px;font-size:20px}.setting-text[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 4px;font-size:1rem;font-weight:500;color:#111827}.setting-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.875rem;color:#6b7280}.actions-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px}.action-button[_ngcontent-%COMP%]{display:flex!important;align-items:center;gap:12px;padding:16px!important;text-align:left;height:auto!important;border-radius:8px!important;transition:all .2s ease;border:1px solid #e5e7eb;background:white!important;color:#111827!important;box-shadow:0 1px 3px #0000001a}.action-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.action-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:24px;height:24px;font-size:24px}.dashboard-action[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#16a34a}.products-action[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#10b981}.orders-action[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#f59e0b}.customers-action[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#8b5cf6}.analytics-action[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#ef4444}.settings-action[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#6b7280}.action-text[_ngcontent-%COMP%]{display:flex;flex-direction:column}.action-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1rem;font-weight:500;color:#111827}.action-text[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:.8rem;color:#6b7280;margin-top:2px}.image-upload-section[_ngcontent-%COMP%]{background:white;border-radius:8px;box-shadow:0 1px 3px #0000001a;padding:24px;margin-bottom:24px}.logo-upload-container[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:24px}.logo-preview[_ngcontent-%COMP%]{width:150px;height:150px;border-radius:12px;border:2px dashed #d1d5db;display:flex;align-items:center;justify-content:center;cursor:pointer;position:relative;overflow:hidden;background:#f9fafb;transition:all .3s ease}.logo-preview[_ngcontent-%COMP%]:hover{border-color:#4ade80;background:#f0fdf4}.logo-preview[_ngcontent-%COMP%]:hover   .upload-overlay[_ngcontent-%COMP%]{opacity:1}.logo-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:10px}.logo-placeholder[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:8px;color:#9ca3af}.logo-placeholder[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px}.logo-placeholder[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.85rem;text-align:center}.upload-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:rgba(74,222,128,.9);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:8px;color:#fff;opacity:0;transition:opacity .3s ease;border-radius:10px}.upload-overlay[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px}.upload-overlay[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.85rem;font-weight:500}.logo-info[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:12px}.logo-hint[_ngcontent-%COMP%]{color:#6b7280;font-size:.9rem;margin:0}.logo-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.upload-progress[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.upload-progress[_ngcontent-%COMP%]   mat-progress-bar[_ngcontent-%COMP%]{flex:1;max-width:200px}.upload-progress[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#16a34a;font-size:.9rem}.map-section[_ngcontent-%COMP%]{margin-top:24px;padding-top:24px;border-top:1px solid #e5e7eb}.map-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:#111827;margin:0 0 12px}.map-container[_ngcontent-%COMP%]{border-radius:8px;overflow:hidden;box-shadow:0 1px 3px #0000001a}.map-hint[_ngcontent-%COMP%]{margin:8px 0 0;font-size:.85rem;color:#6b7280}@media (max-width: 768px){.clean-shop-profile[_ngcontent-%COMP%]{margin:-16px}.profile-header[_ngcontent-%COMP%]{padding:16px}.header-content[_ngcontent-%COMP%]{flex-direction:column;gap:16px;text-align:center}.header-stats[_ngcontent-%COMP%]{gap:16px}.tab-navigation[_ngcontent-%COMP%]{padding:0 16px;overflow-x:auto;white-space:nowrap}.tab-button[_ngcontent-%COMP%]{padding:12px 16px;font-size:.9rem}.tab-content-area[_ngcontent-%COMP%]{padding:16px}.form-fields[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}.holiday-controls[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px}.actions-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.content-header[_ngcontent-%COMP%]{flex-direction:column;gap:12px;align-items:stretch}.form-actions[_ngcontent-%COMP%]{flex-direction:column}.logo-upload-container[_ngcontent-%COMP%]{flex-direction:column;align-items:center}.logo-preview[_ngcontent-%COMP%]{width:120px;height:120px}.logo-info[_ngcontent-%COMP%]{text-align:center;align-items:center}.logo-actions[_ngcontent-%COMP%]{flex-direction:column;width:100%}.logo-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}"]})}}return n})();function il(n,o){1&n&&(e.j41(0,"div",48),e.nrm(1,"mat-spinner"),e.j41(2,"p"),e.EFF(3,"Loading shop information..."),e.k0s()())}function ol(n,o){1&n&&(e.j41(0,"span",49)(1,"mat-icon"),e.EFF(2,"verified"),e.k0s(),e.EFF(3," Verified "),e.k0s())}function al(n,o){if(1&n&&(e.j41(0,"div",50)(1,"span",51),e.EFF(2),e.k0s(),e.j41(3,"span",52),e.EFF(4),e.k0s()()),2&n){const t=o.$implicit;e.R7$(2),e.JRh(t.day),e.R7$(1),e.AVh("closed",t.isClosed),e.R7$(1),e.SpI(" ",t.isClosed?"Closed":t.hours," ")}}function sl(n,o){if(1&n&&(e.j41(0,"mat-icon"),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.R7$(1),e.JRh(t)}}function cl(n,o){if(1&n&&(e.j41(0,"div",53)(1,"div",54)(2,"mat-icon"),e.EFF(3),e.k0s()(),e.j41(4,"div",55)(5,"h4",56),e.EFF(6),e.k0s(),e.j41(7,"p",57),e.EFF(8),e.k0s(),e.j41(9,"span",58),e.EFF(10),e.nI1(11,"date"),e.k0s()()()),2&n){const t=o.$implicit;e.R7$(2),e.HbH(t.type),e.R7$(1),e.JRh(t.icon),e.R7$(3),e.JRh(t.title),e.R7$(2),e.JRh(t.description),e.R7$(2),e.JRh(e.i5U(11,6,t.time,"short"))}}let sa=(()=>{class n{constructor(t,r){this.authService=t,this.shopService=r,this.shopData={name:"Raghavendra Stores",description:"Your neighborhood grocery store with fresh products and daily essentials. We pride ourselves on quality products and excellent customer service.",phone:"+91 9876543210",email:"raghavendra.stores@email.com",address:"123 Main Street, Gandhi Nagar",city:"Bangalore",pincode:"560001",status:"Active",isVerified:!0,logoUrl:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iNDAiIGN5PSI0MCIgcj0iNDAiIGZpbGw9IiM2MzY2RjEiLz4KPHRleHQgeD0iNDAiIHk9IjQwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCIgZmlsbD0id2hpdGUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIyNCIgZm9udC13ZWlnaHQ9ImJvbGQiPlJTPC90ZXh0Pgo8L3N2Zz4="},this.businessHours=[{day:"Monday",hours:"9:00 AM - 9:00 PM",isClosed:!1},{day:"Tuesday",hours:"9:00 AM - 9:00 PM",isClosed:!1},{day:"Wednesday",hours:"9:00 AM - 9:00 PM",isClosed:!1},{day:"Thursday",hours:"9:00 AM - 9:00 PM",isClosed:!1},{day:"Friday",hours:"9:00 AM - 9:00 PM",isClosed:!1},{day:"Saturday",hours:"9:00 AM - 10:00 PM",isClosed:!1},{day:"Sunday",hours:"10:00 AM - 8:00 PM",isClosed:!1}],this.shopStats={todayOrders:23,weeklyOrders:156,monthlyRevenue:89500,totalCustomers:892,averageRating:4.5,responseTime:"< 15 min",deliverySuccess:96},this.recentActivities=[{title:"New Order Received",description:"Order #ORD-456 for \u20b9850 from Priya Sharma",time:new Date,icon:"shopping_cart",type:"order"},{title:"Product Added",description:"Fresh Organic Bananas added to inventory",time:new Date(Date.now()-72e5),icon:"add_box",type:"product"},{title:"Profile Updated",description:"Business hours updated for weekends",time:new Date(Date.now()-144e5),icon:"edit",type:"update"}],this.deliverySettings={radius:5,minimumOrder:100,charge:30,freeAbove:500},this.loading=!1,this.currentUser$=this.authService.currentUser$}ngOnInit(){this.loadShopOverview()}loadShopOverview(){this.loading=!0;const t=this.authService.getCurrentUser();if(!t||!t.shopId)return console.warn("No shop ID found for current user"),void(this.loading=!1);this.shopService.getShopById(t.shopId).subscribe({next:r=>{this.shopData={name:r.name||"My Shop",description:r.description||"Shop description not provided",phone:r.contactNumber||r.phone||"+91 9876543210",email:r.email||"shop@email.com",address:r.address||"123 Main Street",city:r.city||"City",pincode:r.pincode||"000000",status:r.status||"Active",isVerified:r.verified||!1,logoUrl:r.logoUrl||this.generateShopLogo(r.name)},this.loading=!1},error:r=>{console.error("Error loading shop data:",r),this.loading=!1}}),this.loadShopStatistics(t.shopId)}loadShopStatistics(t){this.shopService.getShopAnalytics(t).subscribe({next:r=>{this.shopStats={todayOrders:r.todayOrders||23,weeklyOrders:r.weeklyOrders||156,monthlyRevenue:r.monthlyRevenue||89500,totalCustomers:r.totalCustomers||892,averageRating:r.averageRating||4.5,responseTime:r.responseTime||"< 15 min",deliverySuccess:r.deliverySuccess||96}},error:r=>{console.error("Error loading shop statistics:",r)}})}generateShopLogo(t){const r=t.split(" ").map(i=>i[0]).join("").substring(0,2).toUpperCase();return`data:image/svg+xml;base64,${btoa(`\n      <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <circle cx="40" cy="40" r="40" fill="#6366F1"/>\n        <text x="40" y="40" text-anchor="middle" dominant-baseline="central" fill="white" font-family="Arial" font-size="24" font-weight="bold">${r}</text>\n      </svg>\n    `)}`}getStatusIcon(t){switch(t.toLowerCase()){case"active":return"check_circle";case"pending":return"schedule";case"suspended":return"block";default:return"help"}}getStars(t){const r=[],i=Math.floor(t),a=t%1!=0;for(let l=0;l<i;l++)r.push("star");a&&r.push("star_half");const s=5-Math.ceil(t);for(let l=0;l<s;l++)r.push("star_border");return r}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(Gt.u),e.rXU(Jt.s))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-shop-overview"]],decls:167,vars:33,consts:[[1,"shop-overview-container"],["class","loading-container",4,"ngIf"],[1,"shop-header-card"],[1,"shop-header-content"],[1,"shop-branding"],[1,"shop-logo"],[1,"shop-logo-img",3,"src","alt"],[1,"shop-logo-fallback"],[1,"shop-info"],[1,"shop-name"],[1,"shop-description"],[1,"shop-badges"],[1,"status-badge"],["class","verification-badge",4,"ngIf"],[1,"shop-actions"],["mat-raised-button","","color","primary","routerLink","/shop-owner/shop/profile"],["mat-stroked-button","","routerLink","/shop-owner/settings"],[1,"details-grid"],[1,"detail-card"],[1,"contact-item"],[1,"contact-details"],[1,"contact-label"],[1,"contact-value"],[1,"card-actions"],["mat-button","","routerLink","/shop-owner/business-hours"],[1,"hours-list"],["class","hours-item",4,"ngFor","ngForOf"],[1,"detail-card","metrics-card"],[1,"metrics-grid"],[1,"metric-item"],[1,"metric-value"],[1,"metric-label"],[1,"metric-stars"],[4,"ngFor","ngForOf"],[1,"detail-card","activity-card"],[1,"activity-timeline"],["class","activity-item",4,"ngFor","ngForOf"],[1,"detail-card","stats-card"],[1,"quick-stats"],[1,"stat-item"],[1,"stat-number"],[1,"stat-label"],[1,"stat-change","positive"],["mat-button","","routerLink","/shop-owner/delivery"],[1,"delivery-info"],[1,"delivery-item"],[1,"delivery-label"],[1,"delivery-value"],[1,"loading-container"],[1,"verification-badge"],[1,"hours-item"],[1,"day-name"],[1,"day-hours"],[1,"activity-item"],[1,"activity-icon"],[1,"activity-content"],[1,"activity-title"],[1,"activity-description"],[1,"activity-time"]],template:function(r,i){1&r&&(e.j41(0,"div",0),e.DNE(1,il,4,0,"div",1),e.j41(2,"mat-card",2)(3,"div",3)(4,"div",4)(5,"div",5),e.nrm(6,"img",6),e.j41(7,"div",7)(8,"mat-icon"),e.EFF(9,"storefront"),e.k0s()()(),e.j41(10,"div",8)(11,"h1",9),e.EFF(12),e.k0s(),e.j41(13,"p",10),e.EFF(14),e.k0s(),e.j41(15,"div",11)(16,"span",12)(17,"mat-icon"),e.EFF(18),e.k0s(),e.EFF(19),e.k0s(),e.DNE(20,ol,4,0,"span",13),e.k0s()()(),e.j41(21,"div",14)(22,"button",15)(23,"mat-icon"),e.EFF(24,"edit"),e.k0s(),e.EFF(25," Edit Profile "),e.k0s(),e.j41(26,"button",16)(27,"mat-icon"),e.EFF(28,"settings"),e.k0s(),e.EFF(29," Settings "),e.k0s()()()(),e.j41(30,"div",17)(31,"mat-card",18)(32,"mat-card-header")(33,"mat-card-title")(34,"mat-icon"),e.EFF(35,"contact_phone"),e.k0s(),e.EFF(36," Contact Information "),e.k0s()(),e.j41(37,"mat-card-content")(38,"div",19)(39,"mat-icon"),e.EFF(40,"phone"),e.k0s(),e.j41(41,"div",20)(42,"span",21),e.EFF(43,"Phone"),e.k0s(),e.j41(44,"span",22),e.EFF(45),e.k0s()()(),e.j41(46,"div",19)(47,"mat-icon"),e.EFF(48,"email"),e.k0s(),e.j41(49,"div",20)(50,"span",21),e.EFF(51,"Email"),e.k0s(),e.j41(52,"span",22),e.EFF(53),e.k0s()()(),e.j41(54,"div",19)(55,"mat-icon"),e.EFF(56,"location_on"),e.k0s(),e.j41(57,"div",20)(58,"span",21),e.EFF(59,"Address"),e.k0s(),e.j41(60,"span",22),e.EFF(61),e.k0s()()()()(),e.j41(62,"mat-card",18)(63,"mat-card-header")(64,"mat-card-title")(65,"mat-icon"),e.EFF(66,"schedule"),e.k0s(),e.EFF(67," Business Hours "),e.k0s(),e.j41(68,"div",23)(69,"button",24),e.EFF(70,"Update"),e.k0s()()(),e.j41(71,"mat-card-content")(72,"div",25),e.DNE(73,al,5,4,"div",26),e.k0s()()(),e.j41(74,"mat-card",27)(75,"mat-card-header")(76,"mat-card-title")(77,"mat-icon"),e.EFF(78,"trending_up"),e.k0s(),e.EFF(79," Performance Metrics "),e.k0s()(),e.j41(80,"mat-card-content")(81,"div",28)(82,"div",29)(83,"div",30),e.EFF(84),e.k0s(),e.j41(85,"div",31),e.EFF(86,"Average Rating"),e.k0s(),e.j41(87,"div",32),e.DNE(88,sl,2,1,"mat-icon",33),e.k0s()(),e.j41(89,"div",29)(90,"div",30),e.EFF(91),e.k0s(),e.j41(92,"div",31),e.EFF(93,"Response Time"),e.k0s()(),e.j41(94,"div",29)(95,"div",30),e.EFF(96),e.k0s(),e.j41(97,"div",31),e.EFF(98,"Delivery Success"),e.k0s()(),e.j41(99,"div",29)(100,"div",30),e.EFF(101),e.k0s(),e.j41(102,"div",31),e.EFF(103,"Total Customers"),e.k0s()()()()(),e.j41(104,"mat-card",34)(105,"mat-card-header")(106,"mat-card-title")(107,"mat-icon"),e.EFF(108,"history"),e.k0s(),e.EFF(109," Recent Activity "),e.k0s()(),e.j41(110,"mat-card-content")(111,"div",35),e.DNE(112,cl,12,9,"div",36),e.k0s()()(),e.j41(113,"mat-card",37)(114,"mat-card-header")(115,"mat-card-title")(116,"mat-icon"),e.EFF(117,"analytics"),e.k0s(),e.EFF(118," This Month "),e.k0s()(),e.j41(119,"mat-card-content")(120,"div",38)(121,"div",39)(122,"div",40),e.EFF(123),e.nI1(124,"currency"),e.k0s(),e.j41(125,"div",41),e.EFF(126,"Revenue"),e.k0s(),e.j41(127,"div",42),e.EFF(128,"+15.3%"),e.k0s()(),e.j41(129,"div",39)(130,"div",40),e.EFF(131),e.k0s(),e.j41(132,"div",41),e.EFF(133,"Orders"),e.k0s(),e.j41(134,"div",42),e.EFF(135,"+8.2%"),e.k0s()()()()(),e.j41(136,"mat-card",18)(137,"mat-card-header")(138,"mat-card-title")(139,"mat-icon"),e.EFF(140,"local_shipping"),e.k0s(),e.EFF(141," Delivery Settings "),e.k0s(),e.j41(142,"div",23)(143,"button",43),e.EFF(144,"Update"),e.k0s()()(),e.j41(145,"mat-card-content")(146,"div",44)(147,"div",45)(148,"span",46),e.EFF(149,"Delivery Radius"),e.k0s(),e.j41(150,"span",47),e.EFF(151),e.k0s()(),e.j41(152,"div",45)(153,"span",46),e.EFF(154,"Minimum Order"),e.k0s(),e.j41(155,"span",47),e.EFF(156),e.k0s()(),e.j41(157,"div",45)(158,"span",46),e.EFF(159,"Delivery Charge"),e.k0s(),e.j41(160,"span",47),e.EFF(161),e.k0s()(),e.j41(162,"div",45)(163,"span",46),e.EFF(164,"Free Delivery Above"),e.k0s(),e.j41(165,"span",47),e.EFF(166),e.k0s()()()()()()()),2&r&&(e.R7$(1),e.Y8G("ngIf",i.loading),e.R7$(5),e.Y8G("src",i.shopData.logoUrl,e.B4B)("alt",i.shopData.name),e.R7$(6),e.JRh(i.shopData.name),e.R7$(2),e.JRh(i.shopData.description),e.R7$(2),e.HbH("status-"+i.shopData.status.toLowerCase()),e.R7$(2),e.JRh(i.getStatusIcon(i.shopData.status)),e.R7$(1),e.SpI(" ",i.shopData.status," "),e.R7$(1),e.Y8G("ngIf",i.shopData.isVerified),e.R7$(25),e.JRh(i.shopData.phone),e.R7$(8),e.JRh(i.shopData.email),e.R7$(8),e.E5c("",i.shopData.address,", ",i.shopData.city," - ",i.shopData.pincode,""),e.R7$(12),e.Y8G("ngForOf",i.businessHours),e.R7$(11),e.JRh(i.shopStats.averageRating.toFixed(1)),e.R7$(4),e.Y8G("ngForOf",i.getStars(i.shopStats.averageRating)),e.R7$(3),e.JRh(i.shopStats.responseTime),e.R7$(5),e.SpI("",i.shopStats.deliverySuccess,"%"),e.R7$(5),e.JRh(i.shopStats.totalCustomers),e.R7$(11),e.Y8G("ngForOf",i.recentActivities),e.R7$(11),e.JRh(e.ii3(124,28,i.shopStats.monthlyRevenue,"INR","symbol","1.0-0")),e.R7$(8),e.JRh(i.shopStats.weeklyOrders),e.R7$(20),e.SpI("",i.deliverySettings.radius," km"),e.R7$(5),e.SpI("\u20b9",i.deliverySettings.minimumOrder,""),e.R7$(5),e.SpI("\u20b9",i.deliverySettings.charge,""),e.R7$(5),e.SpI("\u20b9",i.deliverySettings.freeAbove,""))},dependencies:[D.Sq,D.bT,Xe.Wk,j.RN,j.m2,j.MM,j.dh,B.$z,H.An,X.LG,D.oe,D.vh],styles:[".shop-overview-container[_ngcontent-%COMP%]{padding:24px;background-color:#f5f5f5;min-height:calc(100vh - 64px)}.shop-header-card[_ngcontent-%COMP%]{margin-bottom:24px;border-radius:12px;box-shadow:0 4px 12px #0000001a}.shop-header-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:24px;padding:8px}.shop-branding[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;flex:1}.shop-logo[_ngcontent-%COMP%]{position:relative;width:80px;height:80px;border-radius:50%;overflow:hidden;border:3px solid #e5e7eb}.shop-logo-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.shop-logo-fallback[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;display:flex;align-items:center;justify-content:center}.shop-logo-fallback[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px}.shop-name[_ngcontent-%COMP%]{font-size:2rem;font-weight:600;margin:0 0 8px;color:#1f2937}.shop-description[_ngcontent-%COMP%]{font-size:1rem;color:#6b7280;margin:0 0 12px;line-height:1.5}.shop-badges[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.status-badge[_ngcontent-%COMP%], .verification-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:4px 12px;border-radius:20px;font-size:.8rem;font-weight:500;text-transform:uppercase}.status-badge.status-active[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.status-badge.status-pending[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.verification-badge[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.shop-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.details-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:16px}.detail-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #0000001a}.detail-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{background:#f8f9fa;margin:-16px -16px 16px;padding:16px;border-radius:12px 12px 0 0}.detail-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:1.1rem;font-weight:500}.card-actions[_ngcontent-%COMP%]{margin-left:auto}.contact-item[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px;margin-bottom:16px}.contact-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#6b7280;margin-top:2px}.contact-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.contact-label[_ngcontent-%COMP%]{font-size:.8rem;color:#6b7280;font-weight:500}.contact-value[_ngcontent-%COMP%]{font-size:.9rem;color:#374151}.hours-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.hours-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid #f3f4f6}.day-name[_ngcontent-%COMP%]{font-weight:500;color:#374151}.day-hours[_ngcontent-%COMP%]{font-size:.9rem;color:#16a34a}.day-hours.closed[_ngcontent-%COMP%]{color:#dc2626}.metrics-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:16px}.metric-item[_ngcontent-%COMP%]{text-align:center}.metric-value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:#1f2937;margin-bottom:4px}.metric-label[_ngcontent-%COMP%]{font-size:.8rem;color:#6b7280;margin-bottom:4px}.metric-stars[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:2px}.metric-stars[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;color:#fbbf24}.activity-timeline[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.activity-item[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px}.activity-icon[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:#f3f4f6;flex-shrink:0}.activity-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;color:#6b7280}.activity-icon.order[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#2563eb}.activity-icon.product[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#16a34a}.activity-icon.update[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#f59e0b}.activity-title[_ngcontent-%COMP%]{font-size:.9rem;font-weight:600;margin:0 0 2px;color:#374151}.activity-description[_ngcontent-%COMP%]{font-size:.8rem;color:#6b7280;margin:0 0 4px}.activity-time[_ngcontent-%COMP%]{font-size:.7rem;color:#9ca3af}.quick-stats[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.stat-item[_ngcontent-%COMP%]{text-align:center}.stat-number[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:#1f2937;margin-bottom:4px}.stat-label[_ngcontent-%COMP%]{font-size:.8rem;color:#6b7280;margin-bottom:4px}.stat-change[_ngcontent-%COMP%]{font-size:.8rem;font-weight:500;padding:2px 6px;border-radius:12px}.stat-change.positive[_ngcontent-%COMP%]{background:#dcfce7;color:#16a34a}.delivery-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.delivery-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid #f3f4f6}.delivery-label[_ngcontent-%COMP%]{font-weight:500;color:#374151}.delivery-value[_ngcontent-%COMP%]{font-size:.9rem;color:#6b7280;font-weight:600}@media (max-width: 768px){.shop-overview-container[_ngcontent-%COMP%]{padding:16px}.shop-header-content[_ngcontent-%COMP%]{flex-direction:column;text-align:center}.details-grid[_ngcontent-%COMP%], .metrics-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.shop-name[_ngcontent-%COMP%]{font-size:1.5rem}}"]})}}return n})();var xr=E(152),Ei=E(3294);function ws(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Price is required "),e.k0s())}function io(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Price must be greater than 0 "),e.k0s())}function jt(n,o){1&n&&(e.j41(0,"mat-form-field",3)(1,"mat-label"),e.EFF(2,"Cost Price (\u20b9)"),e.k0s(),e.nrm(3,"input",11),e.k0s())}function Kt(n,o){if(1&n&&(e.j41(0,"div",12)(1,"p",13)(2,"strong"),e.EFF(3,"Profit Margin:"),e.k0s(),e.EFF(4),e.k0s()()),2&n){const t=e.XpG();e.R7$(4),e.Lme(" \u20b9",t.getProfit()," (",t.getProfitPercentage(),"%) ")}}let Ao=(()=>{class n{constructor(t,r,i){this.fb=t,this.dialogRef=r,this.data=i,this.priceForm=this.fb.group({price:[i.currentPrice,[b.k0.required,b.k0.min(.01)]],costPrice:[i.costPrice||0,[b.k0.min(0)]]})}onSubmit(){if(this.priceForm.valid){const t={price:this.priceForm.get("price")?.value,costPrice:this.priceForm.get("costPrice")?.value};this.dialogRef.close(t)}}onCancel(){this.dialogRef.close()}getProfit(){const t=this.priceForm.get("price")?.value||0,r=this.priceForm.get("costPrice")?.value||0;return Math.max(0,t-r)}getProfitPercentage(){this.priceForm.get("price");const r=this.priceForm.get("costPrice")?.value||0;return 0===r?"0":(this.getProfit()/r*100).toFixed(1)}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(b.ok),e.rXU(Pe.CP),e.rXU(Pe.Vh))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-price-update-dialog"]],decls:18,vars:7,consts:[["mat-dialog-title",""],[3,"formGroup","ngSubmit"],[1,"price-form"],["appearance","outline",1,"full-width"],["matInput","","type","number","formControlName","price","step","0.01","min","0"],[4,"ngIf"],["appearance","outline","class","full-width",4,"ngIf"],["class","price-info",4,"ngIf"],["align","end"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["matInput","","type","number","formControlName","costPrice","step","0.01","min","0"],[1,"price-info"],[1,"margin-info"]],template:function(r,i){if(1&r&&(e.j41(0,"h2",0),e.EFF(1),e.k0s(),e.j41(2,"form",1),e.bIt("ngSubmit",function(){return i.onSubmit()}),e.j41(3,"mat-dialog-content")(4,"div",2)(5,"mat-form-field",3)(6,"mat-label"),e.EFF(7,"Current Price (\u20b9)"),e.k0s(),e.nrm(8,"input",4),e.DNE(9,ws,2,0,"mat-error",5),e.DNE(10,io,2,0,"mat-error",5),e.k0s(),e.DNE(11,jt,4,0,"mat-form-field",6),e.DNE(12,Kt,5,2,"div",7),e.k0s()(),e.j41(13,"mat-dialog-actions",8)(14,"button",9),e.bIt("click",function(){return i.onCancel()}),e.EFF(15,"Cancel"),e.k0s(),e.j41(16,"button",10),e.EFF(17," Update Price "),e.k0s()()()),2&r){let a,s,l;e.R7$(1),e.SpI("Update Price - ",i.data.productName,""),e.R7$(1),e.Y8G("formGroup",i.priceForm),e.R7$(7),e.Y8G("ngIf",null==(a=i.priceForm.get("price"))?null:a.hasError("required")),e.R7$(1),e.Y8G("ngIf",null==(s=i.priceForm.get("price"))?null:s.hasError("min")),e.R7$(1),e.Y8G("ngIf",i.data.costPrice),e.R7$(1),e.Y8G("ngIf",i.data.costPrice&&(null==(l=i.priceForm.get("price"))?null:l.value)&&(null==(l=i.priceForm.get("costPrice"))?null:l.value)),e.R7$(4),e.Y8G("disabled",i.priceForm.invalid)}},dependencies:[D.bT,b.qT,b.me,b.Q0,b.BC,b.cb,b.VZ,b.j4,b.JD,B.$z,ge.rl,ge.nJ,ge.TL,Ee.fg,Pe.BI,Pe.Yi,Pe.E7],styles:[".price-form[_ngcontent-%COMP%]{min-width:400px;padding:16px 0}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.price-info[_ngcontent-%COMP%]{background:#f5f5f5;padding:12px;border-radius:4px;margin-top:16px}.margin-info[_ngcontent-%COMP%]{margin:0;color:#333}mat-dialog-actions[_ngcontent-%COMP%]{margin-top:16px}"]})}}return n})();function Si(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Stock quantity is required "),e.k0s())}function Ti(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Stock quantity cannot be negative "),e.k0s())}function ca(n,o){1&n&&(e.j41(0,"span"),e.EFF(1,"+"),e.k0s())}function Pt(n,o){if(1&n&&(e.j41(0,"div",12)(1,"p")(2,"strong"),e.EFF(3,"Change:"),e.k0s(),e.DNE(4,ca,2,0,"span",6),e.EFF(5),e.k0s()()),2&n){const t=e.XpG();e.R7$(1),e.AVh("positive",t.getStockChange()>0)("negative",t.getStockChange()<0),e.R7$(3),e.Y8G("ngIf",t.getStockChange()>0),e.R7$(1),e.Lme("",t.getStockChange()," ",t.data.unit||"units"," ")}}let cn=(()=>{class n{constructor(t,r,i){this.fb=t,this.dialogRef=r,this.data=i,this.stockForm=this.fb.group({stockQuantity:[i.currentStock,[b.k0.required,b.k0.min(0)]],reason:[""]})}onSubmit(){if(this.stockForm.valid){const t={stockQuantity:this.stockForm.get("stockQuantity")?.value,reason:this.stockForm.get("reason")?.value};this.dialogRef.close(t)}}onCancel(){this.dialogRef.close()}getStockChange(){return(this.stockForm.get("stockQuantity")?.value||0)-this.data.currentStock}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(b.ok),e.rXU(Pe.CP),e.rXU(Pe.Vh))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-stock-update-dialog"]],decls:29,vars:9,consts:[["mat-dialog-title",""],[3,"formGroup","ngSubmit"],[1,"stock-form"],[1,"current-stock-info"],["appearance","outline",1,"full-width"],["matInput","","type","number","formControlName","stockQuantity","min","0","step","1"],[4,"ngIf"],["matInput","","formControlName","reason","rows","2","placeholder","e.g., New stock arrived, Inventory correction, etc."],["class","stock-change",4,"ngIf"],["align","end"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"stock-change"]],template:function(r,i){if(1&r&&(e.j41(0,"h2",0),e.EFF(1),e.k0s(),e.j41(2,"form",1),e.bIt("ngSubmit",function(){return i.onSubmit()}),e.j41(3,"mat-dialog-content")(4,"div",2)(5,"div",3)(6,"p")(7,"strong"),e.EFF(8,"Current Stock:"),e.k0s(),e.EFF(9),e.k0s()(),e.j41(10,"mat-form-field",4)(11,"mat-label"),e.EFF(12,"New Stock Quantity"),e.k0s(),e.nrm(13,"input",5),e.j41(14,"mat-hint"),e.EFF(15),e.k0s(),e.DNE(16,Si,2,0,"mat-error",6),e.DNE(17,Ti,2,0,"mat-error",6),e.k0s(),e.j41(18,"mat-form-field",4)(19,"mat-label"),e.EFF(20,"Update Reason (Optional)"),e.k0s(),e.j41(21,"textarea",7),e.EFF(22,"            "),e.k0s()(),e.DNE(23,Pt,6,7,"div",8),e.k0s()(),e.j41(24,"mat-dialog-actions",9)(25,"button",10),e.bIt("click",function(){return i.onCancel()}),e.EFF(26,"Cancel"),e.k0s(),e.j41(27,"button",11),e.EFF(28," Update Stock "),e.k0s()()()),2&r){let a,s;e.R7$(1),e.SpI("Update Stock - ",i.data.productName,""),e.R7$(1),e.Y8G("formGroup",i.stockForm),e.R7$(7),e.Lme(" ",i.data.currentStock," ",i.data.unit||"units",""),e.R7$(6),e.JRh(i.data.unit||"units"),e.R7$(1),e.Y8G("ngIf",null==(a=i.stockForm.get("stockQuantity"))?null:a.hasError("required")),e.R7$(1),e.Y8G("ngIf",null==(s=i.stockForm.get("stockQuantity"))?null:s.hasError("min")),e.R7$(6),e.Y8G("ngIf",0!==i.getStockChange()),e.R7$(4),e.Y8G("disabled",i.stockForm.invalid)}},dependencies:[D.bT,b.qT,b.me,b.Q0,b.BC,b.cb,b.VZ,b.j4,b.JD,B.$z,ge.rl,ge.nJ,ge.MV,ge.TL,Ee.fg,Pe.BI,Pe.Yi,Pe.E7],styles:[".stock-form[_ngcontent-%COMP%]{min-width:400px;padding:16px 0}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.current-stock-info[_ngcontent-%COMP%]{background:#f5f5f5;padding:12px;border-radius:4px;margin-bottom:16px}.current-stock-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#333}.stock-change[_ngcontent-%COMP%]{background:#f5f5f5;padding:12px;border-radius:4px;margin-top:16px}.stock-change[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.positive[_ngcontent-%COMP%]{color:#4caf50}.negative[_ngcontent-%COMP%]{color:#f44336}mat-dialog-actions[_ngcontent-%COMP%]{margin-top:16px}"]})}}return n})();function la(n,o){1&n&&(e.j41(0,"mat-form-field",5)(1,"mat-label"),e.EFF(2,"New Price (\u20b9)"),e.k0s(),e.nrm(3,"input",15),e.j41(4,"span",16),e.EFF(5,"\u20b9\xa0"),e.k0s()())}function Do(n,o){1&n&&(e.j41(0,"mat-form-field",5)(1,"mat-label"),e.EFF(2,"Percentage Change"),e.k0s(),e.nrm(3,"input",17),e.j41(4,"span",18),e.EFF(5,"%"),e.k0s(),e.j41(6,"mat-hint"),e.EFF(7,"Enter positive for increase, negative for decrease (e.g., 10 or -5)"),e.k0s()())}function lr(n,o){if(1&n&&(e.j41(0,"div",23)(1,"div",24)(2,"span",25),e.EFF(3),e.k0s(),e.j41(4,"div",26)(5,"span",27),e.EFF(6),e.nI1(7,"number"),e.k0s(),e.j41(8,"mat-icon"),e.EFF(9,"arrow_forward"),e.k0s(),e.j41(10,"span",28),e.EFF(11),e.nI1(12,"number"),e.k0s()()()()),2&n){const t=o.$implicit,r=e.XpG(2);e.R7$(3),e.JRh(t.customName),e.R7$(3),e.SpI("\u20b9",e.i5U(7,3,t.price,"1.0-0"),""),e.R7$(5),e.SpI("\u20b9",e.i5U(12,6,r.getPreviewPrice(t.price),"1.0-0"),"")}}function ll(n,o){if(1&n&&(e.j41(0,"div",29)(1,"span"),e.EFF(2),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(2),e.SpI("...and ",t.data.products.length-3," more products")}}function jo(n,o){if(1&n&&(e.j41(0,"div",19)(1,"h3"),e.EFF(2,"Preview (First 3 products)"),e.k0s(),e.j41(3,"div",20),e.DNE(4,lr,13,9,"div",21),e.DNE(5,ll,3,1,"div",22),e.k0s()()),2&n){const t=e.XpG();e.R7$(4),e.Y8G("ngForOf",t.data.products.slice(0,3)),e.R7$(1),e.Y8G("ngIf",t.data.products.length>3)}}function ui(n,o){1&n&&(e.j41(0,"div",30)(1,"mat-icon"),e.EFF(2,"info"),e.k0s(),e.j41(3,"span"),e.EFF(4,"Demo mode: Changes will be applied locally only"),e.k0s()())}let dn=(()=>{class n{constructor(t,r,i){this.fb=t,this.dialogRef=r,this.data=i,this.bulkUpdateForm=this.fb.group({priceType:["fixed",b.k0.required],newPrice:[null],percentage:[null]}),this.bulkUpdateForm.get("priceType")?.valueChanges.subscribe(a=>{const s=this.bulkUpdateForm.get("newPrice"),l=this.bulkUpdateForm.get("percentage");"fixed"===a?(s?.setValidators([b.k0.required,b.k0.min(0)]),l?.clearValidators()):"percentage"===a&&(l?.setValidators([b.k0.required]),s?.clearValidators()),s?.updateValueAndValidity(),l?.updateValueAndValidity()})}onCancel(){this.dialogRef.close()}onUpdate(){if(this.bulkUpdateForm.valid){const t=this.bulkUpdateForm.value;this.dialogRef.close({priceType:t.priceType,newPrice:t.newPrice,percentage:t.percentage})}}getPreviewPrice(t){const r=this.bulkUpdateForm.value;return"fixed"===r.priceType&&r.newPrice?r.newPrice:"percentage"===r.priceType&&r.percentage?t*(1+r.percentage/100):t}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(b.ok),e.rXU(Pe.CP),e.rXU(Pe.Vh))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-bulk-price-update-dialog"]],decls:26,vars:7,consts:[[1,"bulk-price-dialog"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-content"],[1,"selected-count"],[1,"update-form",3,"formGroup"],["appearance","outline",1,"full-width"],["formControlName","priceType"],["value","fixed"],["value","percentage"],["appearance","outline","class","full-width",4,"ngIf"],["class","preview-section",4,"ngIf"],["class","warning-message",4,"ngIf"],["mat-dialog-actions","","align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"disabled","click"],["matInput","","type","number","formControlName","newPrice","placeholder","Enter new price"],["matPrefix",""],["matInput","","type","number","formControlName","percentage","placeholder","Enter percentage (+ or -)"],["matSuffix",""],[1,"preview-section"],[1,"preview-list"],["class","preview-item",4,"ngFor","ngForOf"],["class","more-indicator",4,"ngIf"],[1,"preview-item"],[1,"product-info"],[1,"product-name"],[1,"price-comparison"],[1,"current-price"],[1,"new-price"],[1,"more-indicator"],[1,"warning-message"]],template:function(r,i){if(1&r&&(e.j41(0,"div",0)(1,"h2",1),e.EFF(2,"Bulk Price Update"),e.k0s(),e.j41(3,"div",2)(4,"p",3)(5,"mat-icon"),e.EFF(6,"inventory"),e.k0s(),e.EFF(7),e.k0s(),e.j41(8,"form",4)(9,"mat-form-field",5)(10,"mat-label"),e.EFF(11,"Update Type"),e.k0s(),e.j41(12,"mat-select",6)(13,"mat-option",7),e.EFF(14,"Set Fixed Price"),e.k0s(),e.j41(15,"mat-option",8),e.EFF(16,"Percentage Increase/Decrease"),e.k0s()()(),e.DNE(17,la,6,0,"mat-form-field",9),e.DNE(18,Do,8,0,"mat-form-field",9),e.k0s(),e.DNE(19,jo,6,2,"div",10),e.DNE(20,ui,5,0,"div",11),e.k0s(),e.j41(21,"div",12)(22,"button",13),e.bIt("click",function(){return i.onCancel()}),e.EFF(23,"Cancel"),e.k0s(),e.j41(24,"button",14),e.bIt("click",function(){return i.onUpdate()}),e.EFF(25," Update Prices "),e.k0s()()()),2&r){let a,s;e.R7$(7),e.SpI(" Update prices for ",i.data.products.length," selected products "),e.R7$(1),e.Y8G("formGroup",i.bulkUpdateForm),e.R7$(9),e.Y8G("ngIf","fixed"===(null==(a=i.bulkUpdateForm.get("priceType"))?null:a.value)),e.R7$(1),e.Y8G("ngIf","percentage"===(null==(s=i.bulkUpdateForm.get("priceType"))?null:s.value)),e.R7$(1),e.Y8G("ngIf",i.bulkUpdateForm.valid),e.R7$(1),e.Y8G("ngIf",i.data.usingFallbackData),e.R7$(4),e.Y8G("disabled",!i.bulkUpdateForm.valid)}},dependencies:[D.Sq,D.bT,b.qT,b.me,b.Q0,b.BC,b.cb,b.j4,b.JD,B.$z,H.An,ge.rl,ge.nJ,ge.MV,ge.JW,ge.yw,Ee.fg,ze.VO,Bt.wT,Pe.BI,Pe.Yi,Pe.E7,D.QX],styles:[".bulk-price-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]{padding:20px;max-width:600px}.bulk-price-dialog[_ngcontent-%COMP%]   .selected-count[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:20px;padding:12px;background-color:#e3f2fd;border-radius:8px;font-weight:500;color:#1976d2}.bulk-price-dialog[_ngcontent-%COMP%]   .selected-count[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#1976d2}.bulk-price-dialog[_ngcontent-%COMP%]   .update-form[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.bulk-price-dialog[_ngcontent-%COMP%]   .preview-section[_ngcontent-%COMP%]{margin-top:24px;padding:16px;border:1px solid #e0e0e0;border-radius:8px;background-color:#fafafa}.bulk-price-dialog[_ngcontent-%COMP%]   .preview-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:16px;color:#333;font-size:16px}.bulk-price-dialog[_ngcontent-%COMP%]   .preview-section[_ngcontent-%COMP%]   .preview-list[_ngcontent-%COMP%]   .preview-item[_ngcontent-%COMP%]{padding:8px 0;border-bottom:1px solid #eee}.bulk-price-dialog[_ngcontent-%COMP%]   .preview-section[_ngcontent-%COMP%]   .preview-list[_ngcontent-%COMP%]   .preview-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.bulk-price-dialog[_ngcontent-%COMP%]   .preview-section[_ngcontent-%COMP%]   .preview-list[_ngcontent-%COMP%]   .preview-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-name[_ngcontent-%COMP%]{font-weight:500;display:block;margin-bottom:4px}.bulk-price-dialog[_ngcontent-%COMP%]   .preview-section[_ngcontent-%COMP%]   .preview-list[_ngcontent-%COMP%]   .preview-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .price-comparison[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:14px}.bulk-price-dialog[_ngcontent-%COMP%]   .preview-section[_ngcontent-%COMP%]   .preview-list[_ngcontent-%COMP%]   .preview-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .price-comparison[_ngcontent-%COMP%]   .current-price[_ngcontent-%COMP%]{color:#666;text-decoration:line-through}.bulk-price-dialog[_ngcontent-%COMP%]   .preview-section[_ngcontent-%COMP%]   .preview-list[_ngcontent-%COMP%]   .preview-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .price-comparison[_ngcontent-%COMP%]   .new-price[_ngcontent-%COMP%]{color:#1976d2;font-weight:500}.bulk-price-dialog[_ngcontent-%COMP%]   .preview-section[_ngcontent-%COMP%]   .preview-list[_ngcontent-%COMP%]   .preview-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .price-comparison[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;color:#999}.bulk-price-dialog[_ngcontent-%COMP%]   .preview-section[_ngcontent-%COMP%]   .preview-list[_ngcontent-%COMP%]   .more-indicator[_ngcontent-%COMP%]{text-align:center;padding:12px;color:#666;font-style:italic;font-size:14px}.bulk-price-dialog[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-top:16px;padding:8px 12px;background-color:#fff3e0;color:#ef6c00;border-radius:4px;font-size:14px}.bulk-price-dialog[_ngcontent-%COMP%]   .warning-message[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}"]})}}return n})();var He=E(7673);let Gr=(()=>{class n{constructor(t){this.http=t,this.apiUrl=`${Oe.c.apiUrl}`}getShopProducts(t,r=0,i=20){const a=(new gt.Nl).set("page",r.toString()).set("size",i.toString());return this.http.get(`${this.apiUrl}/shop-products/my-products`,{params:a}).pipe((0,vt.n)(s=>(0,He.of)(s.data?.content||[])),(0,wt.W)(()=>{const s=[{id:1,name:"Chicken Biryani",description:"Authentic Hyderabadi chicken biryani with aromatic basmati rice",category:"Main Course",price:250,stockQuantity:50,unit:"plates",status:"ACTIVE",primaryImageUrl:"/assets/images/biryani.jpg",isActive:!0,lowStockThreshold:10,sku:"CB001",shopId:t,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:2,name:"Mutton Curry",description:"Spicy mutton curry with traditional South Indian spices",category:"Main Course",price:320,stockQuantity:5,unit:"plates",status:"ACTIVE",primaryImageUrl:"/assets/images/mutton-curry.jpg",isActive:!0,lowStockThreshold:10,sku:"MC001",shopId:t,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}];return(0,He.of)(s)}))}getProductById(t){return this.http.get(`${this.apiUrl}/products/${t}`).pipe((0,vt.n)(r=>(0,He.of)(r.data)),(0,wt.W)(()=>{const r={id:t,name:"Mock Product",description:"Mock product description",category:"Mock Category",price:100,stockQuantity:20,unit:"pieces",status:"ACTIVE",isActive:!0,lowStockThreshold:5,shopId:57,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};return(0,He.of)(r)}))}createProduct(t){return this.http.post(`${this.apiUrl}/products`,t).pipe((0,vt.n)(r=>(0,He.of)(r.data)),(0,wt.W)(()=>{const r={id:Math.floor(1e4*Math.random()),...t,status:"ACTIVE",isActive:!0,primaryImageUrl:"/assets/images/default-product.jpg",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};return(0,He.of)(r)}))}updateProduct(t){return this.http.put(`${this.apiUrl}/products/${t.id}`,t).pipe((0,vt.n)(r=>(0,He.of)(r.data)),(0,wt.W)(()=>{const r={...t,id:t.id,isActive:!0,status:"ACTIVE",primaryImageUrl:"/assets/images/default-product.jpg",updatedAt:(new Date).toISOString(),createdAt:(new Date).toISOString()};return(0,He.of)(r)}))}deleteProduct(t){return this.http.delete(`${this.apiUrl}/products/${t}`).pipe((0,vt.n)(()=>(0,He.of)(!0)),(0,wt.W)(()=>(0,He.of)(!0)))}updateStock(t){return this.http.put(`${this.apiUrl}/products/${t.productId}/stock`,t).pipe((0,vt.n)(r=>(0,He.of)(r.data)),(0,wt.W)(()=>this.getProductById(t.productId).pipe((0,vt.n)(r=>{const i={...r,stockQuantity:t.newQuantity,updatedAt:(new Date).toISOString()};return(0,He.of)(i)}))))}updatePrice(t,r){return this.http.put(`${this.apiUrl}/products/${t}/price`,{price:r}).pipe((0,vt.n)(a=>(0,He.of)(a.data)),(0,wt.W)(()=>this.getProductById(t).pipe((0,vt.n)(a=>{const s={...a,price:r,updatedAt:(new Date).toISOString()};return(0,He.of)(s)}))))}toggleProductStatus(t){return this.http.put(`${this.apiUrl}/products/${t}/toggle-status`,{}).pipe((0,vt.n)(r=>(0,He.of)(r.data)),(0,wt.W)(()=>this.getProductById(t).pipe((0,vt.n)(r=>{const i={...r,isActive:!r.isActive,status:r.isActive?"INACTIVE":"ACTIVE",updatedAt:(new Date).toISOString()};return(0,He.of)(i)}))))}uploadProductImage(t,r,i){const a=new FormData;return a.append("images",i),this.http.post(`${this.apiUrl}/products/images/shop/${t}/${r}`,a).pipe((0,vt.n)(s=>{if(console.log("Upload response:",s),s&&s.data&&s.data.length>0){const l=s.data[0];return console.log("Image data from server:",l),(0,He.of)({id:l.id,imageUrl:l.imageUrl,isPrimary:l.isPrimary})}return(0,He.of)(null)}),(0,wt.W)(s=>{console.error("Error uploading image:",s);const l=`uploads/products/shop/${t}/product_${r}_${Date.now()}.jpg`;return(0,He.of)({imageUrl:l})}))}getProductImages(t,r){return this.http.get(`${this.apiUrl}/products/images/shop/${t}/${r}`).pipe((0,vt.n)(i=>(0,He.of)(i&&i.data?i.data:[])),(0,wt.W)(()=>(0,He.of)([])))}searchProducts(t,r){const i=(new gt.Nl).set("search",r);return this.http.get(`${this.apiUrl}/shops/${t}/products/search`,{params:i}).pipe((0,vt.n)(a=>(0,He.of)(a.data||[])),(0,wt.W)(()=>this.getShopProducts(t).pipe((0,vt.n)(a=>{const s=a.filter(l=>l.name.toLowerCase().includes(r.toLowerCase())||l.description.toLowerCase().includes(r.toLowerCase()));return(0,He.of)(s)}))))}getProductsByCategory(t,r){const i=(new gt.Nl).set("category",r);return this.http.get(`${this.apiUrl}/shops/${t}/products/category`,{params:i}).pipe((0,vt.n)(a=>(0,He.of)(a.data||[])),(0,wt.W)(()=>this.getShopProducts(t).pipe((0,vt.n)(a=>{const s=a.filter(l=>l.category===r);return(0,He.of)(s)}))))}getLowStockProducts(t){return this.http.get(`${this.apiUrl}/shops/${t}/products/low-stock`).pipe((0,vt.n)(r=>(0,He.of)(r.data||[])),(0,wt.W)(()=>this.getShopProducts(t).pipe((0,vt.n)(r=>{const i=r.filter(a=>a.stockQuantity<=a.lowStockThreshold);return(0,He.of)(i)}))))}getProductCategories(t){return this.http.get(`${this.apiUrl}/shops/${t}/categories`).pipe((0,vt.n)(r=>(0,He.of)(r.data||[])),(0,wt.W)(()=>(0,He.of)(["Main Course","Appetizers","Desserts","Beverages","Snacks"])))}bulkUpdatePrices(t,r){return this.http.put(`${this.apiUrl}/shops/${t}/products/bulk-price-update`,{updates:r}).pipe((0,vt.n)(()=>(0,He.of)(!0)),(0,wt.W)(()=>(0,He.of)(!0)))}bulkUpdateStock(t,r){return this.http.put(`${this.apiUrl}/shops/${t}/products/bulk-stock-update`,{updates:r}).pipe((0,vt.n)(()=>(0,He.of)(!0)),(0,wt.W)(()=>(0,He.of)(!0)))}getMasterProducts(t=0,r=20,i){let a=(new gt.Nl).set("page",t.toString()).set("size",r.toString());return i&&(a=a.set("search",i)),this.http.get(`${this.apiUrl}/products/master`,{params:a}).pipe((0,vt.n)(s=>(0,He.of)(s.data||[])),(0,wt.W)(()=>(0,He.of)([{id:1,name:"Organic Rice Basmati",description:"Premium quality organic basmati rice",sku:"RICE-ORG-001",brand:"Organic India",category:{name:"Grocery",id:1},baseUnit:"kg",baseWeight:1,status:"ACTIVE",isFeatured:!0,primaryImageUrl:"/assets/images/rice.jpg"},{id:2,name:"Fresh Milk",description:"Pure cow milk",sku:"MILK-FRESH-001",brand:"Amul",category:{name:"Dairy",id:2},baseUnit:"liter",baseWeight:1,status:"ACTIVE",isFeatured:!1,primaryImageUrl:"/assets/images/milk.jpg"}])))}getAvailableMasterProducts(t=0,r=20,i,a,s){let l=(new gt.Nl).set("page",t.toString()).set("size",r.toString());return i&&(l=l.set("search",i)),a&&(l=l.set("categoryId",a.toString())),s&&(l=l.set("brand",s)),this.http.get(`${this.apiUrl}/shop-products/available-master-products`,{params:l}).pipe((0,vt.n)(u=>(0,He.of)(u.data||{content:[],totalElements:0})),(0,wt.W)(()=>{const u=[{id:3,name:"Organic Tomatoes",description:"Fresh organic tomatoes from local farms",sku:"TOM-ORG-001",brand:"Fresh Farm",category:{name:"Vegetables",id:3},baseUnit:"kg",baseWeight:1,status:"ACTIVE",isFeatured:!0,primaryImageUrl:"/assets/images/tomatoes.jpg",images:[{imageUrl:"/assets/images/tomatoes.jpg",isPrimary:!0}]},{id:4,name:"Premium Chicken",description:"Fresh chicken from organic farms",sku:"CHK-PREM-001",brand:"Organic Meat",category:{name:"Meat",id:4},baseUnit:"kg",baseWeight:1,status:"ACTIVE",isFeatured:!1,primaryImageUrl:"/assets/images/chicken.jpg",images:[{imageUrl:"/assets/images/chicken.jpg",isPrimary:!0}]}];return(0,He.of)({content:u,totalElements:u.length})}))}assignProductToShop(t,r){return this.http.post(`${this.apiUrl}/shops/${t}/products`,{masterProductId:r.masterProductId,price:r.price,stockQuantity:r.stockQuantity||0,customName:r.customName,customDescription:r.customDescription,isAvailable:!0,status:"ACTIVE"}).pipe((0,vt.n)(a=>(0,He.of)(a.data)),(0,wt.W)(()=>{const a={id:Math.floor(1e4*Math.random()),name:r.customName||"Assigned Product",description:r.customDescription||"Product assigned from master catalog",category:"General",price:r.price,stockQuantity:r.stockQuantity||0,unit:"piece",status:"ACTIVE",isActive:!0,lowStockThreshold:10,shopId:t,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};return(0,He.of)(a)}))}getMasterProductSuggestions(t,r=10){if(!t||t.trim().length<2)return(0,He.of)([]);const i=(new gt.Nl).set("query",t.trim()).set("limit",r.toString());return this.http.get(`${this.apiUrl}/products/master/suggestions`,{params:i}).pipe((0,vt.n)(a=>(0,He.of)(a.data||[])),(0,wt.W)(a=>(console.error("Error fetching suggestions:",a),(0,He.of)([]))))}createSuggestionStream(t,r=10){return t.pipe((0,xr.B)(300),(0,Ei.F)(),(0,vt.n)(i=>this.getMasterProductSuggestions(i,r)))}static{this.\u0275fac=function(r){return new(r||n)(e.KVO(gt.Qq))}}static{this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function oo(n,o){1&n&&(e.j41(0,"div",14),e.nrm(1,"mat-spinner",15),e.j41(2,"p"),e.EFF(3,"Loading master products..."),e.k0s()())}function da(n,o){1&n&&(e.j41(0,"div",31)(1,"mat-icon"),e.EFF(2,"star"),e.k0s()())}function ao(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",18)(1,"div",19),e.nrm(2,"img",20),e.DNE(3,da,3,0,"div",21),e.k0s(),e.j41(4,"div",22)(5,"h3",23),e.EFF(6),e.k0s(),e.j41(7,"p",24),e.EFF(8),e.k0s(),e.j41(9,"div",25)(10,"span",26),e.EFF(11),e.k0s(),e.j41(12,"span",27),e.EFF(13),e.k0s(),e.j41(14,"span",28),e.EFF(15),e.k0s()(),e.j41(16,"div",29)(17,"mat-icon"),e.EFF(18,"straighten"),e.k0s(),e.j41(19,"span"),e.EFF(20),e.k0s()()(),e.j41(21,"div",30)(22,"button",13),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.selectProduct(a))}),e.EFF(23),e.k0s()()()}if(2&n){const t=o.$implicit,r=e.XpG(2);e.AVh("selected",(null==r.selectedProduct?null:r.selectedProduct.id)===t.id),e.R7$(2),e.Y8G("src",t.primaryImageUrl||"/assets/images/no-image.png",e.B4B)("alt",t.name),e.R7$(1),e.Y8G("ngIf",t.isFeatured),e.R7$(3),e.JRh(t.name),e.R7$(2),e.JRh(t.description),e.R7$(3),e.JRh(t.category.name||"No Category"),e.R7$(2),e.JRh(t.brand),e.R7$(2),e.SpI("SKU: ",t.sku,""),e.R7$(5),e.Lme("",t.baseWeight," ",t.baseUnit,""),e.R7$(2),e.Y8G("disabled",(null==r.selectedProduct?null:r.selectedProduct.id)===t.id),e.R7$(1),e.SpI(" ",(null==r.selectedProduct?null:r.selectedProduct.id)===t.id?"Selected":"Select"," ")}}function ua(n,o){if(1&n&&(e.j41(0,"div",16),e.DNE(1,ao,24,14,"div",17),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.masterProducts)}}function ga(n,o){1&n&&(e.j41(0,"div",32)(1,"mat-icon"),e.EFF(2,"search_off"),e.k0s(),e.j41(3,"h3"),e.EFF(4,"No products found"),e.k0s(),e.j41(5,"p"),e.EFF(6,"Try adjusting your search criteria"),e.k0s()())}function Bo(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",33),e.nrm(1,"mat-divider"),e.j41(2,"h3"),e.EFF(3),e.k0s(),e.j41(4,"div",34)(5,"mat-form-field",35)(6,"mat-label"),e.EFF(7,"Custom Name (optional)"),e.k0s(),e.j41(8,"input",36),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.customName=i)}),e.k0s()(),e.j41(9,"mat-form-field",37)(10,"mat-label"),e.EFF(11,"Selling Price *"),e.k0s(),e.j41(12,"input",38),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.sellingPrice=i)}),e.k0s(),e.j41(13,"span",39),e.EFF(14,"\u20b9\xa0"),e.k0s()()(),e.j41(15,"div",34)(16,"mat-form-field",35)(17,"mat-label"),e.EFF(18,"Custom Description (optional)"),e.k0s(),e.j41(19,"textarea",40),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.customDescription=i)}),e.k0s()(),e.j41(20,"mat-form-field",41)(21,"mat-label"),e.EFF(22,"Initial Stock"),e.k0s(),e.j41(23,"input",42),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.initialStock=i)}),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(3),e.SpI('Assign "',t.selectedProduct.name,'" to Your Shop'),e.R7$(5),e.Y8G("ngModel",t.customName),e.R7$(4),e.Y8G("ngModel",t.sellingPrice),e.R7$(7),e.Y8G("ngModel",t.customDescription),e.R7$(4),e.Y8G("ngModel",t.initialStock)}}let pa=(()=>{class n{constructor(t,r,i){this.dialogRef=t,this.data=r,this.shopOwnerProductService=i,this.destroy$=new _n.B,this.searchSubject=new _n.B,this.masterProducts=[],this.selectedProduct=null,this.loading=!1,this.searchTerm="",this.customName="",this.customDescription="",this.sellingPrice=null,this.initialStock=0}ngOnInit(){this.loadMasterProducts(),this.searchSubject.pipe((0,ot.Q)(this.destroy$),(0,xr.B)(300),(0,Ei.F)()).subscribe(t=>{this.loadMasterProducts(t)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadMasterProducts(t){this.loading=!0,this.shopOwnerProductService.getMasterProducts(0,50,t).pipe((0,ot.Q)(this.destroy$)).subscribe({next:r=>{this.masterProducts=r,this.loading=!1},error:r=>{console.error("Error loading master products:",r),this.loading=!1}})}onSearchChange(){this.searchSubject.next(this.searchTerm)}selectProduct(t){this.selectedProduct=t,this.customName="",this.customDescription="",this.sellingPrice=null,this.initialStock=0}assignProduct(){!this.selectedProduct||!this.sellingPrice||this.sellingPrice<=0||this.dialogRef.close({masterProduct:this.selectedProduct,customName:this.customName||void 0,customDescription:this.customDescription||void 0,sellingPrice:this.sellingPrice,initialStock:this.initialStock})}cancel(){this.dialogRef.close()}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(Pe.CP),e.rXU(Pe.Vh),e.rXU(Gr))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-browse-master-products-dialog"]],decls:23,vars:6,consts:[[1,"browse-master-products-dialog"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-content"],[1,"search-section"],["appearance","outline",1,"search-field"],["matInput","","placeholder","Search by name, brand, or SKU",3,"ngModel","ngModelChange"],["matSuffix",""],["class","loading-container",4,"ngIf"],["class","master-products-list",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","assignment-form",4,"ngIf"],["mat-dialog-actions","",1,"dialog-actions"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"loading-container"],["diameter","40"],[1,"master-products-list"],["class","product-card",3,"selected",4,"ngFor","ngForOf"],[1,"product-card"],[1,"product-image"],[3,"src","alt"],["class","featured-badge",4,"ngIf"],[1,"product-info"],[1,"product-name"],[1,"product-description"],[1,"product-meta"],[1,"category-tag"],[1,"brand-tag"],[1,"sku-text"],[1,"product-unit"],[1,"product-actions"],[1,"featured-badge"],[1,"empty-state"],[1,"assignment-form"],[1,"form-row"],["appearance","outline"],["matInput","","placeholder","Leave blank to use master product name",3,"ngModel","ngModelChange"],["appearance","outline",1,"price-field"],["matInput","","type","number","placeholder","0.00","required","",3,"ngModel","ngModelChange"],["matPrefix",""],["matInput","","placeholder","Leave blank to use master product description","rows","2",3,"ngModel","ngModelChange"],["appearance","outline",1,"stock-field"],["matInput","","type","number","placeholder","0",3,"ngModel","ngModelChange"]],template:function(r,i){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"h2"),e.EFF(3,"Browse Master Products"),e.k0s(),e.j41(4,"p"),e.EFF(5,"Select products from our master catalog to add to your shop"),e.k0s()(),e.j41(6,"div",2)(7,"div",3)(8,"mat-form-field",4)(9,"mat-label"),e.EFF(10,"Search products..."),e.k0s(),e.j41(11,"input",5),e.bIt("ngModelChange",function(s){return i.searchTerm=s})("ngModelChange",function(){return i.onSearchChange()}),e.k0s(),e.j41(12,"mat-icon",6),e.EFF(13,"search"),e.k0s()()(),e.DNE(14,oo,4,0,"div",7),e.DNE(15,ua,2,1,"div",8),e.DNE(16,ga,7,0,"div",9),e.DNE(17,Bo,24,5,"div",10),e.k0s(),e.j41(18,"div",11)(19,"button",12),e.bIt("click",function(){return i.cancel()}),e.EFF(20,"Cancel"),e.k0s(),e.j41(21,"button",13),e.bIt("click",function(){return i.assignProduct()}),e.EFF(22," Assign Product to Shop "),e.k0s()()()),2&r&&(e.R7$(11),e.Y8G("ngModel",i.searchTerm),e.R7$(3),e.Y8G("ngIf",i.loading),e.R7$(1),e.Y8G("ngIf",!i.loading),e.R7$(1),e.Y8G("ngIf",!i.loading&&0===i.masterProducts.length),e.R7$(1),e.Y8G("ngIf",i.selectedProduct),e.R7$(4),e.Y8G("disabled",!i.selectedProduct||!i.sellingPrice||i.sellingPrice<=0))},dependencies:[D.Sq,D.bT,b.me,b.Q0,b.BC,b.YS,b.vS,B.$z,H.An,X.LG,me.q,ge.rl,ge.nJ,ge.JW,ge.yw,Ee.fg,Pe.BI,Pe.Yi,Pe.E7],styles:[".browse-master-products-dialog[_ngcontent-%COMP%]{width:100%;max-width:900px}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]{max-height:70vh;overflow-y:auto;padding:0 16px}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]{margin-bottom:20px}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]{width:100%}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:16px;color:#666}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]{display:flex;border:2px solid #e0e0e0;border-radius:8px;padding:16px;transition:all .2s ease;cursor:pointer}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]:hover{border-color:#2196f3;box-shadow:0 2px 8px #2196f31a}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card.selected[_ngcontent-%COMP%]{border-color:#2196f3;background-color:#f3f8ff}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image[_ngcontent-%COMP%]{position:relative;width:80px;height:80px;flex-shrink:0;margin-right:16px}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:4px}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image[_ngcontent-%COMP%]   .featured-badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:-4px;background-color:#ff9800;color:#fff;border-radius:50%;width:24px;height:24px;display:flex;align-items:center;justify-content:center}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image[_ngcontent-%COMP%]   .featured-badge[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]{flex:1}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-name[_ngcontent-%COMP%]{margin:0 0 8px;font-size:18px;font-weight:500;color:#333}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-description[_ngcontent-%COMP%]{margin:0 0 12px;color:#666;font-size:14px;line-height:1.4}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-meta[_ngcontent-%COMP%]{display:flex;gap:8px;margin-bottom:8px;flex-wrap:wrap}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-meta[_ngcontent-%COMP%]   .category-tag[_ngcontent-%COMP%], .browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-meta[_ngcontent-%COMP%]   .brand-tag[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2;padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-meta[_ngcontent-%COMP%]   .brand-tag[_ngcontent-%COMP%]{background-color:#f3e5f5;color:#7b1fa2}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-meta[_ngcontent-%COMP%]   .sku-text[_ngcontent-%COMP%]{color:#666;font-size:12px;font-family:monospace}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-unit[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;color:#666;font-size:14px}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-unit[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-actions[_ngcontent-%COMP%]{flex-shrink:0;display:flex;align-items:center;margin-left:16px}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#666}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;margin-bottom:16px;opacity:.5}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-weight:500}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .assignment-form[_ngcontent-%COMP%]{margin-top:24px;padding-top:24px}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .assignment-form[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:16px 0;color:#333;font-weight:500}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .assignment-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:16px}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .assignment-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .assignment-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   mat-form-field.price-field[_ngcontent-%COMP%], .browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .assignment-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   mat-form-field.stock-field[_ngcontent-%COMP%]{flex:0 0 200px}@media (max-width: 600px){.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .assignment-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{flex-direction:column}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .assignment-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   mat-form-field.price-field[_ngcontent-%COMP%], .browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .assignment-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   mat-form-field.stock-field[_ngcontent-%COMP%]{flex:1}}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;padding:16px 24px;border-top:1px solid #e0e0e0;margin-top:24px}@media (max-width: 768px){.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]{flex-direction:column}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image[_ngcontent-%COMP%]{align-self:center;margin:0 0 16px}.browse-master-products-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .master-products-list[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-actions[_ngcontent-%COMP%]{margin:16px 0 0;justify-content:center}}"]})}}return n})();function fa(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Category name is required "),e.k0s())}function Lo(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Name must be at least 2 characters "),e.k0s())}function Fs(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," This category already exists "),e.k0s())}function ma(n,o){1&n&&(e.j41(0,"div",13)(1,"mat-icon"),e.EFF(2,"cloud_off"),e.k0s(),e.j41(3,"span"),e.EFF(4,"You're offline. Category will be saved locally and synced when online."),e.k0s()())}function dl(n,o){1&n&&e.nrm(0,"mat-spinner",14)}function mt(n,o){1&n&&(e.j41(0,"mat-icon",15),e.EFF(1,"add"),e.k0s())}function Cr(n,o){return Ut.apply(this,arguments)}function Ut(){return(Ut=(0,fe.A)(function*(n,o){try{const t=localStorage.getItem("pending_offline_categories");if(!t)return;const r=JSON.parse(t);if(!Array.isArray(r)||0===r.length)return;const i=[];for(const a of r)try{yield n.post(`${o}/products/categories`,{name:a.name}).toPromise(),console.log("Synced offline category:",a.name)}catch(s){409===s?.status||s?.error?.message?.includes("already exists")?console.log("Category already exists on server:",a.name):(i.push(a),console.warn("Failed to sync category:",a.name,s))}i.length>0?localStorage.setItem("pending_offline_categories",JSON.stringify(i)):localStorage.removeItem("pending_offline_categories")}catch(t){console.warn("Error syncing offline categories:",t)}})).apply(this,arguments)}let so=(()=>{class n{constructor(t,r,i,a,s){this.fb=t,this.http=r,this.snackBar=i,this.dialogRef=a,this.data=s,this.saving=!1,this.isOffline=!1,this.apiUrl=Oe.c.apiUrl,this.existingCategories=[]}ngOnInit(){this.isOffline=!navigator.onLine,this.existingCategories=(this.data?.existingCategories||[]).map(t=>t.toUpperCase()),this.form=this.fb.group({name:["",[b.k0.required,b.k0.minLength(2)]]})}onNameInput(){const t=this.form.get("name");if(!t)return;const r=t.value?.trim().toUpperCase();r&&this.existingCategories.includes(r)?t.setErrors({duplicate:!0}):t.hasError("duplicate")&&t.updateValueAndValidity()}onCreate(){if(this.form.invalid||this.saving)return;const t=this.form.get("name").value.trim().toUpperCase();this.existingCategories.includes(t)?this.form.get("name").setErrors({duplicate:!0}):(this.saving=!0,navigator.onLine?this.http.post(`${this.apiUrl}/products/categories`,{name:t}).subscribe({next:r=>{const i=r?.data||r,a={name:i?.name||t,id:i?.id,slug:i?.slug};this.saving=!1,this.snackBar.open(`Category "${a.name}" created!`,"Close",{duration:2e3}),this.dialogRef.close(a)},error:r=>{console.error("Failed to create category via API:",r),this.saveOffline(t)}}):this.saveOffline(t))}saveOffline(t){try{const i=JSON.parse(localStorage.getItem("cached_product_category_names")||"[]");i.includes(t)||(i.push(t),i.sort(),localStorage.setItem("cached_product_category_names",JSON.stringify(i)));const a=JSON.parse(localStorage.getItem("pending_offline_categories")||"[]");a.push({name:t,createdAt:(new Date).toISOString()}),localStorage.setItem("pending_offline_categories",JSON.stringify(a))}catch(i){console.warn("Failed to save category offline:",i)}const r={name:t,createdOffline:!0};this.saving=!1,this.snackBar.open(`Category "${t}" saved locally. Will sync when online.`,"Close",{duration:3e3}),this.dialogRef.close(r)}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(b.ok),e.rXU(gt.Qq),e.rXU(Ce.UG),e.rXU(Pe.CP),e.rXU(Pe.Vh))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-category-create-dialog"]],decls:25,vars:10,consts:[["mat-dialog-title",""],[2,"vertical-align","middle","margin-right","8px"],[3,"formGroup","ngSubmit"],["appearance","outline",1,"full-width"],["matInput","","formControlName","name","placeholder","e.g. SNACKS, DAIRY, BEVERAGES","cdkFocusInitial","",3,"input"],["matPrefix",""],[4,"ngIf"],["class","offline-hint",4,"ngIf"],["align","end"],["mat-button","","mat-dialog-close","",3,"disabled"],["mat-raised-button","","color","primary",3,"disabled","click"],["diameter","18","style","display: inline-block; margin-right: 8px;",4,"ngIf"],["style","margin-right: 4px;",4,"ngIf"],[1,"offline-hint"],["diameter","18",2,"display","inline-block","margin-right","8px"],[2,"margin-right","4px"]],template:function(r,i){if(1&r&&(e.j41(0,"h2",0)(1,"mat-icon",1),e.EFF(2,"create_new_folder"),e.k0s(),e.EFF(3," Create New Category "),e.k0s(),e.j41(4,"mat-dialog-content")(5,"form",2),e.bIt("ngSubmit",function(){return i.onCreate()}),e.j41(6,"mat-form-field",3)(7,"mat-label"),e.EFF(8,"Category Name"),e.k0s(),e.j41(9,"input",4),e.bIt("input",function(){return i.onNameInput()}),e.k0s(),e.j41(10,"mat-icon",5),e.EFF(11,"category"),e.k0s(),e.j41(12,"mat-hint"),e.EFF(13,"Category name will be converted to UPPERCASE"),e.k0s(),e.DNE(14,fa,2,0,"mat-error",6),e.DNE(15,Lo,2,0,"mat-error",6),e.DNE(16,Fs,2,0,"mat-error",6),e.k0s()(),e.DNE(17,ma,5,0,"div",7),e.k0s(),e.j41(18,"mat-dialog-actions",8)(19,"button",9),e.EFF(20,"Cancel"),e.k0s(),e.j41(21,"button",10),e.bIt("click",function(){return i.onCreate()}),e.DNE(22,dl,1,0,"mat-spinner",11),e.DNE(23,mt,2,0,"mat-icon",12),e.EFF(24),e.k0s()()),2&r){let a,s,l;e.R7$(5),e.Y8G("formGroup",i.form),e.R7$(9),e.Y8G("ngIf",null==(a=i.form.get("name"))?null:a.hasError("required")),e.R7$(1),e.Y8G("ngIf",null==(s=i.form.get("name"))?null:s.hasError("minlength")),e.R7$(1),e.Y8G("ngIf",null==(l=i.form.get("name"))?null:l.hasError("duplicate")),e.R7$(1),e.Y8G("ngIf",i.isOffline),e.R7$(2),e.Y8G("disabled",i.saving),e.R7$(2),e.Y8G("disabled",i.form.invalid||i.saving),e.R7$(1),e.Y8G("ngIf",i.saving),e.R7$(1),e.Y8G("ngIf",!i.saving),e.R7$(1),e.SpI(" ",i.saving?"Creating...":"Create Category"," ")}},dependencies:[D.bT,b.qT,b.me,b.BC,b.cb,b.j4,b.JD,B.$z,H.An,X.LG,ge.rl,ge.nJ,ge.MV,ge.TL,ge.JW,Ee.fg,Pe.tx,Pe.BI,Pe.Yi,Pe.E7],styles:[".full-width[_ngcontent-%COMP%]{width:100%}mat-dialog-content[_ngcontent-%COMP%]{min-width:350px;padding-top:8px!important}h2[mat-dialog-title][_ngcontent-%COMP%]{display:flex;align-items:center;margin:0;padding:16px 24px;background:#f8f9fa;border-bottom:1px solid #e0e0e0;font-size:1.1rem}.offline-hint[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 12px;margin-top:12px;background:#fff3e0;border-radius:8px;font-size:.85rem;color:#e65100}.offline-hint[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}mat-dialog-actions[_ngcontent-%COMP%]{padding:12px 24px!important;border-top:1px solid #e0e0e0}@media (max-width: 480px){mat-dialog-content[_ngcontent-%COMP%]{min-width:unset}}"]})}}return n})();function ha(n,o){if(1&n&&(e.j41(0,"span",46),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.SpI(" ",t.selectedFile.name," ")}}function _a(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",47),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.clearImage())}),e.j41(1,"mat-icon"),e.EFF(2,"clear"),e.k0s()()}}function xa(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Product name is required "),e.k0s())}function gi(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Name must be at least 3 characters "),e.k0s())}function Ca(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Price is required "),e.k0s())}function co(n,o){if(1&n&&(e.j41(0,"div",48)(1,"div",49)(2,"span",50),e.EFF(3,"Discount:"),e.k0s(),e.j41(4,"span",51),e.EFF(5),e.nI1(6,"number"),e.k0s()(),e.j41(7,"div",49)(8,"span",50),e.EFF(9,"Discount %:"),e.k0s(),e.j41(10,"span",52),e.EFF(11),e.nI1(12,"number"),e.k0s()()()),2&n){const t=e.XpG();e.R7$(5),e.SpI("\u20b9",e.i5U(6,2,t.calculateDiscountAmount(),"1.2-2"),""),e.R7$(6),e.SpI("",e.i5U(12,5,t.calculateDiscountPercentage(),"1.1-1"),"%")}}function En(n,o){if(1&n&&(e.j41(0,"div",53)(1,"div",54)(2,"span",50),e.EFF(3,"Profit:"),e.k0s(),e.j41(4,"span",55),e.EFF(5),e.nI1(6,"number"),e.k0s()(),e.j41(7,"div",54)(8,"span",50),e.EFF(9,"Margin:"),e.k0s(),e.j41(10,"span",56),e.EFF(11),e.nI1(12,"number"),e.k0s()()()),2&n){const t=e.XpG();e.R7$(5),e.SpI("\u20b9",e.i5U(6,2,t.calculateProfit(),"1.2-2"),""),e.R7$(6),e.SpI("",e.i5U(12,5,t.calculateProfitMargin(),"1.1-1"),"%")}}function pi(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Stock quantity is required "),e.k0s())}function Es(n,o){if(1&n&&(e.j41(0,"mat-option",57),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.Y8G("value",t),e.R7$(1),e.SpI(" ",t," ")}}function Ss(n,o){if(1&n&&(e.j41(0,"mat-option",57),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.Y8G("value",t),e.R7$(1),e.SpI(" ",t," ")}}function ul(n,o){if(1&n&&(e.j41(0,"mat-option",57),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.Y8G("value",t),e.R7$(1),e.SpI(" ",t," ")}}let Ts=(()=>{class n{constructor(t,r,i,a,s,l,u){this.fb=t,this.snackBar=r,this.http=i,this.offlineStorage=a,this.dialog=s,this.dialogRef=l,this.data=u,this.categories=[],this.units=["piece","kg","gram","liter","ml","dozen","pack","box","bag"],this.statuses=["ACTIVE","INACTIVE","OUT_OF_STOCK"],this.selectedFile=null,this.imagePreview=null,this.currentImageUrl=null,this.apiUrl=Oe.c.apiUrl,this.isSaving=!1}ngOnInit(){this.loadCategories(),this.initForm(),this.data.imageUrl&&(this.currentImageUrl=this.data.imageUrl)}loadCategories(){const t=this.getCachedCategoryNames();t.length>0?(this.categories=t,this.data.category&&!this.categories.includes(this.data.category)&&this.categories.push(this.data.category),this.categories.sort()):this.data.category&&(this.categories=[this.data.category]),navigator.onLine&&this.http.get(`${this.apiUrl}/products/categories`,{params:{page:"0",size:"1000",sortBy:"name",sortDirection:"ASC",isActive:"true"}}).subscribe({next:r=>{const i=[],a=r?.data?.content||r?.data||r||[],s=new Set(["piece","kg","gram","g","liter","ml","cm","mm","l","dozen","pack","box","bag","pc","pcs"]);Array.isArray(a)&&a.forEach(l=>{const u="string"==typeof l?l:l.name;u&&u.length>2&&!s.has(u.toLowerCase())&&!i.includes(u)&&i.push(u)}),this.data.category&&!i.includes(this.data.category)&&i.push(this.data.category),this.categories=i.sort();try{localStorage.setItem("cached_product_category_names",JSON.stringify(i))}catch{}},error:()=>{}})}getCachedCategoryNames(){try{const t=localStorage.getItem("cached_product_category_names");if(t){const i=JSON.parse(t);if(Array.isArray(i)&&i.length>0)return i}const r=localStorage.getItem("cached_product_categories");if(r){const i=JSON.parse(r);if(Array.isArray(i)&&i.length>0)return i.map(a=>a.name).filter(a=>!!a)}}catch{}return[]}initForm(){this.editForm=this.fb.group({customName:[this.data.customName||"",[b.k0.required,b.k0.minLength(3)]],description:[this.data.description||""],price:[this.data.price||0,[b.k0.required,b.k0.min(0)]],originalPrice:[this.data.originalPrice||0,[b.k0.min(0)]],costPrice:[this.data.costPrice||0,[b.k0.min(0)]],stockQuantity:[this.data.stockQuantity||0,[b.k0.required,b.k0.min(0)]],category:[this.data.category||""],unit:[this.data.unit||"piece"],sku:[this.data.sku||""],status:[this.data.status||"ACTIVE"],isAvailable:[!1!==this.data.isAvailable],nameTamil:[this.data.nameTamil||""],tags:[this.data.tags||""],barcode1:[this.data.barcode1||""],barcode2:[this.data.barcode2||""],barcode3:[this.data.barcode3||""]})}onSubmit(){if(this.editForm.valid){const t=this.editForm.value,r=t.barcode1?.trim()||"",i=t.barcode2?.trim()||"",a=t.barcode3?.trim()||"";if(r&&i&&r.toLowerCase()===i.toLowerCase())return void this.snackBar.open("Barcode 1 and Barcode 2 cannot be the same.","Close",{duration:3e3});if(r&&a&&r.toLowerCase()===a.toLowerCase())return void this.snackBar.open("Barcode 1 and Barcode 3 cannot be the same.","Close",{duration:3e3});if(i&&a&&i.toLowerCase()===a.toLowerCase())return void this.snackBar.open("Barcode 2 and Barcode 3 cannot be the same.","Close",{duration:3e3});this.validateAndSave(t,r,i,a)}else this.snackBar.open("Please fill all required fields","Close",{duration:2e3})}validateAndSave(t,r,i,a){var s=this;return(0,fe.A)(function*(){s.isSaving=!0;const l=yield s.offlineStorage.validateBarcodes(r||null,i||null,a||null,s.data.id);if(l)return s.isSaving=!1,void s.snackBar.open(l,"Close",{duration:5e3});const u={...s.data,...t,imageUrl:s.currentImageUrl||s.data.imageUrl,voiceSearchTags:t.tags};s.isSaving=!1,s.dialogRef.close(u)})()}onCancel(){this.dialogRef.close()}onCategoryChange(t){"__NEW__"===t&&(this.editForm.patchValue({category:this.data.category||""}),this.dialog.open(so,{width:"420px",maxWidth:"95vw",data:{existingCategories:this.categories},disableClose:!1}).afterClosed().subscribe(a=>{if(a?.name){this.categories.includes(a.name)||(this.categories.push(a.name),this.categories.sort()),this.editForm.patchValue({category:a.name});try{localStorage.setItem("cached_product_category_names",JSON.stringify(this.categories))}catch{}}}))}calculateProfit(){return(this.editForm.get("price")?.value||0)-(this.editForm.get("costPrice")?.value||0)}calculateProfitMargin(){const t=this.editForm.get("price")?.value||0,r=this.editForm.get("costPrice")?.value||0;return 0===t?0:(t-r)/t*100}calculateDiscountAmount(){const t=this.editForm.get("originalPrice")?.value||0,r=this.editForm.get("price")?.value||0;return t>r?t-r:0}calculateDiscountPercentage(){const t=this.editForm.get("originalPrice")?.value||0,r=this.editForm.get("price")?.value||0;return t>0&&t>r?(t-r)/t*100:0}onFileSelected(t){const r=t.target;if(r.files&&r.files[0]){const i=r.files[0];if(!i.type.startsWith("image/"))return void this.snackBar.open("Please select a valid image file","Close",{duration:3e3});if(i.size>5242880)return void this.snackBar.open("Image size should be less than 5MB","Close",{duration:3e3});this.selectedFile=i;const a=new FileReader;a.onload=()=>{this.imagePreview=a.result},a.readAsDataURL(i),this.uploadImageNow(i)}}uploadImageNow(t){const r=localStorage.getItem("current_shop_id")||localStorage.getItem("current_shop_numeric_id");if(!r)return void console.error("No shop ID found - cannot upload image");let i=this.data.id;if(console.log("Upload Debug - Shop ID:",r),console.log("Upload Debug - Product ID:",i),console.log("Upload Debug - Product Data:",this.data),!i){i=1,console.warn("Product ID not found, image upload will be simulated locally");const p=new FileReader;return p.onload=()=>{this.imagePreview=p.result,this.currentImageUrl=p.result,this.data.imageUrl=p.result,this.snackBar.open("Image preview updated (not saved to server)","Close",{duration:3e3})},void p.readAsDataURL(t)}this.snackBar.open("Uploading image...","Close",{duration:1e3});const a=new FormData;a.append("images",t);const l=`${Oe.c.apiUrl}/products/images/shop/${r}/${i}`;console.log("Upload URL:",l);const u=localStorage.getItem("auth_token")||localStorage.getItem("shop_management_token");fetch(l,{method:"POST",headers:{Authorization:"Bearer "+u},body:a}).then(p=>p.json()).then(p=>{if(console.log("Image upload response:",p),p&&p.data&&p.data.length>0){const f=p.data[0];this.currentImageUrl=f.imageUrl,this.data.imageUrl=f.imageUrl,this.imagePreview=null,this.snackBar.open("Image uploaded successfully!","Close",{duration:3e3})}else"9999"===p.statusCode&&this.snackBar.open("Error: "+p.message,"Close",{duration:5e3})}).catch(p=>{console.error("Upload error:",p),this.snackBar.open("Failed to upload image","Close",{duration:3e3})})}clearImage(){this.selectedFile=null,this.imagePreview=null}generateSingleBarcode(t){var r=this;return(0,fe.A)(function*(){let i="",a=0;for(;a<10&&(i=r.generateRandomBarcode(),yield r.offlineStorage.isBarcodeExists(i,r.data.id));)a++;a>=10?r.snackBar.open("Could not generate unique barcode. Please try again.","Close",{duration:3e3}):r.editForm.patchValue({[t]:i})})()}generateRandomBarcode(){const i="200"+Math.floor(1e9*Math.random()).toString().padStart(9,"0");let a=0;for(let l=0;l<12;l++)a+=parseInt(i[l])*(l%2==0?1:3);return i+(10-a%10)%10}getProductImageUrl(){if(this.currentImageUrl){if(this.currentImageUrl.startsWith("http://")||this.currentImageUrl.startsWith("https://"))return this.currentImageUrl;const t=this.currentImageUrl.startsWith("/")?this.currentImageUrl:"/"+this.currentImageUrl;return`${Oe.c.imageBaseUrl}${t}`}return"assets/images/product-placeholder.svg"}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(b.ok),e.rXU(Ce.UG),e.rXU(gt.Qq),e.rXU(at.m),e.rXU(Pe.bZ),e.rXU(Pe.CP),e.rXU(Pe.Vh))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-product-edit-dialog"]],decls:147,vars:15,consts:[["mat-dialog-title",""],[1,"edit-form",3,"formGroup"],[1,"image-upload-section"],[1,"current-image"],["alt","Product image",1,"product-image-preview",3,"src"],[1,"upload-controls"],["type","file","accept","image/*",2,"display","none",3,"change"],["fileInput",""],["mat-stroked-button","","type","button",3,"click"],["class","file-name",4,"ngIf"],["mat-icon-button","","type","button","matTooltip","Remove image",3,"click",4,"ngIf"],["appearance","outline",1,"full-width"],["matInput","","formControlName","customName","placeholder","Enter product name"],[4,"ngIf"],["matInput","","formControlName","description","placeholder","Enter product description","rows","3"],[1,"form-row"],["appearance","outline"],["matInput","","type","number","formControlName","price","placeholder","0.00"],["matPrefix",""],["matInput","","type","number","formControlName","originalPrice","placeholder","0.00"],["matInput","","type","number","formControlName","costPrice","placeholder","0.00"],["class","discount-info",4,"ngIf"],["class","profit-info",4,"ngIf"],["matInput","","type","number","formControlName","stockQuantity","placeholder","0"],["formControlName","unit"],[3,"value",4,"ngFor","ngForOf"],["formControlName","category",3,"selectionChange"],["value",""],["value","__NEW__",1,"add-new-category-option"],["matInput","","formControlName","sku","placeholder","Product SKU"],["formControlName","status"],[1,"availability-toggle"],["formControlName","isAvailable","color","primary"],["matInput","","formControlName","nameTamil","placeholder","\u0ba4\u0bae\u0bbf\u0bb4\u0bcd \u0baa\u0bc6\u0baf\u0bb0\u0bcd"],["matInput","","formControlName","tags","placeholder","egg, \u0bae\u0bc1\u0b9f\u0bcd\u0b9f\u0bc8, muttai"],[1,"barcode-field-group"],["matInput","","formControlName","barcode1","placeholder","Primary barcode"],["mat-mini-fab","","color","accent","type","button","matTooltip","Generate Barcode 1",1,"generate-single-btn",3,"click"],["matInput","","formControlName","barcode2","placeholder","Secondary barcode"],["mat-mini-fab","","color","accent","type","button","matTooltip","Generate Barcode 2",1,"generate-single-btn",3,"click"],[1,"barcode-field-group","full-width"],["matInput","","formControlName","barcode3","placeholder","Tertiary barcode (optional)"],["mat-mini-fab","","color","accent","type","button","matTooltip","Generate Barcode 3",1,"generate-single-btn",3,"click"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"file-name"],["mat-icon-button","","type","button","matTooltip","Remove image",3,"click"],[1,"discount-info"],[1,"discount-item"],[1,"label"],[1,"value","discount"],[1,"value","discount-percent"],[1,"profit-info"],[1,"profit-item"],[1,"value","profit"],[1,"value","margin"],[3,"value"]],template:function(r,i){if(1&r){const a=e.RV6();e.j41(0,"h2",0),e.EFF(1,"Edit Product"),e.k0s(),e.j41(2,"mat-dialog-content")(3,"form",1)(4,"div",2)(5,"div",3),e.nrm(6,"img",4),e.k0s(),e.j41(7,"div",5)(8,"input",6,7),e.bIt("change",function(l){return i.onFileSelected(l)}),e.k0s(),e.j41(10,"button",8),e.bIt("click",function(){e.eBV(a);const l=e.sdS(9);return e.Njj(l.click())}),e.j41(11,"mat-icon"),e.EFF(12,"cloud_upload"),e.k0s(),e.EFF(13),e.k0s(),e.DNE(14,ha,2,1,"span",9),e.DNE(15,_a,3,0,"button",10),e.k0s()(),e.j41(16,"mat-form-field",11)(17,"mat-label"),e.EFF(18,"Product Name"),e.k0s(),e.nrm(19,"input",12),e.DNE(20,xa,2,0,"mat-error",13),e.DNE(21,gi,2,0,"mat-error",13),e.k0s(),e.j41(22,"mat-form-field",11)(23,"mat-label"),e.EFF(24,"Description"),e.k0s(),e.nrm(25,"textarea",14),e.k0s(),e.j41(26,"div",15)(27,"mat-form-field",16)(28,"mat-label"),e.EFF(29,"Selling Price (\u20b9)"),e.k0s(),e.nrm(30,"input",17),e.j41(31,"mat-icon",18),e.EFF(32,"currency_rupee"),e.k0s(),e.DNE(33,Ca,2,0,"mat-error",13),e.k0s(),e.j41(34,"mat-form-field",16)(35,"mat-label"),e.EFF(36,"Original Price / MRP (\u20b9)"),e.k0s(),e.nrm(37,"input",19),e.j41(38,"mat-icon",18),e.EFF(39,"sell"),e.k0s(),e.j41(40,"mat-hint"),e.EFF(41,"For discounts: Set higher than selling price"),e.k0s()()(),e.j41(42,"div",15)(43,"mat-form-field",16)(44,"mat-label"),e.EFF(45,"Cost Price (\u20b9)"),e.k0s(),e.nrm(46,"input",20),e.j41(47,"mat-icon",18),e.EFF(48,"currency_rupee"),e.k0s()()(),e.DNE(49,co,13,8,"div",21),e.DNE(50,En,13,8,"div",22),e.j41(51,"div",15)(52,"mat-form-field",16)(53,"mat-label"),e.EFF(54,"Stock Quantity"),e.k0s(),e.nrm(55,"input",23),e.j41(56,"mat-icon",18),e.EFF(57,"inventory_2"),e.k0s(),e.DNE(58,pi,2,0,"mat-error",13),e.k0s(),e.j41(59,"mat-form-field",16)(60,"mat-label"),e.EFF(61,"Unit"),e.k0s(),e.j41(62,"mat-select",24),e.DNE(63,Es,2,2,"mat-option",25),e.k0s()()(),e.j41(64,"div",15)(65,"mat-form-field",16)(66,"mat-label"),e.EFF(67,"Category"),e.k0s(),e.j41(68,"mat-select",26),e.bIt("selectionChange",function(l){return i.onCategoryChange(l.value)}),e.j41(69,"mat-option",27),e.EFF(70,"None"),e.k0s(),e.DNE(71,Ss,2,2,"mat-option",25),e.j41(72,"mat-option",28)(73,"mat-icon"),e.EFF(74,"add"),e.k0s(),e.EFF(75," Add New Category "),e.k0s()(),e.j41(76,"mat-icon",18),e.EFF(77,"category"),e.k0s()(),e.j41(78,"mat-form-field",16)(79,"mat-label"),e.EFF(80,"SKU"),e.k0s(),e.nrm(81,"input",29),e.j41(82,"mat-icon",18),e.EFF(83,"qr_code"),e.k0s()()(),e.j41(84,"div",15)(85,"mat-form-field",16)(86,"mat-label"),e.EFF(87,"Status"),e.k0s(),e.j41(88,"mat-select",30),e.DNE(89,ul,2,2,"mat-option",25),e.k0s()(),e.j41(90,"div",31)(91,"mat-slide-toggle",32),e.EFF(92," Product Available for Sale "),e.k0s()()(),e.j41(93,"mat-form-field",11)(94,"mat-label"),e.EFF(95,"Tamil Name"),e.k0s(),e.nrm(96,"input",33),e.j41(97,"mat-icon",18),e.EFF(98,"translate"),e.k0s(),e.j41(99,"mat-hint"),e.EFF(100,"Product name in Tamil for voice search"),e.k0s()(),e.j41(101,"mat-form-field",11)(102,"mat-label"),e.EFF(103,"Voice Search Tags"),e.k0s(),e.nrm(104,"input",34),e.j41(105,"mat-icon",18),e.EFF(106,"mic"),e.k0s(),e.j41(107,"mat-hint"),e.EFF(108,"Comma-separated tags for voice search (English and Tamil)"),e.k0s()(),e.j41(109,"div",15)(110,"div",35)(111,"mat-form-field",16)(112,"mat-label"),e.EFF(113,"Barcode 1"),e.k0s(),e.nrm(114,"input",36),e.j41(115,"mat-icon",18),e.EFF(116,"qr_code"),e.k0s()(),e.j41(117,"button",37),e.bIt("click",function(){return i.generateSingleBarcode("barcode1")}),e.j41(118,"mat-icon"),e.EFF(119,"autorenew"),e.k0s()()(),e.j41(120,"div",35)(121,"mat-form-field",16)(122,"mat-label"),e.EFF(123,"Barcode 2"),e.k0s(),e.nrm(124,"input",38),e.j41(125,"mat-icon",18),e.EFF(126,"qr_code"),e.k0s()(),e.j41(127,"button",39),e.bIt("click",function(){return i.generateSingleBarcode("barcode2")}),e.j41(128,"mat-icon"),e.EFF(129,"autorenew"),e.k0s()()()(),e.j41(130,"div",40)(131,"mat-form-field",11)(132,"mat-label"),e.EFF(133,"Barcode 3"),e.k0s(),e.nrm(134,"input",41),e.j41(135,"mat-icon",18),e.EFF(136,"qr_code"),e.k0s(),e.j41(137,"mat-hint"),e.EFF(138,"Additional barcode for different packaging or supplier codes"),e.k0s()(),e.j41(139,"button",42),e.bIt("click",function(){return i.generateSingleBarcode("barcode3")}),e.j41(140,"mat-icon"),e.EFF(141,"autorenew"),e.k0s()()()()(),e.j41(142,"mat-dialog-actions",43)(143,"button",44),e.bIt("click",function(){return i.onCancel()}),e.EFF(144,"Cancel"),e.k0s(),e.j41(145,"button",45),e.bIt("click",function(){return i.onSubmit()}),e.EFF(146," Save Changes "),e.k0s()()}if(2&r){let a,s,l,u,p,f;e.R7$(3),e.Y8G("formGroup",i.editForm),e.R7$(3),e.Y8G("src",i.imagePreview||i.getProductImageUrl(),e.B4B),e.R7$(7),e.SpI(" ",i.selectedFile||i.data.imageUrl?"Change Image":"Upload Image"," "),e.R7$(1),e.Y8G("ngIf",i.selectedFile),e.R7$(1),e.Y8G("ngIf",i.selectedFile||i.imagePreview),e.R7$(5),e.Y8G("ngIf",null==(a=i.editForm.get("customName"))?null:a.hasError("required")),e.R7$(1),e.Y8G("ngIf",null==(s=i.editForm.get("customName"))?null:s.hasError("minlength")),e.R7$(12),e.Y8G("ngIf",null==(l=i.editForm.get("price"))?null:l.hasError("required")),e.R7$(16),e.Y8G("ngIf",(null==(u=i.editForm.get("originalPrice"))?null:u.value)>(null==(u=i.editForm.get("price"))?null:u.value)),e.R7$(1),e.Y8G("ngIf",(null==(p=i.editForm.get("price"))?null:p.value)&&(null==(p=i.editForm.get("costPrice"))?null:p.value)),e.R7$(8),e.Y8G("ngIf",null==(f=i.editForm.get("stockQuantity"))?null:f.hasError("required")),e.R7$(5),e.Y8G("ngForOf",i.units),e.R7$(8),e.Y8G("ngForOf",i.categories),e.R7$(18),e.Y8G("ngForOf",i.statuses),e.R7$(56),e.Y8G("disabled",!i.editForm.valid)}},dependencies:[D.Sq,D.bT,b.qT,b.me,b.Q0,b.BC,b.cb,b.j4,b.JD,B.$z,B.iY,B.$0,H.An,ge.rl,ge.nJ,ge.MV,ge.TL,ge.JW,Ee.fg,ze.VO,Bt.wT,Pe.BI,Pe.Yi,Pe.E7,qe.oV,Ae.sG,D.QX],styles:[".edit-form[_ngcontent-%COMP%]{min-width:500px;padding:16px 0}.edit-form[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{width:100%}.edit-form[_ngcontent-%COMP%]   .image-upload-section[_ngcontent-%COMP%]{margin-bottom:20px;padding:16px;border:1px solid #e0e0e0;border-radius:8px;background:#fafafa}.edit-form[_ngcontent-%COMP%]   .image-upload-section[_ngcontent-%COMP%]   .current-image[_ngcontent-%COMP%]{text-align:center;margin-bottom:16px}.edit-form[_ngcontent-%COMP%]   .image-upload-section[_ngcontent-%COMP%]   .current-image[_ngcontent-%COMP%]   .product-image-preview[_ngcontent-%COMP%]{max-width:200px;max-height:200px;object-fit:contain;border-radius:8px;box-shadow:0 2px 8px #0000001a}.edit-form[_ngcontent-%COMP%]   .image-upload-section[_ngcontent-%COMP%]   .upload-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;justify-content:center}.edit-form[_ngcontent-%COMP%]   .image-upload-section[_ngcontent-%COMP%]   .upload-controls[_ngcontent-%COMP%]   .file-name[_ngcontent-%COMP%]{color:#666;font-size:.875rem;max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.edit-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:8px}.edit-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1}.edit-form[_ngcontent-%COMP%]   .barcode-field-group[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px;flex:1}.edit-form[_ngcontent-%COMP%]   .barcode-field-group[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1}.edit-form[_ngcontent-%COMP%]   .barcode-field-group[_ngcontent-%COMP%]   .generate-single-btn[_ngcontent-%COMP%]{width:32px;height:32px;min-height:32px;margin-top:8px}.edit-form[_ngcontent-%COMP%]   .barcode-field-group[_ngcontent-%COMP%]   .generate-single-btn[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;line-height:18px}.edit-form[_ngcontent-%COMP%]   .availability-toggle[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;padding:16px 0}.edit-form[_ngcontent-%COMP%]   .discount-info[_ngcontent-%COMP%]{display:flex;gap:24px;padding:12px;background:#fff3e0;border-radius:8px;margin-bottom:16px;border:1px solid #ffb74d}.edit-form[_ngcontent-%COMP%]   .discount-info[_ngcontent-%COMP%]   .discount-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.edit-form[_ngcontent-%COMP%]   .discount-info[_ngcontent-%COMP%]   .discount-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#666;font-size:.875rem}.edit-form[_ngcontent-%COMP%]   .discount-info[_ngcontent-%COMP%]   .discount-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600;font-size:1rem}.edit-form[_ngcontent-%COMP%]   .discount-info[_ngcontent-%COMP%]   .discount-item[_ngcontent-%COMP%]   .value.discount[_ngcontent-%COMP%]{color:#ff6f00}.edit-form[_ngcontent-%COMP%]   .discount-info[_ngcontent-%COMP%]   .discount-item[_ngcontent-%COMP%]   .value.discount-percent[_ngcontent-%COMP%]{color:#f57c00}.edit-form[_ngcontent-%COMP%]   .profit-info[_ngcontent-%COMP%]{display:flex;gap:24px;padding:12px;background:#f5f5f5;border-radius:8px;margin-bottom:16px}.edit-form[_ngcontent-%COMP%]   .profit-info[_ngcontent-%COMP%]   .profit-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.edit-form[_ngcontent-%COMP%]   .profit-info[_ngcontent-%COMP%]   .profit-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#666;font-size:.875rem}.edit-form[_ngcontent-%COMP%]   .profit-info[_ngcontent-%COMP%]   .profit-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600;font-size:1rem}.edit-form[_ngcontent-%COMP%]   .profit-info[_ngcontent-%COMP%]   .profit-item[_ngcontent-%COMP%]   .value.profit[_ngcontent-%COMP%]{color:#4caf50}.edit-form[_ngcontent-%COMP%]   .profit-info[_ngcontent-%COMP%]   .profit-item[_ngcontent-%COMP%]   .value.margin[_ngcontent-%COMP%]{color:#2196f3}mat-dialog-content[_ngcontent-%COMP%]{max-height:70vh;overflow-y:auto}mat-dialog-actions[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid #e0e0e0}"]})}}return n})(),fi=(()=>{class n{constructor(t,r){this.el=t,this.offlineStorage=r,this.fallback="assets/images/product-placeholder.svg",this.hasError=!1,this.blobUrl=null}ngOnInit(){this.loadImage()}ngOnChanges(t){t.imageUrl&&(this.hasError=!1,this.cleanupBlobUrl(),this.loadImage())}onError(){this.hasError||(this.hasError=!0,this.el.nativeElement.src=this.fallback)}loadImage(){var t=this;return(0,fe.A)(function*(){if(!t.imageUrl)return void(t.el.nativeElement.src=t.fallback);if(t.imageUrl.startsWith("data:")||t.imageUrl.startsWith("blob:"))return void(t.el.nativeElement.src=t.imageUrl);const r=(0,Mr.V)(t.imageUrl);if(r){try{const i=yield t.offlineStorage.getCachedImage(r);if(i)return t.cleanupBlobUrl(),t.blobUrl=URL.createObjectURL(i),void(t.el.nativeElement.src=t.blobUrl)}catch{}t.el.nativeElement.src=r}else t.el.nativeElement.src=t.fallback})()}cleanupBlobUrl(){this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=null)}ngOnDestroy(){this.cleanupBlobUrl()}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(e.aKT),e.rXU(at.m))}}static{this.\u0275dir=e.FsC({type:n,selectors:[["","appOfflineImg",""]],hostBindings:function(r,i){1&r&&e.bIt("error",function(){return i.onError()})},inputs:{imageUrl:["appOfflineImg","imageUrl"],fallback:"fallback"},features:[e.OA$]})}}return n})();const gl=["scrollableContent"],Is=["searchInput"];function Rt(n,o){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.SpI(" \u2022 ",t.filteredProducts.length," showing")}}function pl(n,o){if(1&n&&(e.j41(0,"span",31),e.EFF(1," \u2022 "),e.j41(2,"strong"),e.EFF(3),e.k0s()()),2&n){const t=e.XpG();e.R7$(3),e.SpI("",t.selectedProducts.length," selected")}}function vr(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",32),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.bulkDeleteProducts())}),e.j41(1,"mat-icon"),e.EFF(2,"delete"),e.k0s(),e.EFF(3),e.k0s()}if(2&n){const t=e.XpG();e.R7$(3),e.SpI(" Delete Selected (",t.selectedProducts.length,") ")}}function lo(n,o){1&n&&(e.j41(0,"mat-icon",33),e.EFF(1,"search"),e.k0s())}function Rs(n,o){1&n&&e.nrm(0,"mat-spinner",34)}function fl(n,o){if(1&n&&(e.j41(0,"mat-option",35),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.Y8G("value",t),e.R7$(1),e.SpI(" ",t," ")}}function va(n,o){1&n&&(e.j41(0,"p"),e.EFF(1,"Loading your products..."),e.k0s())}function ml(n,o){if(1&n&&(e.j41(0,"p"),e.EFF(1),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.SpI('Searching for "',t.searchTerm,'"...')}}function Ns(n,o){if(1&n&&(e.j41(0,"div",36),e.nrm(1,"mat-spinner",37),e.DNE(2,va,2,0,"p",6),e.DNE(3,ml,2,1,"p",6),e.k0s()),2&n){const t=e.XpG();e.R7$(2),e.Y8G("ngIf",!t.searchTerm),e.R7$(1),e.Y8G("ngIf",t.searchTerm)}}function hl(n,o){if(1&n){const t=e.RV6();e.j41(0,"th",54)(1,"mat-checkbox",55),e.bIt("change",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.toggleSelectAll())}),e.k0s()()}if(2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("checked",t.filteredProducts.length>0&&t.selectedProducts.length===t.filteredProducts.length)("indeterminate",t.selectedProducts.length>0&&t.selectedProducts.length<t.filteredProducts.length)}}function _l(n,o){if(1&n){const t=e.RV6();e.j41(0,"td",56)(1,"mat-checkbox",57),e.bIt("change",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.toggleProductSelection(a))})("click",function(i){return i.stopPropagation()}),e.k0s()()}if(2&n){const t=o.$implicit,r=e.XpG(2);e.R7$(1),e.Y8G("checked",r.isProductSelected(t))}}function Pa(n,o){1&n&&e.nrm(0,"th",54)}function xl(n,o){if(1&n&&(e.j41(0,"td",56)(1,"div",58),e.nrm(2,"img",59),e.k0s()()),2&n){const t=o.$implicit;e.R7$(2),e.Y8G("appOfflineImg",t.imageUrl)("fallback","assets/images/product-placeholder.svg")("alt",t.customName)}}function Fr(n,o){1&n&&(e.j41(0,"th",54),e.EFF(1," Product "),e.k0s())}function Cl(n,o){if(1&n&&(e.j41(0,"span",66),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.JRh(t.masterProduct.nameTamil)}}function As(n,o){if(1&n&&(e.j41(0,"span",67),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.SpI(" ",t.category," ")}}function Zr(n,o){if(1&n&&(e.j41(0,"span",68),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.SpI(" SKU: ",t.sku," ")}}function Ds(n,o){if(1&n&&(e.j41(0,"td",56)(1,"div",60)(2,"h3"),e.EFF(3),e.k0s(),e.DNE(4,Cl,2,1,"span",61),e.j41(5,"p",62),e.EFF(6),e.k0s(),e.j41(7,"div",63),e.DNE(8,As,2,1,"span",64),e.DNE(9,Zr,2,1,"span",65),e.k0s()()()),2&n){const t=o.$implicit;e.R7$(3),e.JRh(t.customName),e.R7$(1),e.Y8G("ngIf",null==t.masterProduct?null:t.masterProduct.nameTamil),e.R7$(2),e.JRh(t.description||"No description"),e.R7$(2),e.Y8G("ngIf",t.category),e.R7$(1),e.Y8G("ngIf",t.sku)}}function js(n,o){1&n&&(e.j41(0,"th",54),e.EFF(1," Price "),e.k0s())}function ba(n,o){if(1&n&&(e.j41(0,"td",56)(1,"div",69)(2,"span",70),e.EFF(3),e.nI1(4,"number"),e.k0s(),e.j41(5,"span",71),e.EFF(6),e.k0s()()()),2&n){const t=o.$implicit;e.R7$(3),e.SpI("\u20b9",e.i5U(4,2,t.price,"1.0-0"),""),e.R7$(3),e.JRh(t.unit||"piece")}}function vl(n,o){1&n&&(e.j41(0,"th",54),e.EFF(1," Stock "),e.k0s())}function Bs(n,o){if(1&n&&(e.j41(0,"td",56)(1,"div",72)(2,"span",73),e.EFF(3),e.k0s()()()),2&n){const t=o.$implicit,r=e.XpG(2);e.R7$(2),e.Y8G("ngClass",r.getStockClass(t.stockQuantity)),e.R7$(1),e.SpI(" ",t.stockQuantity," ")}}function Ls(n,o){1&n&&(e.j41(0,"th",54),e.EFF(1," Status "),e.k0s())}function Pl(n,o){if(1&n){const t=e.RV6();e.j41(0,"td",56)(1,"select",74),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.onStatusDropdownChange(s,i))}),e.j41(2,"option",23),e.EFF(3,"Active"),e.k0s(),e.j41(4,"option",24),e.EFF(5,"Inactive"),e.k0s()()()}if(2&n){const t=o.$implicit;e.R7$(1),e.Y8G("ngClass","ACTIVE"===t.status?"status-active":"status-inactive")("value",t.status)}}function bl(n,o){1&n&&(e.j41(0,"th",54),e.EFF(1," Actions "),e.k0s())}function ka(n,o){if(1&n){const t=e.RV6();e.j41(0,"td",56)(1,"div",75)(2,"button",76),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.editProduct(a))}),e.j41(3,"mat-icon"),e.EFF(4,"edit"),e.k0s()(),e.j41(5,"button",77),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.updatePrice(a))}),e.j41(6,"mat-icon"),e.EFF(7,"currency_rupee"),e.k0s()(),e.j41(8,"button",78),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.updateStockDialog(a))}),e.j41(9,"mat-icon"),e.EFF(10,"inventory"),e.k0s()(),e.j41(11,"button",79)(12,"mat-icon"),e.EFF(13,"more_vert"),e.k0s()(),e.j41(14,"mat-menu",null,80)(16,"button",81),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.duplicateProduct(a.id))}),e.j41(17,"mat-icon"),e.EFF(18,"content_copy"),e.k0s(),e.j41(19,"span"),e.EFF(20,"Duplicate"),e.k0s()(),e.j41(21,"button",81),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.toggleAvailability(a))}),e.j41(22,"mat-icon"),e.EFF(23),e.k0s(),e.j41(24,"span"),e.EFF(25),e.k0s()(),e.j41(26,"button",81),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.viewAnalytics(a.id))}),e.j41(27,"mat-icon"),e.EFF(28,"analytics"),e.k0s(),e.j41(29,"span"),e.EFF(30,"Analytics"),e.k0s()(),e.nrm(31,"mat-divider"),e.j41(32,"button",82),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.deleteProduct(a))}),e.j41(33,"mat-icon"),e.EFF(34,"delete"),e.k0s(),e.j41(35,"span"),e.EFF(36,"Delete"),e.k0s()()()()()}if(2&n){const t=o.$implicit,r=e.sdS(15);e.R7$(11),e.Y8G("matMenuTriggerFor",r),e.R7$(12),e.JRh(t.isAvailable?"visibility_off":"visibility"),e.R7$(2),e.JRh(t.isAvailable?"Hide":"Show")}}function kl(n,o){1&n&&e.nrm(0,"tr",83)}function $s(n,o){1&n&&e.nrm(0,"tr",84)}function Gs(n,o){if(1&n){const t=e.RV6();e.j41(0,"mat-paginator",85),e.bIt("page",function(i){e.eBV(t);const a=e.XpG(2);return e.Njj(a.onPageChange(i))}),e.k0s()}if(2&n){const t=e.XpG(2);e.Y8G("length",t.totalProducts)("pageSize",t.pageSize)("pageSizeOptions",t.pageSizeOptions)("pageIndex",t.currentPageIndex)}}function $o(n,o){1&n&&(e.j41(0,"div",90),e.nrm(1,"mat-spinner",91),e.j41(2,"span"),e.EFF(3,"Loading more products..."),e.k0s()())}function mi(n,o){if(1&n&&(e.j41(0,"div",92)(1,"span"),e.EFF(2),e.k0s(),e.j41(3,"span",93),e.EFF(4,"Scroll down to load more"),e.k0s()()),2&n){const t=e.XpG(3);e.R7$(2),e.Lme("Showing ",t.paginatedProducts.length," of ",t.filteredProducts.length," products")}}function Ol(n,o){if(1&n&&(e.j41(0,"div",94)(1,"span"),e.EFF(2),e.k0s()()),2&n){const t=e.XpG(3);e.R7$(2),e.SpI("Showing all ",t.filteredProducts.length," products")}}function uo(n,o){if(1&n&&(e.j41(0,"div",86),e.DNE(1,$o,4,0,"div",87),e.DNE(2,mi,5,2,"div",88),e.DNE(3,Ol,3,1,"div",89),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("ngIf",t.loadingMore),e.R7$(1),e.Y8G("ngIf",!t.loadingMore&&t.hasMoreProducts),e.R7$(1),e.Y8G("ngIf",!t.loadingMore&&!t.hasMoreProducts&&t.filteredProducts.length>0)}}function dr(n,o){if(1&n&&(e.j41(0,"div",38)(1,"mat-card",39)(2,"table",40),e.qex(3,41),e.DNE(4,hl,2,2,"th",42),e.DNE(5,_l,2,1,"td",43),e.bVm(),e.qex(6,44),e.DNE(7,Pa,1,0,"th",42),e.DNE(8,xl,3,3,"td",43),e.bVm(),e.qex(9,45),e.DNE(10,Fr,2,0,"th",42),e.DNE(11,Ds,10,5,"td",43),e.bVm(),e.qex(12,46),e.DNE(13,js,2,0,"th",42),e.DNE(14,ba,7,5,"td",43),e.bVm(),e.qex(15,47),e.DNE(16,vl,2,0,"th",42),e.DNE(17,Bs,4,2,"td",43),e.bVm(),e.qex(18,48),e.DNE(19,Ls,2,0,"th",42),e.DNE(20,Pl,6,2,"td",43),e.bVm(),e.qex(21,49),e.DNE(22,bl,2,0,"th",42),e.DNE(23,ka,37,3,"td",43),e.bVm(),e.DNE(24,kl,1,0,"tr",50),e.DNE(25,$s,1,0,"tr",51),e.k0s(),e.DNE(26,Gs,1,4,"mat-paginator",52),e.DNE(27,uo,4,3,"div",53),e.k0s()()),2&n){const t=e.XpG();e.R7$(2),e.Y8G("dataSource",t.paginatedProducts),e.R7$(22),e.Y8G("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),e.R7$(1),e.Y8G("matRowDefColumns",t.displayedColumns),e.R7$(1),e.Y8G("ngIf",t.isSearching),e.R7$(1),e.Y8G("ngIf",!t.isSearching)}}function Us(n,o){1&n&&(e.j41(0,"p"),e.EFF(1,"Your product list is empty. Add your first product to get started!"),e.k0s())}function zs(n,o){1&n&&(e.j41(0,"p"),e.EFF(1,"Try adjusting your search or filter criteria."),e.k0s())}function yl(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",10),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.browseMasterProducts())}),e.j41(1,"mat-icon"),e.EFF(2,"shopping_basket"),e.k0s(),e.EFF(3," Browse Products to Add "),e.k0s()}}function Oa(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",101),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.addNewProduct())}),e.j41(1,"mat-icon"),e.EFF(2,"add"),e.k0s(),e.EFF(3," Create Custom Product "),e.k0s()}}function ya(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",102),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.clearFilters())}),e.EFF(1," Clear Filters "),e.k0s()}}function Ml(n,o){if(1&n&&(e.j41(0,"div",95)(1,"div",96)(2,"mat-icon"),e.EFF(3,"inventory_2"),e.k0s()(),e.j41(4,"h3"),e.EFF(5,"No products found"),e.k0s(),e.DNE(6,Us,2,0,"p",6),e.DNE(7,zs,2,0,"p",6),e.j41(8,"div",97),e.DNE(9,yl,4,0,"button",98),e.DNE(10,Oa,4,0,"button",99),e.DNE(11,ya,2,0,"button",100),e.k0s()()),2&n){const t=e.XpG();e.R7$(6),e.Y8G("ngIf",0===t.products.length),e.R7$(1),e.Y8G("ngIf",t.products.length>0),e.R7$(2),e.Y8G("ngIf",0===t.products.length),e.R7$(1),e.Y8G("ngIf",0===t.products.length),e.R7$(1),e.Y8G("ngIf",t.products.length>0)}}let wl=(()=>{class n{get isSearching(){return!!(this.searchTerm&&this.searchTerm.trim().length>0)}get paginatedProducts(){if(this.isSearching){const t=this.currentPageIndex*this.pageSize;return this.filteredProducts.slice(t,t+this.pageSize)}return this.filteredProducts.slice(0,this.displayLimit)}get hasMoreProducts(){return!this.isSearching&&this.displayLimit<this.filteredProducts.length}constructor(t,r,i,a,s,l,u,p){this.router=t,this.dialog=r,this.snackBar=i,this.http=a,this.shopContext=s,this.shopOwnerProductService=l,this.offlineStorage=u,this.elementRef=p,this.destroy$=new _n.B,this.searchSubject$=new _n.B,this.apiUrl=Oe.c.apiUrl,this.products=[],this.filteredProducts=[],this.categories=[],this.loading=!1,this.searching=!1,this.usingFallbackData=!1,this.shopId=null,this.searchTerm="",this.selectedCategory="",this.selectedStatus="",this.selectedProducts=[],this.selectAll=!1,this.totalProducts=0,this.pageSize=20,this.pageSizeOptions=[20,50,100,200],this.currentPageIndex=0,this.displayLimit=20,this.loadingMore=!1,this.LOAD_INCREMENT=20,this.displayedColumns=["select","image","name","price","stock","status","actions"],this.loadedFromCache=!1,this.CACHE_VALIDITY_MS=3e5,this.CACHE_TIMESTAMP_KEY="my_products_last_sync"}onContentScroll(t){if(this.isSearching||this.loading||this.loadingMore||!this.hasMoreProducts)return;const r=t.target;r.scrollTop+r.clientHeight>=r.scrollHeight-200&&this.loadMoreProducts()}loadMoreProducts(){this.loadingMore||!this.hasMoreProducts||(this.loadingMore=!0,setTimeout(()=>{this.displayLimit+=this.LOAD_INCREMENT,this.loadingMore=!1},100))}ngAfterViewInit(){setTimeout(()=>{this.searchInput?.nativeElement?.focus()},300)}ngOnInit(){console.log("Loading products for current authenticated user"),this.loadProducts(),this.loadCategories(),this.searchSubject$.pipe((0,xr.B)(50),(0,Ei.F)(),(0,ot.Q)(this.destroy$)).subscribe(t=>{this.searchTerm=t,this.applyFilters()}),this.shopContext.shop$.pipe((0,ot.Q)(this.destroy$)).subscribe(t=>{t&&t.id&&t.id!==this.shopId&&(this.shopId=t.id,localStorage.setItem("current_shop_id",t.id.toString()),console.log("Updated shop ID from context:",this.shopId),this.loadProducts(),this.loadCategories())}),setTimeout(()=>{this.shopContext.refreshShop()},100)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadProducts(){var t=this;return(0,fe.A)(function*(){t.loading=!0,t.searching=!1,console.log("Loading ALL products for authenticated user");try{let r=yield t.offlineStorage.getProducts();try{const i=yield t.offlineStorage.getPendingProductCreations();if(i.length>0){console.log(`Found ${i.length} pending offline products`);const a=i.filter(s=>{const l=s.barcode1?.toLowerCase(),u=(s.name||s.customName)?.toLowerCase(),p=s.tempProductId;return!r.some(f=>!!(p&&f.id===p||l&&(f.barcode1?.toLowerCase()===l||f.barcode?.toLowerCase()===l)||!l&&u&&f.name?.toLowerCase()===u))});a.length>0&&(r=[...a.map(l=>({id:l.tempProductId||t.offlineStorage.generateTempProductId(),shopId:l.shopId,name:l.name||l.customName||"New Product",nameTamil:l.nameTamil,price:l.price,originalPrice:l.originalPrice,costPrice:l.costPrice,stock:l.stockQuantity,trackInventory:l.trackInventory,isAvailable:!0,sku:l.sku||"",barcode:l.barcode1,barcode1:l.barcode1,barcode2:l.barcode2,barcode3:l.barcode3,category:l.categoryName,unit:l.unit,masterProductId:l.masterProductId})),...r])}}catch(i){console.warn("Failed to load pending offline products:",i)}r.length>0&&(console.log(`Loaded ${r.length} products from local cache (including offline)`),t.loadedFromCache=!0,t.mapCachedProducts(r),t.loading=!1)}catch(r){console.warn("Error loading from cache:",r)}if(navigator.onLine){const r=localStorage.getItem(t.CACHE_TIMESTAMP_KEY),i=r?parseInt(r,10):0,a=Date.now()-i;!t.loadedFromCache||a>t.CACHE_VALIDITY_MS?(console.log("Cache is stale or empty, syncing from server..."),t.syncProductsFromServer()):(console.log(`Using cached data (age: ${Math.round(a/1e3)}s, max: ${t.CACHE_VALIDITY_MS/1e3}s)`),t.loading=!1)}else t.loading=!1})()}forceRefreshProducts(){localStorage.removeItem(this.CACHE_TIMESTAMP_KEY),this.loadProducts()}mapCachedProducts(t){this.products=t.map(r=>({id:r.id,customName:r.name,description:r.description||"",price:r.price,originalPrice:r.originalPrice,costPrice:r.costPrice,stockQuantity:r.stock,isAvailable:!1!==r.isAvailable,status:!1!==r.isAvailable?"ACTIVE":"INACTIVE",category:r.category||"",unit:r.unit||"piece",sku:r.sku||"",barcode:r.barcode||"",barcode1:r.barcode1||"",barcode2:r.barcode2||"",barcode3:r.barcode3||"",imageUrl:r.imageUrl||"",masterProductId:r.masterProductId,masterProductName:r.name,masterProduct:void 0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()})),this.usingFallbackData=!1,this.selectedProducts=[],this.selectAll=!1,this.applyFilters(),this.loadCategories(),this.updateSelectAllState(),this.currentPageIndex=0}syncProductsFromServer(){const t=(new gt.Nl).set("page","0").set("size","100000");this.http.get(`${this.apiUrl}/shop-products/my-products`,{params:t}).pipe((0,ot.Q)(this.destroy$)).subscribe({next:r=>{console.log("Full API response:",r);let i=[],a=0;console.log("=== API RESPONSE DEBUG ==="),console.log("Full response:",JSON.stringify(r,null,2)),r&&r.data?r.data.content?(i=r.data.content,a=r.data.totalElements||i.length,console.log("Paginated response - content length:",i.length,"totalElements:",a)):Array.isArray(r.data)?(i=r.data,a=i.length,console.log("Array response - length:",i.length)):console.log("Unexpected response structure:",r.data):Array.isArray(r)&&(i=r,a=i.length,console.log("Direct array response - length:",i.length)),console.log("Products to display:",i.length);const s=i.map(l=>({id:l.id,customName:l.displayName||l.customName||l.masterProduct?.name,description:l.displayDescription||l.customDescription||l.masterProduct?.description,price:l.price,originalPrice:l.originalPrice,costPrice:l.costPrice,stockQuantity:l.stockQuantity,isAvailable:l.isAvailable,status:l.status,category:l.masterProduct?.category?.name,unit:l.baseUnit||l.masterProduct?.baseUnit,sku:l.sku||l.masterProduct?.sku,barcode:l.barcode||l.masterProduct?.barcode||"",barcode1:l.barcode1||"",barcode2:l.barcode2||"",barcode3:l.barcode3||"",imageUrl:l.primaryImageUrl,masterProductId:l.masterProduct?.id,masterProductName:l.masterProduct?.name,masterProduct:l.masterProduct?{id:l.masterProduct.id,name:l.masterProduct.name,nameTamil:l.masterProduct.nameTamil,description:l.masterProduct.description,baseUnit:l.masterProduct.baseUnit,sku:l.masterProduct.sku,tags:l.masterProduct.tags,category:l.masterProduct.category}:void 0,createdAt:l.createdAt,updatedAt:l.updatedAt}));this.products=s,this.saveProductsToCache(s),this.usingFallbackData=!1,this.loadedFromCache=!1,this.selectedProducts=[],this.selectAll=!1,this.applyFilters(),this.loadCategories(),this.updateSelectAllState(),this.currentPageIndex=0,this.loading=!1,console.log("Synced products from server:",this.products.length,"items"),this.mergeOfflineProducts(s)},error:r=>{console.error("Product API error:",r),this.loading=!1,this.loadedFromCache?console.log("Using cached data - server sync failed"):(console.error("Error details:",{status:r.status,statusText:r.statusText,message:r.message,url:r.url}),console.warn("Using fallback product data due to API issues"),this.products=[{id:50,customName:"Coffee Beans Arabica",description:"Premium roasted coffee beans",price:999,costPrice:750,stockQuantity:15,isAvailable:!0,status:"ACTIVE",imageUrl:"https://images.unsplash.com/photo-1559056199-641a0ac8b55e?w=400&h=400&fit=crop",category:"Food & Beverages",unit:"kg",sku:"COFFEE-ARB-001",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:51,customName:"Garden Soil Organic",description:"Premium organic potting soil",price:199,costPrice:150,stockQuantity:8,isAvailable:!0,status:"ACTIVE",imageUrl:"https://images.unsplash.com/photo-1416879595882-3373a0480b5b?w=400&h=400&fit=crop",category:"Garden",unit:"bag",sku:"SOIL-ORG-001",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:49,customName:"Levi's Jeans 501",description:"Classic straight fit denim jeans",price:2999,costPrice:2e3,stockQuantity:25,isAvailable:!0,status:"ACTIVE",imageUrl:"https://images.unsplash.com/photo-1542272604-787c3835535d?w=400&h=400&fit=crop",category:"Clothing",unit:"piece",sku:"LEVI-501-001",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:12,customName:"Dell Laptop XPS 13",description:"High-performance ultrabook for professionals",price:85e3,costPrice:75e3,stockQuantity:3,isAvailable:!0,status:"ACTIVE",imageUrl:"https://images.unsplash.com/photo-1593642702821-c8da6771f0c6?w=400&h=400&fit=crop",category:"Electronics",unit:"piece",sku:"DELL-XPS13-001",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:11,customName:"Samsung Galaxy S24",description:"Latest Samsung smartphone with advanced camera",price:75e3,costPrice:65e3,stockQuantity:5,isAvailable:!0,status:"ACTIVE",imageUrl:"https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=400&h=400&fit=crop",category:"Electronics",unit:"piece",sku:"SGS24-001",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}],this.filteredProducts=[...this.products],this.totalProducts=this.products.length,this.usingFallbackData=!0,this.selectedProducts=[],this.selectAll=!1,this.loadCategories(),this.updateSelectAllState(),this.currentPageIndex=0,this.loading=!1,this.searching=!1,this.snackBar.open("Products loaded (API unavailable - showing sample data)","Close",{duration:5e3,panelClass:["warning-snackbar"]}))}})}loadCategories(){this.categories=[...new Set(this.products.map(t=>t.category).filter(Boolean))]}applyFilter(){this.applyFilters()}getActiveCount(){return this.products.filter(t=>"ACTIVE"===t.status||!0===t.isAvailable).length}getInactiveCount(){return this.products.filter(t=>"INACTIVE"===t.status||!1===t.isAvailable).length}applyFilters(){const t=this.searchTerm?.toLowerCase().trim()||"";this.filteredProducts=this.products.filter(r=>{const i=!t||(r.customName||"").toLowerCase().includes(t)||(r.masterProductName||"").toLowerCase().includes(t)||(r.sku||"").toLowerCase().includes(t),a=!t||r.barcode&&r.barcode.toLowerCase().includes(t)||r.barcode1&&r.barcode1.toLowerCase().includes(t)||r.barcode2&&r.barcode2.toLowerCase().includes(t)||r.barcode3&&r.barcode3.toLowerCase().includes(t);return(i||a)&&(!this.selectedCategory||r.category===this.selectedCategory)&&(!this.selectedStatus||r.status===this.selectedStatus||"available"===this.selectedStatus&&r.isAvailable||"unavailable"===this.selectedStatus&&!r.isAvailable)}),this.filteredProducts.sort((r,i)=>{const a=r.id<0,s=i.id<0;return a&&!s?-1:!a&&s?1:i.id-r.id}),this.totalProducts=this.filteredProducts.length,this.currentPageIndex=0,this.displayLimit=this.LOAD_INCREMENT,this.selectedProducts=this.selectedProducts.filter(r=>this.filteredProducts.some(i=>i.id===r.id)),this.updateSelectAllState(),this.loadCategories()}onStatusDropdownChange(t,r){const i=r.target.value,a="ACTIVE"===i;if(t.status=i,t.isAvailable=a,this.offlineStorage.updateLocalProduct(t.id,{isAvailable:a}).catch(s=>console.warn("Failed to update offline cache:",s)),!this.usingFallbackData)return navigator.onLine?void this.http.patch(`${this.apiUrl}/shop-products/${t.id}/availability`,{isAvailable:a}).pipe((0,ot.Q)(this.destroy$)).subscribe({next:()=>{this.snackBar.open(`Product ${a?"activated":"deactivated"} successfully`,"Close",{duration:2e3})},error:s=>{console.error("Error updating product status:",s),t.isAvailable=!a,t.status=a?"INACTIVE":"ACTIVE",this.snackBar.open("Failed to update product status","Close",{duration:3e3})}}):(this.saveEditOffline(t.id,{isAvailable:a},{isAvailable:!a}),void this.snackBar.open(`Product ${a?"activated":"deactivated"} (saved offline)`,"Close",{duration:2e3}));this.snackBar.open(`Product ${a?"activated":"deactivated"} (demo mode)`,"Close",{duration:2e3})}getStatusClass(t){switch(t?.toUpperCase()){case"ACTIVE":return"status-active";case"INACTIVE":return"status-inactive";case"OUT_OF_STOCK":return"status-out-of-stock";default:return"status-unknown"}}getStockClass(t){return 0===t?"stock-out":t<10?"stock-low":"stock-good"}getProductImageUrl(t){return t.imageUrl&&(0,Mr.V)(t.imageUrl)||"assets/images/product-placeholder.svg"}toggleAvailability(t){t.isAvailable=!t.isAvailable,t.status=t.isAvailable?"ACTIVE":"INACTIVE",this.usingFallbackData?this.snackBar.open(`Product ${t.isAvailable?"activated":"deactivated"} (demo mode)`,"Close",{duration:2e3}):this.http.patch(`${this.apiUrl}/shop-products/${t.id}/availability`,{isAvailable:t.isAvailable}).pipe((0,ot.Q)(this.destroy$)).subscribe({next:()=>{this.snackBar.open(`Product ${t.isAvailable?"activated":"deactivated"} successfully`,"Close",{duration:2e3})},error:r=>{console.error("Error updating product availability:",r),t.isAvailable=!t.isAvailable,t.status=t.isAvailable?"ACTIVE":"INACTIVE",this.snackBar.open("Failed to update product availability","Close",{duration:3e3})}})}updateStockDialog(t){this.dialog.open(cn,{width:"500px",data:{productName:t.customName,currentStock:t.stockQuantity,unit:t.unit}}).afterClosed().subscribe(a=>{a&&this.updateProductStock(t,a.stockQuantity,a.reason)})}updatePrice(t){this.dialog.open(Ao,{width:"500px",data:{productName:t.customName,currentPrice:t.price,costPrice:t.costPrice}}).afterClosed().subscribe(a=>{a&&this.updateProductPrice(t,a.price,a.costPrice)})}clearFilters(){this.searchTerm="",this.selectedCategory="",this.selectedStatus="",this.applyFilters()}onSearchChange(t){this.searchTerm=t.target.value,this.applyFilters()}onCategoryChange(t){this.selectedCategory=t,this.applyFilters()}onStatusChange(t){this.selectedStatus=t,this.applyFilters()}updateProductStatus(t,r){if(this.usingFallbackData)return t.isAvailable=r,void this.snackBar.open(`Product ${r?"enabled":"disabled"} (demo mode)`,"Close",{duration:2e3});console.log("Updating product status:",t.id,r),this.http.put(`${this.apiUrl}/shop-products/${t.id}`,{isAvailable:r}).pipe((0,ot.Q)(this.destroy$)).subscribe({next:()=>{const a=this.products.findIndex(s=>s.id===t.id);-1!==a&&(this.products[a]={...this.products[a],isAvailable:r},this.applyFilters()),this.snackBar.open("Product "+(r?"enabled":"disabled"),"Close",{duration:2e3})},error:a=>{console.error("Error updating product status:",a),t.isAvailable=!r,this.handleError("Failed to update product status")}})}updateProductPrice(t,r,i){if(this.usingFallbackData)return t.price=r,void 0!==i&&(t.costPrice=i),void this.snackBar.open("Price updated (demo mode)","Close",{duration:2e3});console.log("Updating product price:",t.id,r,i);const a={price:r};void 0!==i&&(a.costPrice=i),this.http.put(`${this.apiUrl}/shop-products/${t.id}`,a).pipe((0,ot.Q)(this.destroy$)).subscribe({next:()=>{const s=this.products.findIndex(l=>l.id===t.id);-1!==s&&(this.products[s]={...this.products[s],price:r,...void 0!==i&&{costPrice:i}},this.applyFilters()),this.offlineStorage.updateLocalProduct(t.id,{price:r,...void 0!==i&&{costPrice:i}}).catch(l=>console.warn("Failed to update price in cache:",l)),localStorage.setItem(this.CACHE_TIMESTAMP_KEY,Date.now().toString()),this.snackBar.open("Price updated successfully","Close",{duration:2e3})},error:s=>{console.error("Error updating product price:",s),this.handleError("Failed to update product price")}})}updateProductStock(t,r,i){if(this.usingFallbackData)return t.stockQuantity=r,void this.snackBar.open("Stock updated (demo mode)","Close",{duration:2e3});console.log("Updating product stock:",t.id,r,i),this.http.patch(`${this.apiUrl}/shop-products/${t.id}/inventory?quantity=${r}&operation=SET`,{}).pipe((0,ot.Q)(this.destroy$)).subscribe({next:()=>{const a=this.products.findIndex(s=>s.id===t.id);-1!==a&&(this.products[a]={...this.products[a],stockQuantity:r},this.applyFilters()),this.offlineStorage.updateLocalProduct(t.id,{stock:r}).catch(s=>console.warn("Failed to update stock in cache:",s)),localStorage.setItem(this.CACHE_TIMESTAMP_KEY,Date.now().toString()),this.snackBar.open("Stock updated successfully","Close",{duration:2e3})},error:a=>{console.error("Error updating product stock:",a),this.handleError("Failed to update product stock")}})}editProduct(t){console.log("Editing product:",t),console.log("Product ID:",t.id),console.log("Shop ID:",this.shopId),this.dialog.open(Ts,{width:"600px",data:{id:t.id,customName:t.customName,description:t.description,price:t.price,originalPrice:t.originalPrice,costPrice:t.costPrice,stockQuantity:t.stockQuantity,category:t.category,unit:t.unit,sku:t.sku,status:t.status,isAvailable:t.isAvailable,imageUrl:t.imageUrl,nameTamil:t.masterProduct?.nameTamil||"",tags:t.masterProduct?.tags||"",masterProductId:t.masterProduct?.id,barcode1:t.barcode1||"",barcode2:t.barcode2||"",barcode3:t.barcode3||""}}).afterClosed().subscribe(i=>{i&&(console.log("Dialog result:",i),console.log("Passing product ID to updateProductDetails:",t.id),this.updateProductDetails(t.id,i))})}updateProductDetails(t,r){console.log("updateProductDetails called with productId:",t),console.log("Shop ID:",this.shopId),console.log("Updated data:",r),console.log("Using fallback data?:",this.usingFallbackData);const i=this.products.find(l=>l.id===t),a=i?{price:i.price,originalPrice:i.originalPrice,stockQuantity:i.stockQuantity,sku:i.sku,barcode1:i.barcode1,barcode2:i.barcode2,barcode3:i.barcode3,name:i.customName,nameTamil:i.nameTamil}:{};if(this.usingFallbackData){const l=this.products.findIndex(u=>u.id===t);return-1!==l&&(this.products[l]={...this.products[l],...r},this.applyFilters()),this.saveEditOffline(t,r,a),void this.snackBar.open("Product updated (saved offline)","Close",{duration:2e3})}const s=this.products.findIndex(l=>l.id===t);return-1!==s&&(this.products[s]={...this.products[s],...r},this.applyFilters()),t<0?(this.saveEditOffline(t,r,a),void this.snackBar.open("Product updated (saved offline)","Close",{duration:2e3})):navigator.onLine?void this.http.put(`${this.apiUrl}/shop-products/${t}`,r).pipe((0,ot.Q)(this.destroy$)).subscribe({next:()=>{const l=this.products.findIndex(u=>u.id===t);-1!==l&&(this.products[l]={...this.products[l],customName:r.customName||this.products[l].customName,price:r.price??this.products[l].price,originalPrice:r.originalPrice??this.products[l].originalPrice,costPrice:r.costPrice??this.products[l].costPrice,stockQuantity:r.stockQuantity??this.products[l].stockQuantity,barcode1:r.barcode1??this.products[l].barcode1,barcode2:r.barcode2??this.products[l].barcode2,barcode3:r.barcode3??this.products[l].barcode3},this.applyFilters()),this.offlineStorage.updateLocalProduct(t,{name:r.customName,price:r.price,originalPrice:r.originalPrice,costPrice:r.costPrice,stock:r.stockQuantity,barcode1:r.barcode1,barcode2:r.barcode2,barcode3:r.barcode3}).catch(u=>console.warn("Failed to update cache:",u)),localStorage.setItem(this.CACHE_TIMESTAMP_KEY,Date.now().toString()),this.searchTerm="",this.applyFilters(),this.snackBar.open("Product updated successfully","Close",{duration:2e3})},error:l=>{console.warn("Backend update failed, saving offline:",l),l?.status&&0!==l.status?(this.searchTerm="",this.applyFilters(),this.snackBar.open("Product updated","Close",{duration:2e3})):(this.saveEditOffline(t,r,a),this.searchTerm="",this.applyFilters(),this.snackBar.open("Product updated (saved offline, will sync when online)","Close",{duration:3e3}))}}):(this.saveEditOffline(t,r,a),void this.snackBar.open("Product updated (saved offline, will sync when online)","Close",{duration:3e3}))}saveEditOffline(t,r,i){var a=this;return(0,fe.A)(function*(){try{const s={editId:a.offlineStorage.generateOfflineEditId(),productId:t,shopId:a.shopId||0,changes:{price:r.price,originalPrice:r.originalPrice,stockQuantity:r.stockQuantity,sku:r.sku,barcode1:r.barcode1,barcode2:r.barcode2,barcode3:r.barcode3,customName:r.customName,nameTamil:r.nameTamil},previousValues:i,createdAt:(new Date).toISOString(),synced:!1};yield a.offlineStorage.saveOfflineEdit(s),yield a.offlineStorage.updateLocalProduct(t,{price:r.price,originalPrice:r.originalPrice,stock:r.stockQuantity,sku:r.sku,barcode1:r.barcode1,barcode2:r.barcode2,barcode3:r.barcode3,name:r.customName,nameTamil:r.nameTamil}),console.log("Edit saved offline for product:",t)}catch(s){console.error("Failed to save edit offline:",s)}})()}updateProductWithoutImage(t,r){const i=this.products.findIndex(a=>a.id===t);-1!==i&&(this.products[i]={...this.products[i],...r},this.applyFilters()),this.usingFallbackData?this.snackBar.open("Product updated (demo mode)","Close",{duration:2e3}):this.http.put(`${this.apiUrl}/shop-products/${t}`,r).pipe((0,ot.Q)(this.destroy$)).subscribe({next:()=>{this.loadProducts(),this.snackBar.open("Product updated successfully","Close",{duration:2e3})},error:a=>{console.warn("Backend update failed, but local update successful:",a),this.snackBar.open("Product updated locally","Close",{duration:2e3})}})}deleteProduct(t){if(this.usingFallbackData)return this.products=this.products.filter(r=>r.id!==t.id),this.applyFilters(),void this.snackBar.open("Product deleted (demo mode)","Close",{duration:2e3});if(confirm(`Are you sure you want to delete ${t.customName}?`)){if(console.log("Deleting product:",t.id),t.id<0)return void this.deleteOfflineProduct(t);this.http.delete(`${this.apiUrl}/shop-products/${t.id}`).pipe((0,ot.Q)(this.destroy$)).subscribe({next:()=>{console.log("Product deleted successfully"),this.products=this.products.filter(r=>r.id!==t.id),this.applyFilters(),this.offlineStorage.removeProductFromCache(t.id).catch(r=>console.warn("Failed to remove product from cache:",r)),this.snackBar.open("Product deleted successfully","Close",{duration:2e3})},error:r=>{console.error("Error deleting product:",r),this.handleError("Failed to delete product")}})}}mergeOfflineProducts(t){var r=this;return(0,fe.A)(function*(){try{const i=yield r.offlineStorage.getPendingProductCreations();if(i.length>0){console.log(`Merging ${i.length} pending offline products with server products`);const a=i.map(s=>({id:r.offlineStorage.generateTempProductId(),customName:s.name||s.customName||"New Product",description:s.customDescription||"",price:s.price,originalPrice:s.originalPrice,costPrice:s.costPrice,stockQuantity:s.stockQuantity,isAvailable:!0,status:"ACTIVE",category:s.categoryName||"",unit:s.unit||"piece",sku:s.sku||"",barcode:s.barcode1||"",barcode1:s.barcode1||"",barcode2:s.barcode2||"",barcode3:s.barcode3||"",imageUrl:"",masterProductId:s.masterProductId,masterProductName:s.name||s.customName,masterProduct:void 0,createdAt:s.createdAt,updatedAt:s.createdAt}));r.products=[...a,...t],r.applyFilters(),r.loadCategories(),console.log("Merged offline products, total:",r.products.length)}}catch(i){console.warn("Failed to merge offline products:",i)}})()}saveProductsToCache(t){const r=t.map(i=>({id:i.id,shopId:this.shopId||0,name:i.customName||"",nameTamil:i.masterProduct?.nameTamil,description:i.description,price:i.price,originalPrice:i.originalPrice,costPrice:i.costPrice,stock:i.stockQuantity,trackInventory:!0,isAvailable:i.isAvailable,sku:i.sku||"",barcode:i.barcode,barcode1:i.barcode1,barcode2:i.barcode2,barcode3:i.barcode3,category:i.category,unit:i.unit,imageUrl:i.imageUrl,masterProductId:i.masterProductId}));this.offlineStorage.saveProducts(r,this.shopId||0).then(()=>{localStorage.setItem(this.CACHE_TIMESTAMP_KEY,Date.now().toString()),console.log(`Saved ${r.length} products to IndexedDB cache`)}).catch(i=>{console.warn("Failed to save products to cache:",i)})}deleteOfflineProduct(t){var r=this;return(0,fe.A)(function*(){try{const i=yield r.offlineStorage.getPendingProductCreations();console.log("Looking for offline product to delete:",t.customName),console.log("Pending creations:",i);const a=i.find(s=>s.name&&s.name===t.customName||s.customName&&s.customName===t.customName||s.barcode1&&t.barcode1&&s.barcode1===t.barcode1);a?(yield r.offlineStorage.removeOfflineProductCreation(a.offlineProductId),console.log("Offline product creation removed:",a.offlineProductId)):console.log("No matching offline creation found for product:",t.customName),r.products=r.products.filter(s=>s.id!==t.id),r.applyFilters(),r.snackBar.open(a?"Offline product deleted":"Product removed from list","Close",{duration:2e3})}catch(i){console.error("Error deleting offline product:",i),r.snackBar.open("Failed to delete offline product","Close",{duration:3e3})}})()}bulkDeleteProducts(){if(0===this.selectedProducts.length)return void this.snackBar.open("Please select products to delete","Close",{duration:2e3});const t=this.selectedProducts.length,r=this.selectedProducts.slice(0,3).map(s=>s.customName).join(", ");if(!confirm(`WARNING: You are about to delete ${t} product(s).\n\n${t>3?`${r} and ${t-3} more`:r}\n\nDo you want to proceed?`)||!confirm(`FINAL WARNING: This will permanently delete ${t} product(s) from your shop.\n\nThis action CANNOT be undone.\n\nAre you absolutely sure?`))return;if(t>=50&&"DELETE"!==prompt(`You are deleting ${t} products. Type "DELETE" to confirm:`))return void this.snackBar.open("Deletion cancelled. You must type DELETE to confirm.","Close",{duration:3e3});if(this.usingFallbackData){const s=this.selectedProducts.map(l=>l.id);return this.products=this.products.filter(l=>!s.includes(l.id)),this.clearProductSelection(),this.applyFilters(),void this.snackBar.open(`${t} products deleted (demo mode)`,"Close",{duration:2e3})}const a=this.selectedProducts.map(s=>s.id);console.log("Bulk deleting products:",a),this.http.post(`${this.apiUrl}/shop-products/bulk-delete`,{productIds:a}).pipe((0,ot.Q)(this.destroy$)).subscribe({next:()=>{console.log("Products deleted successfully"),this.products=this.products.filter(s=>!a.includes(s.id)),this.clearProductSelection(),this.applyFilters(),a.forEach(s=>{this.offlineStorage.removeProductFromCache(s).catch(l=>console.warn("Failed to remove product from cache:",l))}),this.snackBar.open(`${t} products deleted successfully`,"Close",{duration:3e3})},error:s=>{console.error("Error bulk deleting products:",s),this.bulkDeleteOneByOne(a)}})}bulkDeleteOneByOne(t){let r=0,i=0;const s=l=>{if(l>=t.length)return this.products=this.products.filter(u=>!t.slice(0,r).includes(u.id)),this.clearProductSelection(),this.applyFilters(),void(0===i?this.snackBar.open(`${r} products deleted successfully`,"Close",{duration:3e3}):this.snackBar.open(`Deleted ${r} products, ${i} failed`,"Close",{duration:5e3}));this.http.delete(`${this.apiUrl}/shop-products/${t[l]}`).pipe((0,ot.Q)(this.destroy$)).subscribe({next:()=>{r++,s(l+1)},error:()=>{i++,s(l+1)}})};s(0)}addNewProduct(){this.router.navigate(["/shop-owner/my-products/add"])}refreshProducts(){localStorage.removeItem(this.CACHE_TIMESTAMP_KEY),this.loadProducts(),this.snackBar.open("Products refreshed from server","Close",{duration:2e3})}handleError(t){this.snackBar.open(t,"Close",{duration:5e3,panelClass:["error-snackbar"]})}formatCurrency(t){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(t)}getStockStatusClass(t){return t<=5?"low-stock":t<=10?"medium-stock":"high-stock"}getStockStatusText(t){return t<=5?"Low Stock":t<=10?"Medium Stock":"In Stock"}bulkUpload(){this.snackBar.open("Bulk upload feature coming soon","Close",{duration:2e3})}duplicateProduct(t){this.snackBar.open("Duplicate product feature coming soon","Close",{duration:2e3})}toggleProductStatus(t){const r=this.products.find(i=>i.id===t);r&&this.updateProductStatus(r,!r.isAvailable)}viewAnalytics(t){this.snackBar.open("Product analytics feature coming soon","Close",{duration:2e3})}updateStock(t){this.snackBar.open("Update stock feature coming soon","Close",{duration:2e3})}get dynamicPageSizeOptions(){const t=[12,24,48,96];return this.totalProducts>96&&!t.includes(this.totalProducts)&&t.push(this.totalProducts),t}onPageChange(t){this.currentPageIndex=t.pageIndex,this.pageSize=t.pageSize,console.log("Page changed:",t.pageIndex,"Page size:",t.pageSize)}toggleProductSelection(t){const r=this.selectedProducts.findIndex(i=>i.id===t.id);r>-1?this.selectedProducts.splice(r,1):this.selectedProducts.push(t),this.updateSelectAllState()}isProductSelected(t){return this.selectedProducts.some(r=>r.id===t.id)}toggleSelectAll(){this.selectedProducts.length===this.filteredProducts.length?(this.selectedProducts=[],this.selectAll=!1):(this.selectedProducts=[...this.filteredProducts],this.selectAll=!0)}updateSelectAllState(){this.selectAll=this.filteredProducts.length>0&&this.selectedProducts.length===this.filteredProducts.length}clearProductSelection(){this.selectedProducts=[],this.selectAll=!1}bulkPriceUpdate(){0!==this.selectedProducts.length?this.dialog.open(dn,{width:"600px",data:{products:this.selectedProducts,usingFallbackData:this.usingFallbackData}}).afterClosed().subscribe(t=>{t&&this.applyBulkPriceUpdate(t)}):this.snackBar.open("Please select products to update prices","Close",{duration:2e3})}applyBulkPriceUpdate(t){if(this.usingFallbackData)return this.selectedProducts.forEach(i=>{"fixed"===t.priceType?i.price=t.newPrice:"percentage"===t.priceType&&(i.price=i.price*(1+t.percentage/100))}),this.snackBar.open(`Updated prices for ${this.selectedProducts.length} products (demo mode)`,"Close",{duration:3e3}),void this.clearProductSelection();const r={productIds:this.selectedProducts.map(i=>i.id),updateType:t.priceType,newPrice:t.newPrice,percentage:t.percentage};this.http.patch(`${this.apiUrl}/shop-products/bulk-price-update`,r).pipe((0,ot.Q)(this.destroy$)).subscribe({next:()=>{this.snackBar.open(`Updated prices for ${this.selectedProducts.length} products`,"Close",{duration:3e3}),this.loadProducts(),this.clearProductSelection()},error:i=>{console.error("Error updating bulk prices:",i),this.snackBar.open("Failed to update prices","Close",{duration:3e3})}})}browseMasterProducts(){let t=this.shopId;if(!t){const i=localStorage.getItem("current_shop_id");i&&(t=parseInt(i,10))}if(!t)return console.error("No shop ID found - user needs to login again"),void this.snackBar.open("Please logout and login again to refresh your shop data","Close",{duration:5e3});this.shopId||(this.shopId=t),console.log("Opening browse dialog with shop ID:",t),this.dialog.open(pa,{width:"900px",maxWidth:"95vw",maxHeight:"90vh",data:{shopId:t}}).afterClosed().subscribe(i=>{i&&this.assignProductToShop(i)})}assignProductToShop(t){var i,r=this;this.shopId&&(console.log("Assigning product to shop:",t),this.shopOwnerProductService.assignProductToShop(this.shopId,{masterProductId:t.masterProduct.id,price:t.sellingPrice,stockQuantity:t.initialStock,customName:t.customName,customDescription:t.customDescription}).pipe((0,ot.Q)(this.destroy$)).subscribe({next:(i=(0,fe.A)(function*(a){console.log("Product assigned successfully:",a);try{const s={id:a.id,shopId:r.shopId,name:a.customName||t.masterProduct.name||"",nameTamil:a.nameTamil||t.masterProduct.nameTamil||"",price:a.price||t.sellingPrice,originalPrice:a.originalPrice||t.sellingPrice,costPrice:a.costPrice||0,stock:a.stockQuantity||t.initialStock||0,trackInventory:!0,isAvailable:!1!==a.isAvailable,sku:a.sku||t.masterProduct.sku||"",barcode:a.barcode1||"",barcode1:a.barcode1||"",barcode2:a.barcode2||"",barcode3:a.barcode3||"",category:a.category||"",unit:a.unit||"piece",imageUrl:a.imageUrl||a.primaryImageUrl||"",tags:a.tags?Array.isArray(a.tags)?a.tags:a.tags.split(",").map(l=>l.trim()):t.masterProduct.tags?t.masterProduct.tags.split(",").map(l=>l.trim()):[]};yield r.offlineStorage.addProductToCache(s),console.log("Added new product to IndexedDB cache:",s)}catch(s){console.warn("Failed to add product to cache:",s)}r.snackBar.open(`Product "${t.masterProduct.name}" assigned to your shop!`,"Close",{duration:3e3}),r.loadProducts()}),function(s){return i.apply(this,arguments)}),error:i=>{console.error("Error assigning product:",i);let a="Failed to assign product to shop";i?.error?.message?a=i.error.message:i?.message&&(a=i.message),this.snackBar.open(a,"Close",{duration:5e3})}}))}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(Xe.Ix),e.rXU(Pe.bZ),e.rXU(Ce.UG),e.rXU(gt.Qq),e.rXU($r.h),e.rXU(Gr),e.rXU(at.m),e.rXU(e.aKT))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-my-products"]],viewQuery:function(r,i){if(1&r&&(e.GBs(lt.iy,5),e.GBs($t.B4,5),e.GBs(gl,5),e.GBs(Is,5)),2&r){let a;e.mGM(a=e.lsd())&&(i.paginator=a.first),e.mGM(a=e.lsd())&&(i.sort=a.first),e.mGM(a=e.lsd())&&(i.scrollableContent=a.first),e.mGM(a=e.lsd())&&(i.searchInput=a.first)}},decls:56,vars:15,consts:[[1,"my-products-container"],[1,"sticky-header"],[1,"products-header"],[1,"header-left"],[1,"active-count"],[1,"inactive-count"],[4,"ngIf"],["class","selection-count",4,"ngIf"],[1,"header-actions"],["mat-raised-button","","color","warn","class","bulk-delete-btn",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",3,"click"],[1,"filters-bar"],[1,"filters-row-1"],["appearance","outline",1,"search-field"],["matInput","","placeholder","Search all products by name, SKU, or description",3,"value","input"],["searchInput",""],["matSuffix","",4,"ngIf"],["matSuffix","","diameter","20",4,"ngIf"],[1,"filter-controls"],["appearance","outline"],[3,"ngModel","ngModelChange","selectionChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["value","ACTIVE"],["value","INACTIVE"],["value","available"],["value","unavailable"],[1,"scrollable-content",3,"scroll"],["class","loading-container",4,"ngIf"],["class","products-list",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"selection-count"],["mat-raised-button","","color","warn",1,"bulk-delete-btn",3,"click"],["matSuffix",""],["matSuffix","","diameter","20"],[3,"value"],[1,"loading-container"],["diameter","40"],[1,"products-list"],[1,"list-container"],["mat-table","",1,"products-table",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","image"],["matColumnDef","name"],["matColumnDef","price"],["matColumnDef","stock"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","product-row",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","pageIndex","page",4,"ngIf"],["class","load-more-container",4,"ngIf"],["mat-header-cell",""],[3,"checked","indeterminate","change"],["mat-cell",""],[3,"checked","change","click"],[1,"product-image"],[3,"appOfflineImg","fallback","alt"],[1,"product-details"],["class","tamil-name",4,"ngIf"],[1,"description"],[1,"meta-tags"],["class","category-tag",4,"ngIf"],["class","sku",4,"ngIf"],[1,"tamil-name"],[1,"category-tag"],[1,"sku"],[1,"price-info"],[1,"price"],[1,"unit"],[1,"stock-info"],[1,"stock-value",3,"ngClass"],[1,"status-dropdown",3,"ngClass","value","change"],[1,"action-buttons"],["mat-icon-button","","color","primary","matTooltip","Edit Product",3,"click"],["mat-icon-button","","matTooltip","Update Price",3,"click"],["mat-icon-button","","matTooltip","Update Stock",3,"click"],["mat-icon-button","","matTooltip","More Options",3,"matMenuTriggerFor"],["actionMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"delete-action",3,"click"],["mat-header-row",""],["mat-row","",1,"product-row"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","pageIndex","page"],[1,"load-more-container"],["class","load-more-spinner",4,"ngIf"],["class","load-more-info",4,"ngIf"],["class","load-more-complete",4,"ngIf"],[1,"load-more-spinner"],["diameter","30"],[1,"load-more-info"],[1,"scroll-hint"],[1,"load-more-complete"],[1,"empty-state"],[1,"empty-icon"],[1,"empty-actions"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],["mat-stroked-button","",3,"click",4,"ngIf"],["mat-button","",3,"click",4,"ngIf"],["mat-stroked-button","",3,"click"],["mat-button","",3,"click"]],template:function(r,i){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1"),e.EFF(5,"My Products"),e.k0s(),e.j41(6,"p"),e.EFF(7),e.j41(8,"span",4),e.EFF(9),e.k0s(),e.EFF(10," \u2022 "),e.j41(11,"span",5),e.EFF(12),e.k0s(),e.DNE(13,Rt,2,1,"span",6),e.DNE(14,pl,4,1,"span",7),e.k0s()(),e.j41(15,"div",8),e.DNE(16,vr,4,1,"button",9),e.j41(17,"button",10),e.bIt("click",function(){return i.addNewProduct()}),e.j41(18,"mat-icon"),e.EFF(19,"add"),e.k0s(),e.EFF(20," Add Custom Product "),e.k0s()()(),e.j41(21,"div",11)(22,"div",12)(23,"mat-form-field",13)(24,"mat-label"),e.EFF(25,"Search products..."),e.k0s(),e.j41(26,"input",14,15),e.bIt("input",function(s){return i.onSearchChange(s)}),e.k0s(),e.DNE(28,lo,2,0,"mat-icon",16),e.DNE(29,Rs,1,0,"mat-spinner",17),e.k0s(),e.j41(30,"div",18)(31,"mat-form-field",19)(32,"mat-label"),e.EFF(33,"Category"),e.k0s(),e.j41(34,"mat-select",20),e.bIt("ngModelChange",function(s){return i.selectedCategory=s})("selectionChange",function(s){return i.onCategoryChange(s.value)}),e.j41(35,"mat-option",21),e.EFF(36,"All Categories"),e.k0s(),e.DNE(37,fl,2,2,"mat-option",22),e.k0s()(),e.j41(38,"mat-form-field",19)(39,"mat-label"),e.EFF(40,"Status"),e.k0s(),e.j41(41,"mat-select",20),e.bIt("ngModelChange",function(s){return i.selectedStatus=s})("selectionChange",function(s){return i.onStatusChange(s.value)}),e.j41(42,"mat-option",21),e.EFF(43,"All Status"),e.k0s(),e.j41(44,"mat-option",23),e.EFF(45,"Active"),e.k0s(),e.j41(46,"mat-option",24),e.EFF(47,"Inactive"),e.k0s(),e.j41(48,"mat-option",25),e.EFF(49,"Available"),e.k0s(),e.j41(50,"mat-option",26),e.EFF(51,"Unavailable"),e.k0s()()()()()()(),e.j41(52,"div",27),e.bIt("scroll",function(s){return i.onContentScroll(s)}),e.DNE(53,Ns,4,2,"div",28),e.DNE(54,dr,28,6,"div",29),e.DNE(55,Ml,12,5,"div",30),e.k0s()()),2&r&&(e.R7$(7),e.SpI(" ",i.products.length," products in your shop \u2022 "),e.R7$(2),e.SpI("",i.getActiveCount()," Active"),e.R7$(3),e.SpI("",i.getInactiveCount()," Inactive"),e.R7$(1),e.Y8G("ngIf",i.filteredProducts.length!==i.products.length),e.R7$(1),e.Y8G("ngIf",i.selectedProducts.length>0),e.R7$(2),e.Y8G("ngIf",i.selectedProducts.length>0),e.R7$(10),e.Y8G("value",i.searchTerm),e.R7$(2),e.Y8G("ngIf",!i.searching),e.R7$(1),e.Y8G("ngIf",i.searching),e.R7$(5),e.Y8G("ngModel",i.selectedCategory),e.R7$(3),e.Y8G("ngForOf",i.categories),e.R7$(4),e.Y8G("ngModel",i.selectedStatus),e.R7$(12),e.Y8G("ngIf",i.loading),e.R7$(1),e.Y8G("ngIf",!i.loading),e.R7$(1),e.Y8G("ngIf",!i.loading&&0===i.filteredProducts.length))},dependencies:[D.YU,D.Sq,D.bT,b.xH,b.y7,b.BC,b.vS,fi,j.RN,B.$z,B.iY,H.An,X.LG,me.q,ae.kk,ae.fb,ae.Cp,ge.rl,ge.nJ,ge.yw,Ee.fg,_e.Zl,_e.tL,_e.ji,_e.cC,_e.YV,_e.iL,_e.KS,_e.$R,_e.YZ,_e.NB,lt.iy,ze.VO,Bt.wT,qe.oV,it.So,D.QX],styles:[".my-products-container[_ngcontent-%COMP%]{padding:0;background:#f5f5f5;display:flex;flex-direction:column;height:calc(100vh - 120px)}.my-products-container[_ngcontent-%COMP%]   .sticky-header[_ngcontent-%COMP%]{flex-shrink:0;z-index:10;background:#f5f5f5;padding:16px 24px 8px;border-bottom:1px solid #e0e0e0}.my-products-container[_ngcontent-%COMP%]   .scrollable-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:0 24px 24px;scroll-behavior:smooth}.my-products-container[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.my-products-container[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 4px;color:#333;font-size:1.75rem;font-weight:600}.my-products-container[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666;font-size:.875rem}.my-products-container[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   .active-count[_ngcontent-%COMP%]{color:#4caf50;font-weight:500}.my-products-container[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   .inactive-count[_ngcontent-%COMP%]{color:#f44336;font-weight:500}.my-products-container[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   .selection-count[_ngcontent-%COMP%]{color:#d32f2f}.my-products-container[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.my-products-container[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .bulk-delete-btn[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .2s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-4px)}to{opacity:1;transform:translateY(0)}}.my-products-container[_ngcontent-%COMP%]   .filters-bar[_ngcontent-%COMP%]{margin-bottom:0}.my-products-container[_ngcontent-%COMP%]   .filters-bar[_ngcontent-%COMP%]   .filters-row-1[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:16px;flex-wrap:wrap}.my-products-container[_ngcontent-%COMP%]   .filters-bar[_ngcontent-%COMP%]   .filters-row-1[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]{flex:1;min-width:300px}.my-products-container[_ngcontent-%COMP%]   .filters-bar[_ngcontent-%COMP%]   .filters-row-1[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]{display:flex;gap:16px}.my-products-container[_ngcontent-%COMP%]   .filters-bar[_ngcontent-%COMP%]   .filters-row-1[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{min-width:150px}.my-products-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]{text-align:center;padding:60px 20px}.my-products-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin-bottom:16px}.my-products-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;margin:0}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .list-container[_ngcontent-%COMP%]{padding:0;overflow:hidden}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]{width:100%}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]{background-color:#fafafa;border-bottom:2px solid #e0e0e0}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]{font-weight:600;color:#333;font-size:.875rem;text-transform:uppercase;letter-spacing:.5px}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{padding:16px;vertical-align:middle}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .mat-column-select[_ngcontent-%COMP%]{width:48px;max-width:48px;padding-right:0!important}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .product-image[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:8px;overflow:hidden;border:1px solid #e0e0e0;background:#f5f5f5;display:flex;align-items:center;justify-content:center}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .product-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;display:block}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 4px;font-size:1rem;font-weight:600;color:#333}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .tamil-name[_ngcontent-%COMP%]{display:block;color:#666;font-size:.875rem;margin-bottom:4px}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{margin:0 0 8px;color:#666;font-size:.875rem;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .meta-tags[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center;flex-wrap:wrap}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .meta-tags[_ngcontent-%COMP%]   .category-tag[_ngcontent-%COMP%]{background:#E3F2FD;color:#1976d2;padding:2px 8px;border-radius:12px;font-size:.75rem;font-weight:500;white-space:nowrap}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .meta-tags[_ngcontent-%COMP%]   .sku[_ngcontent-%COMP%]{color:#999;font-size:.75rem}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .price-info[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{display:block;font-size:1.125rem;font-weight:600;color:#ff6b35}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .price-info[_ngcontent-%COMP%]   .unit[_ngcontent-%COMP%]{font-size:.75rem;color:#999}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .stock-info[_ngcontent-%COMP%]   .stock-value[_ngcontent-%COMP%]{font-weight:600;font-size:1rem}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .stock-info[_ngcontent-%COMP%]   .stock-value.high[_ngcontent-%COMP%]{color:#4caf50}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .stock-info[_ngcontent-%COMP%]   .stock-value.low[_ngcontent-%COMP%]{color:#ff9800}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .stock-info[_ngcontent-%COMP%]   .stock-value.out[_ngcontent-%COMP%]{color:#f44336}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .status-dropdown[_ngcontent-%COMP%]{padding:6px 10px;border-radius:16px;font-size:.75rem;font-weight:600;border:1px solid #e0e0e0;cursor:pointer;outline:none;appearance:auto}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .status-dropdown.status-active[_ngcontent-%COMP%]{background:#E8F5E9;color:#2e7d32}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .status-dropdown.status-inactive[_ngcontent-%COMP%]{background:#F5F5F5;color:#757575}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;gap:4px;align-items:center}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button.mat-icon-button[_ngcontent-%COMP%]{width:36px;height:36px;line-height:36px}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button.mat-icon-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px}.my-products-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:80px 20px}.my-products-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{margin-bottom:16px}.my-products-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#ccc}.my-products-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;color:#333;font-size:1.25rem}.my-products-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 24px;color:#666;font-size:.875rem}.my-products-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:center;flex-wrap:wrap}.my-products-container[_ngcontent-%COMP%]   mat-paginator[_ngcontent-%COMP%]{margin-top:24px;border-top:1px solid #e0e0e0;padding-top:16px}.my-products-container[_ngcontent-%COMP%]   .load-more-container[_ngcontent-%COMP%]{padding:16px;text-align:center;border-top:1px solid #e0e0e0}.my-products-container[_ngcontent-%COMP%]   .load-more-container[_ngcontent-%COMP%]   .load-more-spinner[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:12px;color:#666;font-size:.875rem}.my-products-container[_ngcontent-%COMP%]   .load-more-container[_ngcontent-%COMP%]   .load-more-spinner[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin:0}.my-products-container[_ngcontent-%COMP%]   .load-more-container[_ngcontent-%COMP%]   .load-more-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;color:#666;font-size:.875rem}.my-products-container[_ngcontent-%COMP%]   .load-more-container[_ngcontent-%COMP%]   .load-more-info[_ngcontent-%COMP%]   .scroll-hint[_ngcontent-%COMP%]{color:#999;font-size:.75rem}.my-products-container[_ngcontent-%COMP%]   .load-more-container[_ngcontent-%COMP%]   .load-more-complete[_ngcontent-%COMP%]{color:#4caf50;font-size:.875rem;font-weight:500}.delete-action[_ngcontent-%COMP%]{color:#f44336!important}@media (max-width: 1024px){.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{padding:12px 8px}}@media (max-width: 768px){.my-products-container[_ngcontent-%COMP%]{padding:16px}.my-products-container[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]{flex-direction:column;gap:16px;align-items:stretch}.my-products-container[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]{text-align:center}.my-products-container[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{justify-content:center;flex-wrap:wrap}.my-products-container[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;min-width:140px}.my-products-container[_ngcontent-%COMP%]   .filters-bar[_ngcontent-%COMP%]   .filters-row-1[_ngcontent-%COMP%]{flex-direction:column}.my-products-container[_ngcontent-%COMP%]   .filters-bar[_ngcontent-%COMP%]   .filters-row-1[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]{min-width:unset}.my-products-container[_ngcontent-%COMP%]   .filters-bar[_ngcontent-%COMP%]   .filters-row-1[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.my-products-container[_ngcontent-%COMP%]   .filters-bar[_ngcontent-%COMP%]   .filters-row-1[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{min-width:unset}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]{overflow-x:auto}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]{min-width:700px}}@media (max-width: 480px){.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .product-image[_ngcontent-%COMP%]{width:40px;height:40px}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.875rem}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{display:none}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{padding:8px 4px;font-size:.875rem}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button.mat-icon-button[_ngcontent-%COMP%]{width:32px;height:32px;line-height:32px}.my-products-container[_ngcontent-%COMP%]   .products-list[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button.mat-icon-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px}}"]})}}return n})();var Ii={version:"0.18.5"},Kn=1200,Sn=1252,Ri=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ma={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ur=function(n){-1!=Ri.indexOf(n)&&(Sn=Ma[0]=n)},Tn=function(n){Kn=n,ur(n)};var Nt,gr=function(o){return String.fromCharCode(o)},Ai=function(o){return String.fromCharCode(o)},on=null,Jr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Er(n){for(var o="",t=0,r=0,i=0,a=0,s=0,l=0,u=0,p=0;p<n.length;)a=(t=n.charCodeAt(p++))>>2,s=(3&t)<<4|(r=n.charCodeAt(p++))>>4,l=(15&r)<<2|(i=n.charCodeAt(p++))>>6,u=63&i,isNaN(r)?l=u=64:isNaN(i)&&(u=64),o+=Jr.charAt(a)+Jr.charAt(s)+Jr.charAt(l)+Jr.charAt(u);return o}function tr(n){var o="",a=0,s=0,l=0,u=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var p=0;p<n.length;)a=Jr.indexOf(n.charAt(p++)),s=Jr.indexOf(n.charAt(p++)),o+=String.fromCharCode(a<<2|s>>4),64!==(l=Jr.indexOf(n.charAt(p++)))&&(o+=String.fromCharCode((15&s)<<4|l>>2)),64!==(u=Jr.indexOf(n.charAt(p++)))&&(o+=String.fromCharCode((3&l)<<6|u));return o}var dt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),pr=function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(o,t){return t?new Buffer(o,t):new Buffer(o)}:Buffer.from.bind(Buffer)}return function(){}}();function Ur(n){return dt?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function Uo(n){return dt?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var Rn=function(o){return dt?pr(o,"binary"):o.split("").map(function(t){return 255&t.charCodeAt(0)})};function hi(n){if(typeof ArrayBuffer>"u")return Rn(n);for(var o=new ArrayBuffer(n.length),t=new Uint8Array(o),r=0;r!=n.length;++r)t[r]=255&n.charCodeAt(r);return o}function Pr(n){if(Array.isArray(n))return n.map(function(r){return String.fromCharCode(r)}).join("");for(var o=[],t=0;t<n.length;++t)o[t]=String.fromCharCode(n[t]);return o.join("")}var un=dt?function(n){return Buffer.concat(n.map(function(o){return Buffer.isBuffer(o)?o:pr(o)}))}:function(n){if(typeof Uint8Array<"u"){var o=0,t=0;for(o=0;o<n.length;++o)t+=n[o].length;var r=new Uint8Array(t),i=0;for(o=0,t=0;o<n.length;t+=i,++o)if(i=n[o].length,n[o]instanceof Uint8Array)r.set(n[o],t);else{if("string"==typeof n[o])throw"wtf";r.set(new Uint8Array(n[o]),t)}return r}return[].concat.apply([],n.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))},Nn=/\u0000/g,Kr=/[\u0001-\u0006]/g;function Bi(n){for(var o="",t=n.length-1;t>=0;)o+=n.charAt(t--);return o}function fr(n,o){var t=""+n;return t.length>=o?t:pn("0",o-t.length)+t}function wa(n,o){var t=""+n;return t.length>=o?t:pn(" ",o-t.length)+t}function po(n,o){var t=""+n;return t.length>=o?t:t+pn(" ",o-t.length)}var fo=Math.pow(2,32);function Li(n,o){return n>fo||n<-fo?function El(n,o){var t=""+Math.round(n);return t.length>=o?t:pn("0",o-t.length)+t}(n,o):function Sr(n,o){var t=""+n;return t.length>=o?t:pn("0",o-t.length)+t}(Math.round(n),o)}function _i(n,o){return n.length>=7+(o=o||0)&&103==(32|n.charCodeAt(o))&&101==(32|n.charCodeAt(o+1))&&110==(32|n.charCodeAt(o+2))&&101==(32|n.charCodeAt(o+3))&&114==(32|n.charCodeAt(o+4))&&97==(32|n.charCodeAt(o+5))&&108==(32|n.charCodeAt(o+6))}var Hs=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],zo=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],tt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Ws={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$i={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function mo(n,o,t){for(var r=n<0?-1:1,i=n*r,a=0,s=1,l=0,u=1,p=0,f=0,h=Math.floor(i);p<o&&(l=(h=Math.floor(i))*s+a,f=h*p+u,!(i-h<5e-8));)i=1/(i-h),a=s,s=l,u=p,p=f;if(f>o&&(p>o?(f=u,l=a):(f=p,l=s)),!t)return[0,r*l,f];var _=Math.floor(r*l/f);return[_,r*l-_*f,f]}function zr(n,o,t){if(n>2958465||n<0)return null;var r=0|n,i=Math.floor(86400*(n-r)),a=0,s=[],l={D:r,T:i,u:86400*(n-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),o&&o.date1904&&(r+=1462),l.u>.9999&&(l.u=0,86400==++i&&(l.T=i=0,++r,++l.D)),60===r)s=t?[1317,10,29]:[1900,2,29],a=3;else if(0===r)s=t?[1317,8,29]:[1900,1,0],a=6;else{r>60&&--r;var u=new Date(1900,0,1);u.setDate(u.getDate()+r-1),s=[u.getFullYear(),u.getMonth()+1,u.getDate()],a=u.getDay(),r<60&&(a=(a+6)%7),t&&(a=function Il(n,o){o[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}(u,s))}return l.y=s[0],l.m=s[1],l.d=s[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=a,l}var qs=new Date(1899,11,31,0,0,0),Vr=qs.getTime(),Zs=new Date(1900,2,1,0,0,0);function Fa(n,o){var t=n.getTime();return o?t-=1262304e5:n>=Zs&&(t+=864e5),(t-(Vr+6e4*(n.getTimezoneOffset()-qs.getTimezoneOffset())))/864e5}function xi(n){return-1==n.indexOf(".")?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function ei(n,o){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(0|n)===n?n.toString(10):function Gi(n){var t,o=Math.floor(Math.log(Math.abs(n))*Math.LOG10E);return t=o>=-4&&o<=-1?n.toPrecision(10+o):Math.abs(o)<=9?function Vo(n){var o=n<0?12:11,t=xi(n.toFixed(12));return t.length<=o||(t=n.toPrecision(10)).length<=o?t:n.toExponential(5)}(n):10===o?n.toFixed(10).substr(0,12):function ho(n){var o=xi(n.toFixed(11));return o.length>(n<0?12:11)||"0"===o||"-0"===o?n.toPrecision(6):o}(n),xi(function Tl(n){return-1==n.indexOf("E")?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}(n);case"undefined":return"";case"object":if(null==n)return"";if(n instanceof Date)return Un(14,Fa(n,o&&o.date1904),o)}throw new Error("unsupported value in General format: "+n)}function Qs(n,o,t,r){var u,i="",a=0,s=0,l=t.y,p=0;switch(n){case 98:l=t.y+543;case 121:switch(o.length){case 1:case 2:u=l%100,p=2;break;default:u=l%1e4,p=4}break;case 109:switch(o.length){case 1:case 2:u=t.m,p=o.length;break;case 3:return zo[t.m-1][1];case 5:return zo[t.m-1][0];default:return zo[t.m-1][2]}break;case 100:switch(o.length){case 1:case 2:u=t.d,p=o.length;break;case 3:return Hs[t.q][0];default:return Hs[t.q][1]}break;case 104:switch(o.length){case 1:case 2:u=1+(t.H+11)%12,p=o.length;break;default:throw"bad hour format: "+o}break;case 72:switch(o.length){case 1:case 2:u=t.H,p=o.length;break;default:throw"bad hour format: "+o}break;case 77:switch(o.length){case 1:case 2:u=t.M,p=o.length;break;default:throw"bad minute format: "+o}break;case 115:if("s"!=o&&"ss"!=o&&".0"!=o&&".00"!=o&&".000"!=o)throw"bad second format: "+o;return 0!==t.u||"s"!=o&&"ss"!=o?(s=r>=2?3===r?1e3:100:1===r?10:1,(a=Math.round(s*(t.S+t.u)))>=60*s&&(a=0),"s"===o?0===a?"0":""+a/s:(i=fr(a,2+r),"ss"===o?i.substr(0,2):"."+i.substr(2,o.length-1))):fr(t.S,o.length);case 90:switch(o){case"[h]":case"[hh]":u=24*t.D+t.H;break;case"[m]":case"[mm]":u=60*(24*t.D+t.H)+t.M;break;case"[s]":case"[ss]":u=60*(60*(24*t.D+t.H)+t.M)+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+o}p=3===o.length?1:2;break;case 101:u=l,p=1}return p>0?fr(u,p):""}function Yr(n){if(n.length<=3)return n;for(var t=n.length%3,r=n.substr(0,t);t!=n.length;t+=3)r+=(r.length>0?",":"")+n.substr(t,3);return r}var Ea=/%/g;function ec(n,o){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(0==o)return"0.0E+0";if(o<0)return"-"+ec(n,-o);var i=n.indexOf(".");-1===i&&(i=n.indexOf("E"));var a=Math.floor(Math.log(o)*Math.LOG10E)%i;if(a<0&&(a+=i),-1===(t=(o/Math.pow(10,a)).toPrecision(r+1+(i+a)%i)).indexOf("e")){var s=Math.floor(Math.log(o)*Math.LOG10E);for(-1===t.indexOf(".")?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+a):t+="E+"+(s-a);"0."===t.substr(0,2);)t=(t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,p,f){return u+p+f.substr(0,(i+a)%i)+"."+f.substr(a)+"E"})}else t=o.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Sa=/# (\?+)( ?)\/( ?)(\d+)/,c=/^#*0*\.([0#]+)/,d=/\).*[0#]/,g=/\(###\) ###\\?-####/;function m(n){for(var t,o="",r=0;r!=n.length;++r)switch(t=n.charCodeAt(r)){case 35:break;case 63:o+=" ";break;case 48:o+="0";break;default:o+=String.fromCharCode(t)}return o}function v(n,o){var t=Math.pow(10,o);return""+Math.round(n*t)/t}function O(n,o){var t=n-Math.floor(n),r=Math.pow(10,o);return o<(""+Math.round(t*r)).length?0:Math.round(t*r)}function te(n,o,t){if(40===n.charCodeAt(0)&&!o.match(d)){var r=o.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?te("n",r,t):"("+te("n",r,-t)+")"}if(44===o.charCodeAt(o.length-1))return function Ks(n,o,t){for(var r=o.length-1;44===o.charCodeAt(r-1);)--r;return en(n,o.substr(0,r),t/Math.pow(10,3*(o.length-r)))}(n,o,t);if(-1!==o.indexOf("%"))return function Js(n,o,t){var r=o.replace(Ea,""),i=o.length-r.length;return en(n,r,t*Math.pow(10,2*i))+pn("%",i)}(n,o,t);if(-1!==o.indexOf("E"))return ec(o,t);if(36===o.charCodeAt(0))return"$"+te(n,o.substr(" "==o.charAt(1)?2:1),t);var i,a,s,l,u=Math.abs(t),p=t<0?"-":"";if(o.match(/^00+$/))return p+Li(u,o.length);if(o.match(/^[#?]+$/))return"0"===(i=Li(t,0))&&(i=""),i.length>o.length?i:m(o.substr(0,o.length-i.length))+i;if(a=o.match(Sa))return function tc(n,o,t){var r=parseInt(n[4],10),i=Math.round(o*r),a=Math.floor(i/r),s=i-a*r,l=r;return t+(0===a?"":""+a)+" "+(0===s?pn(" ",n[1].length+1+n[4].length):wa(s,n[1].length)+n[2]+"/"+n[3]+fr(l,n[4].length))}(a,u,p);if(o.match(/^#+0+$/))return p+Li(u,o.length-o.indexOf("0"));if(a=o.match(c))return i=v(t,a[1].length).replace(/^([^\.]+)$/,"$1."+m(a[1])).replace(/\.$/,"."+m(a[1])).replace(/\.(\d*)$/,function(P,x){return"."+x+pn("0",m(a[1]).length-x.length)}),-1!==o.indexOf("0.")?i:i.replace(/^0\./,".");if(o=o.replace(/^#+([0.])/,"$1"),a=o.match(/^(0*)\.(#*)$/))return p+v(u,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=o.match(/^#{1,3},##0(\.?)$/))return p+Yr(Li(u,0));if(a=o.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+te(n,o,-t):Yr(""+(Math.floor(t)+function z(n,o){return o<(""+Math.round((n-Math.floor(n))*Math.pow(10,o))).length?1:0}(t,a[1].length)))+"."+fr(O(t,a[1].length),a[1].length);if(a=o.match(/^#,#*,#0/))return te(n,o.replace(/^#,#*,/,""),t);if(a=o.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Bi(te(n,o.replace(/[\\-]/g,""),t)),s=0,Bi(Bi(o.replace(/\\/g,"")).replace(/[0#]/g,function(P){return s<i.length?i.charAt(s++):"0"===P?"0":""}));if(o.match(g))return"("+(i=te(n,"##########",t)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(a=o.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),l=mo(u,Math.pow(10,s)-1,!1),i=""+p," "==(f=en("n",a[1],l[1])).charAt(f.length-1)&&(f=f.substr(0,f.length-1)+"0"),i+=f+a[2]+"/"+a[3],(f=po(l[2],s)).length<a[4].length&&(f=m(a[4].substr(a[4].length-f.length))+f),i+=f;if(a=o.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),p+((l=mo(u,Math.pow(10,s)-1,!0))[0]||(l[1]?"":"0"))+" "+(l[1]?wa(l[1],s)+a[2]+"/"+a[3]+po(l[2],s):pn(" ",2*s+1+a[2].length+a[3].length));if(a=o.match(/^[#0?]+$/))return i=Li(t,0),o.length<=i.length?i:m(o.substr(0,o.length-i.length))+i;if(a=o.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var h=o.indexOf(".")-s,_=o.length-i.length-h;return m(o.substr(0,h)+i+o.substr(o.length-_))}if(a=o.match(/^00,000\.([#0]*0)$/))return s=O(t,a[1].length),t<0?"-"+te(n,o,-t):Yr(function J(n){return n<2147483647&&n>-2147483648?""+(n>=0?0|n:n-1|0):""+Math.floor(n)}(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(P){return"00,"+(P.length<3?fr(0,3-P.length):"")+P})+"."+fr(s,a[1].length);switch(o){case"###,##0.00":return te(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var C=Yr(Li(u,0));return"0"!==C?p+C:"";case"###,###.00":return te(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return te(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+o+"|")}function st(n,o){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(0==o)return"0.0E+0";if(o<0)return"-"+st(n,-o);var i=n.indexOf(".");-1===i&&(i=n.indexOf("E"));var a=Math.floor(Math.log(o)*Math.LOG10E)%i;if(a<0&&(a+=i),!(t=(o/Math.pow(10,a)).toPrecision(r+1+(i+a)%i)).match(/[Ee]/)){var s=Math.floor(Math.log(o)*Math.LOG10E);-1===t.indexOf(".")?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+a):t+="E+"+(s-a),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,p,f){return u+p+f.substr(0,(i+a)%i)+"."+f.substr(a)+"E"})}else t=o.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function ut(n,o,t){if(40===n.charCodeAt(0)&&!o.match(d)){var r=o.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ut("n",r,t):"("+ut("n",r,-t)+")"}if(44===o.charCodeAt(o.length-1))return function be(n,o,t){for(var r=o.length-1;44===o.charCodeAt(r-1);)--r;return en(n,o.substr(0,r),t/Math.pow(10,3*(o.length-r)))}(n,o,t);if(-1!==o.indexOf("%"))return function Ge(n,o,t){var r=o.replace(Ea,""),i=o.length-r.length;return en(n,r,t*Math.pow(10,2*i))+pn("%",i)}(n,o,t);if(-1!==o.indexOf("E"))return st(o,t);if(36===o.charCodeAt(0))return"$"+ut(n,o.substr(" "==o.charAt(1)?2:1),t);var i,a,s,l,u=Math.abs(t),p=t<0?"-":"";if(o.match(/^00+$/))return p+fr(u,o.length);if(o.match(/^[#?]+$/))return i=""+t,0===t&&(i=""),i.length>o.length?i:m(o.substr(0,o.length-i.length))+i;if(a=o.match(Sa))return function Rl(n,o,t){return t+(0===o?"":""+o)+pn(" ",n[1].length+2+n[4].length)}(a,u,p);if(o.match(/^#+0+$/))return p+fr(u,o.length-o.indexOf("0"));if(a=o.match(c))return i=(i=(""+t).replace(/^([^\.]+)$/,"$1."+m(a[1])).replace(/\.$/,"."+m(a[1]))).replace(/\.(\d*)$/,function(P,x){return"."+x+pn("0",m(a[1]).length-x.length)}),-1!==o.indexOf("0.")?i:i.replace(/^0\./,".");if(o=o.replace(/^#+([0.])/,"$1"),a=o.match(/^(0*)\.(#*)$/))return p+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=o.match(/^#{1,3},##0(\.?)$/))return p+Yr(""+u);if(a=o.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ut(n,o,-t):Yr(""+t)+"."+pn("0",a[1].length);if(a=o.match(/^#,#*,#0/))return ut(n,o.replace(/^#,#*,/,""),t);if(a=o.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Bi(ut(n,o.replace(/[\\-]/g,""),t)),s=0,Bi(Bi(o.replace(/\\/g,"")).replace(/[0#]/g,function(P){return s<i.length?i.charAt(s++):"0"===P?"0":""}));if(o.match(g))return"("+(i=ut(n,"##########",t)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(a=o.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),l=mo(u,Math.pow(10,s)-1,!1),i=""+p," "==(f=en("n",a[1],l[1])).charAt(f.length-1)&&(f=f.substr(0,f.length-1)+"0"),i+=f+a[2]+"/"+a[3],(f=po(l[2],s)).length<a[4].length&&(f=m(a[4].substr(a[4].length-f.length))+f),i+=f;if(a=o.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),p+((l=mo(u,Math.pow(10,s)-1,!0))[0]||(l[1]?"":"0"))+" "+(l[1]?wa(l[1],s)+a[2]+"/"+a[3]+po(l[2],s):pn(" ",2*s+1+a[2].length+a[3].length));if(a=o.match(/^[#0?]+$/))return o.length<=(i=""+t).length?i:m(o.substr(0,o.length-i.length))+i;if(a=o.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var h=o.indexOf(".")-s,_=o.length-i.length-h;return m(o.substr(0,h)+i+o.substr(o.length-_))}if(a=o.match(/^00,000\.([#0]*0)$/))return t<0?"-"+ut(n,o,-t):Yr(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(P){return"00,"+(P.length<3?fr(0,3-P.length):"")+P})+"."+fr(0,a[1].length);switch(o){case"###,###":case"##,###":case"#,###":var C=Yr(""+u);return"0"!==C?p+C:"";default:if(o.match(/\.[0#?]*$/))return ut(n,o.slice(0,o.lastIndexOf(".")),t)+m(o.slice(o.lastIndexOf(".")))}throw new Error("unsupported format |"+o+"|")}function en(n,o,t){return(0|t)===t?ut(n,o,t):te(n,o,t)}var nr=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function xn(n){for(var o=0,t="",r="";o<n.length;)switch(t=n.charAt(o)){case"G":_i(n,o)&&(o+=6),o++;break;case'"':for(;34!==n.charCodeAt(++o)&&o<n.length;);++o;break;case"\\":case"_":o+=2;break;case"@":++o;break;case"B":case"b":if("1"===n.charAt(o+1)||"2"===n.charAt(o+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===n.substr(o,3).toUpperCase()||"AM/PM"===n.substr(o,5).toUpperCase()||"\u4e0a\u5348/\u4e0b\u5348"===n.substr(o,5).toUpperCase())return!0;++o;break;case"[":for(r=t;"]"!==n.charAt(o++)&&o<n.length;)r+=n.charAt(o);if(r.match(nr))return!0;break;case".":case"0":case"#":for(;o<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++o))>-1||"\\"==t&&"-"==n.charAt(o+1)&&"0#".indexOf(n.charAt(o+2))>-1););break;case"?":for(;n.charAt(++o)===t;);break;case"*":++o,(" "==n.charAt(o)||"*"==n.charAt(o))&&++o;break;case"(":case")":++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;o<n.length&&"0123456789".indexOf(n.charAt(++o))>-1;);break;default:++o}return!1}var nc=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function rc(n,o){if(null==o)return!1;var t=parseFloat(o[2]);switch(o[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0}return!1}function Un(n,o,t){null==t&&(t={});var r="";switch(typeof n){case"string":r="m/d/yy"==n&&t.dateNF?t.dateNF:n;break;case"number":null==(r=14==n&&t.dateNF?t.dateNF:(null!=t.table?t.table:tt)[n])&&(r=t.table&&t.table[Ws[n]]||tt[Ws[n]]),null==r&&(r=$i[n]||"General")}if(_i(r,0))return ei(o,t);o instanceof Date&&(o=Fa(o,t.date1904));var i=function Nl(n,o){var t=function kn(n){for(var o=[],t=!1,r=0,i=0;r<n.length;++r)switch(n.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:o[o.length]=n.substr(i,r-i),i=r+1}if(o[o.length]=n.substr(i),!0===t)throw new Error("Format |"+n+"| unterminated string ");return o}(n),r=t.length,i=t[r-1].indexOf("@");if(r<4&&i>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if("number"!=typeof o)return[4,4===t.length||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"]}var a=o>0?t[0]:o<0?t[1]:t[2];if(-1===t[0].indexOf("[")&&-1===t[1].indexOf("["))return[r,a];if(null!=t[0].match(/\[[=<>]/)||null!=t[1].match(/\[[=<>]/)){var s=t[0].match(nc),l=t[1].match(nc);return rc(o,s)?[r,t[0]]:rc(o,l)?[r,t[1]]:[r,t[null!=s&&null!=l?2:1]]}return[r,a]}(r,o);if(_i(i[1]))return ei(o,t);if(!0===o)o="TRUE";else if(!1===o)o="FALSE";else if(""===o||null==o)return"";return function Ui(n,o,t,r){for(var p,f,h,i=[],a="",s=0,l="",u="t",_="H";s<n.length;)switch(l=n.charAt(s)){case"G":if(!_i(n,s))throw new Error("unrecognized character "+l+" in "+n);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(a="";34!==(h=n.charCodeAt(++s))&&s<n.length;)a+=String.fromCharCode(h);i[i.length]={t:"t",v:a},++s;break;case"\\":var C=n.charAt(++s);i[i.length]={t:"("===C||")"===C?C:"t",v:C},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:o},++s;break;case"B":case"b":if("1"===n.charAt(s+1)||"2"===n.charAt(s+1)){if(null==p&&null==(p=zr(o,t,"2"===n.charAt(s+1))))return"";i[i.length]={t:"X",v:n.substr(s,2)},u=l,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(o<0||null==p&&null==(p=zr(o,t)))return"";for(a=l;++s<n.length&&n.charAt(s).toLowerCase()===l;)a+=l;"m"===l&&"h"===u.toLowerCase()&&(l="M"),"h"===l&&(l=_),i[i.length]={t:l,v:a},u=l;break;case"A":case"a":case"\u4e0a":var x={t:l,v:l};if(null==p&&(p=zr(o,t)),"A/P"===n.substr(s,3).toUpperCase()?(null!=p&&(x.v=p.H>=12?"P":"A"),x.t="T",_="h",s+=3):"AM/PM"===n.substr(s,5).toUpperCase()?(null!=p&&(x.v=p.H>=12?"PM":"AM"),x.t="T",s+=5,_="h"):"\u4e0a\u5348/\u4e0b\u5348"===n.substr(s,5).toUpperCase()?(null!=p&&(x.v=p.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),x.t="T",s+=5,_="h"):(x.t="t",++s),null==p&&"T"===x.t)return"";i[i.length]=x,u=l;break;case"[":for(a=l;"]"!==n.charAt(s++)&&s<n.length;)a+=n.charAt(s);if("]"!==a.slice(-1))throw'unterminated "[" block: |'+a+"|";if(a.match(nr)){if(null==p&&null==(p=zr(o,t)))return"";i[i.length]={t:"Z",v:a.toLowerCase()},u=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",xn(n)||(i[i.length]={t:"t",v:a}));break;case".":if(null!=p){for(a=l;++s<n.length&&"0"===(l=n.charAt(s));)a+=l;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++s<n.length&&"0#?.,E+-%".indexOf(l=n.charAt(s))>-1;)a+=l;i[i.length]={t:"n",v:a};break;case"?":for(a=l;n.charAt(++s)===l;)a+=l;i[i.length]={t:l,v:a},u=l;break;case"*":++s,(" "==n.charAt(s)||"*"==n.charAt(s))&&++s;break;case"(":case")":i[i.length]={t:1===r?"t":l,v:l},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;s<n.length&&"0123456789".indexOf(n.charAt(++s))>-1;)a+=n.charAt(s);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:l,v:l},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(l))throw new Error("unrecognized character "+l+" in "+n);i[i.length]={t:"t",v:l},++s}var S,k=0,F=0;for(s=i.length-1,u="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=_,u="h",k<1&&(k=1);break;case"s":(S=i[s].v.match(/\.0+$/))&&(F=Math.max(F,S[0].length-1)),k<3&&(k=3);case"d":case"y":case"M":case"e":u=i[s].t;break;case"m":"s"===u&&(i[s].t="M",k<2&&(k=2));break;case"X":break;case"Z":k<1&&i[s].v.match(/[Hh]/)&&(k=1),k<2&&i[s].v.match(/[Mm]/)&&(k=2),k<3&&i[s].v.match(/[Ss]/)&&(k=3)}switch(k){case 0:break;case 1:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M),p.M>=60&&(p.M=0,++p.H);break;case 2:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M)}var W,w="";for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=Qs(i[s].t.charCodeAt(0),i[s].v,p,F),i[s].t="t";break;case"n":case"?":for(W=s+1;null!=i[W]&&("?"===(l=i[W].t)||"D"===l||(" "===l||"t"===l)&&null!=i[W+1]&&("?"===i[W+1].t||"t"===i[W+1].t&&"/"===i[W+1].v)||"("===i[s].t&&(" "===l||"n"===l||")"===l)||"t"===l&&("/"===i[W].v||" "===i[W].v&&null!=i[W+1]&&"?"==i[W+1].t));)i[s].v+=i[W].v,i[W]={v:"",t:";"},++W;w+=i[s].v,s=W-1;break;case"G":i[s].t="t",i[s].v=ei(o,t)}var ee,A,K="";if(w.length>0){40==w.charCodeAt(0)?(ee=o<0&&45===w.charCodeAt(0)?-o:o,A=en("n",w,ee)):(A=en("n",w,ee=o<0&&r>1?-o:o),ee<0&&i[0]&&"t"==i[0].t&&(A=A.substr(1),i[0].v="-"+i[0].v)),W=A.length-1;var Q=i.length;for(s=0;s<i.length;++s)if(null!=i[s]&&"t"!=i[s].t&&i[s].v.indexOf(".")>-1){Q=s;break}var q=i.length;if(Q===i.length&&-1===A.indexOf("E")){for(s=i.length-1;s>=0;--s)null==i[s]||-1==="n?".indexOf(i[s].t)||(W>=i[s].v.length-1?i[s].v=A.substr(1+(W-=i[s].v.length),i[s].v.length):W<0?i[s].v="":(i[s].v=A.substr(0,W+1),W=-1),i[s].t="t",q=s);W>=0&&q<i.length&&(i[q].v=A.substr(0,W+1)+i[q].v)}else if(Q!==i.length&&-1===A.indexOf("E")){for(W=A.indexOf(".")-1,s=Q;s>=0;--s)if(null!=i[s]&&-1!=="n?".indexOf(i[s].t)){for(f=i[s].v.indexOf(".")>-1&&s===Q?i[s].v.indexOf(".")-1:i[s].v.length-1,K=i[s].v.substr(f+1);f>=0;--f)W>=0&&("0"===i[s].v.charAt(f)||"#"===i[s].v.charAt(f))&&(K=A.charAt(W--)+K);i[s].v=K,i[s].t="t",q=s}for(W>=0&&q<i.length&&(i[q].v=A.substr(0,W+1)+i[q].v),W=A.indexOf(".")+1,s=Q;s<i.length;++s)if(null!=i[s]&&(-1!=="n?(".indexOf(i[s].t)||s===Q)){for(f=i[s].v.indexOf(".")>-1&&s===Q?i[s].v.indexOf(".")+1:0,K=i[s].v.substr(0,f);f<i[s].v.length;++f)W<A.length&&(K+=A.charAt(W++));i[s].v=K,i[s].t="t",q=s}}}for(s=0;s<i.length;++s)null!=i[s]&&"n?".indexOf(i[s].t)>-1&&(i[s].v=en(i[s].t,i[s].v,ee=r>1&&o<0&&s>0&&"-"===i[s-1].v?-o:o),i[s].t="t");var le="";for(s=0;s!==i.length;++s)null!=i[s]&&(le+=i[s].v);return le}(i[1],o,t,i[0])}function Tr(n,o){if("number"!=typeof o){o=+o||-1;for(var t=0;t<392;++t)if(null!=tt[t]){if(tt[t]==n){o=t;break}}else o<0&&(o=t);o<0&&(o=391)}return tt[o]=n,o}function zi(n){for(var o=0;392!=o;++o)void 0!==n[o]&&Tr(n[o],o)}function Zt(){tt=function Sl(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',n}()}var ic=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,oc=function(){var n={version:"1.2.0"},t=function o(){for(var A=0,Q=new Array(256),q=0;256!=q;++q)Q[q]=A=1&(A=1&(A=1&(A=1&(A=1&(A=1&(A=1&(A=1&(A=q)?-306674912^A>>>1:A>>>1)?-306674912^A>>>1:A>>>1)?-306674912^A>>>1:A>>>1)?-306674912^A>>>1:A>>>1)?-306674912^A>>>1:A>>>1)?-306674912^A>>>1:A>>>1)?-306674912^A>>>1:A>>>1)?-306674912^A>>>1:A>>>1;return typeof Int32Array<"u"?new Int32Array(Q):Q}(),i=function r(A){var Q=0,q=0,le=0,de=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(le=0;256!=le;++le)de[le]=A[le];for(le=0;256!=le;++le)for(q=A[le],Q=256+le;Q<4096;Q+=256)q=de[Q]=q>>>8^A[255&q];var Z=[];for(le=1;16!=le;++le)Z[le-1]=typeof Int32Array<"u"?de.subarray(256*le,256*le+256):de.slice(256*le,256*le+256);return Z}(t),a=i[0],s=i[1],l=i[2],u=i[3],p=i[4],f=i[5],h=i[6],_=i[7],C=i[8],P=i[9],x=i[10],k=i[11],F=i[12],S=i[13],w=i[14];return n.table=t,n.bstr=function W(A,Q){for(var q=-1^Q,le=0,de=A.length;le<de;)q=q>>>8^t[255&(q^A.charCodeAt(le++))];return~q},n.buf=function K(A,Q){for(var q=-1^Q,le=A.length-15,de=0;de<le;)q=w[A[de++]^255&q]^S[A[de++]^q>>8&255]^F[A[de++]^q>>16&255]^k[A[de++]^q>>>24]^x[A[de++]]^P[A[de++]]^C[A[de++]]^_[A[de++]]^h[A[de++]]^f[A[de++]]^p[A[de++]]^u[A[de++]]^l[A[de++]]^s[A[de++]]^a[A[de++]]^t[A[de++]];for(le+=15;de<le;)q=q>>>8^t[255&(q^A[de++])];return~q},n.str=function ee(A,Q){for(var q=-1^Q,le=0,de=A.length,Z=0,Fe=0;le<de;)(Z=A.charCodeAt(le++))<128?q=q>>>8^t[255&(q^Z)]:Z<2048?q=(q=q>>>8^t[255&(q^(192|Z>>6&31))])>>>8^t[255&(q^(128|63&Z))]:Z>=55296&&Z<57344?(Z=64+(1023&Z),Fe=1023&A.charCodeAt(le++),q=(q=(q=(q=q>>>8^t[255&(q^(240|Z>>8&7))])>>>8^t[255&(q^(128|Z>>2&63))])>>>8^t[255&(q^(128|Fe>>6&15|(3&Z)<<4))])>>>8^t[255&(q^(128|63&Fe))]):q=(q=(q=q>>>8^t[255&(q^(224|Z>>12&15))])>>>8^t[255&(q^(128|Z>>6&63))])>>>8^t[255&(q^(128|63&Z))];return~q},n}(),nt=function(){var u,o={};function r(y){if("/"==y.charAt(y.length-1))return-1===y.slice(0,-1).indexOf("/")?y:r(y.slice(0,-1));var I=y.lastIndexOf("/");return-1===I?y:y.slice(0,I+1)}function i(y){if("/"==y.charAt(y.length-1))return i(y.slice(0,-1));var I=y.lastIndexOf("/");return-1===I?y:y.slice(I+1)}function a(y,I){"string"==typeof I&&(I=new Date(I));var M=I.getHours();M=(M=M<<6|I.getMinutes())<<5|I.getSeconds()>>>1,y.write_shift(2,M);var T=I.getFullYear()-1980;T=(T=T<<4|I.getMonth()+1)<<5|I.getDate(),y.write_shift(2,T)}function l(y){Gn(y,0);for(var I={},M=0;y.l<=y.length-4;){var T=y.read_shift(2),R=y.read_shift(2),N=y.l+R,ne={};21589===T&&(1&(M=y.read_shift(1))&&(ne.mtime=y.read_shift(4)),R>5&&(2&M&&(ne.atime=y.read_shift(4)),4&M&&(ne.ctime=y.read_shift(4))),ne.mtime&&(ne.mt=new Date(1e3*ne.mtime))),y.l=N,I[T]=ne}return I}function p(){return u||(u={})}function f(y,I){if(80==y[0]&&75==y[1])return p0(y,I);if(109==(32|y[0])&&105==(32|y[1]))return function T3(y,I){if("mime-version:"!=$e(y.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var M=I&&I.root||"",T=(dt&&Buffer.isBuffer(y)?y.toString("binary"):$e(y)).split("\r\n"),R=0,N="";for(R=0;R<T.length;++R)if(/^Content-Location:/i.test(N=T[R])&&(N=N.slice(N.indexOf("file")),M||(M=N.slice(0,N.lastIndexOf("/")+1)),N.slice(0,M.length)!=M))for(;M.length>0&&(M=(M=M.slice(0,M.length-1)).slice(0,M.lastIndexOf("/")+1),N.slice(0,M.length)!=M););var ne=(T[1]||"").match(/boundary="(.*?)"/);if(!ne)throw new Error("MAD cannot find boundary");var pe="--"+(ne[1]||""),ce={FileIndex:[],FullPaths:[]};A(ce);var ye,Re=0;for(R=0;R<T.length;++R){var We=T[R];We!==pe&&We!==pe+"--"||(Re++&&S3(ce,T.slice(ye,R),M),ye=R)}return ce}(y,I);if(y.length<512)throw new Error("CFB file size "+y.length+" < 512");var M,R,N,ne,pe,oe,T=512,ie=[],ce=y.slice(0,512);Gn(ce,0);var ye=function h(y){if(80==y[y.l]&&75==y[y.l+1])return[0,0];y.chk(Ye,"Header Signature: "),y.l+=16;var I=y.read_shift(2,"u");return[y.read_shift(2,"u"),I]}(ce);switch(M=ye[0]){case 3:T=512;break;case 4:T=4096;break;case 0:if(0==ye[1])return p0(y,I);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}512!==T&&Gn(ce=y.slice(0,T),28);var Re=y.slice(0,T);!function _(y,I){var M;switch(y.l+=2,M=y.read_shift(2)){case 9:if(3!=I)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(4!=I)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}y.chk("0600","Mini Sector Shift: "),y.chk("000000000000","Reserved: ")}(ce,M);var We=ce.read_shift(4,"i");if(3===M&&0!==We)throw new Error("# Directory Sectors: Expected 0 saw "+We);ce.l+=4,ne=ce.read_shift(4,"i"),ce.l+=4,ce.chk("00100000","Mini Stream Cutoff Size: "),pe=ce.read_shift(4,"i"),R=ce.read_shift(4,"i"),oe=ce.read_shift(4,"i"),N=ce.read_shift(4,"i");for(var Ne=-1,je=0;je<109&&!((Ne=ce.read_shift(4,"i"))<0);++je)ie[je]=Ne;var ht=function C(y,I){for(var M=Math.ceil(y.length/I)-1,T=[],R=1;R<M;++R)T[R-1]=y.slice(R*I,(R+1)*I);return T[M-1]=y.slice(M*I),T}(y,T);k(oe,N,ht,T,ie);var rn=function S(y,I,M,T){var R=y.length,N=[],ne=[],pe=[],oe=[],ie=T-1,ce=0,ye=0,Re=0,We=0;for(ce=0;ce<R;++ce)if(pe=[],(Re=ce+I)>=R&&(Re-=R),!ne[Re]){oe=[];var Ne=[];for(ye=Re;ye>=0;){Ne[ye]=!0,ne[ye]=!0,pe[pe.length]=ye,oe.push(y[ye]);var je=M[Math.floor(4*ye/T)];if(T<4+(We=4*ye&ie))throw new Error("FAT boundary crossed: "+ye+" 4 "+T);if(!y[je]||Ne[ye=xo(y[je],We)])break}N[Re]={nodes:pe,data:Cu([oe])}}return N}(ht,ne,ie,T);rn[ne].name="!Directory",R>0&&pe!==Fe&&(rn[pe].name="!MiniFAT"),rn[ie[0]].name="!FAT",rn.fat_addrs=ie,rn.ssz=T;var Fn=[],yr=[],ss=[];(function w(y,I,M,T,R,N,ne,pe){for(var We,oe=0,ie=T.length?2:0,ce=I[y].data,ye=0,Re=0;ye<ce.length;ye+=128){var Ne=ce.slice(ye,ye+128);Gn(Ne,64),Re=Ne.read_shift(2),We=dc(Ne,0,Re-ie),T.push(We);var je={name:We,type:Ne.read_shift(1),color:Ne.read_shift(1),L:Ne.read_shift(4,"i"),R:Ne.read_shift(4,"i"),C:Ne.read_shift(4,"i"),clsid:Ne.read_shift(16),state:Ne.read_shift(4,"i"),start:0,size:0};0!==Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2)&&(je.ct=W(Ne,Ne.l-8)),0!==Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2)&&(je.mt=W(Ne,Ne.l-8)),je.start=Ne.read_shift(4,"i"),je.size=Ne.read_shift(4,"i"),je.size<0&&je.start<0&&(je.size=je.type=0,je.start=Fe,je.name=""),5===je.type?(oe=je.start,R>0&&oe!==Fe&&(I[oe].name="!StreamData")):je.size>=4096?(je.storage="fat",void 0===I[je.start]&&(I[je.start]=F(M,je.start,I.fat_addrs,I.ssz)),I[je.start].name=je.name,je.content=I[je.start].data.slice(0,je.size)):(je.storage="minifat",je.size<0?je.size=0:oe!==Fe&&je.start!==Fe&&I[oe]&&(je.content=x(je,I[oe].data,(I[pe]||{}).data))),je.content&&Gn(je.content,0),N[We]=je,ne.push(je)}})(ne,rn,ht,Fn,R,{},yr,pe),function P(y,I,M){for(var T=0,R=0,N=0,ne=0,pe=0,oe=M.length,ie=[],ce=[];T<oe;++T)ie[T]=ce[T]=T,I[T]=M[T];for(;pe<ce.length;++pe)R=y[T=ce[pe]].L,N=y[T].R,ne=y[T].C,ie[T]===T&&(-1!==R&&ie[R]!==R&&(ie[T]=ie[R]),-1!==N&&ie[N]!==N&&(ie[T]=ie[N])),-1!==ne&&(ie[ne]=T),-1!==R&&T!=ie[T]&&(ie[R]=ie[T],ce.lastIndexOf(R)<pe&&ce.push(R)),-1!==N&&T!=ie[T]&&(ie[N]=ie[T],ce.lastIndexOf(N)<pe&&ce.push(N));for(T=1;T<oe;++T)ie[T]===T&&(-1!==N&&ie[N]!==N?ie[T]=ie[N]:-1!==R&&ie[R]!==R&&(ie[T]=ie[R]));for(T=1;T<oe;++T)if(0!==y[T].type){if((pe=T)!=ie[pe])do{I[T]=I[pe=ie[pe]]+"/"+I[T]}while(0!==pe&&-1!==ie[pe]&&pe!=ie[pe]);ie[T]=-1}for(I[0]+="/",T=1;T<oe;++T)2!==y[T].type&&(I[T]+="/")}(yr,ss,Fn),Fn.shift();var cs={FileIndex:yr,FullPaths:ss};return I&&I.raw&&(cs.raw={header:Re,sectors:ht}),cs}function x(y,I,M){for(var R=y.size,N=[],ne=y.start;M&&R>0&&ne>=0;)N.push(I.slice(ne*Z,ne*Z+Z)),R-=Z,ne=xo(M,4*ne);return 0===N.length?ue(0):un(N).slice(0,y.size)}function k(y,I,M,T,R){var N=Fe;if(y===Fe){if(0!==I)throw new Error("DIFAT chain shorter than expected")}else if(-1!==y){var ne=M[y],pe=(T>>>2)-1;if(!ne)return;for(var oe=0;oe<pe&&(N=xo(ne,4*oe))!==Fe;++oe)R.push(N);k(xo(ne,T-4),I-1,M,T,R)}}function F(y,I,M,T,R){var N=[],ne=[];R||(R=[]);var pe=T-1,oe=0,ie=0;for(oe=I;oe>=0;){R[oe]=!0,N[N.length]=oe,ne.push(y[oe]);var ce=M[Math.floor(4*oe/T)];if(T<4+(ie=4*oe&pe))throw new Error("FAT boundary crossed: "+oe+" 4 "+T);if(!y[ce])break;oe=xo(y[ce],ie)}return{nodes:N,data:Cu([ne])}}function W(y,I){return new Date(1e3*(Dn(y,I+4)/1e7*Math.pow(2,32)+Dn(y,I)/1e7-11644473600))}function A(y,I){var M=I||{},T=M.root||"Root Entry";if(y.FullPaths||(y.FullPaths=[]),y.FileIndex||(y.FileIndex=[]),y.FullPaths.length!==y.FileIndex.length)throw new Error("inconsistent CFB structure");0===y.FullPaths.length&&(y.FullPaths[0]=T+"/",y.FileIndex[0]={name:T,type:5}),M.CLSID&&(y.FileIndex[0].clsid=M.CLSID),function Q(y){var I="\x01Sh33tJ5";if(!nt.find(y,"/"+I)){var M=ue(4);M[0]=55,M[1]=M[3]=50,M[2]=54,y.FileIndex.push({name:I,type:2,content:M,size:4,L:69,R:69,C:69}),y.FullPaths.push(y.FullPaths[0]+I),q(y)}}(y)}function q(y,I){A(y);for(var M=!1,T=!1,R=y.FullPaths.length-1;R>=0;--R){var N=y.FileIndex[R];switch(N.type){case 0:T?M=!0:(y.FileIndex.pop(),y.FullPaths.pop());break;case 1:case 2:case 5:T=!0,isNaN(N.R*N.L*N.C)&&(M=!0),N.R>-1&&N.L>-1&&N.R==N.L&&(M=!0);break;default:M=!0}}if(M||I){var ne=new Date(1987,1,19),pe=0,oe=Object.create?Object.create(null):{},ie=[];for(R=0;R<y.FullPaths.length;++R)oe[y.FullPaths[R]]=!0,0!==y.FileIndex[R].type&&ie.push([y.FullPaths[R],y.FileIndex[R]]);for(R=0;R<ie.length;++R){var ce=r(ie[R][0]);(T=oe[ce])||(ie.push([ce,{name:i(ce).replace("/",""),type:1,clsid:ct,ct:ne,mt:ne,content:null}]),oe[ce]=!0)}for(ie.sort(function(We,Ne){return function t(y,I){for(var M=y.split("/"),T=I.split("/"),R=0,N=0,ne=Math.min(M.length,T.length);R<ne;++R){if(N=M[R].length-T[R].length)return N;if(M[R]!=T[R])return M[R]<T[R]?-1:1}return M.length-T.length}(We[0],Ne[0])}),y.FullPaths=[],y.FileIndex=[],R=0;R<ie.length;++R)y.FullPaths[R]=ie[R][0],y.FileIndex[R]=ie[R][1];for(R=0;R<ie.length;++R){var ye=y.FileIndex[R],Re=y.FullPaths[R];if(ye.name=i(Re).replace("/",""),ye.L=ye.R=ye.C=-(ye.color=1),ye.size=ye.content?ye.content.length:0,ye.start=0,ye.clsid=ye.clsid||ct,0===R)ye.C=ie.length>1?1:-1,ye.size=0,ye.type=5;else if("/"==Re.slice(-1)){for(pe=R+1;pe<ie.length&&r(y.FullPaths[pe])!=Re;++pe);for(ye.C=pe>=ie.length?-1:pe,pe=R+1;pe<ie.length&&r(y.FullPaths[pe])!=r(Re);++pe);ye.R=pe>=ie.length?-1:pe,ye.type=1}else r(y.FullPaths[R+1]||"")==r(Re)&&(ye.R=R+1),ye.type=2}}}function le(y,I){var M=I||{};if("mad"==M.fileType)return function I3(y,I){for(var M=I||{},T=M.boundary||"SheetJS",R=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(T="------="+T).slice(2)+'"',"","",""],N=y.FullPaths[0],ne=N,pe=y.FileIndex[0],oe=1;oe<y.FullPaths.length;++oe)if(ne=y.FullPaths[oe].slice(N.length),(pe=y.FileIndex[oe]).size&&pe.content&&"\x01Sh33tJ5"!=ne){ne=ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ht){return"_x"+ht.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ht){return"_u"+ht.charCodeAt(0).toString(16)+"_"});for(var ie=pe.content,ce=dt&&Buffer.isBuffer(ie)?ie.toString("binary"):$e(ie),ye=0,Re=Math.min(1024,ce.length),We=0,Ne=0;Ne<=Re;++Ne)(We=ce.charCodeAt(Ne))>=32&&We<128&&++ye;var je=ye>=4*Re/5;R.push(T),R.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+ne),R.push("Content-Transfer-Encoding: "+(je?"quoted-printable":"base64")),R.push("Content-Type: "+M3(pe,ne)),R.push(""),R.push(je?F3(ce):w3(ce))}return R.push(T+"--\r\n"),R.join("\r\n")}(y,M);if("zip"===(q(y),M.fileType))return function y3(y,I){var M=I||{},T=[],R=[],N=ue(1),ne=M.compression?8:0,pe=0,ie=0,ce=0,ye=0,Re=0,We=y.FullPaths[0],Ne=We,je=y.FileIndex[0],ht=[],rn=0;for(ie=1;ie<y.FullPaths.length;++ie)if(Ne=y.FullPaths[ie].slice(We.length),(je=y.FileIndex[ie]).size&&je.content&&"\x01Sh33tJ5"!=Ne){var hr=ye,Fn=ue(Ne.length);for(ce=0;ce<Ne.length;++ce)Fn.write_shift(1,127&Ne.charCodeAt(ce));Fn=Fn.slice(0,Fn.l),ht[Re]=oc.buf(je.content,0);var yr=je.content;8==ne&&(yr=Y(yr)),(N=ue(30)).write_shift(4,67324752),N.write_shift(2,20),N.write_shift(2,pe),N.write_shift(2,ne),je.mt?a(N,je.mt):N.write_shift(4,0),N.write_shift(-4,8&pe?0:ht[Re]),N.write_shift(4,8&pe?0:yr.length),N.write_shift(4,8&pe?0:je.content.length),N.write_shift(2,Fn.length),N.write_shift(2,0),ye+=N.length,T.push(N),ye+=Fn.length,T.push(Fn),ye+=yr.length,T.push(yr),8&pe&&((N=ue(12)).write_shift(-4,ht[Re]),N.write_shift(4,yr.length),N.write_shift(4,je.content.length),ye+=N.l,T.push(N)),(N=ue(46)).write_shift(4,33639248),N.write_shift(2,0),N.write_shift(2,20),N.write_shift(2,pe),N.write_shift(2,ne),N.write_shift(4,0),N.write_shift(-4,ht[Re]),N.write_shift(4,yr.length),N.write_shift(4,je.content.length),N.write_shift(2,Fn.length),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(4,0),N.write_shift(4,hr),rn+=N.l,R.push(N),rn+=Fn.length,R.push(Fn),++Re}return(N=ue(22)).write_shift(4,101010256),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(2,Re),N.write_shift(2,Re),N.write_shift(4,rn),N.write_shift(4,ye),N.write_shift(2,0),un([un(T),un(R),N])}(y,M);var T=function(We){for(var Ne=0,je=0,ht=0;ht<We.FileIndex.length;++ht){var rn=We.FileIndex[ht];if(rn.content){var hr=rn.content.length;hr>0&&(hr<4096?Ne+=hr+63>>6:je+=hr+511>>9)}}for(var Fn=We.FullPaths.length+3>>2,ss=Ne+127>>7,cs=(Ne+7>>3)+je+Fn+ss,Ro=cs+127>>7,Qd=Ro<=109?0:Math.ceil((Ro-109)/127);cs+Ro+Qd+127>>7>Ro;)Qd=++Ro<=109?0:Math.ceil((Ro-109)/127);var Mi=[1,Qd,Ro,ss,Fn,je,Ne,0];return We.FileIndex[0].size=Ne<<6,Mi[7]=(We.FileIndex[0].start=Mi[0]+Mi[1]+Mi[2]+Mi[3]+Mi[4]+Mi[5])+(Mi[6]+7>>3),Mi}(y),R=ue(T[7]<<9),N=0,ne=0;for(N=0;N<8;++N)R.write_shift(1,De[N]);for(N=0;N<8;++N)R.write_shift(2,0);for(R.write_shift(2,62),R.write_shift(2,3),R.write_shift(2,65534),R.write_shift(2,9),R.write_shift(2,6),N=0;N<3;++N)R.write_shift(2,0);for(R.write_shift(4,0),R.write_shift(4,T[2]),R.write_shift(4,T[0]+T[1]+T[2]+T[3]-1),R.write_shift(4,0),R.write_shift(4,4096),R.write_shift(4,T[3]?T[0]+T[1]+T[2]-1:Fe),R.write_shift(4,T[3]),R.write_shift(-4,T[1]?T[0]-1:Fe),R.write_shift(4,T[1]),N=0;N<109;++N)R.write_shift(-4,N<T[2]?T[1]+N:-1);if(T[1])for(ne=0;ne<T[1];++ne){for(;N<236+127*ne;++N)R.write_shift(-4,N<T[2]?T[1]+N:-1);R.write_shift(-4,ne===T[1]-1?Fe:ne+1)}var pe=function(We){for(ne+=We;N<ne-1;++N)R.write_shift(-4,N+1);We&&(++N,R.write_shift(-4,Fe))};for(ne=N=0,ne+=T[1];N<ne;++N)R.write_shift(-4,Qe.DIFSECT);for(ne+=T[2];N<ne;++N)R.write_shift(-4,Qe.FATSECT);pe(T[3]),pe(T[4]);for(var oe=0,ie=0,ce=y.FileIndex[0];oe<y.FileIndex.length;++oe)(ce=y.FileIndex[oe]).content&&!((ie=ce.content.length)<4096)&&(ce.start=ne,pe(ie+511>>9));for(pe(T[6]+7>>3);511&R.l;)R.write_shift(-4,Qe.ENDOFCHAIN);for(ne=N=0,oe=0;oe<y.FileIndex.length;++oe)(ce=y.FileIndex[oe]).content&&(ie=ce.content.length)&&!(ie>=4096)&&(ce.start=ne,pe(ie+63>>6));for(;511&R.l;)R.write_shift(-4,Qe.ENDOFCHAIN);for(N=0;N<T[4]<<2;++N){var ye=y.FullPaths[N];if(ye&&0!==ye.length){ce=y.FileIndex[N],0===N&&(ce.start=ce.size?ce.start-1:Fe);var Re=0===N&&M.root||ce.name;if(ie=2*(Re.length+1),R.write_shift(64,Re,"utf16le"),R.write_shift(2,ie),R.write_shift(1,ce.type),R.write_shift(1,ce.color),R.write_shift(-4,ce.L),R.write_shift(-4,ce.R),R.write_shift(-4,ce.C),ce.clsid)R.write_shift(16,ce.clsid,"hex");else for(oe=0;oe<4;++oe)R.write_shift(4,0);R.write_shift(4,ce.state||0),R.write_shift(4,0),R.write_shift(4,0),R.write_shift(4,0),R.write_shift(4,0),R.write_shift(4,ce.start),R.write_shift(4,ce.size),R.write_shift(4,0)}else{for(oe=0;oe<17;++oe)R.write_shift(4,0);for(oe=0;oe<3;++oe)R.write_shift(4,-1);for(oe=0;oe<12;++oe)R.write_shift(4,0)}}for(N=1;N<y.FileIndex.length;++N)if((ce=y.FileIndex[N]).size>=4096)if(R.l=ce.start+1<<9,dt&&Buffer.isBuffer(ce.content))ce.content.copy(R,R.l,0,ce.size),R.l+=ce.size+511&-512;else{for(oe=0;oe<ce.size;++oe)R.write_shift(1,ce.content[oe]);for(;511&oe;++oe)R.write_shift(1,0)}for(N=1;N<y.FileIndex.length;++N)if((ce=y.FileIndex[N]).size>0&&ce.size<4096)if(dt&&Buffer.isBuffer(ce.content))ce.content.copy(R,R.l,0,ce.size),R.l+=ce.size+63&-64;else{for(oe=0;oe<ce.size;++oe)R.write_shift(1,ce.content[oe]);for(;63&oe;++oe)R.write_shift(1,0)}if(dt)R.l=R.length;else for(;R.l<R.length;)R.write_shift(1,0);return R}o.version="1.2.1";var ke,Z=64,Fe=-2,Ye="d0cf11e0a1b11ae1",De=[208,207,17,224,161,177,26,225],ct="00000000000000000000000000000000",Qe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Fe,FREESECT:-1,HEADER_SIGNATURE:Ye,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ct,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function $e(y){for(var I=new Array(y.length),M=0;M<y.length;++M)I[M]=String.fromCharCode(y[M]);return I.join("")}function Y(y){return ke?ke.deflateRawSync(y):Ft(y)}for(var y,I,V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],he=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Be=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Te=typeof Uint8Array<"u",ve=Te?new Uint8Array(256):[],yt=0;yt<256;++yt)ve[yt]=(void 0,255&((I=139536&((y=yt)<<1|y<<11)|558144&(y<<5|y<<15))>>16|I>>8|I));function G(y,I){var M=ve[255&y];return I<=8?M>>>8-I:(M=M<<8|ve[y>>8&255],I<=16?M>>>16-I:(M=M<<8|ve[y>>16&255])>>>24-I)}function Ht(y,I){var M=7&I,T=I>>>3;return(y[T]|(M<=6?0:y[T+1]<<8))>>>M&3}function Tt(y,I){var M=7&I,T=I>>>3;return(y[T]|(M<=5?0:y[T+1]<<8))>>>M&7}function It(y,I){var M=7&I,T=I>>>3;return(y[T]|(M<=3?0:y[T+1]<<8))>>>M&31}function Le(y,I){var M=7&I,T=I>>>3;return(y[T]|(M<=1?0:y[T+1]<<8))>>>M&127}function Pn(y,I,M){var T=7&I,R=I>>>3,ne=y[R]>>>T;return M<8-T||(ne|=y[R+1]<<8-T,M<16-T)||(ne|=y[R+2]<<16-T,M<24-T)||(ne|=y[R+3]<<24-T),ne&(1<<M)-1}function Br(y,I,M){var T=7&I,R=I>>>3;return T<=5?y[R]|=(7&M)<<T:(y[R]|=M<<T&255,y[R+1]=(7&M)>>8-T),I+3}function si(y,I,M){return y[I>>>3]|=M=(1&M)<<(7&I),I+1}function Oi(y,I,M){var R=I>>>3;return y[R]|=255&(M<<=7&I),y[R+1]=M>>>=8,I+8}function os(y,I,M){var R=I>>>3;return y[R]|=255&(M<<=7&I),y[R+1]=255&(M>>>=8),y[R+2]=M>>>8,I+16}function Ji(y,I){var M=y.length,T=2*M>I?2*M:I+5,R=0;if(M>=I)return y;if(dt){var N=Uo(T);if(y.copy)y.copy(N);else for(;R<y.length;++R)N[R]=y[R];return N}if(Te){var ne=new Uint8Array(T);if(ne.set)ne.set(y);else for(;R<M;++R)ne[R]=y[R];return ne}return y.length=T,y}function Or(y){for(var I=new Array(y),M=0;M<y;++M)I[M]=0;return I}function yi(y,I,M){var T=1,R=0,N=0,ne=0,pe=0,oe=y.length,ie=Te?new Uint16Array(32):Or(32);for(N=0;N<32;++N)ie[N]=0;for(N=oe;N<M;++N)y[N]=0;oe=y.length;var ce=Te?new Uint16Array(oe):Or(oe);for(N=0;N<oe;++N)ie[R=y[N]]++,T<R&&(T=R),ce[N]=0;for(ie[0]=0,N=1;N<=T;++N)ie[N+16]=pe=pe+ie[N-1]<<1;for(N=0;N<oe;++N)0!=(pe=y[N])&&(ce[N]=ie[pe+16]++);var ye=0;for(N=0;N<oe;++N)if(0!=(ye=y[N]))for(pe=G(ce[N],T)>>T-ye,ne=(1<<T+4-ye)-1;ne>=0;--ne)I[pe|ne<<ye]=15&ye|N<<4;return T}var Ki=Te?new Uint16Array(512):Or(512),as=Te?new Uint16Array(32):Or(32);if(!Te){for(var ar=0;ar<512;++ar)Ki[ar]=0;for(ar=0;ar<32;++ar)as[ar]=0}!function(){for(var y=[],I=0;I<32;I++)y.push(5);yi(y,as,32);var M=[];for(I=0;I<=143;I++)M.push(8);for(;I<=255;I++)M.push(9);for(;I<=279;I++)M.push(7);for(;I<=287;I++)M.push(8);yi(M,Ki,288)}();var ci=function(){for(var I=Te?new Uint8Array(32768):[],M=0,T=0;M<Be.length-1;++M)for(;T<Be[M+1];++T)I[T]=M;for(;T<32768;++T)I[T]=29;var R=Te?new Uint8Array(259):[];for(M=0,T=0;M<he.length-1;++M)for(;T<he[M+1];++T)R[T]=M;return function(oe,ie){return oe.length<8?function N(pe,oe){for(var ie=0;ie<pe.length;){var ce=Math.min(65535,pe.length-ie);for(oe.write_shift(1,+(ie+ce==pe.length)),oe.write_shift(2,ce),oe.write_shift(2,65535&~ce);ce-- >0;)oe[oe.l++]=pe[ie++]}return oe.l}(oe,ie):function ne(pe,oe){for(var ie=0,ce=0,ye=Te?new Uint16Array(32768):[];ce<pe.length;){var Re=Math.min(65535,pe.length-ce);if(Re<10){for(7&(ie=Br(oe,ie,+(ce+Re==pe.length)))&&(ie+=8-(7&ie)),oe.l=ie/8|0,oe.write_shift(2,Re),oe.write_shift(2,65535&~Re);Re-- >0;)oe[oe.l++]=pe[ce++];ie=8*oe.l}else{ie=Br(oe,ie,+(ce+Re==pe.length)+2);for(var We=0;Re-- >0;){var Ne=pe[ce],je=-1,ht=0;if((je=ye[We=32767&(We<<5^Ne)])&&((je|=-32768&ce)>ce&&(je-=32768),je<ce))for(;pe[je+ht]==pe[ce+ht]&&ht<250;)++ht;if(ht>2){(Ne=R[ht])<=22?ie=Oi(oe,ie,ve[Ne+1]>>1)-1:(Oi(oe,ie,3),Oi(oe,ie+=5,ve[Ne-23]>>5),ie+=3);var rn=Ne<8?0:Ne-4>>2;rn>0&&(os(oe,ie,ht-he[Ne]),ie+=rn),ie=Oi(oe,ie,ve[Ne=I[ce-je]]>>3),ie-=3;var hr=Ne<4?0:Ne-2>>1;hr>0&&(os(oe,ie,ce-je-Be[Ne]),ie+=hr);for(var Fn=0;Fn<ht;++Fn)ye[We]=32767&ce,We=32767&(We<<5^pe[ce]),++ce;Re-=ht-1}else Ne<=143?Ne+=48:ie=si(oe,ie,1),ie=Oi(oe,ie,ve[Ne]),ye[We]=32767&ce,++ce}ie=Oi(oe,ie,0)-1}}return oe.l=(ie+7)/8|0,oe.l}(oe,ie)}}();function Ft(y){var I=ue(50+Math.floor(1.1*y.length)),M=ci(y,I);return I.slice(0,M)}var bn=Te?new Uint16Array(32768):Or(32768),Lr=Te?new Uint16Array(32768):Or(32768),In=Te?new Uint16Array(128):Or(128),Io=1,d0=1;function b3(y,I){var M=It(y,I)+257,T=It(y,I+=5)+1,R=function Wt(y,I){var M=7&I,T=I>>>3;return(y[T]|(M<=4?0:y[T+1]<<8))>>>M&15}(y,I+=5)+4;I+=4;for(var N=0,ne=Te?new Uint8Array(19):Or(19),pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],oe=1,ie=Te?new Uint8Array(8):Or(8),ce=Te?new Uint8Array(8):Or(8),ye=ne.length,Re=0;Re<R;++Re)ne[V[Re]]=N=Tt(y,I),oe<N&&(oe=N),ie[N]++,I+=3;var We=0;for(ie[0]=0,Re=1;Re<=oe;++Re)ce[Re]=We=We+ie[Re-1]<<1;for(Re=0;Re<ye;++Re)0!=(We=ne[Re])&&(pe[Re]=ce[We]++);var Ne=0;for(Re=0;Re<ye;++Re)if(0!=(Ne=ne[Re])){We=ve[pe[Re]]>>8-Ne;for(var je=(1<<7-Ne)-1;je>=0;--je)In[We|je<<Ne]=7&Ne|Re<<3}var ht=[];for(oe=1;ht.length<M+T;)switch(We=In[Le(y,I)],I+=7&We,We>>>=3){case 16:for(N=3+Ht(y,I),I+=2,We=ht[ht.length-1];N-- >0;)ht.push(We);break;case 17:for(N=3+Tt(y,I),I+=3;N-- >0;)ht.push(0);break;case 18:for(N=11+Le(y,I),I+=7;N-- >0;)ht.push(0);break;default:ht.push(We),oe<We&&(oe=We)}var rn=ht.slice(0,M),hr=ht.slice(M);for(Re=M;Re<286;++Re)rn[Re]=0;for(Re=T;Re<30;++Re)hr[Re]=0;return Io=yi(rn,bn,286),d0=yi(hr,Lr,30),I}function u0(y,I){var T=function k3(y,I){if(3==y[0]&&!(3&y[1]))return[Ur(I),2];for(var M=0,T=0,R=Uo(I||1<<18),N=0,ne=R.length>>>0,pe=0,oe=0;!(1&T);)if(T=Tt(y,M),M+=3,T>>>1)for(T>>1==1?(pe=9,oe=5):(M=b3(y,M),pe=Io,oe=d0);;){!I&&ne<N+32767&&(ne=(R=Ji(R,N+32767)).length);var ce=Pn(y,M,pe),ye=T>>>1==1?Ki[ce]:bn[ce];if(M+=15&ye,(ye>>>=4)>>>8&255){if(256==ye)break;var Re=(ye-=257)<8?0:ye-4>>2;Re>5&&(Re=0);var We=N+he[ye];Re>0&&(We+=Pn(y,M,Re),M+=Re),ce=Pn(y,M,oe),M+=15&(ye=T>>>1==1?as[ce]:Lr[ce]);var Ne=(ye>>>=4)<4?0:ye-2>>1,je=Be[ye];for(Ne>0&&(je+=Pn(y,M,Ne),M+=Ne),!I&&ne<We&&(ne=(R=Ji(R,We+100)).length);N<We;)R[N]=R[N-je],++N}else R[N++]=ye}else{7&M&&(M+=8-(7&M));var ie=y[M>>>3]|y[1+(M>>>3)]<<8;if(M+=32,ie>0)for(!I&&ne<N+ie&&(ne=(R=Ji(R,N+ie)).length);ie-- >0;)R[N++]=y[M>>>3],M+=8}return I?[R,M+7>>>3]:[R.slice(0,N),M+7>>>3]}(y.slice(y.l||0),I);return y.l+=T[1],T[0]}function g0(y,I){if(!y)throw new Error(I);typeof console<"u"&&console.error(I)}function p0(y,I){var M=y;Gn(M,0);var N={FileIndex:[],FullPaths:[]};A(N,{root:I.root});for(var ne=M.length-4;(80!=M[ne]||75!=M[ne+1]||5!=M[ne+2]||6!=M[ne+3])&&ne>=0;)--ne;M.l=ne+4,M.l+=4;var pe=M.read_shift(2);M.l+=6;var oe=M.read_shift(4);for(M.l=oe,ne=0;ne<pe;++ne){M.l+=20;var ie=M.read_shift(4),ce=M.read_shift(4),ye=M.read_shift(2),Re=M.read_shift(2),We=M.read_shift(2);M.l+=8;var Ne=M.read_shift(4),je=l(M.slice(M.l+ye,M.l+ye+Re));M.l+=ye+Re+We;var ht=M.l;M.l=Ne+4,O3(M,ie,ce,N,je),M.l=ht}return N}function O3(y,I,M,T,R){y.l+=2;var N=y.read_shift(2),ne=y.read_shift(2),pe=function s(y){var I=65535&y.read_shift(2),M=65535&y.read_shift(2),T=new Date,R=31&M,N=15&(M>>>=5);M>>>=4,T.setMilliseconds(0),T.setFullYear(M+1980),T.setMonth(N-1),T.setDate(R);var ne=31&I,pe=63&(I>>>=5);return T.setHours(I>>>=6),T.setMinutes(pe),T.setSeconds(ne<<1),T}(y);if(8257&N)throw new Error("Unsupported ZIP encryption");y.read_shift(4);for(var ie=y.read_shift(4),ce=y.read_shift(4),ye=y.read_shift(2),Re=y.read_shift(2),We="",Ne=0;Ne<ye;++Ne)We+=String.fromCharCode(y[y.l++]);if(Re){var je=l(y.slice(y.l,y.l+Re));(je[21589]||{}).mt&&(pe=je[21589].mt),((R||{})[21589]||{}).mt&&(pe=R[21589].mt)}y.l+=Re;var ht=y.slice(y.l,y.l+ie);switch(ne){case 8:ht=function se(y,I){if(!ke)return u0(y,I);var T=new(0,ke.InflateRaw),R=T._processChunk(y.slice(y.l),T._finishFlushFlag);return y.l+=T.bytesRead,R}(y,ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ne)}var rn=!1;8&N&&(134695760==y.read_shift(4)&&(y.read_shift(4),rn=!0),ie=y.read_shift(4),ce=y.read_shift(4)),ie!=I&&g0(rn,"Bad compressed size: "+I+" != "+ie),ce!=M&&g0(rn,"Bad uncompressed size: "+M+" != "+ce),Zd(T,We,ht,{unsafe:!0,mt:pe})}var jc={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function M3(y,I){if(y.ctype)return y.ctype;var M=y.name||"",T=M.match(/\.([^\.]+)$/);return T&&jc[T[1]]||I&&(T=(M=I).match(/[\.\\]([^\.\\])+$/))&&jc[T[1]]?jc[T[1]]:"application/octet-stream"}function w3(y){for(var I=Er(y),M=[],T=0;T<I.length;T+=76)M.push(I.slice(T,T+76));return M.join("\r\n")+"\r\n"}function F3(y){var I=y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ie){var ce=ie.charCodeAt(0).toString(16).toUpperCase();return"="+(1==ce.length?"0"+ce:ce)});"\n"==(I=I.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(I="=0D"+I.slice(1));for(var M=[],T=(I=I.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),R=0;R<T.length;++R){var N=T[R];if(0!=N.length)for(var ne=0;ne<N.length;){var pe=76,oe=N.slice(ne,ne+pe);"="==oe.charAt(pe-1)?pe--:"="==oe.charAt(pe-2)?pe-=2:"="==oe.charAt(pe-3)&&(pe-=3),oe=N.slice(ne,ne+pe),(ne+=pe)<N.length&&(oe+="="),M.push(oe)}else M.push("")}return M.join("\r\n")}function S3(y,I,M){for(var ne,T="",R="",N="",pe=0;pe<10;++pe){var oe=I[pe];if(!oe||oe.match(/^\s*$/))break;var ie=oe.match(/^(.*?):\s*([^\s].*)$/);if(ie)switch(ie[1].toLowerCase()){case"content-location":T=ie[2].trim();break;case"content-type":N=ie[2].trim();break;case"content-transfer-encoding":R=ie[2].trim()}}switch(++pe,R.toLowerCase()){case"base64":ne=Rn(tr(I.slice(pe).join("")));break;case"quoted-printable":ne=function E3(y){for(var I=[],M=0;M<y.length;++M){for(var T=y[M];M<=y.length&&"="==T.charAt(T.length-1);)T=T.slice(0,T.length-1)+y[++M];I.push(T)}for(var R=0;R<I.length;++R)I[R]=I[R].replace(/[=][0-9A-Fa-f]{2}/g,function(N){return String.fromCharCode(parseInt(N.slice(1),16))});return Rn(I.join("\r\n"))}(I.slice(pe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+R)}var ce=Zd(y,T.slice(M.length),ne,{unsafe:!0});N&&(ce.ctype=N)}function Zd(y,I,M,T){var R=T&&T.unsafe;R||A(y);var N=!R&&nt.find(y,I);if(!N){var ne=y.FullPaths[0];I.slice(0,ne.length)==ne?ne=I:("/"!=ne.slice(-1)&&(ne+="/"),ne=(ne+I).replace("//","/")),N={name:i(I),type:2},y.FileIndex.push(N),y.FullPaths.push(ne),R||nt.utils.cfb_gc(y)}return N.content=M,N.size=M?M.length:0,T&&(T.CLSID&&(N.clsid=T.CLSID),T.mt&&(N.mt=T.mt),T.ct&&(N.ct=T.ct)),N}return o.find=function de(y,I){var M=y.FullPaths.map(function(oe){return oe.toUpperCase()}),T=M.map(function(oe){var ie=oe.split("/");return ie[ie.length-("/"==oe.slice(-1)?2:1)]}),R=!1;47===I.charCodeAt(0)?(R=!0,I=M[0].slice(0,-1)+I):R=-1!==I.indexOf("/");var N=I.toUpperCase(),ne=!0===R?M.indexOf(N):T.indexOf(N);if(-1!==ne)return y.FileIndex[ne];var pe=!N.match(Kr);for(N=N.replace(Nn,""),pe&&(N=N.replace(Kr,"!")),ne=0;ne<M.length;++ne)if((pe?M[ne].replace(Kr,"!"):M[ne]).replace(Nn,"")==N||(pe?T[ne].replace(Kr,"!"):T[ne]).replace(Nn,"")==N)return y.FileIndex[ne];return null},o.read=function ee(y,I){var M=I&&I.type;switch(M||dt&&Buffer.isBuffer(y)&&(M="buffer"),M||"base64"){case"file":return function K(y,I){return p(),f(u.readFileSync(y),I)}(y,I);case"base64":return f(Rn(tr(y)),I);case"binary":return f(Rn(y),I)}return f(y,I)},o.parse=f,o.write=function ft(y,I){var M=le(y,I);switch(I&&I.type||"buffer"){case"file":return p(),u.writeFileSync(I.filename,M),M;case"binary":return"string"==typeof M?M:$e(M);case"base64":return Er("string"==typeof M?M:$e(M));case"buffer":if(dt)return Buffer.isBuffer(M)?M:pr(M);case"array":return"string"==typeof M?Rn(M):M}return M},o.writeFile=function St(y,I,M){p();var T=le(y,M);u.writeFileSync(I,T)},o.utils={cfb_new:function R3(y){var I={};return A(I,y),I},cfb_add:Zd,cfb_del:function N3(y,I){A(y);var M=nt.find(y,I);if(M)for(var T=0;T<y.FileIndex.length;++T)if(y.FileIndex[T]==M)return y.FileIndex.splice(T,1),y.FullPaths.splice(T,1),!0;return!1},cfb_mov:function A3(y,I,M){A(y);var T=nt.find(y,I);if(T)for(var R=0;R<y.FileIndex.length;++R)if(y.FileIndex[R]==T)return y.FileIndex[R].name=i(M),y.FullPaths[R]=M,!0;return!1},cfb_gc:function D3(y){q(y,!0)},ReadShift:Da,CheckField:Tu,prep_blob:Gn,bconcat:un,use_zlib:function U(y){try{var M=new(0,y.InflateRaw);if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),!M.bytesRead)throw new Error("zlib does not expose bytesRead");ke=y}catch(T){console.error("cannot use native zlib: "+(T.message||T))}},_deflateRaw:Ft,_inflateRaw:u0,consts:Qe},o}();let Vi;function f0(n){return"string"==typeof n?hi(n):Array.isArray(n)?function Di(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}(n):n}function Ia(n,o,t){if(typeof Vi<"u"&&Vi.writeFileSync)return t?Vi.writeFileSync(n,o,t):Vi.writeFileSync(n,o);if(typeof Deno<"u"){if(t&&"string"==typeof o)switch(t){case"utf8":o=new TextEncoder(t).encode(o);break;case"binary":o=hi(o);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,o)}var r="utf8"==t?ni(o):o;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,n);if(typeof Blob<"u"){var i=new Blob([f0(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,n);if(typeof saveAs<"u")return saveAs(i,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:n,saveAs:!0});var s=document.createElement("a");if(null!=s.download)return s.download=n,s.href=a,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(n);return l.open("w"),l.encoding="binary",Array.isArray(o)&&(o=Pr(o)),l.write(o),l.close(),o}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+n)}function gn(n){for(var o=Object.keys(n),t=[],r=0;r<o.length;++r)Object.prototype.hasOwnProperty.call(n,o[r])&&t.push(o[r]);return t}function Jd(n,o){for(var t=[],r=gn(n),i=0;i!==r.length;++i)null==t[n[r[i]][o]]&&(t[n[r[i]][o]]=r[i]);return t}function ac(n){for(var o=[],t=gn(n),r=0;r!==t.length;++r)o[n[t[r]]]=t[r];return o}function sc(n){for(var o=[],t=gn(n),r=0;r!==t.length;++r)o[n[t[r]]]=parseInt(t[r],10);return o}var cc=new Date(1899,11,30,0,0,0);function An(n,o){var t=n.getTime();return o&&(t-=1263168e5),(t-(cc.getTime()+6e4*(n.getTimezoneOffset()-cc.getTimezoneOffset())))/864e5}var Kd=new Date,_0=cc.getTime()+6e4*(Kd.getTimezoneOffset()-cc.getTimezoneOffset()),eu=Kd.getTimezoneOffset();function jl(n){var o=new Date;return o.setTime(24*n*60*60*1e3+_0),o.getTimezoneOffset()!==eu&&o.setTime(o.getTime()+6e4*(o.getTimezoneOffset()-eu)),o}var tu=new Date("2017-02-19T19:06:09.000Z"),nu=isNaN(tu.getFullYear())?new Date("2/19/17"):tu,C0=2017==nu.getFullYear();function ln(n,o){var t=new Date(n);if(C0)return o>0?t.setTime(t.getTime()+60*t.getTimezoneOffset()*1e3):o<0&&t.setTime(t.getTime()-60*t.getTimezoneOffset()*1e3),t;if(n instanceof Date)return n;if(1917==nu.getFullYear()&&!isNaN(t.getFullYear())){var r=t.getFullYear();return n.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var i=n.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return n.indexOf("Z")>-1&&(a=new Date(a.getTime()-60*a.getTimezoneOffset()*1e3)),a}function _o(n,o){if(dt&&Buffer.isBuffer(n)){if(o){if(255==n[0]&&254==n[1])return ni(n.slice(2).toString("utf16le"));if(254==n[1]&&255==n[2])return ni(function go(n){for(var o=[],t=0;t<n.length>>1;++t)o[t]=String.fromCharCode(n.charCodeAt(2*t+1)+(n.charCodeAt(2*t)<<8));return o.join("")}(n.slice(2).toString("binary")))}return n.toString("binary")}if(typeof TextDecoder<"u")try{if(o){if(255==n[0]&&254==n[1])return ni(new TextDecoder("utf-16le").decode(n.slice(2)));if(254==n[0]&&255==n[1])return ni(new TextDecoder("utf-16be").decode(n.slice(2)))}var t={"\u20ac":"\x80","\u201a":"\x82",\u0192:"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87",\u02c6:"\x88","\u2030":"\x89",\u0160:"\x8a","\u2039":"\x8b",\u0152:"\x8c",\u017d:"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99",\u0161:"\x9a","\u203a":"\x9b",\u0153:"\x9c",\u017e:"\x9e",\u0178:"\x9f"};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(a){return t[a]||a})}catch{}for(var r=[],i=0;i!=n.length;++i)r.push(String.fromCharCode(n[i]));return r.join("")}function Qt(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if("object"!=typeof n||null==n)return n;if(n instanceof Date)return new Date(n.getTime());var o={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(o[t]=Qt(n[t]));return o}function pn(n,o){for(var t="";t.length<o;)t+=n;return t}function Xr(n){var o=Number(n);if(!isNaN(o))return isFinite(o)?o:NaN;if(!/\d/.test(n))return o;var t=1,r=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return isNaN(o=Number(r))&&(r=r.replace(/[(](.*)[)]/,function(i,a){return t=-t,a}),isNaN(o=Number(r)))?o:o/t}var v0=["january","february","march","april","may","june","july","august","september","october","november","december"];function Xo(n){var o=new Date(n),t=new Date(NaN),r=o.getYear(),i=o.getMonth(),a=o.getDate();if(isNaN(a))return t;var s=n.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==v0.indexOf(s))return t}else if(s.match(/[a-z]/))return t;return r<0||r>8099?t:(i>0||a>1)&&101!=r?o:n.match(/[^-0-9:,\/\\]/)?t:o}function Ot(n,o,t){if(n.FullPaths){var r;if("string"==typeof t)return r=dt?pr(t):function Xs(n){for(var o=[],t=0,r=n.length+250,i=Ur(n.length+255),a=0;a<n.length;++a){var s=n.charCodeAt(a);if(s<128)i[t++]=s;else if(s<2048)i[t++]=192|s>>6&31,i[t++]=128|63&s;else if(s>=55296&&s<57344){s=64+(1023&s);var l=1023&n.charCodeAt(++a);i[t++]=240|s>>8&7,i[t++]=128|s>>2&63,i[t++]=128|l>>6&15|(3&s)<<4,i[t++]=128|63&l}else i[t++]=224|s>>12&15,i[t++]=128|s>>6&63,i[t++]=128|63&s;t>r&&(o.push(i.slice(0,t)),t=0,i=Ur(65535),r=65530)}return o.push(i.slice(0,t)),un(o)}(t),nt.utils.cfb_add(n,o,r);nt.utils.cfb_add(n,o,t)}else n.file(o,t)}function Ll(){return nt.utils.cfb_new()}var fn='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',$l=ac({"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"}),Gl=/[&<>'"]/g,F0=/[\u0000-\u0008\u000b-\u001f]/g;function Xt(n){return(n+"").replace(Gl,function(t){return $l[t]}).replace(F0,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function lu(n){return Xt(n).replace(/ /g,"_x0020_")}var du=/[\u0000-\u001f]/g;function uu(n){return(n+"").replace(Gl,function(t){return $l[t]}).replace(/\n/g,"<br/>").replace(du,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function Ul(n){for(var o="",t=0,r=0,i=0,a=0,s=0,l=0;t<n.length;)(r=n.charCodeAt(t++))<128?o+=String.fromCharCode(r):(i=n.charCodeAt(t++),r>191&&r<224?(s=(31&r)<<6,s|=63&i,o+=String.fromCharCode(s)):(a=n.charCodeAt(t++),r<240?o+=String.fromCharCode((15&r)<<12|(63&i)<<6|63&a):(l=((7&r)<<18|(63&i)<<12|(63&a)<<6|63&(s=n.charCodeAt(t++)))-65536,o+=String.fromCharCode(55296+(l>>>10&1023)),o+=String.fromCharCode(56320+(1023&l)))));return o}function pu(n){var t,r,l,o=Ur(2*n.length),i=1,a=0,s=0;for(r=0;r<n.length;r+=i)i=1,(l=n.charCodeAt(r))<128?t=l:l<224?(t=64*(31&l)+(63&n.charCodeAt(r+1)),i=2):l<240?(t=4096*(15&l)+64*(63&n.charCodeAt(r+1))+(63&n.charCodeAt(r+2)),i=3):(i=4,t=262144*(7&l)+4096*(63&n.charCodeAt(r+1))+64*(63&n.charCodeAt(r+2))+(63&n.charCodeAt(r+3)),s=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==s&&(o[a++]=255&s,o[a++]=s>>>8,s=0),o[a++]=t%256,o[a++]=t>>>8;return o.slice(0,a).toString("ucs2")}function fu(n){return pr(n,"binary").toString("utf8")}var lc="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",tn=dt&&(fu(lc)==Ul(lc)&&fu||pu(lc)==Ul(lc)&&pu)||Ul,ni=dt?function(n){return pr(n,"utf8").toString("binary")}:function(n){for(var o=[],t=0,r=0,i=0;t<n.length;)switch(r=n.charCodeAt(t++),!0){case r<128:o.push(String.fromCharCode(r));break;case r<2048:o.push(String.fromCharCode(192+(r>>6))),o.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,i=n.charCodeAt(t++)-56320+(r<<10),o.push(String.fromCharCode(240+(i>>18&7))),o.push(String.fromCharCode(144+(i>>12&63))),o.push(String.fromCharCode(128+(i>>6&63))),o.push(String.fromCharCode(128+(63&i)));break;default:o.push(String.fromCharCode(224+(r>>12))),o.push(String.fromCharCode(128+(r>>6&63))),o.push(String.fromCharCode(128+(63&r)))}return o.join("")},mu=function(){var n=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(o){return[new RegExp("&"+o[0]+";","ig"),o[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),i=0;i<n.length;++i)r=r.replace(n[i][0],n[i][1]);return r}}(),_u=/(^\s|\s$|\n)/;function $n(n,o){return"<"+n+(o.match(_u)?' xml:space="preserve"':"")+">"+o+"</"+n+">"}function Na(n){return gn(n).map(function(o){return" "+o+'="'+n[o]+'"'}).join("")}function we(n,o,t){return"<"+n+(null!=t?Na(t):"")+(null!=o?(o.match(_u)?' xml:space="preserve"':"")+">"+o+"</"+n:"/")+">"}function zl(n,o){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(o)throw t}return""}var yn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Yi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],kr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"},xu=function(n){for(var o=[],r=0;r<n[0].length;++r)if(n[0][r])for(var i=0,a=n[0][r].length;i<a;i+=10240)o.push.apply(o,n[0][r].slice(i,i+10240));return o},Cu=dt?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(o){return Buffer.isBuffer(o)?o:pr(o)})):xu(n)}:xu,vu=function(n,o,t){for(var r=[],i=o;i<t;i+=2)r.push(String.fromCharCode(Ci(n,i)));return r.join("").replace(Nn,"")},dc=dt?function(n,o,t){return Buffer.isBuffer(n)?n.toString("utf16le",o,t).replace(Nn,""):vu(n,o,t)}:vu,Pu=function(n,o,t){for(var r=[],i=o;i<o+t;++i)r.push(("0"+n[i].toString(16)).slice(-2));return r.join("")},bu=dt?function(n,o,t){return Buffer.isBuffer(n)?n.toString("hex",o,o+t):Pu(n,o,t)}:Pu,ku=function(n,o,t){for(var r=[],i=o;i<t;i++)r.push(String.fromCharCode(Wo(n,i)));return r.join("")},Ho=dt?function(o,t,r){return Buffer.isBuffer(o)?o.toString("utf8",t,r):ku(o,t,r)}:ku,Ou=function(n,o){var t=Dn(n,o);return t>0?Ho(n,o+4,o+4+t-1):""},Yl=Ou,yu=function(n,o){var t=Dn(n,o);return t>0?Ho(n,o+4,o+4+t-1):""},Xl=yu,Mu=function(n,o){var t=2*Dn(n,o);return t>0?Ho(n,o+4,o+4+t-1):""},Hl=Mu,wu=function(o,t){var r=Dn(o,t);return r>0?dc(o,t+4,t+4+r):""},Wl=wu,Fu=function(n,o){var t=Dn(n,o);return t>0?Ho(n,o+4,o+4+t):""},ql=Fu,Eu=function(n,o){return function D0(n,o){for(var t=1-2*(n[o+7]>>>7),r=((127&n[o+7])<<4)+(n[o+6]>>>4&15),i=15&n[o+6],a=5;a>=0;--a)i=256*i+n[o+a];return 2047==r?0==i?t*(1/0):NaN:(0==r?r=-1022:(r-=1023,i+=Math.pow(2,52)),t*Math.pow(2,r-52)*i)}(n,o)},uc=Eu,Zl=function(o){return Array.isArray(o)||typeof Uint8Array<"u"&&o instanceof Uint8Array};dt&&(Yl=function(o,t){if(!Buffer.isBuffer(o))return Ou(o,t);var r=o.readUInt32LE(t);return r>0?o.toString("utf8",t+4,t+4+r-1):""},Xl=function(o,t){if(!Buffer.isBuffer(o))return yu(o,t);var r=o.readUInt32LE(t);return r>0?o.toString("utf8",t+4,t+4+r-1):""},Hl=function(o,t){if(!Buffer.isBuffer(o))return Mu(o,t);var r=2*o.readUInt32LE(t);return o.toString("utf16le",t+4,t+4+r-1)},Wl=function(o,t){if(!Buffer.isBuffer(o))return wu(o,t);var r=o.readUInt32LE(t);return o.toString("utf16le",t+4,t+4+r)},ql=function(o,t){if(!Buffer.isBuffer(o))return Fu(o,t);var r=o.readUInt32LE(t);return o.toString("utf8",t+4,t+4+r)},uc=function(o,t){return Buffer.isBuffer(o)?o.readDoubleLE(t):Eu(o,t)},Zl=function(o){return Buffer.isBuffer(o)||Array.isArray(o)||typeof Uint8Array<"u"&&o instanceof Uint8Array}),typeof Nt<"u"&&function Su(){dc=function(n,o,t){return Nt.utils.decode(1200,n.slice(o,t)).replace(Nn,"")},Ho=function(n,o,t){return Nt.utils.decode(65001,n.slice(o,t))},Yl=function(n,o){var t=Dn(n,o);return t>0?Nt.utils.decode(Sn,n.slice(o+4,o+4+t-1)):""},Xl=function(n,o){var t=Dn(n,o);return t>0?Nt.utils.decode(Kn,n.slice(o+4,o+4+t-1)):""},Hl=function(n,o){var t=2*Dn(n,o);return t>0?Nt.utils.decode(1200,n.slice(o+4,o+4+t-1)):""},Wl=function(n,o){var t=Dn(n,o);return t>0?Nt.utils.decode(1200,n.slice(o+4,o+4+t)):""},ql=function(n,o){var t=Dn(n,o);return t>0?Nt.utils.decode(65001,n.slice(o+4,o+4+t)):""}}();var Wo=function(n,o){return n[o]},Ci=function(n,o){return 256*n[o+1]+n[o]},B0=function(n,o){var t=256*n[o+1]+n[o];return t<32768?t:-1*(65535-t+1)},Dn=function(n,o){return n[o+3]*(1<<24)+(n[o+2]<<16)+(n[o+1]<<8)+n[o]},xo=function(n,o){return n[o+3]<<24|n[o+2]<<16|n[o+1]<<8|n[o]},L0=function(n,o){return n[o]<<24|n[o+1]<<16|n[o+2]<<8|n[o+3]};function Da(n,o){var r,i,s,l,u,p,t="",a=[];switch(o){case"dbcs":if(p=this.l,dt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(u=0;u<n;++u)t+=String.fromCharCode(Ci(this,p)),p+=2;n*=2;break;case"utf8":t=Ho(this,this.l,this.l+n);break;case"utf16le":t=dc(this,this.l,this.l+(n*=2));break;case"wstr":if(!(typeof Nt<"u"))return Da.call(this,n,"dbcs");t=Nt.utils.decode(Kn,this.slice(this.l,this.l+2*n)),n*=2;break;case"lpstr-ansi":t=Yl(this,this.l),n=4+Dn(this,this.l);break;case"lpstr-cp":t=Xl(this,this.l),n=4+Dn(this,this.l);break;case"lpwstr":t=Hl(this,this.l),n=4+2*Dn(this,this.l);break;case"lpp4":n=4+Dn(this,this.l),t=Wl(this,this.l),2&n&&(n+=2);break;case"8lpp4":n=4+Dn(this,this.l),t=ql(this,this.l),3&n&&(n+=4-(3&n));break;case"cstr":for(n=0,t="";0!==(s=Wo(this,this.l+n++));)a.push(gr(s));t=a.join("");break;case"_wstr":for(n=0,t="";0!==(s=Ci(this,this.l+n));)a.push(gr(s)),n+=2;n+=2,t=a.join("");break;case"dbcs-cont":for(t="",p=this.l,u=0;u<n;++u){if(this.lens&&-1!==this.lens.indexOf(p))return s=Wo(this,p),this.l=p+1,l=Da.call(this,n-u,s?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(gr(Ci(this,p))),p+=2}t=a.join(""),n*=2;break;case"cpstr":if(typeof Nt<"u"){t=Nt.utils.decode(Kn,this.slice(this.l,this.l+n));break}case"sbcs-cont":for(t="",p=this.l,u=0;u!=n;++u){if(this.lens&&-1!==this.lens.indexOf(p))return s=Wo(this,p),this.l=p+1,l=Da.call(this,n-u,s?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(gr(Wo(this,p))),p+=1}t=a.join("");break;default:switch(n){case 1:return r=Wo(this,this.l),this.l++,r;case 2:return r=("i"===o?B0:Ci)(this,this.l),this.l+=2,r;case 4:case-4:return"i"!==o&&128&this[this.l+3]?(i=Dn(this,this.l),this.l+=4,i):(r=(n>0?xo:L0)(this,this.l),this.l+=4,r);case 8:case-8:if("f"===o)return i=8==n?uc(this,this.l):uc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;n=8;case 16:t=bu(this,this.l,n)}}return this.l+=n,t}var $0=function(n,o,t){n[t]=255&o,n[t+1]=o>>>8&255,n[t+2]=o>>>16&255,n[t+3]=o>>>24&255},G0=function(n,o,t){n[t]=255&o,n[t+1]=o>>8&255,n[t+2]=o>>16&255,n[t+3]=o>>24&255},U0=function(n,o,t){n[t]=255&o,n[t+1]=o>>>8&255};function z0(n,o,t){var r=0,i=0;if("dbcs"===t){for(i=0;i!=o.length;++i)U0(this,o.charCodeAt(i),this.l+2*i);r=2*o.length}else if("sbcs"===t){if(typeof Nt<"u"&&874==Sn)for(i=0;i!=o.length;++i){var a=Nt.utils.encode(Sn,o.charAt(i));this[this.l+i]=a[0]}else for(o=o.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=o.length;++i)this[this.l+i]=255&o.charCodeAt(i);r=o.length}else{if("hex"===t){for(;i<n;++i)this[this.l++]=parseInt(o.slice(2*i,2*i+2),16)||0;return this}if("utf16le"===t){var s=Math.min(this.l+n,this.length);for(i=0;i<Math.min(o.length,n);++i){var l=o.charCodeAt(i);this[this.l++]=255&l,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(n){case 1:r=1,this[this.l]=255&o;break;case 2:r=2,this[this.l]=255&o,this[this.l+1]=255&(o>>>=8);break;case 3:r=3,this[this.l]=255&o,this[this.l+1]=255&(o>>>=8),this[this.l+2]=255&(o>>>=8);break;case 4:r=4,$0(this,o,this.l);break;case 8:if(r=8,"f"===t){!function j0(n,o,t){var r=(o<0||1/o==-1/0?1:0)<<7,i=0,a=0,s=r?-o:o;isFinite(s)?0==s?i=a=0:(i=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(o)?26985:0);for(var l=0;l<=5;++l,a/=256)n[t+l]=255&a;n[t+6]=(15&i)<<4|15&a,n[t+7]=i>>4|r}(this,o,this.l);break}case 16:break;case-4:r=4,G0(this,o,this.l)}}return this.l+=r,this}function Tu(n,o){var t=bu(this,this.l,n.length>>1);if(t!==n)throw new Error(o+"Expected "+n+" saw "+t);this.l+=n.length>>1}function Gn(n,o){n.l=o,n.read_shift=Da,n.chk=Tu,n.write_shift=z0}function Vn(n,o){n.l+=o}function ue(n){var o=Ur(n);return Gn(o,0),o}function rr(){var n=[],o=dt?256:2048,t=function(p){var f=ue(p);return Gn(f,0),f},r=t(o),i=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&n.push(r),r=null)},a=function(p){return r&&p<r.length-r.l?r:(i(),r=t(Math.max(p+1,o)))};return{next:a,push:function(p){i(),null==(r=p).l&&(r.l=r.length),a(o)},end:function(){return i(),un(n)},_bufs:n}}function xe(n,o,t,r){var a,i=+o;if(!isNaN(i)){r||(r=es[i].p||(t||[]).length||0),a=1+(i>=128?1:0)+1,r>=128&&++a,r>=16384&&++a,r>=2097152&&++a;var s=n.next(a);i<=127?s.write_shift(1,i):(s.write_shift(1,128+(127&i)),s.write_shift(1,i>>7));for(var l=0;4!=l;++l){if(!(r>=128)){s.write_shift(1,r);break}s.write_shift(1,128+(127&r)),r>>=7}r>0&&Zl(t)&&n.push(t)}}function ja(n,o,t){var r=Qt(n);if(o.s?(r.cRel&&(r.c+=o.s.c),r.rRel&&(r.r+=o.s.r)):(r.cRel&&(r.c+=o.c),r.rRel&&(r.r+=o.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Iu(n,o,t){var r=Qt(n);return r.s=ja(r.s,o.s,t),r.e=ja(r.e,o.s,t),r}function Ba(n,o){if(n.cRel&&n.c<0)for(n=Qt(n);n.c<0;)n.c+=o>8?16384:256;if(n.rRel&&n.r<0)for(n=Qt(n);n.r<0;)n.r+=o>8?1048576:o>5?65536:16384;var t=pt(n);return!n.cRel&&null!=n.cRel&&(t=function X0(n){return n.replace(/^([A-Z])/,"$$$1")}(t)),!n.rRel&&null!=n.rRel&&(t=function V0(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(t)),t}function Ql(n,o){return 0!=n.s.r||n.s.rRel||n.e.r!=(o.biff>=12?1048575:o.biff>=8?65536:16384)||n.e.rRel?0!=n.s.c||n.s.cRel||n.e.c!=(o.biff>=12?16383:255)||n.e.cRel?Ba(n.s,o.biff)+":"+Ba(n.e,o.biff):(n.s.rRel?"":"$")+mn(n.s.r)+":"+(n.e.rRel?"":"$")+mn(n.e.r):(n.s.cRel?"":"$")+nn(n.s.c)+":"+(n.e.cRel?"":"$")+nn(n.e.c)}function Jl(n){return parseInt(function Y0(n){return n.replace(/\$(\d+)$/,"$1")}(n),10)-1}function mn(n){return""+(n+1)}function Kl(n){for(var o=function H0(n){return n.replace(/^\$([A-Z])/,"$1")}(n),t=0,r=0;r!==o.length;++r)t=26*t+o.charCodeAt(r)-64;return t-1}function nn(n){if(n<0)throw new Error("invalid column "+n);var o="";for(++n;n;n=Math.floor((n-1)/26))o=String.fromCharCode((n-1)%26+65)+o;return o}function Cn(n){for(var o=0,t=0,r=0;r<n.length;++r){var i=n.charCodeAt(r);i>=48&&i<=57?o=10*o+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:o-1}}function pt(n){for(var o=n.c+1,t="";o;o=(o-1)/26|0)t=String.fromCharCode((o-1)%26+65)+t;return t+(n.r+1)}function ir(n){var o=n.indexOf(":");return-1==o?{s:Cn(n),e:Cn(n)}:{s:Cn(n.slice(0,o)),e:Cn(n.slice(o+1))}}function bt(n,o){return typeof o>"u"||"number"==typeof o?bt(n.s,n.e):("string"!=typeof n&&(n=pt(n)),"string"!=typeof o&&(o=pt(o)),n==o?n:n+":"+o)}function Dt(n){var o={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,i=0,a=n.length;for(t=0;r<a&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(o.s.c=--t,t=0;r<a&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;if(o.s.r=--t,r===a||10!=i)return o.e.c=o.s.c,o.e.r=o.s.r,o;for(++r,t=0;r!=a&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(o.e.c=--t,t=0;r!=a&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;return o.e.r=--t,o}function ri(n,o,t){return null==n||null==n.t||"z"==n.t?"":void 0!==n.w?n.w:("d"==n.t&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),"e"==n.t?Pi[n.v]||n.v:function Ru(n,o){var t="d"==n.t&&o instanceof Date;if(null!=n.z)try{return n.w=Un(n.z,t?An(o):o)}catch{}try{return n.w=Un((n.XF||{}).numFmtId||(t?14:0),t?An(o):o)}catch{return""+o}}(n,null==o?n.v:o))}function Xi(n,o){var t=o&&o.sheet?o.sheet:"Sheet1",r={};return r[t]=n,{SheetNames:[t],Sheets:r}}function Nu(n,o,t){var r=t||{},i=n?Array.isArray(n):r.dense;null!=on&&null==i&&(i=on);var a=n||(i?[]:{}),s=0,l=0;if(a&&null!=r.origin){if("number"==typeof r.origin)s=r.origin;else{var u="string"==typeof r.origin?Cn(r.origin):r.origin;s=u.r,l=u.c}a["!ref"]||(a["!ref"]="A1:A1")}var p={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=Dt(a["!ref"]);p.s.c=f.s.c,p.s.r=f.s.r,p.e.c=Math.max(p.e.c,f.e.c),p.e.r=Math.max(p.e.r,f.e.r),-1==s&&(p.e.r=s=f.e.r+1)}for(var h=0;h!=o.length;++h)if(o[h]){if(!Array.isArray(o[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=o[h].length;++_)if(!(typeof o[h][_]>"u")){var C={v:o[h][_]},P=s+h,x=l+_;if(p.s.r>P&&(p.s.r=P),p.s.c>x&&(p.s.c=x),p.e.r<P&&(p.e.r=P),p.e.c<x&&(p.e.c=x),!o[h][_]||"object"!=typeof o[h][_]||Array.isArray(o[h][_])||o[h][_]instanceof Date)if(Array.isArray(C.v)&&(C.f=o[h][_][1],C.v=C.v[0]),null===C.v)if(C.f)C.t="n";else if(r.nullError)C.t="e",C.v=0;else{if(!r.sheetStubs)continue;C.t="z"}else"number"==typeof C.v?C.t="n":"boolean"==typeof C.v?C.t="b":C.v instanceof Date?(C.z=r.dateNF||tt[14],r.cellDates?(C.t="d",C.w=Un(C.z,An(C.v))):(C.t="n",C.v=An(C.v),C.w=Un(C.z,C.v))):C.t="s";else C=o[h][_];if(i)a[P]||(a[P]=[]),a[P][x]&&a[P][x].z&&(C.z=a[P][x].z),a[P][x]=C;else{var k=pt({c:x,r:P});a[k]&&a[k].z&&(C.z=a[k].z),a[k]=C}}}return p.s.c<1e7&&(a["!ref"]=bt(p)),a}function qo(n,o){return Nu(null,n,o)}function Hr(n,o){return o||(o=ue(4)),o.write_shift(4,n),o}function Yn(n){var o=n.read_shift(4);return 0===o?"":n.read_shift(o,"dbcs")}function jn(n,o){var t=!1;return null==o&&(t=!0,o=ue(4+2*n.length)),o.write_shift(4,n.length),n.length>0&&o.write_shift(0,n,"dbcs"),t?o.slice(0,o.l):o}function Z0(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function ed(n,o){var t=n.l,r=n.read_shift(1),i=Yn(n),a=[],s={t:i,h:i};if(1&r){for(var l=n.read_shift(4),u=0;u!=l;++u)a.push(Z0(n));s.r=a}else s.r=[{ich:0,ifnt:0}];return n.l=t+o,s}var K0=ed;function Rr(n){var o=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:o,iStyleRef:t}}function Co(n,o){return null==o&&(o=ue(8)),o.write_shift(-4,n.c),o.write_shift(3,n.iStyleRef||n.s),o.write_shift(1,0),o}function vo(n){var o=n.read_shift(2);return o+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:o}}function Po(n,o){return null==o&&(o=ue(4)),o.write_shift(3,n.iStyleRef||n.s),o.write_shift(1,0),o}var tf=Yn,Au=jn;function td(n){var o=n.read_shift(4);return 0===o||4294967295===o?"":n.read_shift(o,"dbcs")}function gc(n,o){var t=!1;return null==o&&(t=!0,o=ue(127)),o.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&o.write_shift(0,n,"dbcs"),t?o.slice(0,o.l):o}var nf=Yn,nd=td,rd=gc;function id(n){var o=n.slice(n.l,n.l+4),t=1&o[0],r=2&o[0];n.l+=4;var i=0===r?uc([0,0,0,0,252&o[0],o[1],o[2],o[3]],0):xo(o,0)>>2;return t?i/100:i}function Du(n,o){null==o&&(o=ue(4));var t=0,r=0,i=100*n;if(n==(0|n)&&n>=-(1<<29)&&n<1<<29?r=1:i==(0|i)&&i>=-(1<<29)&&i<1<<29&&(r=1,t=1),!r)throw new Error("unsupported RkNumber "+n);o.write_shift(-4,((t?i:n)<<2)+(t+2))}function ju(n){var o={s:{},e:{}};return o.s.r=n.read_shift(4),o.e.r=n.read_shift(4),o.s.c=n.read_shift(4),o.e.c=n.read_shift(4),o}var bo=ju,Zo=function rf(n,o){return o||(o=ue(16)),o.write_shift(4,n.s.r),o.write_shift(4,n.e.r),o.write_shift(4,n.s.c),o.write_shift(4,n.e.c),o};function Xn(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function ko(n,o){return(o||ue(8)).write_shift(8,n,"f")}function pc(n,o){if(o||(o=ue(8)),!n||n.auto)return o.write_shift(4,0),o.write_shift(4,0),o;null!=n.index?(o.write_shift(1,2),o.write_shift(1,n.index)):null!=n.theme?(o.write_shift(1,6),o.write_shift(1,n.theme)):(o.write_shift(1,5),o.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),o.write_shift(2,t),n.rgb&&null==n.theme){var r=n.rgb||"FFFFFF";"number"==typeof r&&(r=("000000"+r.toString(16)).slice(-6)),o.write_shift(1,parseInt(r.slice(0,2),16)),o.write_shift(1,parseInt(r.slice(2,4),16)),o.write_shift(1,parseInt(r.slice(4,6),16)),o.write_shift(1,255)}else o.write_shift(2,0),o.write_shift(1,0),o.write_shift(1,0);return o}var ad={1:{n:"CodePage",t:2},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},sd={1:{n:"CodePage",t:2},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}};function hf(n){return n.map(function(o){return[o>>16&255,o>>8&255,255&o]})}var Oo=Qt(hf([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),Pi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},cd={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},_c={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Uu(n,o){var i,t=function h0(n){for(var o=[],t=gn(n),r=0;r!==t.length;++r)null==o[n[t[r]]]&&(o[n[t[r]]]=[]),o[n[t[r]]].push(t[r]);return o}(cd),r=[];r[r.length]=fn,r[r.length]=we("Types",null,{xmlns:yn.CT,"xmlns:xsd":yn.xsd,"xmlns:xsi":yn.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return we("Default",null,{Extension:u[0],ContentType:u[1]})}));var a=function(u){n[u]&&n[u].length>0&&(r[r.length]=we("Override",null,{PartName:("/"==(i=n[u][0])[0]?"":"/")+i,ContentType:_c[u][o.bookType]||_c[u].xlsx}))},s=function(u){(n[u]||[]).forEach(function(p){r[r.length]=we("Override",null,{PartName:("/"==p[0]?"":"/")+p,ContentType:_c[u][o.bookType]||_c[u].xlsx})})},l=function(u){(n[u]||[]).forEach(function(p){r[r.length]=we("Override",null,{PartName:("/"==p[0]?"":"/")+p,ContentType:t[u][0]})})};return a("workbooks"),s("sheets"),s("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),s("metadata"),l("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var kt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function La(n){var o=n.lastIndexOf("/");return n.slice(0,o+1)+"_rels/"+n.slice(o+1)+".rels"}function Qo(n){var o=[fn,we("Relationships",null,{xmlns:yn.RELS})];return gn(n["!id"]).forEach(function(t){o[o.length]=we("Relationship",null,n["!id"][t])}),o.length>2&&(o[o.length]="</Relationships>",o[1]=o[1].replace("/>",">")),o.join("")}function zt(n,o,t,r,i,a){if(i||(i={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),o<0)for(o=n["!idx"];n["!id"]["rId"+o];++o);if(n["!idx"]=o+1,i.Id="rId"+o,i.Type=r,i.Target=t,a?i.TargetMode=a:[kt.HLINK,kt.XPATH,kt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),n["!id"][i.Id])throw new Error("Cannot rewrite rId "+o);return n["!id"][i.Id]=i,n[("/"+i.Target).replace("//","/")]=i,o}function zu(n,o,t){return['  <rdf:Description rdf:about="'+n+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+o+'"/>\n',"  </rdf:Description>\n"].join("")}function kf(n,o){return['  <rdf:Description rdf:about="'+n+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+o+'"/>\n',"  </rdf:Description>\n"].join("")}function Vu(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ii.version+"</meta:generator></office:meta></office:document-meta>"}var bi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function dd(n,o,t,r,i){null!=i[n]||null==o||""===o||(i[n]=o,o=Xt(o),r[r.length]=t?we(n,o,t):$n(n,o))}function Xu(n,o){var t=o||{},r=[fn,we("cp:coreProperties",null,{"xmlns:cp":yn.CORE_PROPS,"xmlns:dc":yn.dc,"xmlns:dcterms":yn.dcterms,"xmlns:dcmitype":yn.dcmitype,"xmlns:xsi":yn.xsi})],i={};if(!n&&!t.Props)return r.join("");n&&(null!=n.CreatedDate&&dd("dcterms:created","string"==typeof n.CreatedDate?n.CreatedDate:zl(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),null!=n.ModifiedDate&&dd("dcterms:modified","string"==typeof n.ModifiedDate?n.ModifiedDate:zl(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var a=0;a!=bi.length;++a){var s=bi[a],l=t.Props&&null!=t.Props[s[1]]?t.Props[s[1]]:n?n[s[1]]:null;!0===l?l="1":!1===l?l="0":"number"==typeof l&&(l=String(l)),null!=l&&dd(s[0],l,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var yo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Hu=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function qu(n){var o=[],t=we;return n||(n={}),n.Application="SheetJS",o[o.length]=fn,o[o.length]=we("Properties",null,{xmlns:yn.EXT_PROPS,"xmlns:vt":yn.vt}),yo.forEach(function(r){if(void 0!==n[r[1]]){var i;switch(r[2]){case"string":i=Xt(String(n[r[1]]));break;case"bool":i=n[r[1]]?"true":"false"}void 0!==i&&(o[o.length]=t(r[0],i))}}),o[o.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),o[o.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(r){return"<vt:lpstr>"+Xt(r)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),o.length>2&&(o[o.length]="</Properties>",o[1]=o[1].replace("/>",">")),o.join("")}function Zu(n){var o=[fn,we("Properties",null,{xmlns:yn.CUST_PROPS,"xmlns:vt":yn.vt})];if(!n)return o.join("");var t=1;return gn(n).forEach(function(i){++t,o[o.length]=we("property",function A0(n,o){switch(typeof n){case"string":var t=we("vt:lpwstr",Xt(n));return o&&(t=t.replace(/&quot;/g,"_x0022_")),t;case"number":return we((0|n)==n?"vt:i4":"vt:r8",Xt(String(n)));case"boolean":return we("vt:bool",n?"true":"false")}if(n instanceof Date)return we("vt:filetime",zl(n));throw new Error("Unable to serialize "+n)}(n[i],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Xt(i)})}),o.length>2&&(o[o.length]="</Properties>",o[1]=o[1].replace("/>",">")),o.join("")}var ud={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function ng(n,o){var t=ue(4),r=ue(4);switch(t.write_shift(4,80==n?31:n),n){case 3:r.write_shift(-4,o);break;case 5:(r=ue(8)).write_shift(8,o,"f");break;case 11:r.write_shift(4,o?1:0);break;case 64:r=function If(n){var t=("string"==typeof n?new Date(Date.parse(n)):n).getTime()/1e3+11644473600,r=t%Math.pow(2,32),i=(t-r)/Math.pow(2,32);i*=1e7;var a=(r*=1e7)/Math.pow(2,32)|0;a>0&&(r%=Math.pow(2,32),i+=a);var s=ue(8);return s.write_shift(4,r),s.write_shift(4,i),s}(o);break;case 31:case 80:for((r=ue(4+2*(o.length+1)+(o.length%2?0:2))).write_shift(4,o.length+1),r.write_shift(0,o,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+o)}return un([t,r])}var ig=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Lf(n){switch(typeof n){case"boolean":return 11;case"number":return(0|n)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64}return-1}function og(n,o,t){var r=ue(8),i=[],a=[],s=8,l=0,u=ue(8),p=ue(8);if(u.write_shift(4,2),u.write_shift(4,1200),p.write_shift(4,1),a.push(u),i.push(p),s+=8+u.length,!o){(p=ue(8)).write_shift(4,0),i.unshift(p);var f=[ue(4)];for(f[0].write_shift(4,n.length),l=0;l<n.length;++l){var h=n[l][0];for((u=ue(8+2*(h.length+1)+(h.length%2?0:2))).write_shift(4,l+2),u.write_shift(4,h.length+1),u.write_shift(0,h,"dbcs");u.l!=u.length;)u.write_shift(1,0);f.push(u)}u=un(f),a.unshift(u),s+=8+u.length}for(l=0;l<n.length;++l)if((!o||o[n[l][0]])&&!(ig.indexOf(n[l][0])>-1||Hu.indexOf(n[l][0])>-1)&&null!=n[l][1]){var _=n[l][1],C=0;if(o){var P=t[C=+o[n[l][0]]];if("version"==P.p&&"string"==typeof _){var x=_.split(".");_=(+x[0]<<16)+(+x[1]||0)}u=ng(P.t,_)}else{var k=Lf(_);-1==k&&(k=31,_=String(_)),u=ng(k,_)}a.push(u),(p=ue(8)).write_shift(4,o?C:2+l),i.push(p),s+=8+u.length}var F=8*(a.length+1);for(l=0;l<a.length;++l)i[l].write_shift(4,F),F+=a[l].length;return r.write_shift(4,s),r.write_shift(4,a.length),un([r].concat(i).concat(a))}function sg(n,o,t,r,i,a){var s=ue(i?68:48),l=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,nt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,i?2:1),s.write_shift(16,o,"hex"),s.write_shift(4,i?68:48);var u=og(n,t,r);if(l.push(u),i){var p=og(i,null,null);s.write_shift(16,a,"hex"),s.write_shift(4,68+u.length),l.push(p)}return un(l)}function or(n,o){return o||(o=ue(2)),o.write_shift(2,+!!n),o}function Mn(n){return n.read_shift(2,"u")}function Nr(n,o){return o||(o=ue(2)),o.write_shift(2,n),o}function lg(n,o,t){return t||(t=ue(2)),t.write_shift(1,"e"==o?+n:+!!n),t.write_shift(1,"e"==o?1:0),t}function Ga(n,o,t){var r=n.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont",a=Kn;t&&t.biff>=8&&(Kn=1200),t&&8!=t.biff?12==t.biff&&(i="wstr"):n.read_shift(1)&&(i="dbcs-cont"),t.biff>=2&&t.biff<=5&&(i="cpstr");var l=r?n.read_shift(r,i):"";return Kn=a,l}function Vf(n){var o=n.t||"",r=ue(3);r.write_shift(2,o.length),r.write_shift(1,1);var i=ue(2*o.length);return i.write_shift(2*o.length,o,"utf16le"),un([r,i])}function dg(n,o,t){return t||(t=ue(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function ug(n,o){o||(o=ue(6+2*n.length)),o.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)o.write_shift(2,n.charCodeAt(t));return o.write_shift(2,0),o}function Zf(n){var o=ue(512),t=0,r=n.Target;"file://"==r.slice(0,7)&&(r=r.slice(7));var i=r.indexOf("#"),a=i>-1?31:23;switch(r.charAt(0)){case"#":a=28;break;case".":a&=-3}o.write_shift(4,2),o.write_shift(4,a);var s=[8,6815827,6619237,4849780,83];for(t=0;t<s.length;++t)o.write_shift(4,s[t]);if(28==a)ug(r=r.slice(1),o);else if(2&a){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<s.length;++t)o.write_shift(1,parseInt(s[t],16));var l=i>-1?r.slice(0,i):r;for(o.write_shift(4,2*(l.length+1)),t=0;t<l.length;++t)o.write_shift(2,l.charCodeAt(t));o.write_shift(2,0),8&a&&ug(i>-1?r.slice(i+1):"",o)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<s.length;++t)o.write_shift(1,parseInt(s[t],16));for(var u=0;"../"==r.slice(3*u,3*u+3)||"..\\"==r.slice(3*u,3*u+3);)++u;for(o.write_shift(2,u),o.write_shift(4,r.length-3*u+1),t=0;t<r.length-3*u;++t)o.write_shift(1,255&r.charCodeAt(t+3*u));for(o.write_shift(1,0),o.write_shift(2,65535),o.write_shift(2,57005),t=0;t<6;++t)o.write_shift(4,0)}return o.slice(0,o.l)}function Fo(n,o,t,r){return r||(r=ue(6)),r.write_shift(2,n),r.write_shift(2,o),r.write_shift(2,t||0),r}function Kf(n,o,t){var r=t.biff>8?4:2;return[n.read_shift(r),n.read_shift(r,"i"),n.read_shift(r,"i")]}function vc(n){var o=n.read_shift(2),t=n.read_shift(2);return{s:{c:n.read_shift(2),r:o},e:{c:n.read_shift(2),r:t}}}function mg(n,o){return o||(o=ue(8)),o.write_shift(2,n.s.r),o.write_shift(2,n.e.r),o.write_shift(2,n.s.c),o.write_shift(2,n.e.c),o}function md(n,o,t){var r=1536,i=16;switch(t.bookType){case"biff8":case"xla":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;default:throw new Error("unsupported BIFF version")}var a=ue(i);return a.write_shift(2,r),a.write_shift(2,o),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function um(n,o){var t=!o||o.biff>=8?2:1,r=ue(8+t*n.name.length);r.write_shift(4,n.pos),r.write_shift(1,n.hs||0),r.write_shift(1,n.dt),r.write_shift(1,n.name.length),o.biff>=8&&r.write_shift(1,1),r.write_shift(t*n.name.length,n.name,o.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function Sm(n,o,t,r){var i=t&&5==t.biff;r||(r=ue(i?3+o.length:5+2*o.length)),r.write_shift(2,n),r.write_shift(i?1:2,o.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*o.length,o,i?"sbcs":"utf16le");var a=r.length>r.l?r.slice(0,r.l):r;return null==a.l&&(a.l=a.length),a}function vg(n,o,t,r){var i=t&&5==t.biff;r||(r=ue(i?16:20)),r.write_shift(2,0),n.style?(r.write_shift(2,n.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,n.numFmtId||0),r.write_shift(2,o<<4));var a=0;return n.numFmtId>0&&i&&(a|=1024),r.write_shift(4,a),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function ih(n){var o=ue(24),t=Cn(n[0]);o.write_shift(2,t.r),o.write_shift(2,t.r),o.write_shift(2,t.c),o.write_shift(2,t.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)o.write_shift(1,parseInt(r[i],16));return un([o,Zf(n[1])])}function ah(n){var o=n[1].Tooltip,t=ue(10+2*(o.length+1));t.write_shift(2,2048);var r=Cn(n[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var i=0;i<o.length;++i)t.write_shift(2,o.charCodeAt(i));return t.write_shift(2,0),t}var hd=function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},o=ac({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,u){var p=u||{};p.dateNF||(p.dateNF="yyyymmdd");var f=qo(function t(l,u){var p=[],f=Ur(1);switch(u.type){case"base64":f=Rn(tr(l));break;case"binary":f=Rn(l);break;case"buffer":case"array":f=l}Gn(f,0);var h=f.read_shift(1),_=!!(136&h),C=!1,P=!1;switch(h){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:C=!0,_=!0;break;case 140:P=!0;break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var x=0,k=521;2==h&&(x=f.read_shift(2)),f.l+=3,2!=h&&(x=f.read_shift(4)),x>1048576&&(x=1e6),2!=h&&(k=f.read_shift(2));var F=f.read_shift(2),S=u.codepage||1252;2!=h&&(f.l+=16,f.read_shift(1),0!==f[f.l]&&(S=n[f[f.l]]),f.l+=1,f.l+=2),P&&(f.l+=36);for(var w=[],W={},K=Math.min(f.length,2==h?521:k-10-(C?264:0)),ee=P?32:11;f.l<K&&13!=f[f.l];)switch(W={},W.name=Nt.utils.decode(S,f.slice(f.l,f.l+ee)).replace(/[\u0000\r\n].*$/g,""),f.l+=ee,W.type=String.fromCharCode(f.read_shift(1)),2!=h&&!P&&(W.offset=f.read_shift(4)),W.len=f.read_shift(1),2==h&&(W.offset=f.read_shift(2)),W.dec=f.read_shift(1),W.name.length&&w.push(W),2!=h&&(f.l+=P?13:14),W.type){case"B":(!C||8!=W.len)&&u.WTF&&console.log("Skipping "+W.name+":"+W.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+W.name+":"+W.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+W.type)}if(13!==f[f.l]&&(f.l=k-1),13!==f.read_shift(1))throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=k;var A=0,Q=0;for(p[0]=[],Q=0;Q!=w.length;++Q)p[0][Q]=w[Q].name;for(;x-- >0;)if(42!==f[f.l])for(++f.l,p[++A]=[],Q=0,Q=0;Q!=w.length;++Q){var q=f.slice(f.l,f.l+w[Q].len);f.l+=w[Q].len,Gn(q,0);var le=Nt.utils.decode(S,q);switch(w[Q].type){case"C":le.trim().length&&(p[A][Q]=le.replace(/\s+$/,""));break;case"D":p[A][Q]=8===le.length?new Date(+le.slice(0,4),+le.slice(4,6)-1,+le.slice(6,8)):le;break;case"F":p[A][Q]=parseFloat(le.trim());break;case"+":case"I":p[A][Q]=P?2147483648^q.read_shift(-4,"i"):q.read_shift(4,"i");break;case"L":switch(le.trim().toUpperCase()){case"Y":case"T":p[A][Q]=!0;break;case"N":case"F":p[A][Q]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+le+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));p[A][Q]="##MEMO##"+(P?parseInt(le.trim(),10):q.read_shift(4));break;case"N":(le=le.replace(/\u0000/g,"").trim())&&"."!=le&&(p[A][Q]=+le||0);break;case"@":p[A][Q]=new Date(q.read_shift(-8,"f")-621356832e5);break;case"T":p[A][Q]=new Date(864e5*(q.read_shift(4)-2440588)+q.read_shift(4));break;case"Y":p[A][Q]=q.read_shift(4,"i")/1e4+q.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":p[A][Q]=-q.read_shift(-8,"f");break;case"B":if(C&&8==w[Q].len){p[A][Q]=q.read_shift(8,"f");break}case"G":case"P":q.l+=w[Q].len;break;case"0":if("_NullFlags"===w[Q].name)break;default:throw new Error("DBF Unsupported data type "+w[Q].type)}}else f.l+=F;if(2!=h&&f.l<f.length&&26!=f[f.l++])throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return u&&u.sheetRows&&(p=p.slice(0,u.sheetRows)),u.DBF=w,p}(l,p),p);return f["!cols"]=p.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete p.DBF,f}var a={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function i(l,u){try{return Xi(r(l,u),u)}catch(p){if(u&&u.WTF)throw p}return{SheetNames:[],Sheets:{}}},to_sheet:r,from_sheet:function s(l,u){var p=u||{};if(+p.codepage>=0&&Tn(+p.codepage),"string"==p.type)throw new Error("Cannot write DBF to JS string");var f=rr(),h=Nc(l,{header:1,raw:!0,cellDates:!0}),_=h[0],C=h.slice(1),P=l["!cols"]||[],x=0,k=0,F=0,S=1;for(x=0;x<_.length;++x)if(((P[x]||{}).DBF||{}).name)_[x]=P[x].DBF.name,++F;else if(null!=_[x]){if(++F,"number"==typeof _[x]&&(_[x]=_[x].toString(10)),"string"!=typeof _[x])throw new Error("DBF Invalid column name "+_[x]+" |"+typeof _[x]+"|");if(_.indexOf(_[x])!==x)for(k=0;k<1024;++k)if(-1==_.indexOf(_[x]+"_"+k)){_[x]+="_"+k;break}}var w=Dt(l["!ref"]),W=[],K=[],ee=[];for(x=0;x<=w.e.c-w.s.c;++x){var A="",Q="",q=0,le=[];for(k=0;k<C.length;++k)null!=C[k][x]&&le.push(C[k][x]);if(0!=le.length&&null!=_[x]){for(k=0;k<le.length;++k){switch(typeof le[k]){case"number":Q="B";break;case"string":default:Q="C";break;case"boolean":Q="L";break;case"object":Q=le[k]instanceof Date?"D":"C"}q=Math.max(q,String(le[k]).length),A=A&&A!=Q?"C":Q}q>250&&(q=250),"C"==(Q=((P[x]||{}).DBF||{}).type)&&P[x].DBF.len>q&&(q=P[x].DBF.len),"B"==A&&"N"==Q&&(A="N",ee[x]=P[x].DBF.dec,q=P[x].DBF.len),K[x]="C"==A||"N"==Q?q:a[A]||0,S+=K[x],W[x]=A}else W[x]="?"}var de=f.next(32);for(de.write_shift(4,318902576),de.write_shift(4,C.length),de.write_shift(2,296+32*F),de.write_shift(2,S),x=0;x<4;++x)de.write_shift(4,0);for(de.write_shift(4,0|(+o[Sn]||3)<<8),x=0,k=0;x<_.length;++x)if(null!=_[x]){var Z=f.next(32),Fe=(_[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Z.write_shift(1,Fe,"sbcs"),Z.write_shift(1,"?"==W[x]?"C":W[x],"sbcs"),Z.write_shift(4,k),Z.write_shift(1,K[x]||a[W[x]]||0),Z.write_shift(1,ee[x]||0),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(1,0),Z.write_shift(4,0),Z.write_shift(4,0),k+=K[x]||a[W[x]]||0}var Ye=f.next(264);for(Ye.write_shift(4,13),x=0;x<65;++x)Ye.write_shift(4,0);for(x=0;x<C.length;++x){var De=f.next(S);for(De.write_shift(1,0),k=0;k<_.length;++k)if(null!=_[k])switch(W[k]){case"L":De.write_shift(1,null==C[x][k]?63:C[x][k]?84:70);break;case"B":De.write_shift(8,C[x][k]||0,"f");break;case"N":var ct="0";for("number"==typeof C[x][k]&&(ct=C[x][k].toFixed(ee[k]||0)),F=0;F<K[k]-ct.length;++F)De.write_shift(1,32);De.write_shift(1,ct,"sbcs");break;case"D":C[x][k]?(De.write_shift(4,("0000"+C[x][k].getFullYear()).slice(-4),"sbcs"),De.write_shift(2,("00"+(C[x][k].getMonth()+1)).slice(-2),"sbcs"),De.write_shift(2,("00"+C[x][k].getDate()).slice(-2),"sbcs")):De.write_shift(8,"00000000","sbcs");break;case"C":var Qe=String(null!=C[x][k]?C[x][k]:"").slice(0,K[k]);for(De.write_shift(1,Qe,"sbcs"),F=0;F<K[k]-Qe.length;++F)De.write_shift(1,32)}}return f.next(1).write_shift(1,26),f.end()}}}(),Fg=function(){var n={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},o=new RegExp("\x1bN("+gn(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(_,C){var P=n[C];return"number"==typeof P?Ai(P):P},r=function(_,C,P){var x=C.charCodeAt(0)-32<<4|P.charCodeAt(0)-48;return 59==x?_:Ai(x)};function a(_,C){var de,P=_.split(/[\n\r]+/),x=-1,k=-1,F=0,S=0,w=[],W=[],K=null,ee={},A=[],Q=[],q=[],le=0;for(+C.codepage>=0&&Tn(+C.codepage);F!==P.length;++F){le=0;var De,Z=P[F].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(o,t),Fe=Z.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")});if(Z.length>0)switch(Fe[0]){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==Fe[1].charAt(0)&&W.push(Z.slice(3).replace(/;;/g,";"));break;case"C":var ct=!1,Qe=!1,St=!1,$e=!1,ft=-1,ke=-1;for(S=1;S<Fe.length;++S)switch(Fe[S].charAt(0)){case"A":case"G":break;case"X":k=parseInt(Fe[S].slice(1))-1,Qe=!0;break;case"Y":for(x=parseInt(Fe[S].slice(1))-1,Qe||(k=0),de=w.length;de<=x;++de)w[de]=[];break;case"K":'"'===(De=Fe[S].slice(1)).charAt(0)?De=De.slice(1,De.length-1):"TRUE"===De?De=!0:"FALSE"===De?De=!1:isNaN(Xr(De))?isNaN(Xo(De).getDate())||(De=ln(De)):(De=Xr(De),null!==K&&xn(K)&&(De=jl(De))),typeof Nt<"u"&&"string"==typeof De&&"string"!=(C||{}).type&&(C||{}).codepage&&(De=Nt.utils.decode(C.codepage,De)),ct=!0;break;case"E":$e=!0;var U=ea(Fe[S].slice(1),{r:x,c:k});w[x][k]=[w[x][k],U];break;case"S":St=!0,w[x][k]=[w[x][k],"S5S"];break;case"R":ft=parseInt(Fe[S].slice(1))-1;break;case"C":ke=parseInt(Fe[S].slice(1))-1;break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+Z)}if(ct&&(w[x][k]&&2==w[x][k].length?w[x][k][0]=De:w[x][k]=De,K=null),St){if($e)throw new Error("SYLK shared formula cannot have own formula");var se=ft>-1&&w[ft][ke];if(!se||!se[1])throw new Error("SYLK shared formula cannot find base");w[x][k][1]=qg(se[1],{r:x-ft,c:k-ke})}break;case"F":var Y=0;for(S=1;S<Fe.length;++S)switch(Fe[S].charAt(0)){case"X":k=parseInt(Fe[S].slice(1))-1,++Y;break;case"Y":for(x=parseInt(Fe[S].slice(1))-1,de=w.length;de<=x;++de)w[de]=[];break;case"M":le=parseInt(Fe[S].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":K=W[parseInt(Fe[S].slice(1))];break;case"W":for(q=Fe[S].slice(1).split(" "),de=parseInt(q[0],10);de<=parseInt(q[1],10);++de)le=parseInt(q[2],10),Q[de-1]=0===le?{hidden:!0}:{wch:le},Wi(Q[de-1]);break;case"C":Q[k=parseInt(Fe[S].slice(1))-1]||(Q[k]={});break;case"R":A[x=parseInt(Fe[S].slice(1))-1]||(A[x]={}),le>0?(A[x].hpt=le,A[x].hpx=Oc(le)):0===le&&(A[x].hidden=!0);break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+Z)}Y<1&&(K=null);break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+Z)}}return A.length>0&&(ee["!rows"]=A),Q.length>0&&(ee["!cols"]=Q),C&&C.sheetRows&&(w=w.slice(0,C.sheetRows)),[w,ee]}function s(_,C){var P=function i(_,C){switch(C.type){case"base64":return a(tr(_),C);case"binary":return a(_,C);case"buffer":return a(dt&&Buffer.isBuffer(_)?_.toString("binary"):Pr(_),C);case"array":return a(_o(_),C)}throw new Error("Unrecognized type "+C.type)}(_,C),k=P[1],F=qo(P[0],C);return gn(k).forEach(function(S){F[S]=k[S]}),F}function u(_,C,P,x){var k="C;Y"+(P+1)+";X"+(x+1)+";K";switch(_.t){case"n":k+=_.v||0,_.f&&!_.F&&(k+=";E"+kd(_.f,{r:P,c:x}));break;case"b":k+=_.v?"TRUE":"FALSE";break;case"e":k+=_.w||_.v;break;case"d":k+='"'+(_.w||_.v)+'"';break;case"s":k+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return k}return n["|"]=254,{to_workbook:function l(_,C){return Xi(s(_,C),C)},to_sheet:s,from_sheet:function h(_,C){var F,P=["ID;PWXL;N;E"],x=[],k=Dt(_["!ref"]),S=Array.isArray(_),w="\r\n";P.push("P;PGeneral"),P.push("F;P0;DG0G8;M255"),_["!cols"]&&function p(_,C){C.forEach(function(P,x){var k="F;W"+(x+1)+" "+(x+1)+" ";P.hidden?k+="0":("number"==typeof P.width&&!P.wpx&&(P.wpx=Va(P.width)),"number"==typeof P.wpx&&!P.wch&&(P.wch=Ya(P.wpx)),"number"==typeof P.wch&&(k+=Math.round(P.wch)))," "!=k.charAt(k.length-1)&&_.push(k)})}(P,_["!cols"]),_["!rows"]&&function f(_,C){C.forEach(function(P,x){var k="F;";P.hidden?k+="M0;":P.hpt?k+="M"+20*P.hpt+";":P.hpx&&(k+="M"+20*Xa(P.hpx)+";"),k.length>2&&_.push(k+"R"+(x+1))})}(P,_["!rows"]),P.push("B;Y"+(k.e.r-k.s.r+1)+";X"+(k.e.c-k.s.c+1)+";D"+[k.s.c,k.s.r,k.e.c,k.e.r].join(" "));for(var W=k.s.r;W<=k.e.r;++W)for(var K=k.s.c;K<=k.e.c;++K){var ee=pt({r:W,c:K});(F=S?(_[W]||[])[K]:_[ee])&&(null!=F.v||F.f&&!F.F)&&x.push(u(F,0,W,K))}return P.join(w)+w+x.join(w)+w+"E"+w}}}(),Eg=function(){function o(a,s){for(var l=a.split("\n"),u=-1,p=-1,f=0,h=[];f!==l.length;++f)if("BOT"!==l[f].trim()){if(!(u<0)){for(var _=l[f].trim().split(","),C=_[0],P=_[1],x=l[++f]||"";1&(x.match(/["]/g)||[]).length&&f<l.length-1;)x+="\n"+l[++f];switch(x=x.trim(),+C){case-1:if("BOT"===x){h[++u]=[],p=0;continue}if("EOD"!==x)throw new Error("Unrecognized DIF special command "+x);break;case 0:h[u][p]="TRUE"===x||"FALSE"!==x&&(isNaN(Xr(P))?isNaN(Xo(P).getDate())?P:ln(P):Xr(P)),++p;break;case 1:(x=(x=x.slice(1,x.length-1)).replace(/""/g,'"'))&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),h[u][p++]=""!==x?x:null}if("EOD"===x)break}}else h[++u]=[],p=0;return s&&s.sheetRows&&(h=h.slice(0,s.sheetRows)),h}function t(a,s){return qo(function n(a,s){switch(s.type){case"base64":return o(tr(a),s);case"binary":return o(a,s);case"buffer":return o(dt&&Buffer.isBuffer(a)?a.toString("binary"):Pr(a),s);case"array":return o(_o(a),s)}throw new Error("Unrecognized type "+s.type)}(a,s),s)}return{to_workbook:function r(a,s){return Xi(t(a,s),s)},to_sheet:t,from_sheet:function(){var a=function(u,p,f,h,_){u.push(p),u.push(f+","+h),u.push('"'+_.replace(/"/g,'""')+'"')},s=function(u,p,f,h){u.push(p+","+f),u.push(1==p?'"'+h.replace(/"/g,'""')+'"':h)};return function(u){var h,p=[],f=Dt(u["!ref"]),_=Array.isArray(u);a(p,"TABLE",0,1,"sheetjs"),a(p,"VECTORS",0,f.e.r-f.s.r+1,""),a(p,"TUPLES",0,f.e.c-f.s.c+1,""),a(p,"DATA",0,0,"");for(var C=f.s.r;C<=f.e.r;++C){s(p,-1,0,"BOT");for(var P=f.s.c;P<=f.e.c;++P){var x=pt({r:C,c:P});if(h=_?(u[C]||[])[P]:u[x])switch(h.t){case"n":var k=h.w;!k&&null!=h.v&&(k=h.v),null==k?s(p,1,0,h.f&&!h.F?"="+h.f:""):s(p,0,k,"V");break;case"b":s(p,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":s(p,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Un(h.z||tt[14],An(ln(h.v)))),s(p,0,h.w,"V");break;default:s(p,1,0,"")}else s(p,1,0,"")}}return s(p,-1,0,"EOD"),p.join("\r\n")}}()}}(),Sg=function(){function n(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function o(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,_){return qo(function t(h,_){for(var C=h.split("\n"),P=-1,x=-1,k=0,F=[];k!==C.length;++k){var S=C[k].trim().split(":");if("cell"===S[0]){var w=Cn(S[1]);if(F.length<=w.r)for(P=F.length;P<=w.r;++P)F[P]||(F[P]=[]);switch(P=w.r,x=w.c,S[2]){case"t":F[P][x]=n(S[3]);break;case"v":F[P][x]=+S[3];break;case"vtf":var W=S[S.length-1];case"vtc":F[P][x]="nl"===S[3]?!!+S[4]:+S[4],"vtf"==S[2]&&(F[P][x]=[F[P][x],W])}}}return _&&_.sheetRows&&(F=F.slice(0,_.sheetRows)),F}(h,_),_)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),u="--SocialCalcSpreadsheetControlSave--";function p(h){if(!h||!h["!ref"])return"";for(var P,_=[],C=[],x="",k=ir(h["!ref"]),F=Array.isArray(h),S=k.s.r;S<=k.e.r;++S)for(var w=k.s.c;w<=k.e.c;++w)if(x=pt({r:S,c:w}),(P=F?(h[S]||[])[w]:h[x])&&null!=P.v&&"z"!==P.t){switch(C=["cell",x,"t"],P.t){case"s":case"str":C.push(o(P.v));break;case"n":P.f?(C[2]="vtf",C[3]="n",C[4]=P.v,C[5]=o(P.f)):(C[2]="v",C[3]=P.v);break;case"b":C[2]="vt"+(P.f?"f":"c"),C[3]="nl",C[4]=P.v?"1":"0",C[5]=o(P.f||(P.v?"TRUE":"FALSE"));break;case"d":var W=An(ln(P.v));C[2]="vtc",C[3]="nd",C[4]=""+W,C[5]=P.w||Un(P.z||tt[14],W);break;case"e":continue}_.push(C.join(":"))}return _.push("sheet:c:"+(k.e.c-k.s.c+1)+":r:"+(k.e.r-k.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join("\n")}return{to_workbook:function i(h,_){return Xi(r(h,_),_)},to_sheet:r,from_sheet:function f(h){return[a,s,l,s,p(h),u].join("\n")}}}(),Jo=function(){function n(f,h,_,C,P){P.raw?h[_][C]=f:""===f||(h[_][C]="TRUE"===f||"FALSE"!==f&&(isNaN(Xr(f))?isNaN(Xo(f).getDate())?f:ln(f):Xr(f)))}var t={44:",",9:"\t",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(f){for(var h={},_=!1,C=0,P=0;C<f.length;++C)34==(P=f.charCodeAt(C))?_=!_:!_&&P in t&&(h[P]=(h[P]||0)+1);for(C in P=[],h)Object.prototype.hasOwnProperty.call(h,C)&&P.push([h[C],C]);if(!P.length)for(C in h=r)Object.prototype.hasOwnProperty.call(h,C)&&P.push([h[C],C]);return P.sort(function(x,k){return x[0]-k[0]||r[x[1]]-r[k[1]]}),t[P.pop()[1]]||44}function s(f,h){return!h||!h.PRN||h.FS||"sep="==f.slice(0,4)||f.indexOf("\t")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?function a(f,h){var _=h||{},C="";null!=on&&null==_.dense&&(_.dense=on);var P=_.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};"sep="==f.slice(0,4)?13==f.charCodeAt(5)&&10==f.charCodeAt(6)?(C=f.charAt(4),f=f.slice(7)):13==f.charCodeAt(5)||10==f.charCodeAt(5)?(C=f.charAt(4),f=f.slice(6)):C=i(f.slice(0,1024)):C=_&&_.FS?_.FS:i(f.slice(0,1024));var k=0,F=0,S=0,w=0,W=0,K=C.charCodeAt(0),ee=!1,A=0,Q=f.charCodeAt(0);f=f.replace(/\r\n/gm,"\n");var q=null!=_.dateNF?function Dl(n){var o="number"==typeof n?tt[n]:n;return o=o.replace(ic,"(\\d+)"),new RegExp("^"+o+"$")}(_.dateNF):null;function le(){var de=f.slice(w,W),Z={};if('"'==de.charAt(0)&&'"'==de.charAt(de.length-1)&&(de=de.slice(1,-1).replace(/""/g,'"')),0===de.length)Z.t="z";else if(_.raw)Z.t="s",Z.v=de;else if(0===de.trim().length)Z.t="s",Z.v=de;else if(61==de.charCodeAt(0))34==de.charCodeAt(1)&&34==de.charCodeAt(de.length-1)?(Z.t="s",Z.v=de.slice(2,-1).replace(/""/g,'"')):function D_(n){return 1!=n.length}(de)?(Z.t="n",Z.f=de.slice(1)):(Z.t="s",Z.v=de);else if("TRUE"==de)Z.t="b",Z.v=!0;else if("FALSE"==de)Z.t="b",Z.v=!1;else if(isNaN(S=Xr(de)))if(!isNaN(Xo(de).getDate())||q&&de.match(q)){Z.z=_.dateNF||tt[14];var Fe=0;q&&de.match(q)&&(de=function Ta(n,o,t){var r=-1,i=-1,a=-1,s=-1,l=-1,u=-1;(o.match(ic)||[]).forEach(function(h,_){var C=parseInt(t[_+1],10);switch(h.toLowerCase().charAt(0)){case"y":r=C;break;case"d":a=C;break;case"h":s=C;break;case"s":u=C;break;case"m":s>=0?l=C:i=C}}),u>=0&&-1==l&&i>=0&&(l=i,i=-1);var p=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);7==p.length&&(p="0"+p),8==p.length&&(p="20"+p);var f=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return-1==s&&-1==l&&-1==u?p:-1==r&&-1==i&&-1==a?f:p+"T"+f}(0,_.dateNF,de.match(q)||[]),Fe=1),_.cellDates?(Z.t="d",Z.v=ln(de,Fe)):(Z.t="n",Z.v=An(ln(de,Fe))),!1!==_.cellText&&(Z.w=Un(Z.z,Z.v instanceof Date?An(Z.v):Z.v)),_.cellNF||delete Z.z}else Z.t="s",Z.v=de;else Z.t="n",!1!==_.cellText&&(Z.w=de),Z.v=S;if("z"==Z.t||(_.dense?(P[k]||(P[k]=[]),P[k][F]=Z):P[pt({c:F,r:k})]=Z),Q=f.charCodeAt(w=W+1),x.e.c<F&&(x.e.c=F),x.e.r<k&&(x.e.r=k),A==K)++F;else if(F=0,++k,_.sheetRows&&_.sheetRows<=k)return!0}e:for(;W<f.length;++W)switch(A=f.charCodeAt(W)){case 34:34===Q&&(ee=!ee);break;case K:case 10:case 13:if(!ee&&le())break e}return W-w>0&&le(),P["!ref"]=bt(x),P}(f,h):qo(function o(f,h){var _=h||{},C=[];if(!f||0===f.length)return C;for(var P=f.split(/[\r\n]/),x=P.length-1;x>=0&&0===P[x].length;)--x;for(var k=10,F=0,S=0;S<=x;++S)-1==(F=P[S].indexOf(" "))?F=P[S].length:F++,k=Math.max(k,F);for(S=0;S<=x;++S){C[S]=[];var w=0;for(n(P[S].slice(0,k).trim(),C,S,w,_),w=1;w<=(P[S].length-k)/10+1;++w)n(P[S].slice(k+10*(w-1),k+10*w).trim(),C,S,w,_)}return _.sheetRows&&(C=C.slice(0,_.sheetRows)),C}(f,h),h)}function l(f,h){var _="",C="string"==h.type?[0,0,0,0]:function $d(n,o){var t="";switch((o||{}).type||"base64"){case"buffer":case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=tr(n.slice(0,12));break;case"binary":t=n;break;default:throw new Error("Unrecognized type "+(o&&o.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}(f,h);switch(h.type){case"base64":_=tr(f);break;case"binary":case"string":_=f;break;case"buffer":_=65001==h.codepage?f.toString("utf8"):h.codepage&&typeof Nt<"u"?Nt.utils.decode(h.codepage,f):dt&&Buffer.isBuffer(f)?f.toString("binary"):Pr(f);break;case"array":_=_o(f);break;default:throw new Error("Unrecognized type "+h.type)}return 239==C[0]&&187==C[1]&&191==C[2]?_=tn(_.slice(3)):"string"!=h.type&&"buffer"!=h.type&&65001==h.codepage?_=tn(_):"binary"==h.type&&typeof Nt<"u"&&h.codepage&&(_=Nt.utils.decode(h.codepage,Nt.utils.encode(28591,_))),"socialcalc:version:"==_.slice(0,19)?Sg.to_sheet("string"==h.type?_:tn(_),h):s(_,h)}return{to_workbook:function u(f,h){return Xi(l(f,h),h)},to_sheet:l,from_sheet:function p(f){for(var C,h=[],_=Dt(f["!ref"]),P=Array.isArray(f),x=_.s.r;x<=_.e.r;++x){for(var k=[],F=_.s.c;F<=_.e.c;++F){var S=pt({r:x,c:F});if((C=P?(f[x]||[])[F]:f[S])&&null!=C.v){for(var w=(C.w||(ri(C),C.w)||"").slice(0,10);w.length<10;)w+=" ";k.push(w+(0===F?" ":""))}else k.push("          ")}h.push(k.join(""))}return h.join("\n")}}}(),Eo=function(){function n(U,se,Y){if(U){Gn(U,U.l||0);for(var V=Y.Enum||ft;U.l<U.length;){var he=U.read_shift(2),Be=V[he]||V[65535],Se=U.read_shift(2),Te=U.l+Se,ve=Be.f&&Be.f(U,Se,Y);if(U.l=Te,se(ve,Be,he))return}}}function t(U,se){if(!U)return U;var Y=se||{};null!=on&&null==Y.dense&&(Y.dense=on);var V=Y.dense?[]:{},he="Sheet1",Be="",Se=0,Te={},ve=[],yt=[],G={s:{r:0,c:0},e:{r:0,c:0}},Ht=Y.sheetRows||0;if(0==U[2]&&(8==U[3]||9==U[3])&&U.length>=16&&5==U[14]&&108===U[15])throw new Error("Unsupported Works 3 for Mac file");if(2==U[2])Y.Enum=ft,n(U,function(Le,Pn,Br){switch(Br){case 0:Y.vers=Le,Le>=4096&&(Y.qpro=!0);break;case 6:G=Le;break;case 204:Le&&(Be=Le);break;case 222:Be=Le;break;case 15:case 51:Y.qpro||(Le[1].v=Le[1].v.slice(1));case 13:case 14:case 16:14==Br&&112==(112&Le[2])&&(15&Le[2])>1&&(15&Le[2])<15&&(Le[1].z=Y.dateNF||tt[14],Y.cellDates&&(Le[1].t="d",Le[1].v=jl(Le[1].v))),Y.qpro&&Le[3]>Se&&(V["!ref"]=bt(G),Te[he]=V,ve.push(he),V=Y.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},Se=Le[3],he=Be||"Sheet"+(Se+1),Be="");var si=Y.dense?(V[Le[0].r]||[])[Le[0].c]:V[pt(Le[0])];if(si){si.t=Le[1].t,si.v=Le[1].v,null!=Le[1].z&&(si.z=Le[1].z),null!=Le[1].f&&(si.f=Le[1].f);break}Y.dense?(V[Le[0].r]||(V[Le[0].r]=[]),V[Le[0].r][Le[0].c]=Le[1]):V[pt(Le[0])]=Le[1]}},Y);else{if(26!=U[2]&&14!=U[2])throw new Error("Unrecognized LOTUS BOF "+U[2]);Y.Enum=ke,14==U[2]&&(Y.qpro=!0,U.l=0),n(U,function(Le,Pn,Br){switch(Br){case 204:he=Le;break;case 22:Le[1].v=Le[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Le[3]>Se&&(V["!ref"]=bt(G),Te[he]=V,ve.push(he),V=Y.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},he="Sheet"+((Se=Le[3])+1)),Ht>0&&Le[0].r>=Ht)break;Y.dense?(V[Le[0].r]||(V[Le[0].r]=[]),V[Le[0].r][Le[0].c]=Le[1]):V[pt(Le[0])]=Le[1],G.e.c<Le[0].c&&(G.e.c=Le[0].c),G.e.r<Le[0].r&&(G.e.r=Le[0].r);break;case 27:Le[14e3]&&(yt[Le[14e3][0]]=Le[14e3][1]);break;case 1537:yt[Le[0]]=Le[1],Le[0]==Se&&(he=Le[1])}},Y)}if(V["!ref"]=bt(G),Te[Be||he]=V,ve.push(Be||he),!yt.length)return{SheetNames:ve,Sheets:Te};for(var Tt={},Wt=[],It=0;It<yt.length;++It)Te[ve[It]]?(Wt.push(yt[It]||ve[It]),Tt[yt[It]]=Te[yt[It]]||Te[ve[It]]):(Wt.push(yt[It]),Tt[yt[It]]={"!ref":"A1"});return{SheetNames:Wt,Sheets:Tt}}function p(U,se,Y){var V=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&20768!=Y.vers?(V[0].c=U.read_shift(1),V[3]=U.read_shift(1),V[0].r=U.read_shift(2),U.l+=2):(V[2]=U.read_shift(1),V[0].c=U.read_shift(2),V[0].r=U.read_shift(2)),V}function f(U,se,Y){var V=U.l+se,he=p(U,0,Y);if(he[1].t="s",20768==Y.vers){U.l++;var Be=U.read_shift(1);return he[1].v=U.read_shift(Be,"utf8"),he}return Y.qpro&&U.l++,he[1].v=U.read_shift(V-U.l,"cstr"),he}function h(U,se,Y){var V=ue(7+Y.length);V.write_shift(1,255),V.write_shift(2,se),V.write_shift(2,U),V.write_shift(1,39);for(var he=0;he<V.length;++he){var Be=Y.charCodeAt(he);V.write_shift(1,Be>=128?95:Be)}return V.write_shift(1,0),V}function C(U,se,Y){var V=ue(7);return V.write_shift(1,255),V.write_shift(2,se),V.write_shift(2,U),V.write_shift(2,Y,"i"),V}function x(U,se,Y){var V=ue(13);return V.write_shift(1,255),V.write_shift(2,se),V.write_shift(2,U),V.write_shift(8,Y,"f"),V}function F(U,se,Y){var V=32768&se;return se=(V?U:0)+((se&=-32769)>=8192?se-16384:se),(V?"":"$")+(Y?nn(se):mn(se))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function K(U){var se=[{c:0,r:0},{t:"n",v:0},0];return se[0].r=U.read_shift(2),se[3]=U[U.l++],se[0].c=U[U.l++],se}function A(U,se,Y,V){var he=ue(6+V.length);he.write_shift(2,U),he.write_shift(1,Y),he.write_shift(1,se),he.write_shift(1,39);for(var Be=0;Be<V.length;++Be){var Se=V.charCodeAt(Be);he.write_shift(1,Se>=128?95:Se)}return he.write_shift(1,0),he}function q(U,se){var Y=K(U),V=U.read_shift(4),he=U.read_shift(4),Be=U.read_shift(2);if(65535==Be)return 0===V&&3221225472===he?(Y[1].t="e",Y[1].v=15):0===V&&3489660928===he?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var Se=32768&Be;return Be=(32767&Be)-16446,Y[1].v=(1-2*Se)*(he*Math.pow(2,Be+32)+V*Math.pow(2,Be)),Y}function le(U,se,Y,V){var he=ue(14);if(he.write_shift(2,U),he.write_shift(1,Y),he.write_shift(1,se),0==V)return he.write_shift(4,0),he.write_shift(4,0),he.write_shift(2,65535),he;var Be=0,Se=0,ve=0;return V<0&&(Be=1,V=-V),Se=0|Math.log2(V),2147483648&(ve=(V/=Math.pow(2,Se-31))>>>0)||(++Se,ve=(V/=2)>>>0),V-=ve,ve|=2147483648,ve>>>=0,V*=Math.pow(2,32),he.write_shift(4,V>>>0),he.write_shift(4,ve),he.write_shift(2,Se+=16383+(Be?32768:0)),he}function Fe(U,se){var Y=K(U),V=U.read_shift(8,"f");return Y[1].v=V,Y}function De(U,se){return 0==U[U.l+se-1]?U.read_shift(se,"cstr"):""}function $e(U,se){var Y=ue(5+U.length);Y.write_shift(2,14e3),Y.write_shift(2,se);for(var V=0;V<U.length;++V){var he=U.charCodeAt(V);Y[Y.l++]=he>127?95:he}return Y[Y.l++]=0,Y}var ft={0:{n:"BOF",f:Mn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function l(U,se,Y){var V={s:{c:0,r:0},e:{c:0,r:0}};return 8==se&&Y.qpro?(V.s.c=U.read_shift(1),U.l++,V.s.r=U.read_shift(2),V.e.c=U.read_shift(1),U.l++,V.e.r=U.read_shift(2),V):(V.s.c=U.read_shift(2),V.s.r=U.read_shift(2),12==se&&Y.qpro&&(U.l+=2),V.e.c=U.read_shift(2),V.e.r=U.read_shift(2),12==se&&Y.qpro&&(U.l+=2),65535==V.s.c&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function _(U,se,Y){var V=p(U,0,Y);return V[1].v=U.read_shift(2,"i"),V}},14:{n:"NUMBER",f:function P(U,se,Y){var V=p(U,0,Y);return V[1].v=U.read_shift(8,"f"),V}},15:{n:"LABEL",f},16:{n:"FORMULA",f:function k(U,se,Y){var V=U.l+se,he=p(U,0,Y);if(he[1].v=U.read_shift(8,"f"),Y.qpro)U.l=V;else{var Be=U.read_shift(2);(function W(U,se){Gn(U,0);for(var Y=[],V=0,he="",Be="",Se="",Te="";U.l<U.length;){var ve=U[U.l++];switch(ve){case 0:Y.push(U.read_shift(8,"f"));break;case 1:Be=F(se[0].c,U.read_shift(2),!0),he=F(se[0].r,U.read_shift(2),!1),Y.push(Be+he);break;case 2:var yt=F(se[0].c,U.read_shift(2),!0),G=F(se[0].r,U.read_shift(2),!1);Be=F(se[0].c,U.read_shift(2),!0),he=F(se[0].r,U.read_shift(2),!1),Y.push(yt+G+":"+Be+he);break;case 3:if(U.l<U.length)return void console.error("WK1 premature formula end");break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(U.read_shift(2));break;case 6:for(var Ht="";ve=U[U.l++];)Ht+=String.fromCharCode(ve);Y.push('"'+Ht.replace(/"/g,'""')+'"');break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:Te=Y.pop(),Se=Y.pop(),Y.push(["AND","OR"][ve-20]+"("+Se+","+Te+")");break;default:if(ve<32&&w[ve])Te=Y.pop(),Se=Y.pop(),Y.push(Se+w[ve]+Te);else{if(!S[ve])return ve<=7?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=24?console.error("WK1 unsupported op "+ve.toString(16)):ve<=30?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=115?console.error("WK1 unsupported function opcode "+ve.toString(16)):console.error("WK1 unrecognized opcode "+ve.toString(16));if(69==(V=S[ve][1])&&(V=U[U.l++]),V>Y.length)return void console.error("WK1 bad formula parse 0x"+ve.toString(16)+":|"+Y.join("|")+"|");var Tt=Y.slice(-V);Y.length-=V,Y.push(S[ve][0]+"("+Tt.join(",")+")")}}}1==Y.length?se[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")})(U.slice(U.l,U.l+Be),he),U.l+=Be}return he}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:De},222:{n:"SHEETNAMELP",f:function ct(U,se){var Y=U[U.l++];Y>se-1&&(Y=se-1);for(var V="";V.length<Y;)V+=String.fromCharCode(U[U.l++]);return V}},65535:{n:""}},ke={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function ee(U,se){var Y=K(U);return Y[1].t="s",Y[1].v=U.read_shift(se-4,"cstr"),Y}},23:{n:"NUMBER17",f:q},24:{n:"NUMBER18",f:function Q(U,se){var Y=K(U);Y[1].v=U.read_shift(2);var V=Y[1].v>>1;if(1&Y[1].v)switch(7&V){case 0:V=5e3*(V>>3);break;case 1:V=500*(V>>3);break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64}return Y[1].v=V,Y}},25:{n:"FORMULA19",f:function de(U,se){var Y=q(U);return U.l+=se-14,Y}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function St(U,se){for(var Y={},V=U.l+se;U.l<V;){var he=U.read_shift(2);if(14e3==he){for(Y[he]=[0,""],Y[he][0]=U.read_shift(2);U[U.l];)Y[he][1]+=String.fromCharCode(U[U.l]),U.l++;U.l++}}return Y}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function Z(U,se){var Y=K(U),V=U.read_shift(4);return Y[1].v=V>>6,Y}},38:{n:"??"},39:{n:"NUMBER27",f:Fe},40:{n:"FORMULA28",f:function Ye(U,se){var Y=Fe(U);return U.l+=se-10,Y}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:De},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function Qe(U,se,Y){if(Y.qpro&&!(se<21)){var V=U.read_shift(1);return U.l+=17,U.l+=1,U.l+=2,[V,U.read_shift(se-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function r(U,se){var Y=se||{};if(+Y.codepage>=0&&Tn(+Y.codepage),"string"==Y.type)throw new Error("Cannot write WK1 to JS string");var V=rr(),he=Dt(U["!ref"]),Be=Array.isArray(U),Se=[];Ie(V,0,function a(U){var se=ue(2);return se.write_shift(2,U),se}(1030)),Ie(V,6,function u(U){var se=ue(8);return se.write_shift(2,U.s.c),se.write_shift(2,U.s.r),se.write_shift(2,U.e.c),se.write_shift(2,U.e.r),se}(he));for(var Te=Math.min(he.e.r,8191),ve=he.s.r;ve<=Te;++ve)for(var yt=mn(ve),G=he.s.c;G<=he.e.c;++G){ve===he.s.r&&(Se[G]=nn(G));var Tt=Be?(U[ve]||[])[G]:U[Se[G]+yt];Tt&&"z"!=Tt.t&&("n"==Tt.t?(0|Tt.v)==Tt.v&&Tt.v>=-32768&&Tt.v<=32767?Ie(V,13,C(ve,G,Tt.v)):Ie(V,14,x(ve,G,Tt.v)):Ie(V,15,h(ve,G,ri(Tt).slice(0,239))))}return Ie(V,1),V.end()},book_to_wk3:function i(U,se){var Y=se||{};if(+Y.codepage>=0&&Tn(+Y.codepage),"string"==Y.type)throw new Error("Cannot write WK3 to JS string");var V=rr();Ie(V,0,function s(U){var se=ue(26);se.write_shift(2,4096),se.write_shift(2,4),se.write_shift(4,0);for(var Y=0,V=0,he=0,Be=0;Be<U.SheetNames.length;++Be){var Te=U.Sheets[U.SheetNames[Be]];if(Te&&Te["!ref"]){++he;var ve=ir(Te["!ref"]);Y<ve.e.r&&(Y=ve.e.r),V<ve.e.c&&(V=ve.e.c)}}return Y>8191&&(Y=8191),se.write_shift(2,Y),se.write_shift(1,he),se.write_shift(1,V),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(1,1),se.write_shift(1,2),se.write_shift(4,0),se.write_shift(4,0),se}(U));for(var he=0,Be=0;he<U.SheetNames.length;++he)(U.Sheets[U.SheetNames[he]]||{})["!ref"]&&Ie(V,27,$e(U.SheetNames[he],Be++));var Se=0;for(he=0;he<U.SheetNames.length;++he){var Te=U.Sheets[U.SheetNames[he]];if(Te&&Te["!ref"]){for(var ve=Dt(Te["!ref"]),yt=Array.isArray(Te),G=[],Ht=Math.min(ve.e.r,8191),Tt=ve.s.r;Tt<=Ht;++Tt)for(var Wt=mn(Tt),It=ve.s.c;It<=ve.e.c;++It){Tt===ve.s.r&&(G[It]=nn(It));var Pn=yt?(Te[Tt]||[])[It]:Te[G[It]+Wt];Pn&&"z"!=Pn.t&&("n"==Pn.t?Ie(V,23,le(Tt,It,Se,Pn.v)):Ie(V,22,A(Tt,It,Se,ri(Pn).slice(0,239))))}++Se}}return Ie(V,1),V.end()},to_workbook:function o(U,se){switch(se.type){case"base64":return t(Rn(tr(U)),se);case"binary":return t(Rn(U),se);case"buffer":case"array":return t(U,se)}throw"Unsupported type "+se.type}}}(),Lh=/^\s|\s$|[\t\n\r]/;function Ig(n,o){if(!o.bookSST)return"";var t=[fn];t[t.length]=we("sst",null,{xmlns:Yi[0],count:n.Count,uniqueCount:n.Unique});for(var r=0;r!=n.length;++r)if(null!=n[r]){var i=n[r],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),i.t.match(Lh)&&(a+=' xml:space="preserve"'),a+=">"+Xt(i.t)+"</t>"),t[t.length]=a+="</si>"}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}var zh=function J0(n,o){var t=!1;return null==o&&(t=!0,o=ue(15+4*n.t.length)),o.write_shift(1,0),jn(n.t,o),t?o.slice(0,o.l):o};function Vh(n){var o=rr();xe(o,159,function Uh(n,o){return o||(o=ue(8)),o.write_shift(4,n.Count),o.write_shift(4,n.Unique),o}(n));for(var t=0;t<n.length;++t)xe(o,19,zh(n[t]));return xe(o,160),o.end()}function _d(n){var t,a,o=0,r=function Rg(n){if(typeof Nt<"u")return Nt.utils.encode(Sn,n);for(var o=[],t=n.split(""),r=0;r<t.length;++r)o[r]=t[r].charCodeAt(0);return o}(n),i=r.length+1;for((t=Ur(i))[0]=r.length,a=1;a!=i;++a)t[a]=r[a-1];for(a=i-1;a>=0;--a)o=((16384&o?1:0)|o<<1&32767)^t[a];return 52811^o}var jg=function(){function n(i,a){switch(a.type){case"base64":return o(tr(i),a);case"binary":return o(i,a);case"buffer":return o(dt&&Buffer.isBuffer(i)?i.toString("binary"):Pr(i),a);case"array":return o(_o(i),a)}throw new Error("Unrecognized type "+a.type)}function o(i,a){var l=(a||{}).dense?[]:{},u=i.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var p={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(f,h){Array.isArray(l)&&(l[h]=[]);for(var P,_=/\\\w+\b/g,C=0,x=-1;P=_.exec(f);){if("\\cell"===P[0]){var k=f.slice(C,_.lastIndex-P[0].length);if(" "==k[0]&&(k=k.slice(1)),++x,k.length){var F={v:k,t:"s"};Array.isArray(l)?l[h][x]=F:l[pt({r:h,c:x})]=F}}C=_.lastIndex}x>p.e.c&&(p.e.c=x)}),l["!ref"]=bt(p),l}return{to_workbook:function t(i,a){return Xi(n(i,a),a)},to_sheet:n,from_sheet:function r(i){for(var l,a=["{\\rtf1\\ansi"],s=Dt(i["!ref"]),u=Array.isArray(i),p=s.s.r;p<=s.e.r;++p){a.push("\\trowd\\trautofit1");for(var f=s.s.c;f<=s.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=s.s.c;f<=s.e.c;++f){var h=pt({r:p,c:f});(l=u?(i[p]||[])[f]:i[h])&&(null!=l.v||l.f&&!l.F)&&(a.push(" "+(l.w||(ri(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}}}();function za(n){for(var o=0,t=1;3!=o;++o)t=256*t+(n[o]>255?255:n[o]<0?0:n[o]);return t.toString(16).toUpperCase().slice(1)}var Wn=6;function Va(n){return Math.floor((n+Math.round(128/Wn)/256)*Wn)}function Ya(n){return Math.floor((n-5)/Wn*100+.5)/100}function kc(n){return Math.round((n*Wn+5)/Wn*256)/256}function Wi(n){n.width?(n.wpx=Va(n.width),n.wch=Ya(n.wpx),n.MDW=Wn):n.wpx?(n.wch=Ya(n.wpx),n.width=kc(n.wch),n.MDW=Wn):"number"==typeof n.wch&&(n.width=kc(n.wch),n.wpx=Va(n.width),n.MDW=Wn),n.customWidth&&delete n.customWidth}var Lg=96;function Xa(n){return 96*n/Lg}function Oc(n){return n*Lg/96}function $g(n,o){var r,t=[fn,we("styleSheet",null,{xmlns:Yi[0],"xmlns:vt":yn.vt})];return n.SSF&&null!=(r=function m1(n){var o=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)null!=n[r]&&(o[o.length]=we("numFmt",null,{numFmtId:r,formatCode:Xt(n[r])}))}),1===o.length?"":(o[o.length]="</numFmts>",o[0]=we("numFmts",null,{count:o.length-2}).replace("/>",">"),o.join(""))}(n.SSF))&&(t[t.length]=r),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=function h1(n){var o=[];return o[o.length]=we("cellXfs",null),n.forEach(function(t){o[o.length]=we("xf",null,t)}),o[o.length]="</cellXfs>",2===o.length?"":(o[0]=we("cellXfs",null,{count:o.length-2}).replace("/>",">"),o.join(""))}(o.cellXfs))&&(t[t.length]=r),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function C1(n,o,t){t||(t=ue(6+4*o.length)),t.write_shift(2,n),jn(o,t);var r=t.length>t.l?t.slice(0,t.l):t;return null==t.l&&(t.l=t.length),r}var vd,b1=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],k1=Vn;function Gg(n,o){o||(o=ue(84)),vd||(vd=ac(b1));var t=vd[n.patternType];null==t&&(t=40),o.write_shift(4,t);var r=0;if(40!=t)for(pc({auto:1},o),pc({auto:1},o);r<12;++r)o.write_shift(4,0);else{for(;r<4;++r)o.write_shift(4,0);for(;r<12;++r)o.write_shift(4,0)}return o.length>o.l?o.slice(0,o.l):o}function Ug(n,o,t){return t||(t=ue(16)),t.write_shift(2,o||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Ha(n,o){return o||(o=ue(10)),o.write_shift(1,0),o.write_shift(1,0),o.write_shift(4,0),o.write_shift(4,0),o}var y1=Vn;function L1(n,o){var t=rr();return xe(t,278),function S1(n,o){if(o){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)null!=o[i]&&++t}),0!=t&&(xe(n,615,Hr(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)null!=o[i]&&xe(n,44,C1(i,o[i]))}),xe(n,616))}}(t,n.SSF),function T1(n){xe(n,611,Hr(1)),xe(n,43,function P1(n,o){o||(o=ue(153)),o.write_shift(2,20*n.sz),function sf(n,o){o||(o=ue(2)),o.write_shift(1,(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0)),o.write_shift(1,0)}(n,o),o.write_shift(2,n.bold?700:400);var t=0;"superscript"==n.vertAlign?t=1:"subscript"==n.vertAlign&&(t=2),o.write_shift(2,t),o.write_shift(1,n.underline||0),o.write_shift(1,n.family||0),o.write_shift(1,n.charset||0),o.write_shift(1,0),pc(n.color,o);var r=0;return"major"==n.scheme&&(r=1),"minor"==n.scheme&&(r=2),o.write_shift(1,r),jn(n.name,o),o.length>o.l?o.slice(0,o.l):o}({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),xe(n,612)}(t),function I1(n){xe(n,603,Hr(2)),xe(n,45,Gg({patternType:"none"})),xe(n,45,Gg({patternType:"gray125"})),xe(n,604)}(t),function R1(n){xe(n,613,Hr(1)),xe(n,46,function M1(n,o){return o||(o=ue(51)),o.write_shift(1,0),Ha(0,o),Ha(0,o),Ha(0,o),Ha(0,o),Ha(0,o),o.length>o.l?o.slice(0,o.l):o}()),xe(n,614)}(t),function N1(n){xe(n,626,Hr(1)),xe(n,47,Ug({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),xe(n,627)}(t),function A1(n,o){xe(n,617,Hr(o.length)),o.forEach(function(t){xe(n,47,Ug(t,0))}),xe(n,618)}(t,o.cellXfs),function D1(n){xe(n,619,Hr(1)),xe(n,48,function w1(n,o){return o||(o=ue(52)),o.write_shift(4,n.xfId),o.write_shift(2,1),o.write_shift(1,+n.builtinId),o.write_shift(1,0),gc(n.name||"",o),o.length>o.l?o.slice(0,o.l):o}({xfId:0,builtinId:0,name:"Normal"})),xe(n,620)}(t),function j1(n){xe(n,505,Hr(0)),xe(n,506)}(t),function B1(n){xe(n,508,function F1(n,o,t){var r=ue(2052);return r.write_shift(4,n),gc(o,r),gc(t,r),r.length>r.l?r.slice(0,r.l):r}(0,"TableStyleMedium9","PivotStyleMedium4")),xe(n,509)}(t),xe(t,279),t.end()}function Pd(n,o){if(o&&o.themeXLSX)return o.themeXLSX;if(n&&"string"==typeof n.raw)return n.raw;var t=[fn];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',t[t.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',t[t.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',t[t.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',t[t.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',t[t.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',t[t.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function u_(){var n=rr();return xe(n,332),xe(n,334,Hr(1)),xe(n,335,function i_(n){var o=ue(12+2*n.name.length);return o.write_shift(4,n.flags),o.write_shift(4,n.version),jn(n.name,o),o.slice(0,o.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),xe(n,336),xe(n,339,function s_(n,o){var t=ue(8+2*o.length);return t.write_shift(4,n),jn(o,t),t.slice(0,t.l)}(1,"XLDAPR")),xe(n,52),xe(n,35,Hr(514)),xe(n,4096,Hr(0)),xe(n,4097,Nr(1)),xe(n,36),xe(n,53),xe(n,340),xe(n,337,function l_(n,o){var t=ue(8);return t.write_shift(4,n),t.write_shift(4,o?1:0),t}(1,!0)),xe(n,51,function a_(n){var o=ue(4+8*n.length);o.write_shift(4,n.length);for(var t=0;t<n.length;++t)o.write_shift(4,n[t][0]),o.write_shift(4,n[t][1]);return o}([[1,0]])),xe(n,338),xe(n,333),n.end()}function Vg(){var n=[fn];return n.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),n.join("")}var Ko=1024;function Yg(n,o){for(var t=[21600,21600],r=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),i=[we("xml",null,{"xmlns:v":kr.v,"xmlns:o":kr.o,"xmlns:x":kr.x,"xmlns:mv":kr.mv}).replace(/\/>/,">"),we("o:shapelayout",we("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),we("v:shapetype",[we("v:stroke",null,{joinstyle:"miter"}),we("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:r})];Ko<1e3*n;)Ko+=1e3;return o.forEach(function(a){var s=Cn(a[0]),l={color2:"#BEFF82",type:"gradient"};"gradient"==l.type&&(l.angle="-180");var u="gradient"==l.type?we("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,p=we("v:fill",u,l);++Ko,i=i.concat(["<v:shape"+Na({id:"_x0000_s"+Ko,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",p,we("v:shadow",null,{on:"t",obscured:"t"}),we("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",$n("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),$n("x:AutoFill","False"),$n("x:Row",String(s.r)),$n("x:Column",String(s.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function Hg(n){var o=[fn,we("comments",null,{xmlns:Yi[0]})],t=[];return o.push("<authors>"),n.forEach(function(r){r[1].forEach(function(i){var a=Xt(i.a);-1==t.indexOf(a)&&(t.push(a),o.push("<author>"+a+"</author>")),i.T&&i.ID&&-1==t.indexOf("tc="+i.ID)&&(t.push("tc="+i.ID),o.push("<author>tc="+i.ID+"</author>"))})}),0==t.length&&(t.push("SheetJ5"),o.push("<author>SheetJ5</author>")),o.push("</authors>"),o.push("<commentList>"),n.forEach(function(r){var i=0,a=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=t.indexOf("tc="+r[1][0].ID):r[1].forEach(function(u){u.a&&(i=t.indexOf(Xt(u.a))),a.push(u.t||"")}),o.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),a.length<=1)o.push($n("t",Xt(a[0]||"")));else{for(var s="Comment:\n    "+a[0]+"\n",l=1;l<a.length;++l)s+="Reply:\n    "+a[l]+"\n";o.push($n("t",Xt(s)))}o.push("</text></comment>")}),o.push("</commentList>"),o.length>2&&(o[o.length]="</comments>",o[1]=o[1].replace("/>",">")),o.join("")}function v_(n,o,t){var r=[fn,we("ThreadedComments",null,{xmlns:yn.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(i){var a="";(i[1]||[]).forEach(function(s,l){if(s.T){s.a&&-1==o.indexOf(s.a)&&o.push(s.a);var u={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};0==l?a=u.id:u.parentId=a,s.ID=u.id,s.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+o.indexOf(s.a)).slice(-12)+"}"),r.push(we("threadedComment",$n("text",s.t||""),u))}else delete s.ID})}),r.push("</ThreadedComments>"),r.join("")}var y_=Yn;function F_(n){var o=rr(),t=[];return xe(o,628),xe(o,630),n.forEach(function(r){r[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),xe(o,632,function M_(n){return jn(n.slice(0,54))}(i.a)))})}),xe(o,631),xe(o,633),n.forEach(function(r){r[1].forEach(function(i){i.iauthor=t.indexOf(i.a);var a={s:Cn(r[0]),e:Cn(r[0])};xe(o,635,function O_(n,o){return null==o&&(o=ue(36)),o.write_shift(4,n[1].iauthor),Zo(n[0],o),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o}([a,i])),i.t&&i.t.length>0&&xe(o,637,function ef(n,o){var t=!1;return null==o&&(t=!0,o=ue(23+4*n.t.length)),o.write_shift(1,1),jn(n.t,o),o.write_shift(4,1),function Q0(n,o){o||(o=ue(4)),o.write_shift(2,n.ich||0),o.write_shift(2,n.ifnt||0)}({ich:0,ifnt:0},o),t?o.slice(0,o.l):o}(i)),xe(o,636),delete i.iauthor})}),xe(o,634),xe(o,629),o.end()}var Wg=["xlsb","xlsm","xlam","biff8","xla"],ea=function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,o={r:0,c:0};function t(r,i,a,s){var l=!1,u=!1;0==a.length?u=!0:"["==a.charAt(0)&&(u=!0,a=a.slice(1,-1)),0==s.length?l=!0:"["==s.charAt(0)&&(l=!0,s=s.slice(1,-1));var p=a.length>0?0|parseInt(a,10):0,f=s.length>0?0|parseInt(s,10):0;return l?f+=o.c:--f,u?p+=o.r:--p,i+(l?"":"$")+nn(f)+(u?"":"$")+mn(p)}return function(i,a){return o=a,i.replace(n,t)}}(),bd=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,kd=function(){return function(o,t){return o.replace(bd,function(r,i,a,s,l,u){var p=Kl(s)-(a?0:t.c),f=Jl(u)-(l?0:t.r);return i+"R"+(0==f?"":l?f+1:"["+f+"]")+"C"+(0==p?"":a?p+1:"["+p+"]")})}}();function qg(n,o){return n.replace(bd,function(t,r,i,a,s,l){return r+("$"==i?i+a:nn(Kl(a)+o.c))+("$"==s?s+l:mn(Jl(l)+o.r))})}function wn(n){n.l+=1}function qi(n,o){var t=n.read_shift(1==o?1:2);return[16383&t,t>>14&1,t>>15&1]}function Zg(n,o,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return Qg(n);12==t.biff&&(r=4)}var i=n.read_shift(r),a=n.read_shift(r),s=qi(n,2),l=qi(n,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function Qg(n){var o=qi(n,2),t=qi(n,2),r=n.read_shift(1),i=n.read_shift(1);return{s:{r:o[0],c:r,cRel:o[1],rRel:o[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function Jg(n,o,t){if(t&&t.biff>=2&&t.biff<=5)return function B_(n){var o=qi(n,2),t=n.read_shift(1);return{r:o[0],c:t,cRel:o[1],rRel:o[2]}}(n);var r=n.read_shift(t&&12==t.biff?4:2),i=qi(n,2);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function L_(n){var o=n.read_shift(2),t=n.read_shift(2);return{r:o,c:255&t,fQuoted:!!(16384&t),cRel:t>>15,rRel:t>>15}}function Kg(n){var o=1&n[n.l+1];return n.l+=4,[o,1]}function ep(n){return[n.read_shift(1),n.read_shift(1)]}function fx(n,o){var t=[n.read_shift(1)];if(12==o)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2}switch(t[0]){case 4:t[1]=function vn(n,o){return 1===n.read_shift(o)}(n,1)?"TRUE":"FALSE",12!=o&&(n.l+=7);break;case 37:case 16:t[1]=Pi[n[n.l]],n.l+=12==o?4:8;break;case 0:n.l+=8;break;case 1:t[1]=Xn(n);break;case 2:t[1]=function wo(n,o,t){if(t.biff>5)return function Ua(n,o,t){var r=n.read_shift(t&&2==t.biff?1:2);return 0===r?(n.l++,""):function Mo(n,o,t){if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(o,"cpstr");if(t.biff>=12)return n.read_shift(o,"dbcs-cont")}var i=n.read_shift(1);return n.read_shift(o,0===i?"sbcs-cont":"dbcs-cont")}(n,r,t)}(n,0,t);var r=n.read_shift(1);return 0===r?(n.l++,""):n.read_shift(r,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}(n,0,{biff:o>0&&o<8?2:o});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function mx(n,o,t){for(var r=n.read_shift(12==t.biff?4:2),i=[],a=0;a!=r;++a)i.push((12==t.biff?bo:vc)(n,8));return i}function hx(n,o,t){var r=0,i=0;12==t.biff?(r=n.read_shift(4),i=n.read_shift(4)):(i=1+n.read_shift(1),r=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,0==--i&&(i=256));for(var a=0,s=[];a!=r&&(s[a]=[]);++a)for(var l=0;l!=i;++l)s[a][l]=fx(n,t.biff);return s}function Wa(n,o,t){return n.l+=2,[L_(n)]}function Od(n){return n.l+=6,[]}function tp(n){return n.l+=2,[Mn(n),1&n.read_shift(2)]}var Dx=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],np={1:{n:"PtgExp",f:function cx(n,o,t){return n.l++,t&&12==t.biff?[n.read_shift(4,"i"),0]:[n.read_shift(2),n.read_shift(t&&2==t.biff?1:2)]}},2:{n:"PtgTbl",f:Vn},3:{n:"PtgAdd",f:wn},4:{n:"PtgSub",f:wn},5:{n:"PtgMul",f:wn},6:{n:"PtgDiv",f:wn},7:{n:"PtgPower",f:wn},8:{n:"PtgConcat",f:wn},9:{n:"PtgLt",f:wn},10:{n:"PtgLe",f:wn},11:{n:"PtgEq",f:wn},12:{n:"PtgGe",f:wn},13:{n:"PtgGt",f:wn},14:{n:"PtgNe",f:wn},15:{n:"PtgIsect",f:wn},16:{n:"PtgUnion",f:wn},17:{n:"PtgRange",f:wn},18:{n:"PtgUplus",f:wn},19:{n:"PtgUminus",f:wn},20:{n:"PtgPercent",f:wn},21:{n:"PtgParen",f:wn},22:{n:"PtgMissArg",f:wn},23:{n:"PtgStr",f:function px(n,o,t){return n.l++,Ga(n,0,t)}},26:{n:"PtgSheet",f:function Lx(n,o,t){return n.l+=5,n.l+=2,n.l+=2==t.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function $x(n,o,t){return n.l+=2==t.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function lx(n){return n.l++,Pi[n.read_shift(1)]}},29:{n:"PtgBool",f:function ux(n){return n.l++,0!==n.read_shift(1)}},30:{n:"PtgInt",f:function dx(n){return n.l++,n.read_shift(2)}},31:{n:"PtgNum",f:function gx(n){return n.l++,Xn(n)}},32:{n:"PtgArray",f:function H_(n,o,t){var r=(96&n[n.l++])>>5;return n.l+=2==t.biff?6:12==t.biff?14:7,[r]}},33:{n:"PtgFunc",f:function ix(n,o,t){var r=(96&n[n.l])>>5;n.l+=1;var i=n.read_shift(t&&t.biff<=3?1:2);return[sC[i],op[i],r]}},34:{n:"PtgFuncVar",f:function ox(n,o,t){var r=n[n.l++],i=n.read_shift(1),a=t&&t.biff<=3?[88==r?-1:0,n.read_shift(1)]:function ax(n){return[n[n.l+1]>>7,32767&n.read_shift(2)]}(n);return[i,(0===a[0]?op:aC)[a[1]]]}},35:{n:"PtgName",f:function _x(n,o,t){var r=n.read_shift(1)>>>5&3,a=n.read_shift(!t||t.biff>=8?4:2);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12}return[r,0,a]}},36:{n:"PtgRef",f:function tx(n,o,t){var r=(96&n[n.l])>>5;return n.l+=1,[r,Jg(n,0,t)]}},37:{n:"PtgArea",f:function U_(n,o,t){return[(96&n[n.l++])>>5,Zg(n,0,t)]}},38:{n:"PtgMemArea",f:function vx(n,o,t){var r=n.read_shift(1)>>>5&3;return n.l+=t&&2==t.biff?3:4,[r,n.read_shift(t&&2==t.biff?1:2)]}},39:{n:"PtgMemErr",f:Vn},40:{n:"PtgMemNoMem",f:Vn},41:{n:"PtgMemFunc",f:function Px(n,o,t){return[n.read_shift(1)>>>5&3,n.read_shift(t&&2==t.biff?1:2)]}},42:{n:"PtgRefErr",f:function bx(n,o,t){var r=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,12==t.biff&&(n.l+=2),[r]}},43:{n:"PtgAreaErr",f:function V_(n,o,t){var r=(96&n[n.l++])>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function nx(n,o,t){var r=(96&n[n.l])>>5;n.l+=1;var i=function $_(n,o,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return function G_(n){var o=n.read_shift(2),t=n.read_shift(1),r=(32768&o)>>15,i=(16384&o)>>14;return o&=16383,1==r&&o>=8192&&(o-=16384),1==i&&t>=128&&(t-=256),{r:o,c:t,cRel:i,rRel:r}}(n);var i=n.read_shift(r>=12?4:2),a=n.read_shift(2),s=(16384&a)>>14,l=(32768&a)>>15;if(a&=16383,1==l)for(;i>524287;)i-=1048576;if(1==s)for(;a>8191;)a-=16384;return{r:i,c:a,cRel:s,rRel:l}}(n,0,t);return[r,i]}},45:{n:"PtgAreaN",f:function X_(n,o,t){var r=(96&n[n.l++])>>5,i=function j_(n,o,t){if(t.biff<8)return Qg(n);var r=n.read_shift(12==t.biff?4:2),i=n.read_shift(12==t.biff?4:2),a=qi(n,2),s=qi(n,2);return{s:{r,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}(n,0,t);return[r,i]}},46:{n:"PtgMemAreaN",f:function Gx(n){return[n.read_shift(1)>>>5&3,n.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function Ux(n){return[n.read_shift(1)>>>5&3,n.read_shift(2)]}},57:{n:"PtgNameX",f:function xx(n,o,t){return 5==t.biff?function Cx(n){var o=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var r=n.read_shift(2);return n.l+=12,[o,t,r]}(n):[n.read_shift(1)>>>5&3,n.read_shift(2),n.read_shift(4)]}},58:{n:"PtgRef3d",f:function rx(n,o,t){var r=(96&n[n.l])>>5;n.l+=1;var i=n.read_shift(2);return t&&5==t.biff&&(n.l+=12),[r,i,Jg(n,0,t)]}},59:{n:"PtgArea3d",f:function z_(n,o,t){var r=(96&n[n.l++])>>5,i=n.read_shift(2,"i");if(t&&5===t.biff)n.l+=12;return[r,i,Zg(n,0,t)]}},60:{n:"PtgRefErr3d",f:function kx(n,o,t){var r=(96&n[n.l++])>>5,i=n.read_shift(2),a=4;if(t)switch(t.biff){case 5:a=15;break;case 12:a=6}return n.l+=a,[r,i]}},61:{n:"PtgAreaErr3d",f:function Y_(n,o,t){var r=(96&n[n.l++])>>5,i=n.read_shift(2),a=8;if(t)switch(t.biff){case 5:n.l+=12,a=6;break;case 12:a=12}return n.l+=a,[r,i]}},255:{}},Vx={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Yx={1:{n:"PtgElfLel",f:tp},2:{n:"PtgElfRw",f:Wa},3:{n:"PtgElfCol",f:Wa},6:{n:"PtgElfRwV",f:Wa},7:{n:"PtgElfColV",f:Wa},10:{n:"PtgElfRadical",f:Wa},11:{n:"PtgElfRadicalS",f:Od},13:{n:"PtgElfColS",f:Od},15:{n:"PtgElfColSV",f:Od},16:{n:"PtgElfRadicalLel",f:tp},25:{n:"PtgList",f:function jx(n){n.l+=2;var o=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(4),i=n.read_shift(2),a=n.read_shift(2);return{ixti:o,coltype:3&t,rt:Dx[t>>2&31],idx:r,c:i,C:a}}},29:{n:"PtgSxName",f:function Bx(n){return n.l+=2,[n.read_shift(4)]}},255:{}},Xx={0:{n:"PtgAttrNoop",f:function zx(n){return n.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function J_(n,o,t){var r=255&n[n.l+1]?1:0;return n.l+=t&&2==t.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function Z_(n,o,t){var r=255&n[n.l+1]?1:0;return n.l+=2,[r,n.read_shift(t&&2==t.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function W_(n,o,t){n.l+=2;for(var r=n.read_shift(t&&2==t.biff?1:2),i=[],a=0;a<=r;++a)i.push(n.read_shift(t&&2==t.biff?1:2));return i}},8:{n:"PtgAttrGoto",f:function q_(n,o,t){var r=255&n[n.l+1]?1:0;return n.l+=2,[r,n.read_shift(t&&2==t.biff?1:2)]}},16:{n:"PtgAttrSum",f:function sx(n,o,t){n.l+=t&&2==t.biff?3:4}},32:{n:"PtgAttrBaxcel",f:Kg},33:{n:"PtgAttrBaxcel",f:Kg},64:{n:"PtgAttrSpace",f:function K_(n){return n.read_shift(2),ep(n)}},65:{n:"PtgAttrSpaceSemi",f:function ex(n){return n.read_shift(2),ep(n)}},128:{n:"PtgAttrIfError",f:function Q_(n){var o=255&n[n.l+1]?1:0;return n.l+=2,[o,n.read_shift(2)]}},255:{}};function qa(n,o,t,r){if(r.biff<8)return Vn(n,o);for(var i=n.l+o,a=[],s=0;s!==t.length;++s)switch(t[s][0]){case"PtgArray":t[s][1]=hx(n,0,r),a.push(t[s][1]);break;case"PtgMemArea":t[s][2]=mx(n,0,r),a.push(t[s][2]);break;case"PtgExp":r&&12==r.biff&&(t[s][1][1]=n.read_shift(4),a.push(t[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[s][0]}return 0!=(o=i-n.l)&&a.push(Vn(n,o)),a}function Hx(n){for(var o=[],t=0;t<n.length;++t){for(var r=n[t],i=[],a=0;a<r.length;++a){var s=r[a];i.push(s?2===s[0]?'"'+s[1].replace(/"/g,'""')+'"':s[1]:"")}o.push(i.join(","))}return o.join(";")}var Wx={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function rp(n,o,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[o]))return n.SheetNames[o];if(!n.XTI)return"SH33TJSERR6";var r=n.XTI[o];if(t.biff<8)return o>1e4&&(o-=65536),o<0&&(o=-o),0==o?"":n.XTI[o-1];if(!r)return"SH33TJSERR1";var i="";if(t.biff>8)switch(n[r[0]][0]){case 357:return i=-1==r[1]?"#REF":n.SheetNames[r[1]],r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 358:return null!=t.SID?n.SheetNames[t.SID]:"SH33TJSSAME"+n[r[0]][0];default:return"SH33TJSSRC"+n[r[0]][0]}switch(n[r[0]][0][0]){case 1025:return i=-1==r[1]?"#REF":n.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 14849:return n[r[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return n[r[0]][0][3]?(i=-1==r[1]?"#REF":n[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+n[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function ip(n,o,t){var r=rp(n,o,t);return"#REF"==r?r:function qx(n,o){if(!(n||o&&o.biff<=5&&o.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}(r,t)}function qn(n,o,t,r,i){var u,p,f,C,a=i&&i.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},l=[],h=0,_=0,P="";if(!n[0]||!n[0][0])return"";for(var x=-1,k="",F=0,S=n[0].length;F<S;++F){var w=n[0][F];switch(w[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=l.pop(),p=l.pop(),x>=0){switch(n[0][x][1][0]){case 0:k=pn(" ",n[0][x][1][1]);break;case 1:k=pn("\r",n[0][x][1][1]);break;default:if(k="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][x][1][0])}p+=k,x=-1}l.push(p+Wx[w[0]]+u);break;case"PtgIsect":u=l.pop(),p=l.pop(),l.push(p+" "+u);break;case"PtgUnion":u=l.pop(),p=l.pop(),l.push(p+","+u);break;case"PtgRange":u=l.pop(),p=l.pop(),l.push(p+":"+u);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":f=ja(w[1][1],s,i),l.push(Ba(f,a));break;case"PtgRefN":f=t?ja(w[1][1],t,i):w[1][1],l.push(Ba(f,a));break;case"PtgRef3d":h=w[1][1],f=ja(w[1][2],s,i),P=ip(r,h,i),l.push(P+"!"+Ba(f,a));break;case"PtgFunc":case"PtgFuncVar":var K=w[1][0],ee=w[1][1];K||(K=0);var A=0==(K&=127)?[]:l.slice(-K);l.length-=K,"User"===ee&&(ee=A.shift()),l.push(ee+"("+A.join(",")+")");break;case"PtgBool":l.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":l.push(w[1]);break;case"PtgNum":l.push(String(w[1]));break;case"PtgStr":l.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":C=Iu(w[1][1],t?{s:t}:s,i),l.push(Ql(C,i));break;case"PtgArea":C=Iu(w[1][1],s,i),l.push(Ql(C,i));break;case"PtgArea3d":C=w[1][2],P=ip(r,h=w[1][1],i),l.push(P+"!"+Ql(C,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgName":var Q=(r.names||[])[(_=w[1][2])-1]||(r[0]||[])[_],q=Q?Q.Name:"SH33TJSNAME"+String(_);q&&"_xlfn."==q.slice(0,6)&&!i.xlfn&&(q=q.slice(6)),l.push(q);break;case"PtgNameX":var de,le=w[1][1];if(_=w[1][2],!(i.biff<=5)){var Z="";if(14849==((r[le]||[])[0]||[])[0]||(1025==((r[le]||[])[0]||[])[0]?r[le][_]&&r[le][_].itab>0&&(Z=r.SheetNames[r[le][_].itab-1]+"!"):Z=r.SheetNames[_-1]+"!"),r[le]&&r[le][_])Z+=r[le][_].Name;else if(r[0]&&r[0][_])Z+=r[0][_].Name;else{var Fe=(rp(r,le,i)||"").split(";;");Fe[_-1]?Z=Fe[_-1]:Z+="SH33TJSERRX"}l.push(Z);break}le<0&&(le=-le),r[le]&&(de=r[le][_]),de||(de={Name:"SH33TJSERRY"}),l.push(de.Name);break;case"PtgParen":var Ye="(",De=")";if(x>=0){switch(k="",n[0][x][1][0]){case 2:Ye=pn(" ",n[0][x][1][1])+Ye;break;case 3:Ye=pn("\r",n[0][x][1][1])+Ye;break;case 4:De=pn(" ",n[0][x][1][1])+De;break;case 5:De=pn("\r",n[0][x][1][1])+De;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][x][1][0])}x=-1}l.push(Ye+l.pop()+De);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":l.push("#REF!");break;case"PtgExp":var ct={c:t.c,r:t.r};if(r.sharedf[pt(f={c:w[1][1],r:w[1][0]})]){var Qe=r.sharedf[pt(f)];l.push(qn(Qe,0,ct,r,i))}else{var St=!1;for(u=0;u!=r.arrayf.length;++u)if(!(f.c<(p=r.arrayf[u])[0].s.c||f.c>p[0].e.c||f.r<p[0].s.r||f.r>p[0].e.r)){l.push(qn(p[1],0,ct,r,i)),St=!0;break}St||l.push(w[1])}break;case"PtgArray":l.push("{"+Hx(w[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=F;break;case"PtgMissArg":l.push("");break;case"PtgList":l.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(w))}if(3!=i.biff&&x>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(n[0][F][0])){var ft=!0;switch((w=n[0][x])[1][0]){case 4:ft=!1;case 0:k=pn(" ",w[1][1]);break;case 5:ft=!1;case 1:k=pn("\r",w[1][1]);break;default:if(k="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}l.push((ft?k:"")+l.pop()+(ft?"":k)),x=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]}function wc(n,o,t){var r=n.read_shift(4),i=function Za(n,o,t){for(var i,a,r=n.l+o,s=[];r!=n.l;)o=r-n.l,i=np[a=n[n.l]]||np[Vx[a]],(24===a||25===a)&&(i=(24===a?Yx:Xx)[n[n.l+1]]),i&&i.f?s.push([i.n,i.f(n,o,t)]):Vn(n,o);return s}(n,r,t),a=n.read_shift(4);return[i,a>0?qa(n,a,i,t):null]}var rC=wc,Fc=wc,iC=wc,oC=wc,aC={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},op={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},sC={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function cC(n){return("of:="+n.replace(bd,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function lC(n){return n.replace(/\./,"!")}var Qa=typeof Map<"u";function wd(n,o,t){var r=0,i=n.length;if(t){if(Qa?t.has(o):Object.prototype.hasOwnProperty.call(t,o))for(var a=Qa?t.get(o):t[o];r<a.length;++r)if(n[a[r]].t===o)return n.Count++,a[r]}else for(;r<i;++r)if(n[r].t===o)return n.Count++,r;return n[i]={t:o},n.Count++,n.Unique++,t&&(Qa?(t.has(o)||t.set(o,[]),t.get(o).push(i)):(Object.prototype.hasOwnProperty.call(t,o)||(t[o]=[]),t[o].push(i))),i}function Sc(n,o){var t={min:n+1,max:n+1},r=-1;return o.MDW&&(Wn=o.MDW),null!=o.width?t.customWidth=1:null!=o.wpx?r=Ya(o.wpx):null!=o.wch&&(r=o.wch),r>-1?(t.width=kc(r),t.customWidth=1):null!=o.width&&(t.width=o.width),o.hidden&&(t.hidden=!0),null!=o.level&&(t.outlineLevel=t.level=o.level),t}function So(n,o){if(n){var t=[.7,.7,.75,.75,.3,.3];"xlml"==o&&(t=[1,1,1,1,.5,.5]),null==n.left&&(n.left=t[0]),null==n.right&&(n.right=t[1]),null==n.top&&(n.top=t[2]),null==n.bottom&&(n.bottom=t[3]),null==n.header&&(n.header=t[4]),null==n.footer&&(n.footer=t[5])}}function Zi(n,o,t){var r=t.revssf[null!=o.z?o.z:"General"],i=60,a=n.length;if(null==r&&t.ssf)for(;i<392;++i)if(null==t.ssf[i]){Tr(o.z,i),t.ssf[i]=o.z,t.revssf[o.z]=r=i;break}for(i=0;i!=a;++i)if(n[i].numFmtId===r)return i;return n[a]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function uC(n,o,t){if(n&&n["!ref"]){var r=Dt(n["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}var MC=["objects","scenarios","selectLockedCells","selectUnlockedCells"],wC=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function LC(n,o,t,r){if(n.c&&t["!comments"].push([o,n.c]),void 0===n.v&&"string"!=typeof n.f||"z"===n.t&&!n.f)return"";var i="",a=n.t,s=n.v;if("z"!==n.t)switch(n.t){case"b":i=n.v?"1":"0";break;case"n":i=""+n.v;break;case"e":i=Pi[n.v];break;case"d":r&&r.cellDates?i=ln(n.v,-1).toISOString():((n=Qt(n)).t="n",i=""+(n.v=An(ln(n.v)))),typeof n.z>"u"&&(n.z=tt[14]);break;default:i=n.v}var l=$n("v",Xt(i)),u={r:o},p=Zi(r.cellXfs,n,r);switch(0!==p&&(u.s=p),n.t){case"n":case"z":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;default:if(null==n.v){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){l=$n("v",""+wd(r.Strings,n.v,r.revStrings)),u.t="s";break}u.t="str"}if(n.t!=a&&(n.t=a,n.v=s),"string"==typeof n.f&&n.f){var f=n.F&&n.F.slice(0,o.length)==o?{t:"array",ref:n.F}:null;l=we("f",Xt(n.f),f)+(null!=n.v?l:"")}return n.l&&t["!links"].push([o,n.l]),n.D&&(u.cm=1),we("c",l,u)}function cp(n,o,t,r){var s,i=[fn,we("worksheet",null,{xmlns:Yi[0],"xmlns:r":yn.r})],l="",u=t.Sheets[t.SheetNames[n]];null==u&&(u={});var p=u["!ref"]||"A1",f=Dt(p);if(f.e.c>16383||f.e.r>1048575){if(o.WTF)throw new Error("Range "+p+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),p=bt(f)}r||(r={}),u["!comments"]=[];var h=[];(function yC(n,o,t,r,i){var a=!1,s={},l=null;if("xlsx"!==r.bookType&&o.vbaraw){var u=o.SheetNames[t];try{o.Workbook&&(u=o.Workbook.Sheets[t].CodeName||u)}catch{}a=!0,s.codeName=ni(Xt(u))}if(n&&n["!outline"]){var p={summaryBelow:1,summaryRight:1};n["!outline"].above&&(p.summaryBelow=0),n["!outline"].left&&(p.summaryRight=0),l=(l||"")+we("outlinePr",null,p)}!a&&!l||(i[i.length]=we("sheetPr",l,s))})(u,t,n,o,i),i[i.length]=we("dimension",null,{ref:p}),i[i.length]=function BC(n,o,t,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),we("sheetViews",we("sheetView",null,i),{})}(0,0,0,t),o.sheetFormat&&(i[i.length]=we("sheetFormatPr",null,{defaultRowHeight:o.sheetFormat.defaultRowHeight||"16",baseColWidth:o.sheetFormat.baseColWidth||"10",outlineLevelRow:o.sheetFormat.outlineLevelRow||"7"})),null!=u["!cols"]&&u["!cols"].length>0&&(i[i.length]=function RC(n,o){for(var r,t=["<cols>"],i=0;i!=o.length;++i)(r=o[i])&&(t[t.length]=we("col",null,Sc(i,r)));return t[t.length]="</cols>",t.join("")}(0,u["!cols"])),i[s=i.length]="<sheetData/>",u["!links"]=[],null!=u["!ref"]&&(l=function GC(n,o,t,r){var u,k,i=[],a=[],s=Dt(n["!ref"]),l="",p="",f=[],h=0,_=0,C=n["!rows"],P=Array.isArray(n),x={r:p},F=-1;for(_=s.s.c;_<=s.e.c;++_)f[_]=nn(_);for(h=s.s.r;h<=s.e.r;++h){for(a=[],p=mn(h),_=s.s.c;_<=s.e.c;++_){u=f[_]+p;var S=P?(n[h]||[])[_]:n[u];void 0!==S&&null!=(l=LC(S,u,n,o))&&a.push(l)}(a.length>0||C&&C[h])&&(x={r:p},C&&C[h]&&((k=C[h]).hidden&&(x.hidden=1),F=-1,k.hpx?F=Xa(k.hpx):k.hpt&&(F=k.hpt),F>-1&&(x.ht=F,x.customHeight=1),k.level&&(x.outlineLevel=k.level)),i[i.length]=we("row",a.join(""),x))}if(C)for(;h<C.length;++h)C&&C[h]&&(x={r:h+1},(k=C[h]).hidden&&(x.hidden=1),F=-1,k.hpx?F=Xa(k.hpx):k.hpt&&(F=k.hpt),F>-1&&(x.ht=F,x.customHeight=1),k.level&&(x.outlineLevel=k.level),i[i.length]=we("row","",x));return i.join("")}(u,o),l.length>0&&(i[i.length]=l)),i.length>s+1&&(i[i.length]="</sheetData>",i[s]=i[s].replace("/>",">")),u["!protect"]&&(i[i.length]=function FC(n){var o={sheet:1};return MC.forEach(function(t){null!=n[t]&&n[t]&&(o[t]="1")}),wC.forEach(function(t){null!=n[t]&&!n[t]&&(o[t]="0")}),n.password&&(o.password=_d(n.password).toString(16).toUpperCase()),we("sheetProtection",null,o)}(u["!protect"])),null!=u["!autofilter"]&&(i[i.length]=function AC(n,o,t,r){var i="string"==typeof n.ref?n.ref:bt(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,s=ir(i);s.s.r==s.e.r&&(s.e.r=ir(o["!ref"]).e.r,i=bt(s));for(var l=0;l<a.length;++l){var u=a[l];if("_xlnm._FilterDatabase"==u.Name&&u.Sheet==r){u.Ref="'"+t.SheetNames[r]+"'!"+i;break}}return l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+i}),we("autoFilter",null,{ref:i})}(u["!autofilter"],u,t,n)),null!=u["!merges"]&&u["!merges"].length>0&&(i[i.length]=function kC(n){if(0===n.length)return"";for(var o='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)o+='<mergeCell ref="'+bt(n[t])+'"/>';return o+"</mergeCells>"}(u["!merges"]));var C,_=-1,P=-1;return u["!links"].length>0&&(i[i.length]="<hyperlinks>",u["!links"].forEach(function(x){x[1].Target&&(C={ref:x[0]},"#"!=x[1].Target.charAt(0)&&(P=zt(r,-1,Xt(x[1].Target).replace(/#.*$/,""),kt.HLINK),C["r:id"]="rId"+P),(_=x[1].Target.indexOf("#"))>-1&&(C.location=Xt(x[1].Target.slice(_+1))),x[1].Tooltip&&(C.tooltip=Xt(x[1].Tooltip)),i[i.length]=we("hyperlink",null,C))}),i[i.length]="</hyperlinks>"),delete u["!links"],null!=u["!margins"]&&(i[i.length]=function TC(n){return So(n),we("pageMargins",null,n)}(u["!margins"])),(!o||o.ignoreEC||null==o.ignoreEC)&&(i[i.length]=$n("ignoredErrors",we("ignoredError",null,{numberStoredAsText:1,sqref:p}))),h.length>0&&(P=zt(r,-1,"../drawings/drawing"+(n+1)+".xml",kt.DRAW),i[i.length]=we("drawing",null,{"r:id":"rId"+P}),u["!drawing"]=h),u["!comments"].length>0&&(P=zt(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",kt.VML),i[i.length]=we("legacyDrawing",null,{"r:id":"rId"+P}),u["!legacy"]=P),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function VC(n,o,t,r){var i=function zC(n,o,t){var r=ue(145),i=(t["!rows"]||[])[n]||{};r.write_shift(4,n),r.write_shift(4,0);var a=320;i.hpx?a=20*Xa(i.hpx):i.hpt&&(a=20*i.hpt),r.write_shift(2,a),r.write_shift(1,0);var s=0;i.level&&(s|=i.level),i.hidden&&(s|=16),(i.hpx||i.hpt)&&(s|=32),r.write_shift(1,s),r.write_shift(1,0);var l=0,u=r.l;r.l+=4;for(var p={r:n,c:0},f=0;f<16;++f)if(!(o.s.c>f+1<<10||o.e.c<f<<10)){for(var h=-1,_=-1,C=f<<10;C<f+1<<10;++C)p.c=C,(Array.isArray(t)?(t[p.r]||[])[p.c]:t[pt(p)])&&(h<0&&(h=C),_=C);h<0||(++l,r.write_shift(4,h),r.write_shift(4,_))}var x=r.l;return r.l=u,r.write_shift(4,l),r.l=x,r.length>r.l?r.slice(0,r.l):r}(r,t,o);(i.length>17||(o["!rows"]||[])[r])&&xe(n,0,i)}var YC=bo,XC=Zo;var Fv=bo,Ev=Zo,dp=["left","right","top","bottom","header","footer"];function Xv(n,o,t,r,i,a,s){if(void 0===o.v)return!1;var l="";switch(o.t){case"b":l=o.v?"1":"0";break;case"d":(o=Qt(o)).z=o.z||tt[14],o.v=An(ln(o.v)),o.t="n";break;case"n":case"e":l=""+o.v;break;default:l=o.v}var u={r:t,c:r};switch(u.s=Zi(i.cellXfs,o,i),o.l&&a["!links"].push([pt(u),o.l]),o.c&&a["!comments"].push([pt(u),o.c]),o.t){case"s":case"str":return i.bookSST?(l=wd(i.Strings,o.v,i.revStrings),u.t="s",u.v=l,s?xe(n,18,function uv(n,o,t){return null==t&&(t=ue(8)),Po(o,t),t.write_shift(4,o.v),t}(0,u)):xe(n,7,function lv(n,o,t){return null==t&&(t=ue(12)),Co(o,t),t.write_shift(4,o.v),t}(0,u))):(u.t="str",s?xe(n,17,function kv(n,o,t){return null==t&&(t=ue(8+4*n.v.length)),Po(o,t),jn(n.v,t),t.length>t.l?t.slice(0,t.l):t}(o,u)):xe(n,6,function Pv(n,o,t){return null==t&&(t=ue(12+4*n.v.length)),Co(o,t),jn(n.v,t),t.length>t.l?t.slice(0,t.l):t}(o,u))),!0;case"n":return o.v==(0|o.v)&&o.v>-1e3&&o.v<1e3?s?xe(n,13,function xv(n,o,t){return null==t&&(t=ue(8)),Po(o,t),Du(n.v,t),t}(o,u)):xe(n,2,function hv(n,o,t){return null==t&&(t=ue(12)),Co(o,t),Du(n.v,t),t}(o,u)):s?xe(n,16,function fv(n,o,t){return null==t&&(t=ue(12)),Po(o,t),ko(n.v,t),t}(o,u)):xe(n,5,function pv(n,o,t){return null==t&&(t=ue(16)),Co(o,t),ko(n.v,t),t}(o,u)),!0;case"b":return u.t="b",s?xe(n,15,function rv(n,o,t){return null==t&&(t=ue(5)),Po(o,t),t.write_shift(1,n.v?1:0),t}(o,u)):xe(n,4,function tv(n,o,t){return null==t&&(t=ue(9)),Co(o,t),t.write_shift(1,n.v?1:0),t}(o,u)),!0;case"e":return u.t="e",s?xe(n,14,function sv(n,o,t){return null==t&&(t=ue(8)),Po(o,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}(o,u)):xe(n,3,function ov(n,o,t){return null==t&&(t=ue(9)),Co(o,t),t.write_shift(1,n.v),t}(o,u)),!0}return s?xe(n,12,function KC(n,o,t){return null==t&&(t=ue(4)),Po(o,t)}(0,u)):xe(n,1,function QC(n,o,t){return null==t&&(t=ue(8)),Co(o,t)}(0,u)),!0}function n2(n,o,t,r){var i=rr(),a=t.SheetNames[n],s=t.Sheets[a]||{},l=a;try{t&&t.Workbook&&(l=t.Workbook.Sheets[n].CodeName||l)}catch{}var u=Dt(s["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(o.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],xe(i,129),(t.vbaraw||s["!outline"])&&xe(i,147,function qC(n,o,t){null==t&&(t=ue(84+4*n.length));var r=192;o&&(o.above&&(r&=-65),o.left&&(r&=-129)),t.write_shift(1,r);for(var i=1;i<3;++i)t.write_shift(1,0);return pc({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),Au(n,t),t.slice(0,t.l)}(l,s["!outline"])),xe(i,148,XC(u)),function e2(n,o,t){xe(n,133),xe(n,137,function $v(n,o,t){null==t&&(t=ue(30));var r=924;return(((o||{}).Views||[])[0]||{}).RTL&&(r|=32),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}(0,t)),xe(n,138),xe(n,134)}(i,0,t.Workbook),function qv(n,o){!o||!o["!cols"]||(xe(n,390),o["!cols"].forEach(function(t,r){t&&xe(n,60,function Dv(n,o,t){null==t&&(t=ue(18));var r=Sc(n,o);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,256*(r.width||10)),t.write_shift(4,0);var i=0;return o.hidden&&(i|=1),"number"==typeof r.width&&(i|=2),o.level&&(i|=o.level<<8),t.write_shift(2,i),t}(r,t))}),xe(n,391))}(i,s),function Hv(n,o,t,r){var i=Dt(o["!ref"]||"A1"),s="",l=[];xe(n,145);var u=Array.isArray(o),p=i.e.r;o["!rows"]&&(p=Math.max(i.e.r,o["!rows"].length-1));for(var f=i.s.r;f<=p;++f){s=mn(f),VC(n,o,i,f);var h=!1;if(f<=i.e.r)for(var _=i.s.c;_<=i.e.c;++_){f===i.s.r&&(l[_]=nn(_));var C=u?(o[f]||[])[_]:o[l[_]+s];h=!!C&&Xv(n,C,f,_,r,o,h)}}xe(n,146)}(i,s,0,o),function t2(n,o){o["!protect"]&&xe(n,535,function Uv(n,o){return null==o&&(o=ue(66)),o.write_shift(2,n.password?_d(n.password):0),o.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){o.write_shift(4,t[1]?null==n[t[0]]||n[t[0]]?0:1:null!=n[t[0]]&&n[t[0]]?0:1)}),o}(o["!protect"]))}(i,s),function Kv(n,o,t,r){if(o["!autofilter"]){var i=o["!autofilter"],a="string"==typeof i.ref?i.ref:bt(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,l=ir(a);l.s.r==l.e.r&&(l.e.r=ir(o["!ref"]).e.r,a=bt(l));for(var u=0;u<s.length;++u){var p=s[u];if("_xlnm._FilterDatabase"==p.Name&&p.Sheet==r){p.Ref="'"+t.SheetNames[r]+"'!"+a;break}}u==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+a}),xe(n,161,Zo(Dt(a))),xe(n,162)}}(i,s,t,n),function Wv(n,o){!o||!o["!merges"]||(xe(n,177,function Sv(n,o){return null==o&&(o=ue(4)),o.write_shift(4,n),o}(o["!merges"].length)),o["!merges"].forEach(function(t){xe(n,176,Ev(t))}),xe(n,178))}(i,s),function Qv(n,o,t){o["!links"].forEach(function(r){if(r[1].Target){var i=zt(t,-1,r[1].Target.replace(/#.*$/,""),kt.HLINK);xe(n,494,function Iv(n,o){var t=ue(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));Zo({s:Cn(n[0]),e:Cn(n[0])},t),rd("rId"+o,t);var r=n[1].Target.indexOf("#");return jn((-1==r?"":n[1].Target.slice(r+1))||"",t),jn(n[1].Tooltip||"",t),jn("",t),t.slice(0,t.l)}(r,i))}}),delete o["!links"]}(i,s,r),s["!margins"]&&xe(i,476,function Bv(n,o){return null==o&&(o=ue(48)),So(n),dp.forEach(function(t){ko(n[t],o)}),o}(s["!margins"])),(!o||o.ignoreEC||null==o.ignoreEC)&&function Zv(n,o){!o||!o["!ref"]||(xe(n,648),xe(n,649,function Gv(n){var o=ue(24);return o.write_shift(4,4),o.write_shift(4,1),Zo(n,o),o}(Dt(o["!ref"]))),xe(n,650))}(i,s),function Jv(n,o,t,r){if(o["!comments"].length>0){var i=zt(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",kt.VML);xe(n,551,rd("rId"+i)),o["!legacy"]=i}}(i,s,n,r),xe(i,130),i.end()}var Ed=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],f2="][*?/\\".split("");function fp(n,o){if(n.length>31){if(o)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var t=!0;return f2.forEach(function(r){if(-1!=n.indexOf(r)){if(!o)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");t=!1}}),t}function hp(n){var o=[fn];o[o.length]=we("workbook",null,{xmlns:Yi[0],"xmlns:r":yn.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(Ed.forEach(function(l){null!=n.Workbook.WBProps[l[0]]&&n.Workbook.WBProps[l[0]]!=l[1]&&(r[l[0]]=n.Workbook.WBProps[l[0]])}),n.Workbook.WBProps.CodeName&&(r.codeName=n.Workbook.WBProps.CodeName,delete r.CodeName)),o[o.length]=we("workbookPr",null,r);var i=n.Workbook&&n.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(o[o.length]="<bookViews>",a=0;a!=n.SheetNames.length&&i[a]&&i[a].Hidden;++a);a==n.SheetNames.length&&(a=0),o[o.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',o[o.length]="</bookViews>"}for(o[o.length]="<sheets>",a=0;a!=n.SheetNames.length;++a){var s={name:Xt(n.SheetNames[a].slice(0,31))};if(s.sheetId=""+(a+1),s["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden"}o[o.length]=we("sheet",null,s)}return o[o.length]="</sheets>",t&&(o[o.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(l){var u={name:l.Name};l.Comment&&(u.comment=l.Comment),null!=l.Sheet&&(u.localSheetId=""+l.Sheet),l.Hidden&&(u.hidden="1"),l.Ref&&(o[o.length]=we("definedName",Xt(l.Ref),u))}),o[o.length]="</definedNames>"),o.length>2&&(o[o.length]="</workbook>",o[1]=o[1].replace("/>",">")),o.join("")}function C2(n,o){return o||(o=ue(127)),o.write_shift(4,n.Hidden),o.write_shift(4,n.iTabID),rd(n.strRelID,o),jn(n.name.slice(0,31),o),o.length>o.l?o.slice(0,o.l):o}function E2(n,o){var t=rr();return xe(t,131),xe(t,128,function M2(n,o){o||(o=ue(127));for(var t=0;4!=t;++t)o.write_shift(4,0);return jn("SheetJS",o),jn(Ii.version,o),jn(Ii.version,o),jn("7262",o),o.length>o.l?o.slice(0,o.l):o}()),xe(t,153,function P2(n,o){o||(o=ue(72));var t=0;return n&&n.filterPrivacy&&(t|=8),o.write_shift(4,t),o.write_shift(4,0),Au(n&&n.CodeName||"ThisWorkbook",o),o.slice(0,o.l)}(n.Workbook&&n.Workbook.WBProps||null)),function F2(n,o){if(o.Workbook&&o.Workbook.Sheets){for(var t=o.Workbook.Sheets,r=0,i=-1,a=-1;r<t.length;++r)!t[r]||!t[r].Hidden&&-1==i?i=r:1==t[r].Hidden&&-1==a&&(a=r);a>i||(xe(n,135),xe(n,158,function w2(n,o){return o||(o=ue(29)),o.write_shift(-4,0),o.write_shift(-4,460),o.write_shift(4,28800),o.write_shift(4,17600),o.write_shift(4,500),o.write_shift(4,n),o.write_shift(4,n),o.write_shift(1,120),o.length>o.l?o.slice(0,o.l):o}(i)),xe(n,136))}}(t,n),function y2(n,o){xe(n,143);for(var t=0;t!=o.SheetNames.length;++t)xe(n,156,C2({Hidden:o.Workbook&&o.Workbook.Sheets&&o.Workbook.Sheets[t]&&o.Workbook.Sheets[t].Hidden||0,iTabID:t+1,strRelID:"rId"+(t+1),name:o.SheetNames[t]}));xe(n,144)}(t,n),xe(t,132),t.end()}function z2(n,o,t,r,i){return(".bin"===o.slice(-4)?n2:cp)(n,t,r,i)}function X2(n,o,t){return(".bin"===o.slice(-4)?F_:Hg)(n,t)}function Cp(n){return we("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+kd(n.Ref,{r:0,c:0})})}function cP(n,o,t,r,i,a,s){if(!n||null==n.v&&null==n.f)return"";var l={};if(n.f&&(l["ss:Formula"]="="+Xt(kd(n.f,s))),n.F&&n.F.slice(0,o.length)==o){var u=Cn(n.F.slice(o.length+1));l["ss:ArrayRange"]="RC:R"+(u.r==s.r?"":"["+(u.r-s.r)+"]")+"C"+(u.c==s.c?"":"["+(u.c-s.c)+"]")}if(n.l&&n.l.Target&&(l["ss:HRef"]=Xt(n.l.Target),n.l.Tooltip&&(l["x:HRefScreenTip"]=Xt(n.l.Tooltip))),t["!merges"])for(var p=t["!merges"],f=0;f!=p.length;++f)p[f].s.c!=s.c||p[f].s.r!=s.r||(p[f].e.c>p[f].s.c&&(l["ss:MergeAcross"]=p[f].e.c-p[f].s.c),p[f].e.r>p[f].s.r&&(l["ss:MergeDown"]=p[f].e.r-p[f].s.r));var h="",_="";switch(n.t){case"z":if(!r.sheetStubs)return"";break;case"n":h="Number",_=String(n.v);break;case"b":h="Boolean",_=n.v?"1":"0";break;case"e":h="Error",_=Pi[n.v];break;case"d":h="DateTime",_=new Date(n.v).toISOString(),null==n.z&&(n.z=n.z||tt[14]);break;case"s":h="String",_=function E0(n){return(n+"").replace(Gl,function(t){return $l[t]}).replace(du,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}(n.v||"")}var C=Zi(r.cellXfs,n,r);l["ss:StyleID"]="s"+(21+C),l["ss:Index"]=s.c+1;var x="z"==n.t?"":'<Data ss:Type="'+h+'">'+(null!=n.v?_:"")+"</Data>";return(n.c||[]).length>0&&(x+=function sP(n){return n.map(function(o){var t=function S0(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}(o.t||""),r=we("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return we("Comment",r,{"ss:Author":o.a})}).join("")}(n.c)),we("Cell",x,l)}function lP(n,o){var t='<Row ss:Index="'+(n+1)+'"';return o&&(o.hpt&&!o.hpx&&(o.hpx=Oc(o.hpt)),o.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+o.hpx+'"'),o.hidden&&(t+=' ss:Hidden="1"')),t+">"}function uP(n,o,t){var r=[],a=t.Sheets[t.SheetNames[n]],s=a?function oP(n,o,t,r){if(!n||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,a=[],s=0;s<i.length;++s){var l=i[s];l.Sheet==t&&(l.Name.match(/^_xlfn\./)||a.push(Cp(l)))}return a.join("")}(a,0,n,t):"";return s.length>0&&r.push("<Names>"+s+"</Names>"),s=a?function dP(n,o,t,r){if(!n["!ref"])return"";var i=Dt(n["!ref"]),a=n["!merges"]||[],s=0,l=[];n["!cols"]&&n["!cols"].forEach(function(k,F){Wi(k);var S=!!k.width,w=Sc(F,k),W={"ss:Index":F+1};S&&(W["ss:Width"]=Va(w.width)),k.hidden&&(W["ss:Hidden"]="1"),l.push(we("Column",null,W))});for(var u=Array.isArray(n),p=i.s.r;p<=i.e.r;++p){for(var f=[lP(p,(n["!rows"]||[])[p])],h=i.s.c;h<=i.e.c;++h){var _=!1;for(s=0;s!=a.length;++s)if(!(a[s].s.c>h||a[s].s.r>p||a[s].e.c<h||a[s].e.r<p)){(a[s].s.c!=h||a[s].s.r!=p)&&(_=!0);break}if(!_){var C={r:p,c:h},P=pt(C);f.push(cP(u?(n[p]||[])[h]:n[P],P,n,o,0,0,C))}}f.push("</Row>"),f.length>2&&l.push(f.join(""))}return l.join("")}(a,o):"",s.length>0&&r.push("<Table>"+s+"</Table>"),r.push(function aP(n,o,t,r){if(!n)return"";var i=[];if(n["!margins"]&&(i.push("<PageSetup>"),n["!margins"].header&&i.push(we("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&i.push(we("Footer",null,{"x:Margin":n["!margins"].footer})),i.push(we("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t])if(r.Workbook.Sheets[t].Hidden)i.push(we("Visible",1==r.Workbook.Sheets[t].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<t&&(!r.Workbook.Sheets[a]||r.Workbook.Sheets[a].Hidden);++a);a==t&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),n["!protect"]&&(i.push($n("ProtectContents","True")),n["!protect"].objects&&i.push($n("ProtectObjects","True")),n["!protect"].scenarios&&i.push($n("ProtectScenarios","True")),null==n["!protect"].selectLockedCells||n["!protect"].selectLockedCells?null!=n["!protect"].selectUnlockedCells&&!n["!protect"].selectUnlockedCells&&i.push($n("EnableSelection","UnlockedCells")):i.push($n("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){n["!protect"][s[0]]&&i.push("<"+s[1]+"/>")})),0==i.length?"":we("WorksheetOptions",i.join(""),{xmlns:kr.x})}(a,0,n,t)),r.join("")}function gP(n,o){o||(o={}),n.SSF||(n.SSF=Qt(tt)),n.SSF&&(Zt(),zi(n.SSF),o.revssf=sc(n.SSF),o.revssf[n.SSF[65535]]=0,o.ssf=n.SSF,o.cellXfs=[],Zi(o.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(function tP(n,o){var t=[];return n.Props&&t.push(function Sf(n,o){var t=[];return gn(ud).map(function(r){for(var i=0;i<bi.length;++i)if(bi[i][1]==r)return bi[i];for(i=0;i<yo.length;++i)if(yo[i][1]==r)return yo[i];throw r}).forEach(function(r){if(null!=n[r[1]]){var i=o&&o.Props&&null!=o.Props[r[1]]?o.Props[r[1]]:n[r[1]];"date"===r[2]&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof i?i=String(i):!0===i||!1===i?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push($n(ud[r[1]]||r[1],i))}}),we("DocumentProperties",t.join(""),{xmlns:kr.o})}(n.Props,o)),n.Custprops&&t.push(function Tf(n,o){var t=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return n&&gn(n).forEach(function(a){if(Object.prototype.hasOwnProperty.call(n,a)){for(var s=0;s<bi.length;++s)if(a==bi[s][1])return;for(s=0;s<yo.length;++s)if(a==yo[s][1])return;for(s=0;s<t.length;++s)if(a==t[s])return;var l=n[a],u="string";"number"==typeof l?(u="float",l=String(l)):!0===l||!1===l?(u="boolean",l=l?"1":"0"):l=String(l),i.push(we(lu(a),l,{"dt:dt":u}))}}),o&&gn(o).forEach(function(a){if(Object.prototype.hasOwnProperty.call(o,a)&&(!n||!Object.prototype.hasOwnProperty.call(n,a))){var s=o[a],l="string";"number"==typeof s?(l="float",s=String(s)):!0===s||!1===s?(l="boolean",s=s?"1":"0"):s instanceof Date?(l="dateTime.tz",s=s.toISOString()):s=String(s),i.push(we(lu(a),s,{"dt:dt":l}))}}),"<"+r+' xmlns="'+kr.o+'">'+i.join("")+"</"+r+">"}(n.Props,n.Custprops)),t.join("")}(n,o)),t.push(""),t.push(""),t.push("");for(var r=0;r<n.SheetNames.length;++r)t.push(we("Worksheet",uP(r,o,n),{"ss:Name":Xt(n.SheetNames[r])}));return t[2]=function rP(n,o){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return o.cellXfs.forEach(function(r,i){var a=[];a.push(we("NumberFormat",null,{"ss:Format":Xt(tt[r.numFmtId])}));var s={"ss:ID":"s"+(21+i)};t.push(we("Style",a.join(""),s))}),we("Styles",t.join(""))}(0,o),t[3]=function iP(n){if(!((n||{}).Workbook||{}).Names)return"";for(var o=n.Workbook.Names,t=[],r=0;r<o.length;++r){var i=o[r];null==i.Sheet&&(i.Name.match(/^_xlfn\./)||t.push(Cp(i)))}return we("Names",t.join(""))}(n),fn+we("Workbook",t.join(""),{xmlns:kr.ss,"xmlns:o":kr.o,"xmlns:x":kr.x,"xmlns:ss":kr.ss,"xmlns:dt":kr.dt,"xmlns:html":kr.html})}var Ka={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};var es={0:{f:function UC(n,o){var t={},r=n.l+o;t.r=n.read_shift(4),n.l+=4;var i=n.read_shift(2);n.l+=1;var a=n.read_shift(1);return n.l=r,7&a&&(t.level=7&a),16&a&&(t.hidden=!0),32&a&&(t.hpt=i/20),t}},1:{f:function ZC(n){return[Rr(n)]}},2:{f:function mv(n){return[Rr(n),id(n),"n"]}},3:{f:function iv(n){return[Rr(n),n.read_shift(1),"e"]}},4:{f:function ev(n){return[Rr(n),n.read_shift(1),"b"]}},5:{f:function gv(n){return[Rr(n),Xn(n),"n"]}},6:{f:function vv(n){return[Rr(n),Yn(n),"str"]}},7:{f:function cv(n){return[Rr(n),n.read_shift(4),"s"]}},8:{f:function wv(n,o,t){var r=n.l+o,i=Rr(n);i.r=t["!row"];var s=[i,Yn(n),"str"];if(t.cellFormula){n.l+=2;var l=Fc(n,r-n.l,t);s[3]=qn(l,0,i,t.supbooks,t)}else n.l=r;return s}},9:{f:function Mv(n,o,t){var r=n.l+o,i=Rr(n);i.r=t["!row"];var s=[i,Xn(n),"n"];if(t.cellFormula){n.l+=2;var l=Fc(n,r-n.l,t);s[3]=qn(l,0,i,t.supbooks,t)}else n.l=r;return s}},10:{f:function Ov(n,o,t){var r=n.l+o,i=Rr(n);i.r=t["!row"];var s=[i,n.read_shift(1),"b"];if(t.cellFormula){n.l+=2;var l=Fc(n,r-n.l,t);s[3]=qn(l,0,i,t.supbooks,t)}else n.l=r;return s}},11:{f:function yv(n,o,t){var r=n.l+o,i=Rr(n);i.r=t["!row"];var s=[i,n.read_shift(1),"e"];if(t.cellFormula){n.l+=2;var l=Fc(n,r-n.l,t);s[3]=qn(l,0,i,t.supbooks,t)}else n.l=r;return s}},12:{f:function JC(n){return[vo(n)]}},13:{f:function _v(n){return[vo(n),id(n),"n"]}},14:{f:function av(n){return[vo(n),n.read_shift(1),"e"]}},15:{f:function nv(n){return[vo(n),n.read_shift(1),"b"]}},16:{f:function lp(n){return[vo(n),Xn(n),"n"]}},17:{f:function bv(n){return[vo(n),Yn(n),"str"]}},18:{f:function dv(n){return[vo(n),n.read_shift(4),"s"]}},19:{f:ed},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function k2(n,o,t){var r=n.l+o;n.l+=4,n.l+=1;var i=n.read_shift(4),a=nf(n),s=iC(n,0,t),l=td(n);n.l=r;var u={Name:a,Ptg:s};return i<268435455&&(u.Sheet=i),l&&(u.Comment=l),u}},40:{},42:{},43:{f:function v1(n,o,t){var r={};r.sz=n.read_shift(2)/20;var i=function af(n){var o=n.read_shift(1);return n.l++,{fBold:1&o,fItalic:2&o,fUnderline:4&o,fStrikeout:8&o,fOutline:16&o,fShadow:32&o,fCondense:64&o,fExtend:128&o}}(n);switch(i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1),700===n.read_shift(2)&&(r.bold=1),n.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var s=n.read_shift(1);0!=s&&(r.underline=s);var l=n.read_shift(1);l>0&&(r.family=l);var u=n.read_shift(1);switch(u>0&&(r.charset=u),n.l++,r.color=function of(n){var o={},r=n.read_shift(1)>>>1,i=n.read_shift(1),a=n.read_shift(2,"i"),s=n.read_shift(1),l=n.read_shift(1),u=n.read_shift(1);switch(n.l++,r){case 0:o.auto=1;break;case 1:o.index=i;var p=Oo[i];p&&(o.rgb=za(p));break;case 2:o.rgb=za([s,l,u]);break;case 3:o.theme=i}return 0!=a&&(o.tint=a>0?a/32767:a/32768),o}(n),n.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=Yn(n),r}},44:{f:function x1(n,o){return[n.read_shift(2),Yn(n)]}},45:{f:k1},46:{f:y1},47:{f:function O1(n,o){var t=n.l+o,r=n.read_shift(2),i=n.read_shift(2);return n.l=t,{ixfe:r,numFmtId:i}}},48:{},49:{f:function q0(n){return n.read_shift(4,"i")}},50:{},51:{f:function o_(n){for(var o=[],t=n.read_shift(4);t-- >0;)o.push([n.read_shift(4),n.read_shift(4)]);return o}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:function wg(n,o,t){if(!t.cellStyles)return Vn(n,o);var r=t&&t.biff>=12?4:2,i=n.read_shift(r),a=n.read_shift(r),s=n.read_shift(r),l=n.read_shift(r),u=n.read_shift(2);2==r&&(n.l+=2);var p={s:i,e:a,w:s,ixfe:l,flags:u};return(t.biff>=5||!t.biff)&&(p.level=u>>8&7),p}},62:{f:function Cv(n){return[Rr(n),ed(n),"is"]}},63:{f:function f_(n){var o={};o.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),o.r=pt(t);var r=n.read_shift(1);return 2&r&&(o.l="1"),8&r&&(o.a="1"),o}},64:{f:function zv(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Vn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function Lv(n){var o=n.read_shift(2);return n.l+=28,{RTL:32&o}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function WC(n,o){var t={},r=n[n.l];return++n.l,t.above=!(64&r),t.left=!(128&r),n.l+=18,t.name=tf(n,o-19),t}},148:{f:YC,p:16},151:{f:function Rv(){}},152:{},153:{f:function v2(n,o){var t={},r=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var i=o>8?Yn(n):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(65536&r),t.backupFile=!!(64&r),t.checkCompatibility=!!(4096&r),t.date1904=!!(1&r),t.filterPrivacy=!!(8&r),t.hidePivotFieldList=!!(1024&r),t.promptedSolutions=!!(16&r),t.publishItems=!!(2048&r),t.refreshAllConnections=!!(262144&r),t.saveExternalLinkValues=!!(128&r),t.showBorderUnselectedTables=!!(4&r),t.showInkAnnotation=!!(32&r),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(32768&r),t.updateLinks=["userSet","never","always"][r>>8&3],t}},154:{},155:{},156:{f:function x2(n,o){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=nd(n,o-8),t.name=Yn(n),t}},157:{},158:{},159:{T:1,f:function $h(n){return[n.read_shift(4),n.read_shift(4)]}},160:{T:-1},161:{T:1,f:bo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Fv},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function r_(n,o){return{flags:n.read_shift(4),version:n.read_shift(4),name:Yn(n)}}},336:{T:-1},337:{f:function c_(n){return n.l+=4,0!=n.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:nd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:function yg(n,o,t){if(t.biff<8)return function Ym(n,o,t){3==n[n.l+1]&&n[n.l]++;var r=Ga(n,0,t);return 3==r.charCodeAt(0)?r.slice(1):r}(n,0,t);for(var r=[],i=n.l+o,a=n.read_shift(t.biff>8?4:2);0!=a--;)r.push(Kf(n,0,t));if(n.l!=i)throw new Error("Bad ExternSheet: "+n.l+" != "+i);return r}},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function Nv(n,o,t){var r=n.l+o,i=ju(n),a=n.read_shift(1),s=[i];if(s[2]=a,t.cellFormula){var l=rC(n,r-n.l,t);s[1]=l}else n.l=r;return s}},427:{f:function Av(n,o,t){var r=n.l+o,a=[bo(n,16)];if(t.cellFormula){var s=oC(n,r-n.l,t);a[1]=s,n.l=r}else n.l=r;return a}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function jv(n){var o={};return dp.forEach(function(t){o[t]=Xn(n)}),o}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function HC(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function Tv(n,o){var t=n.l+o,r=bo(n,16),i=td(n),a=Yn(n),s=Yn(n),l=Yn(n);n.l=t;var u={rfx:r,relId:i,loc:a,display:l};return s&&(u.Tooltip=s),u}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:nd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:y_},633:{T:1},634:{T:-1},635:{T:1,f:function k_(n){var o={};o.iauthor=n.read_shift(4);var t=bo(n,16);return o.rfx=t.s,o.ref=pt(t.s),n.l+=16,o}},636:{T:-1},637:{f:K0},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function s2(n,o){return n.l+=10,{name:Yn(n)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function Vv(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Ie(n,o,t,r){var i=o;if(!isNaN(i)){var a=r||(t||[]).length||0,s=n.next(4);s.write_shift(2,i),s.write_shift(2,a),a>0&&Zl(t)&&n.push(t)}}function ts(n,o,t){return n||(n=ue(7)),n.write_shift(2,o),n.write_shift(2,t),n.write_shift(2,0),n.write_shift(1,0),n}function kP(n,o,t,r){if(null!=o.v)switch(o.t){case"d":case"n":var i="d"==o.t?An(ln(o.v)):o.v;return void(i==(0|i)&&i>=0&&i<65536?Ie(n,2,function Oh(n,o,t){var r=ue(9);return ts(r,n,o),r.write_shift(2,t),r}(t,r,i)):Ie(n,3,function bh(n,o,t){var r=ue(15);return ts(r,n,o),r.write_shift(8,t,"f"),r}(t,r,i)));case"b":case"e":return void Ie(n,5,function PP(n,o,t,r){var i=ue(9);return ts(i,n,o),lg(t,r||"b",i),i}(t,r,o.v,o.t));case"s":case"str":return void Ie(n,4,function bP(n,o,t){var r=ue(8+2*t.length);return ts(r,n,o),r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r.l<r.length?r.slice(0,r.l):r}(t,r,(o.v||"").slice(0,255)))}Ie(n,1,ts(null,t,r))}function IP(n,o,t,r,i){var a=16+Zi(i.cellXfs,o,i);if(null!=o.v||o.bf)if(o.bf)Ie(n,6,function nC(n,o,t,r,i){var a=Fo(o,t,i),s=function tC(n){if(null==n){var o=ue(8);return o.write_shift(1,3),o.write_shift(1,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,65535),o}return ko("number"==typeof n?n:0)}(n.v),l=ue(6);l.write_shift(2,33),l.write_shift(4,0);for(var p=ue(n.bf.length),f=0;f<n.bf.length;++f)p[f]=n.bf[f];return un([a,s,l,p])}(o,t,r,0,a));else switch(o.t){case"d":case"n":Ie(n,515,function Um(n,o,t,r){var i=ue(14);return Fo(n,o,r,i),ko(t,i),i}(t,r,"d"==o.t?An(ln(o.v)):o.v,a));break;case"b":case"e":Ie(n,517,function $m(n,o,t,r,i,a){var s=ue(8);return Fo(n,o,r,s),lg(t,a,s),s}(t,r,o.v,a,0,o.t));break;case"s":case"str":i.bookSST?Ie(n,253,function Mm(n,o,t,r){var i=ue(10);return Fo(n,o,r,i),i.write_shift(4,t),i}(t,r,wd(i.Strings,o.v,i.revStrings),a)):Ie(n,516,function Fm(n,o,t,r,i){var a=!i||8==i.biff,s=ue(+a+8+(1+a)*t.length);return Fo(n,o,r,s),s.write_shift(2,t.length),a&&s.write_shift(1,1),s.write_shift((1+a)*t.length,t,a?"utf16le":"sbcs"),s}(t,r,(o.v||"").slice(0,255),a,i));break;default:Ie(n,513,Fo(t,r,a))}else Ie(n,513,Fo(t,r,a))}function RP(n,o,t){var f,r=rr(),i=t.SheetNames[n],a=t.Sheets[i]||{},s=(t||{}).Workbook||{},l=(s.Sheets||[])[n]||{},u=Array.isArray(a),p=8==o.biff,h="",_=[],C=Dt(a["!ref"]||"A1"),P=p?65536:16384;if(C.e.c>255||C.e.r>=P){if(o.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");C.e.c=Math.min(C.e.c,255),C.e.r=Math.min(C.e.c,P-1)}Ie(r,2057,md(0,16,o)),Ie(r,13,Nr(1)),Ie(r,12,Nr(100)),Ie(r,15,or(!0)),Ie(r,17,or(!1)),Ie(r,16,ko(.001)),Ie(r,95,or(!0)),Ie(r,42,or(!1)),Ie(r,43,or(!1)),Ie(r,130,Nr(1)),Ie(r,128,function Lm(n){var o=ue(8);return o.write_shift(4,0),o.write_shift(2,n[0]?n[0]+1:0),o.write_shift(2,n[1]?n[1]+1:0),o}([0,0])),Ie(r,131,or(!1)),Ie(r,132,or(!1)),p&&function TP(n,o){if(o){var t=0;o.forEach(function(r,i){++t<=256&&r&&Ie(n,125,function gh(n,o){var t=ue(12);t.write_shift(2,o),t.write_shift(2,o),t.write_shift(2,256*n.width),t.write_shift(2,0);var r=0;return n.hidden&&(r|=1),t.write_shift(1,r),t.write_shift(1,r=n.level||0),t.write_shift(2,0),t}(Sc(i,r),i))})}}(r,a["!cols"]),Ie(r,512,function Im(n,o){var t=8!=o.biff&&o.biff?2:4,r=ue(2*t+6);return r.write_shift(t,n.s.r),r.write_shift(t,n.e.r+1),r.write_shift(2,n.s.c),r.write_shift(2,n.e.c+1),r.write_shift(2,0),r}(C,o)),p&&(a["!links"]=[]);for(var x=C.s.r;x<=C.e.r;++x){h=mn(x);for(var k=C.s.c;k<=C.e.c;++k){x===C.s.r&&(_[k]=nn(k)),f=_[k]+h;var F=u?(a[x]||[])[k]:a[f];F&&(IP(r,F,x,k,o),p&&F.l&&a["!links"].push([f,F.l]))}}var S=l.CodeName||l.name||i;return p&&Ie(r,574,function Pm(n){var o=ue(18),t=1718;return n&&n.RTL&&(t|=64),o.write_shift(2,t),o.write_shift(4,0),o.write_shift(4,64),o.write_shift(4,0),o.write_shift(4,0),o}((s.Views||[])[0])),p&&(a["!merges"]||[]).length&&Ie(r,229,function Jm(n){var o=ue(2+8*n.length);o.write_shift(2,n.length);for(var t=0;t<n.length;++t)mg(n[t],o);return o}(a["!merges"])),p&&function SP(n,o){for(var t=0;t<o["!links"].length;++t){var r=o["!links"][t];Ie(n,440,ih(r)),r[1].Tooltip&&Ie(n,2048,ah(r))}delete o["!links"]}(r,a),Ie(r,442,dg(S)),p&&function FP(n,o){var t=ue(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Ie(n,2151,t),(t=ue(39)).write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),mg(Dt(o["!ref"]||"A1"),t),t.write_shift(4,4),Ie(n,2152,t)}(r,a),Ie(r,10),r.end()}function NP(n,o,t){var r=rr(),i=(n||{}).Workbook||{},a=i.Sheets||[],s=i.WBProps||{},l=8==t.biff,u=5==t.biff;Ie(r,2057,md(0,5,t)),"xla"==t.bookType&&Ie(r,135),Ie(r,225,l?Nr(1200):null),Ie(r,193,function $f(n,o){o||(o=ue(n));for(var t=0;t<n;++t)o.write_shift(1,0);return o}(2)),u&&Ie(r,191),u&&Ie(r,192),Ie(r,226),Ie(r,92,function cm(n,o){var t=!o||8==o.biff,r=ue(t?112:54);for(r.write_shift(8==o.biff?2:1,7),t&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(t?0:536870912));r.l<r.length;)r.write_shift(1,t?0:32);return r}(0,t)),Ie(r,66,Nr(l?1200:1252)),l&&Ie(r,353,Nr(0)),l&&Ie(r,448),Ie(r,317,function mh(n){for(var o=ue(2*n),t=0;t<n;++t)o.write_shift(2,t+1);return o}(n.SheetNames.length)),l&&n.vbaraw&&Ie(r,211),l&&n.vbaraw&&Ie(r,442,dg(s.CodeName||"ThisWorkbook")),Ie(r,156,Nr(17)),Ie(r,25,or(!1)),Ie(r,18,or(!1)),Ie(r,19,Nr(0)),l&&Ie(r,431,or(!1)),l&&Ie(r,444,Nr(0)),Ie(r,61,function Cm(){var n=ue(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}()),Ie(r,64,or(!1)),Ie(r,141,Nr(0)),Ie(r,34,or("true"==function p2(n){return n.Workbook&&n.Workbook.WBProps&&function an(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}(n.Workbook.WBProps.date1904)?"true":"false"}(n))),Ie(r,14,or(!0)),l&&Ie(r,439,or(!1)),Ie(r,218,Nr(0)),function MP(n,o,t){Ie(n,49,function Om(n,o){var t=n.name||"Arial",r=o&&5==o.biff,a=ue(r?15+t.length:16+2*t.length);return a.write_shift(2,20*(n.sz||12)),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,t.length),r||a.write_shift(1,1),a.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le"),a}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},t))}(r,0,t),function wP(n,o,t){o&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)null!=o[i]&&Ie(n,1054,Sm(i,o[i],t))})}(r,n.SSF,t),function EP(n,o){for(var t=0;t<16;++t)Ie(n,224,vg({numFmtId:0,style:!0},0,o));o.cellXfs.forEach(function(r){Ie(n,224,vg(r,0,o))})}(r,t),l&&Ie(r,352,or(!1));var f=r.end(),h=rr();l&&Ie(h,140,function ch(n){return n||(n=ue(4)),n.write_shift(2,1),n.write_shift(2,1),n}()),l&&t.Strings&&function vP(n,o,t,r){var i=r||(t||[]).length||0;if(i<=8224)return Ie(n,o,t,i);var a=o;if(!isNaN(a)){for(var s=t.parts||[],l=0,u=0,p=0;p+(s[l]||8224)<=8224;)p+=s[l]||8224,l++;var f=n.next(4);for(f.write_shift(2,a),f.write_shift(2,p),n.push(t.slice(u,u+p)),u+=p;u<i;){for((f=n.next(4)).write_shift(2,60),p=0;p+(s[l]||8224)<=8224;)p+=s[l]||8224,l++;f.write_shift(2,p),n.push(t.slice(u,u+p)),u+=p}}}(h,252,function pm(n,o){var t=ue(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var r=[],i=0;i<n.length;++i)r[i]=Vf(n[i]);var a=un([t].concat(r));return a.parts=[t.length].concat(r.map(function(s){return s.length})),a}(t.Strings)),Ie(h,10);var _=h.end(),C=rr(),P=0,x=0;for(x=0;x<n.SheetNames.length;++x)P+=(l?12:11)+(l?2:1)*n.SheetNames[x].length;var k=f.length+P+_.length;for(x=0;x<n.SheetNames.length;++x)Ie(C,133,um({pos:k,hs:(a[x]||{}).Hidden||0,dt:0,name:n.SheetNames[x]},t)),k+=o[x].length;var S=C.end();if(P!=S.length)throw new Error("BS8 "+P+" != "+S.length);var w=[];return f.length&&w.push(f),S.length&&w.push(S),_.length&&w.push(_),un(w)}function Pp(n,o){for(var t=0;t<=n.SheetNames.length;++t){var r=n.Sheets[n.SheetNames[t]];r&&r["!ref"]&&ir(r["!ref"]).e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}var a=o||{};switch(a.biff||2){case 8:case 5:return function AP(n,o){var t=o||{},r=[];n&&!n.SSF&&(n.SSF=Qt(tt)),n&&n.SSF&&(Zt(),zi(n.SSF),t.revssf=sc(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ld(t),t.cellXfs=[],Zi(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var i=0;i<n.SheetNames.length;++i)r[r.length]=RP(i,t,n);return r.unshift(NP(n,r,t)),un(r)}(n,o);case 4:case 3:case 2:return function yP(n,o){var t=o||{};null!=on&&null==t.dense&&(t.dense=on);for(var r=rr(),i=0,a=0;a<n.SheetNames.length;++a)n.SheetNames[a]==t.sheet&&(i=a);if(0==i&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Ie(r,4==t.biff?1033:3==t.biff?521:9,md(0,16,t)),function OP(n,o,t,r){var s,i=Array.isArray(o),a=Dt(o["!ref"]||"A1"),l="",u=[];if(a.e.c>255||a.e.r>16383){if(r.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),s=bt(a)}for(var p=a.s.r;p<=a.e.r;++p){l=mn(p);for(var f=a.s.c;f<=a.e.c;++f){p===a.s.r&&(u[f]=nn(f)),s=u[f]+l;var h=i?(o[p]||[])[f]:o[s];h&&kP(n,h,p,f)}}}(r,n.Sheets[n.SheetNames[i]],0,t),Ie(r,10),r.end()}(n,o)}throw new Error("invalid type "+a.bookType+" for BIFF")}function kp(n,o,t,r){for(var i=n["!merges"]||[],a=[],s=o.s.c;s<=o.e.c;++s){for(var l=0,u=0,p=0;p<i.length;++p)if(!(i[p].s.r>t||i[p].s.c>s||i[p].e.r<t||i[p].e.c<s)){if(i[p].s.r<t||i[p].s.c<s){l=-1;break}l=i[p].e.r-i[p].s.r+1,u=i[p].e.c-i[p].s.c+1;break}if(!(l<0)){var f=pt({r:t,c:s}),h=r.dense?(n[t]||[])[s]:n[f],_=h&&null!=h.v&&(h.h||uu(h.w||(ri(h),h.w)||""))||"",C={};l>1&&(C.rowspan=l),u>1&&(C.colspan=u),r.editable?_='<span contenteditable="true">'+_+"</span>":h&&(C["data-t"]=h&&h.t||"z",null!=h.v&&(C["data-v"]=h.v),null!=h.z&&(C["data-z"]=h.z),h.l&&"#"!=(h.l.Target||"#").charAt(0)&&(_='<a href="'+h.l.Target+'">'+_+"</a>")),C.id=(r.id||"sjs")+"-"+f,a.push(we("td",_,C))}}return"<tr>"+a.join("")+"</tr>"}var Op='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',yp="</body></html>";function wp(n,o){var t=o||{},i=null!=t.footer?t.footer:yp,a=[null!=t.header?t.header:Op],s=ir(n["!ref"]);t.dense=Array.isArray(n),a.push(function Mp(n,o,t){return[].join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}(0,0,t));for(var l=s.s.r;l<=s.e.r;++l)a.push(kp(n,s,l,t));return a.push("</table>"+i),a.join("")}function Fp(n,o,t){var r=t||{};null!=on&&(r.dense=on);var i=0,a=0;if(null!=r.origin)if("number"==typeof r.origin)i=r.origin;else{var s="string"==typeof r.origin?Cn(r.origin):r.origin;i=s.r,a=s.c}var l=o.getElementsByTagName("tr"),u=Math.min(r.sheetRows||1e7,l.length),p={s:{r:0,c:0},e:{r:i,c:a}};if(n["!ref"]){var f=ir(n["!ref"]);p.s.r=Math.min(p.s.r,f.s.r),p.s.c=Math.min(p.s.c,f.s.c),p.e.r=Math.max(p.e.r,f.e.r),p.e.c=Math.max(p.e.c,f.e.c),-1==i&&(p.e.r=i=f.e.r+1)}var h=[],_=0,C=n["!rows"]||(n["!rows"]=[]),P=0,x=0,k=0,F=0,S=0,w=0;for(n["!cols"]||(n["!cols"]=[]);P<l.length&&x<u;++P){var W=l[P];if(Sp(W)){if(r.display)continue;C[x]={hidden:!0}}var K=W.children;for(k=F=0;k<K.length;++k){var ee=K[k];if(!r.display||!Sp(ee)){var A=ee.hasAttribute("data-v")?ee.getAttribute("data-v"):ee.hasAttribute("v")?ee.getAttribute("v"):mu(ee.innerHTML),Q=ee.getAttribute("data-z")||ee.getAttribute("z");for(_=0;_<h.length;++_){var q=h[_];q.s.c==F+a&&q.s.r<x+i&&x+i<=q.e.r&&(F=q.e.c+1-a,_=-1)}w=+ee.getAttribute("colspan")||1,((S=+ee.getAttribute("rowspan")||1)>1||w>1)&&h.push({s:{r:x+i,c:F+a},e:{r:x+i+(S||1)-1,c:F+a+(w||1)-1}});var le={t:"s",v:A},de=ee.getAttribute("data-t")||ee.getAttribute("t")||"";null!=A&&(0==A.length?le.t=de||"z":r.raw||0==A.trim().length||"s"==de||("TRUE"===A?le={t:"b",v:!0}:"FALSE"===A?le={t:"b",v:!1}:isNaN(Xr(A))?isNaN(Xo(A).getDate())||(le={t:"d",v:ln(A)},r.cellDates||(le={t:"n",v:An(le.v)}),le.z=r.dateNF||tt[14]):le={t:"n",v:Xr(A)})),void 0===le.z&&null!=Q&&(le.z=Q);var Z="",Fe=ee.getElementsByTagName("A");if(Fe&&Fe.length)for(var Ye=0;Ye<Fe.length&&(!Fe[Ye].hasAttribute("href")||"#"==(Z=Fe[Ye].getAttribute("href")).charAt(0));++Ye);Z&&"#"!=Z.charAt(0)&&(le.l={Target:Z}),r.dense?(n[x+i]||(n[x+i]=[]),n[x+i][F+a]=le):n[pt({c:F+a,r:x+i})]=le,p.e.c<F+a&&(p.e.c=F+a),F+=w}}++x}return h.length&&(n["!merges"]=(n["!merges"]||[]).concat(h)),p.e.r=Math.max(p.e.r,x-1+i),n["!ref"]=bt(p),x>=u&&(n["!fullref"]=bt((p.e.r=l.length-P+x-1+i,p))),n}function Ep(n,o){return Fp((o||{}).dense?[]:{},n,o)}function Sp(n){var o="",t=function BP(n){return n.ownerDocument.defaultView&&"function"==typeof n.ownerDocument.defaultView.getComputedStyle?n.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(n);return t&&(o=t(n).getPropertyValue("display")),o||(o=n.style&&n.style.display),"none"===o}var $P=function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),o="<office:document-styles "+Na({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return fn+o}}(),Ap=function(){var n=function(a){return Xt(a).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},o="          <table:table-cell />\n",r=function(a,s,l){var u=[];u.push('      <table:table table:name="'+Xt(s.SheetNames[l])+'" table:style-name="ta1">\n');var p=0,f=0,h=ir(a["!ref"]||"A1"),_=a["!merges"]||[],C=0,P=Array.isArray(a);if(a["!cols"])for(f=0;f<=h.e.c;++f)u.push("        <table:table-column"+(a["!cols"][f]?' table:style-name="co'+a["!cols"][f].ods+'"':"")+"></table:table-column>\n");var k=a["!rows"]||[];for(p=0;p<h.s.r;++p)u.push("        <table:table-row"+(k[p]?' table:style-name="ro'+k[p].ods+'"':"")+"></table:table-row>\n");for(;p<=h.e.r;++p){for(u.push("        <table:table-row"+(k[p]?' table:style-name="ro'+k[p].ods+'"':"")+">\n"),f=0;f<h.s.c;++f)u.push(o);for(;f<=h.e.c;++f){var F=!1,S={},w="";for(C=0;C!=_.length;++C)if(!(_[C].s.c>f||_[C].s.r>p||_[C].e.c<f||_[C].e.r<p)){(_[C].s.c!=f||_[C].s.r!=p)&&(F=!0),S["table:number-columns-spanned"]=_[C].e.c-_[C].s.c+1,S["table:number-rows-spanned"]=_[C].e.r-_[C].s.r+1;break}if(F)u.push("          <table:covered-table-cell/>\n");else{var W=pt({r:p,c:f}),K=P?(a[p]||[])[f]:a[W];if(K&&K.f&&(S["table:formula"]=Xt(cC(K.f)),K.F&&K.F.slice(0,W.length)==W)){var ee=ir(K.F);S["table:number-matrix-columns-spanned"]=ee.e.c-ee.s.c+1,S["table:number-matrix-rows-spanned"]=ee.e.r-ee.s.r+1}if(K){switch(K.t){case"b":w=K.v?"TRUE":"FALSE",S["office:value-type"]="boolean",S["office:boolean-value"]=K.v?"true":"false";break;case"n":w=K.w||String(K.v||0),S["office:value-type"]="float",S["office:value"]=K.v||0;break;case"s":case"str":w=null==K.v?"":K.v,S["office:value-type"]="string";break;case"d":w=K.w||ln(K.v).toISOString(),S["office:value-type"]="date",S["office:date-value"]=ln(K.v).toISOString(),S["table:style-name"]="ce1";break;default:u.push(o);continue}var A=n(w);if(K.l&&K.l.Target){var Q=K.l.Target;"#"!=(Q="#"==Q.charAt(0)?"#"+lC(Q.slice(1)):Q).charAt(0)&&!Q.match(/^\w+:/)&&(Q="../"+Q),A=we("text:a",A,{"xlink:href":Q.replace(/&/g,"&amp;")})}u.push("          "+we("table:table-cell",we("text:p",A,{}),S)+"\n")}else u.push(o)}}u.push("        </table:table-row>\n")}return u.push("      </table:table>\n"),u.join("")};return function(s,l){var u=[fn],p=Na({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Na({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==l.bookType?(u.push("<office:document"+p+f+">\n"),u.push(Vu().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+p+">\n"),function(a,s){a.push(" <office:automatic-styles>\n"),a.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),a.push('   <number:month number:style="long"/>\n'),a.push("   <number:text>/</number:text>\n"),a.push('   <number:day number:style="long"/>\n'),a.push("   <number:text>/</number:text>\n"),a.push("   <number:year/>\n"),a.push("  </number:date-style>\n");var l=0;s.SheetNames.map(function(p){return s.Sheets[p]}).forEach(function(p){if(p&&p["!cols"])for(var f=0;f<p["!cols"].length;++f)if(p["!cols"][f]){var h=p["!cols"][f];if(null==h.width&&null==h.wpx&&null==h.wch)continue;Wi(h),h.ods=l;var _=p["!cols"][f].wpx+"px";a.push('  <style:style style:name="co'+l+'" style:family="table-column">\n'),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_+'"/>\n'),a.push("  </style:style>\n"),++l}});var u=0;s.SheetNames.map(function(p){return s.Sheets[p]}).forEach(function(p){if(p&&p["!rows"])for(var f=0;f<p["!rows"].length;++f)if(p["!rows"][f]){p["!rows"][f].ods=u;var h=p["!rows"][f].hpx+"px";a.push('  <style:style style:name="ro'+u+'" style:family="table-row">\n'),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+'"/>\n'),a.push("  </style:style>\n"),++u}}),a.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),a.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),a.push("  </style:style>\n"),a.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),a.push(" </office:automatic-styles>\n")}(u,s),u.push("  <office:body>\n"),u.push("    <office:spreadsheet>\n");for(var h=0;h!=s.SheetNames.length;++h)u.push(r(s.Sheets[s.SheetNames[h]],s,h));return u.push("    </office:spreadsheet>\n"),u.push("  </office:body>\n"),u.push("fods"==l.bookType?"</office:document>":"</office:document-content>"),u.join("")}}();function Dp(n,o){if("fods"==o.bookType)return Ap(n,o);var t=Ll(),r="",i=[],a=[];return Ot(t,r="mimetype","application/vnd.oasis.opendocument.spreadsheet"),Ot(t,r="content.xml",Ap(n,o)),i.push([r,"text/xml"]),a.push([r,"ContentFile"]),Ot(t,r="styles.xml",$P(n,o)),i.push([r,"text/xml"]),a.push([r,"StylesFile"]),Ot(t,r="meta.xml",fn+Vu()),i.push([r,"text/xml"]),a.push([r,"MetadataFile"]),Ot(t,r="manifest.rdf",function Of(n){var o=[fn];o.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var t=0;t!=n.length;++t)o.push(zu(n[t][0],n[t][1])),o.push(kf("",n[t][0]));return o.push(zu("","Document","pkg")),o.push("</rdf:RDF>"),o.join("")}(a)),i.push([r,"application/rdf+xml"]),Ot(t,r="META-INF/manifest.xml",function bf(n){var o=[fn];o.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),o.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var t=0;t<n.length;++t)o.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+'"/>\n');return o.push("</manifest:manifest>"),o.join("")}(i)),t}function To(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function GP(n){return typeof TextEncoder<"u"?(new TextEncoder).encode(n):Rn(ni(n))}function Qi(n){var o=n.reduce(function(i,a){return i+a.length},0),t=new Uint8Array(o),r=0;return n.forEach(function(i){t.set(i,r),r+=i.length}),t}function ns(n,o){var t=o?o[0]:0,r=127&n[t];e:if(n[t++]>=128&&(r|=(127&n[t])<<7,n[t++]<128||(r|=(127&n[t])<<14,n[t++]<128)||(r|=(127&n[t])<<21,n[t++]<128)||(r+=(127&n[t])*Math.pow(2,28),++t,n[t++]<128)||(r+=(127&n[t])*Math.pow(2,35),++t,n[t++]<128)||(r+=(127&n[t])*Math.pow(2,42),++t,n[t++]<128)))break e;return o&&(o[0]=t),r}function Vt(n){var o=new Uint8Array(7);o[0]=127&n;var t=1;e:if(n>127){if(o[t-1]|=128,o[t]=n>>7&127,++t,n<=16383||(o[t-1]|=128,o[t]=n>>14&127,++t,n<=2097151)||(o[t-1]|=128,o[t]=n>>21&127,++t,n<=268435455)||(o[t-1]|=128,o[t]=n/256>>>21&127,++t,n<=34359738367)||(o[t-1]|=128,o[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;o[t-1]|=128,o[t]=n/16777216>>>21&127,++t}return o.slice(0,t)}function hn(n){var o=0,t=127&n[o];e:if(n[o++]>=128){if(t|=(127&n[o])<<7,n[o++]<128||(t|=(127&n[o])<<14,n[o++]<128)||(t|=(127&n[o])<<21,n[o++]<128))break e;t|=(127&n[o])<<28}return t}function Lt(n){for(var o=[],t=[0];t[0]<n.length;){var l,r=t[0],i=ns(n,t),a=7&i,s=0;if(0==(i=Math.floor(i/8)))break;switch(a){case 0:for(var u=t[0];n[t[0]++]>=128;);l=n.slice(u,t[0]);break;case 5:l=n.slice(t[0],t[0]+(s=4)),t[0]+=s;break;case 1:l=n.slice(t[0],t[0]+(s=8)),t[0]+=s;break;case 2:s=ns(n,t),l=n.slice(t[0],t[0]+s),t[0]+=s;break;default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(r))}var p={data:l,type:a};null==o[i]?o[i]=[p]:o[i].push(p)}return o}function Ln(n){var o=[];return n.forEach(function(t,r){t.forEach(function(i){i.data&&(o.push(Vt(8*r+i.type)),2==i.type&&o.push(Vt(i.data.length)),o.push(i.data))})}),Qi(o)}function Ar(n){for(var o,t=[],r=[0];r[0]<n.length;){var i=ns(n,r),a=Lt(n.slice(r[0],r[0]+i));r[0]+=i;var s={id:hn(a[1][0].data),messages:[]};a[2].forEach(function(l){var u=Lt(l.data),p=hn(u[3][0].data);s.messages.push({meta:u,data:n.slice(r[0],r[0]+p)}),r[0]+=p}),null!=(o=a[3])&&o[0]&&(s.merge=hn(a[3][0].data)>>>0>0),t.push(s)}return t}function na(n){var o=[];return n.forEach(function(t){var r=[];r[1]=[{data:Vt(t.id),type:0}],r[2]=[],null!=t.merge&&(r[3]=[{data:Vt(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(s){i.push(s.data),s.meta[3]=[{type:0,data:Vt(s.data.length)}],r[2].push({data:Ln(s.meta),type:2})});var a=Ln(r);o.push(Vt(a.length)),o.push(a),i.forEach(function(s){return o.push(s)})}),Qi(o)}function YP(n,o){if(0!=n)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],r=ns(o,t),i=[];t[0]<o.length;){var a=3&o[t[0]];if(0!=a){var u=0,p=0;if(1==a?(p=4+(o[t[0]]>>2&7),u=(224&o[t[0]++])<<3,u|=o[t[0]++]):(p=1+(o[t[0]++]>>2),2==a?(u=o[t[0]]|o[t[0]+1]<<8,t[0]+=2):(u=(o[t[0]]|o[t[0]+1]<<8|o[t[0]+2]<<16|o[t[0]+3]<<24)>>>0,t[0]+=4)),i=[Qi(i)],0==u)throw new Error("Invalid offset 0");if(u>i[0].length)throw new Error("Invalid offset beyond length");if(p>=u)for(i.push(i[0].slice(-u)),p-=u;p>=i[i.length-1].length;)i.push(i[i.length-1]),p-=i[i.length-1].length;i.push(i[0].slice(-u,-u+p))}else{var s=o[t[0]++]>>2;if(s<60)++s;else{var l=s-59;s=o[t[0]],l>1&&(s|=o[t[0]+1]<<8),l>2&&(s|=o[t[0]+2]<<16),l>3&&(s|=o[t[0]+3]<<24),s>>>=0,s++,t[0]+=l}i.push(o.slice(t[0],t[0]+s)),t[0]+=s}}var f=Qi(i);if(f.length!=r)throw new Error("Unexpected length: ".concat(f.length," != ").concat(r));return f}function Dr(n){for(var o=[],t=0;t<n.length;){var r=n[t++],i=n[t]|n[t+1]<<8|n[t+2]<<16;o.push(YP(r,n.slice(t+=3,t+i))),t+=i}if(t!==n.length)throw new Error("data is not a valid framed stream!");return Qi(o)}function ra(n){for(var o=[],t=0;t<n.length;){var r=Math.min(n.length-t,268435455),i=new Uint8Array(4);o.push(i);var a=Vt(r),s=a.length;o.push(a),r<=60?(s++,o.push(new Uint8Array([r-1<<2]))):r<=256?(s+=2,o.push(new Uint8Array([240,r-1&255]))):r<=65536?(s+=3,o.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(s+=4,o.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(s+=5,o.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),o.push(n.slice(t,t+r)),s+=r,i[0]=0,i[1]=255&s,i[2]=s>>8&255,i[3]=s>>16&255,t+=r}return Qi(o)}function Ad(n,o){var t=new Uint8Array(32),r=To(t),i=12,a=0;switch(t[0]=5,n.t){case"n":t[1]=2,function VP(n,o,t){var r=Math.floor(0==t?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,i=t/Math.pow(10,r-6176);n[o+15]|=r>>7,n[o+14]|=(127&r)<<1;for(var a=0;i>=1;++a,i/=256)n[o+a]=255&i;n[o+15]|=t>=0?0:128}(t,i,n.v),a|=1,i+=16;break;case"b":t[1]=6,r.setFloat64(i,n.v?1:0,!0),a|=2,i+=8;break;case"s":if(-1==o.indexOf(n.v))throw new Error("Value ".concat(n.v," missing from SST!"));t[1]=3,r.setUint32(i,o.indexOf(n.v),!0),a|=8,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(8,a,!0),t.slice(0,i)}function Dd(n,o){var t=new Uint8Array(32),r=To(t),i=12,a=0;switch(t[0]=3,n.t){case"n":t[2]=2,r.setFloat64(i,n.v,!0),a|=32,i+=8;break;case"b":t[2]=6,r.setFloat64(i,n.v?1:0,!0),a|=32,i+=8;break;case"s":if(-1==o.indexOf(n.v))throw new Error("Value ".concat(n.v," missing from SST!"));t[2]=3,r.setUint32(i,o.indexOf(n.v),!0),a|=16,i+=4;break;default:throw"unsupported cell type "+n.t}return r.setUint32(4,a,!0),t.slice(0,i)}function Zn(n){return ns(Lt(n)[1][0].data)}function tb(n,o,t){var r,i,a,s;if(null==(r=n[6])||!r[0]||null==(i=n[7])||!i[0])throw"Mutation only works on post-BNC storages!";if((null==(s=null==(a=n[8])?void 0:a[0])?void 0:s.data)&&hn(n[8][0].data)>0)throw"Math only works with normal offsets";for(var u=0,p=To(n[7][0].data),f=0,h=[],_=To(n[4][0].data),C=0,P=[],x=0;x<o.length;++x)if(null!=o[x]){var k,F;switch(p.setUint16(2*x,f,!0),_.setUint16(2*x,C,!0),typeof o[x]){case"string":k=Ad({t:"s",v:o[x]},t),F=Dd({t:"s",v:o[x]},t);break;case"number":k=Ad({t:"n",v:o[x]},t),F=Dd({t:"n",v:o[x]},t);break;case"boolean":k=Ad({t:"b",v:o[x]},t),F=Dd({t:"b",v:o[x]},t);break;default:throw new Error("Unsupported value "+o[x])}h.push(k),f+=k.length,P.push(F),C+=F.length,++u}else p.setUint16(2*x,65535,!0),_.setUint16(2*x,65535);for(n[2][0].data=Vt(u);x<n[7][0].data.length/2;++x)p.setUint16(2*x,65535,!0),_.setUint16(2*x,65535,!0);return n[6][0].data=Qi(h),n[3][0].data=Qi(P),u}function Ld(n){!function Lp(n){return function(t){for(var r=0;r!=n.length;++r){var i=n[r];void 0===t[i[0]]&&(t[i[0]]=i[1]),"n"===i[2]&&(t[i[0]]=Number(t[i[0]]))}}}([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function cb(n,o){return"ods"==o.bookType?Dp(n,o):"numbers"==o.bookType?function nb(n,o){if(!o||!o.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=ir(t["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(bt(r)));var a=Nc(t,{range:r,header:1}),s=["~Sh33tJ5~"];a.forEach(function(Y){return Y.forEach(function(V){"string"==typeof V&&s.push(V)})});var l={},u=[],p=nt.read(o.numbers,{type:"base64"});p.FileIndex.map(function(Y,V){return[Y,p.FullPaths[V]]}).forEach(function(Y){var V=Y[0],he=Y[1];2==V.type&&V.name.match(/\.iwa/)&&Ar(Dr(V.content)).forEach(function(ve){u.push(ve.id),l[ve.id]={deps:[],location:he,type:hn(ve.messages[0].meta[1][0].data)}})}),u.sort(function(Y,V){return Y-V});var f=u.filter(function(Y){return Y>1}).map(function(Y){return[Y,Vt(Y)]});p.FileIndex.map(function(Y,V){return[Y,p.FullPaths[V]]}).forEach(function(Y){var V=Y[0];V.name.match(/\.iwa/)&&Ar(Dr(V.content)).forEach(function(Se){Se.messages.forEach(function(Te){f.forEach(function(ve){Se.messages.some(function(yt){return 11006!=hn(yt.meta[1][0].data)&&function UP(n,o){e:for(var t=0;t<=n.length-o.length;++t){for(var r=0;r<o.length;++r)if(n[t+r]!=o[r])continue e;return!0}return!1}(yt.data,ve[1])})&&l[ve[0]].deps.push(Se.id)})})})});for(var P,_=nt.find(p,l[1].location),C=Ar(Dr(_.content)),x=0;x<C.length;++x){var k=C[x];1==k.id&&(P=k)}var F=Zn(Lt(P.messages[0].data)[1][0].data);for(C=Ar(Dr((_=nt.find(p,l[F].location)).content)),x=0;x<C.length;++x)(k=C[x]).id==F&&(P=k);for(F=Zn(Lt(P.messages[0].data)[2][0].data),C=Ar(Dr((_=nt.find(p,l[F].location)).content)),x=0;x<C.length;++x)(k=C[x]).id==F&&(P=k);for(F=Zn(Lt(P.messages[0].data)[2][0].data),C=Ar(Dr((_=nt.find(p,l[F].location)).content)),x=0;x<C.length;++x)(k=C[x]).id==F&&(P=k);var S=Lt(P.messages[0].data);S[6][0].data=Vt(r.e.r+1),S[7][0].data=Vt(r.e.c+1);for(var w=Zn(S[46][0].data),W=nt.find(p,l[w].location),K=Ar(Dr(W.content)),ee=0;ee<K.length&&K[ee].id!=w;++ee);if(K[ee].id!=w)throw"Bad ColumnRowUIDMapArchive";var A=Lt(K[ee].messages[0].data);A[1]=[],A[2]=[],A[3]=[];for(var Q=0;Q<=r.e.c;++Q){var q=[];q[1]=q[2]=[{type:0,data:Vt(Q+420690)}],A[1].push({type:2,data:Ln(q)}),A[2].push({type:0,data:Vt(Q)}),A[3].push({type:0,data:Vt(Q)})}A[4]=[],A[5]=[],A[6]=[];for(var le=0;le<=r.e.r;++le)(q=[])[1]=q[2]=[{type:0,data:Vt(le+726270)}],A[4].push({type:2,data:Ln(q)}),A[5].push({type:0,data:Vt(le)}),A[6].push({type:0,data:Vt(le)});K[ee].messages[0].data=Ln(A),W.content=ra(na(K)),W.size=W.content.length,delete S[46];var de=Lt(S[4][0].data);de[7][0].data=Vt(r.e.r+1);var Fe=Zn(Lt(de[1][0].data)[2][0].data);if((K=Ar(Dr((W=nt.find(p,l[Fe].location)).content)))[0].id!=Fe)throw"Bad HeaderStorageBucket";var Ye=Lt(K[0].messages[0].data);for(le=0;le<a.length;++le){var De=Lt(Ye[2][0].data);De[1][0].data=Vt(le),De[4][0].data=Vt(a[le].length),Ye[2][le]={type:Ye[2][0].type,data:Ln(De)}}K[0].messages[0].data=Ln(Ye),W.content=ra(na(K)),W.size=W.content.length;var ct=Zn(de[2][0].data);if((K=Ar(Dr((W=nt.find(p,l[ct].location)).content)))[0].id!=ct)throw"Bad HeaderStorageBucket";for(Ye=Lt(K[0].messages[0].data),Q=0;Q<=r.e.c;++Q)(De=Lt(Ye[2][0].data))[1][0].data=Vt(Q),De[4][0].data=Vt(r.e.r+1),Ye[2][Q]={type:Ye[2][0].type,data:Ln(De)};K[0].messages[0].data=Ln(Ye),W.content=ra(na(K)),W.size=W.content.length;var Qe=Zn(de[4][0].data);!function(){for(var he,Y=nt.find(p,l[Qe].location),V=Ar(Dr(Y.content)),Be=0;Be<V.length;++Be){var Se=V[Be];Se.id==Qe&&(he=Se)}var Te=Lt(he.messages[0].data);Te[3]=[];var ve=[];s.forEach(function(Ht,Tt){ve[1]=[{type:0,data:Vt(Tt)}],ve[2]=[{type:0,data:Vt(1)}],ve[3]=[{type:2,data:GP(Ht)}],Te[3].push({type:2,data:Ln(ve)})}),he.messages[0].data=Ln(Te);var G=ra(na(V));Y.content=G,Y.size=Y.content.length}();var St=Lt(de[3][0].data),$e=St[1][0];delete St[2];var ft=Lt($e.data),ke=Zn(ft[2][0].data);!function(){for(var he,Y=nt.find(p,l[ke].location),V=Ar(Dr(Y.content)),Be=0;Be<V.length;++Be){var Se=V[Be];Se.id==ke&&(he=Se)}var Te=Lt(he.messages[0].data);delete Te[6],delete St[7];var ve=new Uint8Array(Te[5][0].data);Te[5]=[];for(var yt=0,G=0;G<=r.e.r;++G){var Ht=Lt(ve);yt+=tb(Ht,a[G],s),Ht[1][0].data=Vt(G),Te[5].push({data:Ln(Ht),type:2})}Te[1]=[{type:0,data:Vt(r.e.c+1)}],Te[2]=[{type:0,data:Vt(r.e.r+1)}],Te[3]=[{type:0,data:Vt(yt)}],Te[4]=[{type:0,data:Vt(r.e.r+1)}],he.messages[0].data=Ln(Te);var Wt=ra(na(V));Y.content=Wt,Y.size=Y.content.length}(),$e.data=Ln(ft),de[3][0].data=Ln(St),S[4][0].data=Ln(de),P.messages[0].data=Ln(S);var se=ra(na(C));return _.content=se,_.size=_.content.length,p}(n,o):"xlsb"==o.bookType?function lb(n,o){Ko=1024,n&&!n.SSF&&(n.SSF=Qt(tt)),n&&n.SSF&&(Zt(),zi(n.SSF),o.revssf=sc(n.SSF),o.revssf[n.SSF[65535]]=0,o.ssf=n.SSF),o.rels={},o.wbrels={},o.Strings=[],o.Strings.Count=0,o.Strings.Unique=0,Qa?o.revStrings=new Map:(o.revStrings={},o.revStrings.foo=[],delete o.revStrings.foo);var t="xlsb"==o.bookType?"bin":"xml",r=Wg.indexOf(o.bookType)>-1,i={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Ld(o=o||{});var a=Ll(),s="",l=0;if(o.cellXfs=[],Zi(o.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),Ot(a,s="docProps/core.xml",Xu(n.Props,o)),i.coreprops.push(s),zt(o.rels,2,s,kt.CORE_PROPS),s="docProps/app.xml",!n.Props||!n.Props.SheetNames)if(n.Workbook&&n.Workbook.Sheets){for(var u=[],p=0;p<n.SheetNames.length;++p)2!=(n.Workbook.Sheets[p]||{}).Hidden&&u.push(n.SheetNames[p]);n.Props.SheetNames=u}else n.Props.SheetNames=n.SheetNames;for(n.Props.Worksheets=n.Props.SheetNames.length,Ot(a,s,qu(n.Props)),i.extprops.push(s),zt(o.rels,3,s,kt.EXT_PROPS),n.Custprops!==n.Props&&gn(n.Custprops||{}).length>0&&(Ot(a,s="docProps/custom.xml",Zu(n.Custprops)),i.custprops.push(s),zt(o.rels,4,s,kt.CUST_PROPS)),l=1;l<=n.SheetNames.length;++l){var f={"!id":{}},h=n.Sheets[n.SheetNames[l-1]];if(Ot(a,s="xl/worksheets/sheet"+l+"."+t,z2(l-1,s,o,n,f)),i.sheets.push(s),zt(o.wbrels,-1,"worksheets/sheet"+l+"."+t,kt.WS[0]),h){var C=h["!comments"],P=!1,x="";C&&C.length>0&&(Ot(a,x="xl/comments"+l+"."+t,X2(C,x,o)),i.comments.push(x),zt(f,-1,"../comments"+l+"."+t,kt.CMNT),P=!0),h["!legacy"]&&P&&Ot(a,"xl/drawings/vmlDrawing"+l+".vml",Yg(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Ot(a,La(s),Qo(f))}return null!=o.Strings&&o.Strings.length>0&&(Ot(a,s="xl/sharedStrings."+t,function Y2(n,o,t){return(".bin"===o.slice(-4)?Vh:Ig)(n,t)}(o.Strings,s,o)),i.strs.push(s),zt(o.wbrels,-1,"sharedStrings."+t,kt.SST)),Ot(a,s="xl/workbook."+t,function U2(n,o,t){return(".bin"===o.slice(-4)?E2:hp)(n,t)}(n,s,o)),i.workbooks.push(s),zt(o.rels,1,s,kt.WB),Ot(a,s="xl/theme/theme1.xml",Pd(n.Themes,o)),i.themes.push(s),zt(o.wbrels,-1,"theme/theme1.xml",kt.THEME),Ot(a,s="xl/styles."+t,function V2(n,o,t){return(".bin"===o.slice(-4)?L1:$g)(n,t)}(n,s,o)),i.styles.push(s),zt(o.wbrels,-1,"styles."+t,kt.STY),n.vbaraw&&r&&(Ot(a,s="xl/vbaProject.bin",n.vbaraw),i.vba.push(s),zt(o.wbrels,-1,"vbaProject.bin",kt.VBA)),Ot(a,s="xl/metadata."+t,function H2(n){return(".bin"===n.slice(-4)?u_:Vg)()}(s)),i.metadata.push(s),zt(o.wbrels,-1,"metadata."+t,kt.XLMETA),Ot(a,"[Content_Types].xml",Uu(i,o)),Ot(a,"_rels/.rels",Qo(o.rels)),Ot(a,"xl/_rels/workbook."+t+".rels",Qo(o.wbrels)),delete o.revssf,delete o.ssf,a}(n,o):function $p(n,o){Ko=1024,n&&!n.SSF&&(n.SSF=Qt(tt)),n&&n.SSF&&(Zt(),zi(n.SSF),o.revssf=sc(n.SSF),o.revssf[n.SSF[65535]]=0,o.ssf=n.SSF),o.rels={},o.wbrels={},o.Strings=[],o.Strings.Count=0,o.Strings.Unique=0,Qa?o.revStrings=new Map:(o.revStrings={},o.revStrings.foo=[],delete o.revStrings.foo);var t="xml",r=Wg.indexOf(o.bookType)>-1,i={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Ld(o=o||{});var a=Ll(),s="",l=0;if(o.cellXfs=[],Zi(o.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),Ot(a,s="docProps/core.xml",Xu(n.Props,o)),i.coreprops.push(s),zt(o.rels,2,s,kt.CORE_PROPS),s="docProps/app.xml",!n.Props||!n.Props.SheetNames)if(n.Workbook&&n.Workbook.Sheets){for(var u=[],p=0;p<n.SheetNames.length;++p)2!=(n.Workbook.Sheets[p]||{}).Hidden&&u.push(n.SheetNames[p]);n.Props.SheetNames=u}else n.Props.SheetNames=n.SheetNames;n.Props.Worksheets=n.Props.SheetNames.length,Ot(a,s,qu(n.Props)),i.extprops.push(s),zt(o.rels,3,s,kt.EXT_PROPS),n.Custprops!==n.Props&&gn(n.Custprops||{}).length>0&&(Ot(a,s="docProps/custom.xml",Zu(n.Custprops)),i.custprops.push(s),zt(o.rels,4,s,kt.CUST_PROPS));var f=["SheetJ5"];for(o.tcid=0,l=1;l<=n.SheetNames.length;++l){var h={"!id":{}},_=n.Sheets[n.SheetNames[l-1]];if(Ot(a,s="xl/worksheets/sheet"+l+"."+t,cp(l-1,o,n,h)),i.sheets.push(s),zt(o.wbrels,-1,"worksheets/sheet"+l+"."+t,kt.WS[0]),_){var P=_["!comments"],x=!1,k="";if(P&&P.length>0){var F=!1;P.forEach(function(S){S[1].forEach(function(w){1==w.T&&(F=!0)})}),F&&(Ot(a,k="xl/threadedComments/threadedComment"+l+"."+t,v_(P,f,o)),i.threadedcomments.push(k),zt(h,-1,"../threadedComments/threadedComment"+l+"."+t,kt.TCMNT)),Ot(a,k="xl/comments"+l+"."+t,Hg(P)),i.comments.push(k),zt(h,-1,"../comments"+l+"."+t,kt.CMNT),x=!0}_["!legacy"]&&x&&Ot(a,"xl/drawings/vmlDrawing"+l+".vml",Yg(l,_["!comments"])),delete _["!comments"],delete _["!legacy"]}h["!id"].rId1&&Ot(a,La(s),Qo(h))}return null!=o.Strings&&o.Strings.length>0&&(Ot(a,s="xl/sharedStrings."+t,Ig(o.Strings,o)),i.strs.push(s),zt(o.wbrels,-1,"sharedStrings."+t,kt.SST)),Ot(a,s="xl/workbook."+t,hp(n)),i.workbooks.push(s),zt(o.rels,1,s,kt.WB),Ot(a,s="xl/theme/theme1.xml",Pd(n.Themes,o)),i.themes.push(s),zt(o.wbrels,-1,"theme/theme1.xml",kt.THEME),Ot(a,s="xl/styles."+t,$g(n,o)),i.styles.push(s),zt(o.wbrels,-1,"styles."+t,kt.STY),n.vbaraw&&r&&(Ot(a,s="xl/vbaProject.bin",n.vbaraw),i.vba.push(s),zt(o.wbrels,-1,"vbaProject.bin",kt.VBA)),Ot(a,s="xl/metadata."+t,Vg()),i.metadata.push(s),zt(o.wbrels,-1,"metadata."+t,kt.XLMETA),f.length>1&&(Ot(a,s="xl/persons/person.xml",function b_(n){var o=[fn,we("personList",null,{xmlns:yn.TCMNT,"xmlns:x":Yi[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,r){o.push(we("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:t,providerId:"None"}))}),o.push("</personList>"),o.join("")}(f)),i.people.push(s),zt(o.wbrels,-1,"persons/person.xml",kt.PEOPLE)),Ot(a,"[Content_Types].xml",Uu(i,o)),Ot(a,"_rels/.rels",Qo(o.rels)),Ot(a,"xl/_rels/workbook.xml.rels",Qo(o.wbrels)),delete o.revssf,delete o.ssf,a}(n,o)}function Up(n,o){switch(o.type){case"base64":case"binary":break;case"buffer":case"array":o.type="";break;case"file":return Ia(o.file,nt.write(n,{type:dt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+o.bookType+"' files");default:throw new Error("Unrecognized type "+o.type)}return nt.write(n,o)}function ai(n,o,t){t||(t="");var r=t+n;switch(o.type){case"base64":return Er(ni(r));case"binary":return ni(r);case"string":return n;case"file":return Ia(o.file,r,"utf8");case"buffer":return dt?pr(r,"utf8"):typeof TextEncoder<"u"?(new TextEncoder).encode(r):ai(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+o.type)}function Ic(n,o){switch(o.type){case"string":case"base64":case"binary":for(var t="",r=0;r<n.length;++r)t+=String.fromCharCode(n[r]);return"base64"==o.type?Er(t):"string"==o.type?tn(t):t;case"file":return Ia(o.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+o.type)}}function Rc(n,o){(function Go(){Tn(1200),function Fl(){ur(1252)}()})(),function mp(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");!function m2(n,o,t){n.forEach(function(r,i){fp(r);for(var a=0;a<i;++a)if(r==n[a])throw new Error("Duplicate Sheet Name: "+r);if(t){var s=o&&o[i]&&o[i].CodeName||r;if(95==s.charCodeAt(0)&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}(n.SheetNames,n.Workbook&&n.Workbook.Sheets||[],!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)uC(n.Sheets[n.SheetNames[t]],0,t)}(n);var t=Qt(o||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),"array"==t.type){t.type="binary";var r=Rc(n,t);return t.type="array",hi(r)}var i=0;if(t.sheet&&(i="number"==typeof t.sheet?t.sheet:n.SheetNames.indexOf(t.sheet),!n.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return ai(gP(n,t),t);case"slk":case"sylk":return ai(Fg.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"htm":case"html":return ai(wp(n.Sheets[n.SheetNames[i]],t),t);case"txt":return function xb(n,o){switch(o.type){case"base64":return Er(n);case"binary":case"string":return n;case"file":return Ia(o.file,n,"binary");case"buffer":return dt?pr(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+o.type)}(Wp(n.Sheets[n.SheetNames[i]],t),t);case"csv":return ai(Vd(n.Sheets[n.SheetNames[i]],t),t,"\ufeff");case"dif":return ai(Eg.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"dbf":return Ic(hd.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"prn":return ai(Jo.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"rtf":return ai(jg.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"eth":return ai(Sg.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"fods":return ai(Dp(n,t),t);case"wk1":return Ic(Eo.sheet_to_wk1(n.Sheets[n.SheetNames[i]],t),t);case"wk3":return Ic(Eo.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Ic(Pp(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),function _b(n,o){var t=o||{};return Up(function CP(n,o){var t=o||{},r=nt.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return nt.utils.cfb_add(r,i,Pp(n,t)),8==t.biff&&(n.Props||n.Custprops)&&function xP(n,o){var s,t=[],r=[],i=[],a=0,l=Jd(ad,"n"),u=Jd(sd,"n");if(n.Props)for(s=gn(n.Props),a=0;a<s.length;++a)(Object.prototype.hasOwnProperty.call(l,s[a])?t:Object.prototype.hasOwnProperty.call(u,s[a])?r:i).push([s[a],n.Props[s[a]]]);if(n.Custprops)for(s=gn(n.Custprops),a=0;a<s.length;++a)Object.prototype.hasOwnProperty.call(n.Props||{},s[a])||(Object.prototype.hasOwnProperty.call(l,s[a])?t:Object.prototype.hasOwnProperty.call(u,s[a])?r:i).push([s[a],n.Custprops[s[a]]]);var p=[];for(a=0;a<i.length;++a)ig.indexOf(i[a][0])>-1||Hu.indexOf(i[a][0])>-1||null!=i[a][1]&&p.push(i[a]);r.length&&nt.utils.cfb_add(o,"/\x05SummaryInformation",sg(r,Ka.SI,u,sd)),(t.length||p.length)&&nt.utils.cfb_add(o,"/\x05DocumentSummaryInformation",sg(t,Ka.DSI,l,ad,p.length?p:null,Ka.UDI))}(n,r),8==t.biff&&n.vbaraw&&function T_(n,o){o.FullPaths.forEach(function(t,r){if(0!=r){var i=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==i.slice(-1)&&nt.utils.cfb_add(n,i,o.FileIndex[r].content)}})}(r,nt.read(n.vbaraw,{type:"string"==typeof n.vbaraw?"binary":"buffer"})),r}(n,t),t)}(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function mb(n,o){var t=Qt(o||{});return function zp(n,o){var t={},r=dt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(o.compression&&(t.compression="DEFLATE"),o.password)t.type=r;else switch(o.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+o.bookType+"' files");case"buffer":case"file":t.type=r;break;default:throw new Error("Unrecognized type "+o.type)}var i=n.FullPaths?nt.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!o.compression}):n.generate(t);if(typeof Deno<"u"&&"string"==typeof i){if("binary"==o.type||"base64"==o.type)return i;i=new Uint8Array(hi(i))}return o.password&&typeof encrypt_agile<"u"?Up(encrypt_agile(i,o.password),o):"file"===o.type?Ia(o.file,i):"string"==o.type?tn(i):i}(cb(n,t),t)}(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function Yp(n,o,t,r,i,a,s,l){var u=mn(t),p=l.defval,f=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),h=!0,_=1===i?[]:{};if(1!==i)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:t,enumerable:!1})}catch{_.__rowNum__=t}else _.__rowNum__=t;if(!s||n[t])for(var C=o.s.c;C<=o.e.c;++C){var P=s?n[t][C]:n[r[C]+u];if(void 0!==P&&void 0!==P.t){var x=P.v;switch(P.t){case"z":if(null==x)break;continue;case"e":x=0==x?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+P.t)}if(null!=a[C]){if(null==x)if("e"==P.t&&null===x)_[a[C]]=null;else if(void 0!==p)_[a[C]]=p;else{if(!f||null!==x)continue;_[a[C]]=null}else _[a[C]]=f&&("n"!==P.t||"n"===P.t&&!1!==l.rawNumbers)?x:ri(P,x,l);null!=x&&(h=!1)}}else{if(void 0===p)continue;null!=a[C]&&(_[a[C]]=p)}}return{row:_,isempty:h}}function Nc(n,o){if(null==n||null==n["!ref"])return[];var t={t:"n",v:0},r=0,i=1,a=[],s=0,l="",u={s:{r:0,c:0},e:{r:0,c:0}},p=o||{},f=null!=p.range?p.range:n["!ref"];switch(1===p.header?r=1:"A"===p.header?r=2:Array.isArray(p.header)?r=3:null==p.header&&(r=0),typeof f){case"string":u=Dt(f);break;case"number":(u=Dt(n["!ref"])).s.r=f;break;default:u=f}r>0&&(i=0);var h=mn(u.s.r),_=[],C=[],P=0,x=0,k=Array.isArray(n),F=u.s.r,S=0,w={};k&&!n[F]&&(n[F]=[]);var W=p.skipHidden&&n["!cols"]||[],K=p.skipHidden&&n["!rows"]||[];for(S=u.s.c;S<=u.e.c;++S)if(!(W[S]||{}).hidden)switch(_[S]=nn(S),t=k?n[F][S]:n[_[S]+h],r){case 1:a[S]=S-u.s.c;break;case 2:a[S]=_[S];break;case 3:a[S]=p.header[S-u.s.c];break;default:if(null==t&&(t={w:"__EMPTY",t:"s"}),l=s=ri(t,null,p),x=w[s]||0){do{l=s+"_"+x++}while(w[l]);w[s]=x,w[l]=1}else w[s]=1;a[S]=l}for(F=u.s.r+i;F<=u.e.r;++F)if(!(K[F]||{}).hidden){var ee=Yp(n,u,F,_,r,a,k,p);(!1===ee.isempty||(1===r?!1!==p.blankrows:p.blankrows))&&(C[P++]=ee.row)}return C.length=P,C}var Xp=/"/g;function Hp(n,o,t,r,i,a,s,l){for(var u=!0,p=[],f="",h=mn(t),_=o.s.c;_<=o.e.c;++_)if(r[_]){var C=l.dense?(n[t]||[])[_]:n[r[_]+h];if(null==C)f="";else if(null!=C.v){u=!1,f=""+(l.rawNumbers&&"n"==C.t?C.v:ri(C,null,l));for(var P=0,x=0;P!==f.length;++P)if((x=f.charCodeAt(P))===i||x===a||34===x||l.forceQuotes){f='"'+f.replace(Xp,'""')+'"';break}"ID"==f&&(f='"ID"')}else null==C.f||C.F?f="":(u=!1,(f="="+C.f).indexOf(",")>=0&&(f='"'+f.replace(Xp,'""')+'"'));p.push(f)}return!1===l.blankrows&&u?null:p.join(s)}function Vd(n,o){var t=[],r=o??{};if(null==n||null==n["!ref"])return"";var i=Dt(n["!ref"]),a=void 0!==r.FS?r.FS:",",s=a.charCodeAt(0),l=void 0!==r.RS?r.RS:"\n",u=l.charCodeAt(0),p=new RegExp(("|"==a?"\\|":a)+"+$"),f="",h=[];r.dense=Array.isArray(n);for(var _=r.skipHidden&&n["!cols"]||[],C=r.skipHidden&&n["!rows"]||[],P=i.s.c;P<=i.e.c;++P)(_[P]||{}).hidden||(h[P]=nn(P));for(var x=0,k=i.s.r;k<=i.e.r;++k)(C[k]||{}).hidden||null!=(f=Hp(n,i,k,h,s,u,a,r))&&(r.strip&&(f=f.replace(p,"")),(f||!1!==r.blankrows)&&t.push((x++?l:"")+f));return delete r.dense,t.join("")}function Wp(n,o){o||(o={}),o.FS="\t",o.RS="\n";var t=Vd(n,o);if(typeof Nt>"u"||"string"==o.type)return t;var r=Nt.utils.encode(1200,t,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r}function qp(n,o,t){var r=t||{},i=+!r.skipHeader,a=n||{},s=0,l=0;if(a&&null!=r.origin)if("number"==typeof r.origin)s=r.origin;else{var u="string"==typeof r.origin?Cn(r.origin):r.origin;s=u.r,l=u.c}var p,f={s:{c:0,r:0},e:{c:l,r:s+o.length-1+i}};if(a["!ref"]){var h=Dt(a["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),-1==s&&(f.e.r=(s=h.e.r+1)+o.length-1+i)}else-1==s&&(s=0,f.e.r=o.length-1+i);var _=r.header||[],C=0;o.forEach(function(x,k){gn(x).forEach(function(F){-1==(C=_.indexOf(F))&&(_[C=_.length]=F);var S=x[F],w="z",W="",K=pt({c:l+C,r:s+k+i});p=rs(a,K),!S||"object"!=typeof S||S instanceof Date?("number"==typeof S?w="n":"boolean"==typeof S?w="b":"string"==typeof S?w="s":S instanceof Date?(w="d",r.cellDates||(w="n",S=An(S)),W=r.dateNF||tt[14]):null===S&&r.nullError&&(w="e",S=0),p?(p.t=w,p.v=S,delete p.w,delete p.R,W&&(p.z=W)):a[K]=p={t:w,v:S},W&&(p.z=W)):a[K]=S})}),f.e.c=Math.max(f.e.c,l+_.length-1);var P=mn(s);if(i)for(C=0;C<_.length;++C)a[nn(C+l)+P]={t:"s",v:_[C]};return a["!ref"]=bt(f),a}function rs(n,o,t){if("string"==typeof o){if(Array.isArray(n)){var r=Cn(o);return n[r.r]||(n[r.r]=[]),n[r.r][r.c]||(n[r.r][r.c]={t:"z"})}return n[o]||(n[o]={t:"z"})}return rs(n,pt("number"!=typeof o?o:{r:o,c:t||0}))}function Zp(n,o,t){return o?(n.l={Target:o},t&&(n.l.Tooltip=t)):delete n.l,n}var Hd={encode_col:nn,encode_row:mn,encode_cell:pt,encode_range:bt,decode_col:Kl,decode_row:Jl,split_cell:function W0(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Cn,decode_range:ir,format_cell:ri,sheet_add_aoa:Nu,sheet_add_json:qp,sheet_add_dom:Fp,aoa_to_sheet:qo,json_to_sheet:function vb(n,o){return qp(null,n,o)},table_to_sheet:Ep,table_to_book:function jP(n,o){return Xi(Ep(n,o),o)},sheet_to_csv:Vd,sheet_to_txt:Wp,sheet_to_json:Nc,sheet_to_html:wp,sheet_to_formulae:function Cb(n){var t,o="",r="";if(null==n||null==n["!ref"])return[];var l,i=Dt(n["!ref"]),a="",s=[],u=[],p=Array.isArray(n);for(l=i.s.c;l<=i.e.c;++l)s[l]=nn(l);for(var f=i.s.r;f<=i.e.r;++f)for(a=mn(f),l=i.s.c;l<=i.e.c;++l)if(o=s[l]+a,r="",void 0!==(t=p?(n[f]||[])[l]:n[o])){if(null!=t.F){if(o=t.F,!t.f)continue;r=t.f,-1==o.indexOf(":")&&(o=o+":"+o)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}u[u.length]=o+"="+r}return u},sheet_to_row_object_array:Nc,sheet_get_cell:rs,book_new:function Yd(){return{SheetNames:[],Sheets:{}}},book_append_sheet:function Xd(n,o,t,r){var i=1;if(!t)for(;i<=65535&&-1!=n.SheetNames.indexOf(t="Sheet"+i);++i,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&n.SheetNames.indexOf(t)>=0){var a=t.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var s=a&&a[1]||t;for(++i;i<=65535&&-1!=n.SheetNames.indexOf(t=s+i);++i);}if(fp(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=o,t},book_set_sheet_visibility:function bb(n,o,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var r=function Pb(n,o){if("number"==typeof o){if(o>=0&&n.SheetNames.length>o)return o;throw new Error("Cannot find sheet # "+o)}if("string"==typeof o){var t=n.SheetNames.indexOf(o);if(t>-1)return t;throw new Error("Cannot find sheet name |"+o+"|")}throw new Error("Cannot find sheet |"+o+"|")}(n,o);switch(n.Workbook.Sheets[r]||(n.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[r].Hidden=t},cell_set_number_format:function kb(n,o){return n.z=o,n},cell_set_hyperlink:Zp,cell_set_internal_link:function Ob(n,o,t){return Zp(n,"#"+o,t)},cell_add_comment:function yb(n,o,t){n.c||(n.c=[]),n.c.push({t:o,a:t||"SheetJS"})},sheet_set_array_formula:function Mb(n,o,t,r){for(var i="string"!=typeof o?o:Dt(o),a="string"==typeof o?o:bt(o),s=i.s.r;s<=i.e.r;++s)for(var l=i.s.c;l<=i.e.c;++l){var u=rs(n,s,l);u.t="n",u.F=a,delete u.v,s==i.s.r&&l==i.s.c&&(u.f=t,r&&(u.D=!0))}return n},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Tb(n,o){if(1&n&&(e.j41(0,"mat-option",55),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.Y8G("value",t),e.R7$(1),e.SpI(" ",t," ")}}function Ib(n,o){if(1&n&&(e.j41(0,"th",56),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.JRh(t.showTamil?"\u0baa\u0bca\u0bb0\u0bc1\u0bb3\u0bcd":"Product")}}function Rb(n,o){if(1&n&&(e.j41(0,"td",57)(1,"div",58)(2,"div",59)(3,"h4"),e.EFF(4),e.k0s(),e.j41(5,"p"),e.EFF(6),e.k0s()()()()),2&n){const t=o.$implicit,r=e.XpG();e.R7$(3),e.AVh("tamil-text",r.showTamil),e.R7$(1),e.JRh(r.showTamil&&t.productNameTamil?t.productNameTamil:t.productName),e.R7$(1),e.AVh("tamil-text",r.showTamil),e.R7$(1),e.JRh(r.showTamil&&t.categoryTamil?t.categoryTamil:t.category)}}function Nb(n,o){1&n&&(e.j41(0,"th",56),e.EFF(1,"Current Stock"),e.k0s())}function Ab(n,o){if(1&n&&(e.j41(0,"td",57)(1,"div",60)(2,"span",61),e.EFF(3),e.k0s(),e.j41(4,"div",62),e.nrm(5,"div",63),e.k0s()()()),2&n){const t=o.$implicit,r=e.XpG();e.R7$(2),e.HbH(r.getStockClass(t)),e.R7$(1),e.Lme(" ",t.currentStock," ",t.unit," "),e.R7$(2),e.HbH(r.getStockClass(t)),e.xc7("width",r.getStockPercentage(t),"%")}}function Db(n,o){1&n&&(e.j41(0,"th",64),e.EFF(1,"Min/Max Stock"),e.k0s())}function jb(n,o){if(1&n&&(e.j41(0,"td",57)(1,"div",65)(2,"span",66),e.EFF(3),e.k0s(),e.j41(4,"span",67),e.EFF(5),e.k0s()()()),2&n){const t=o.$implicit;e.R7$(3),e.SpI("Min: ",t.minStock,""),e.R7$(2),e.SpI("Max: ",t.maxStock,"")}}function Bb(n,o){1&n&&(e.j41(0,"th",64),e.EFF(1,"Status"),e.k0s())}function Lb(n,o){if(1&n&&(e.j41(0,"td",57)(1,"span",68)(2,"mat-icon"),e.EFF(3),e.k0s(),e.EFF(4),e.k0s()()),2&n){const t=o.$implicit,r=e.XpG();e.R7$(1),e.HbH("status-"+t.status),e.R7$(2),e.JRh(r.getStatusIcon(t.status)),e.R7$(1),e.SpI(" ",r.getStatusLabel(t.status)," ")}}function $b(n,o){1&n&&(e.j41(0,"th",64),e.EFF(1,"Price/Cost"),e.k0s())}function Gb(n,o){if(1&n&&(e.j41(0,"td",57)(1,"div",69)(2,"span",70),e.EFF(3),e.k0s(),e.j41(4,"span",71),e.EFF(5),e.k0s()()()),2&n){const t=o.$implicit;e.R7$(3),e.SpI("\u20b9",t.price,""),e.R7$(2),e.SpI("Cost: \u20b9",t.cost,"")}}function Ub(n,o){1&n&&(e.j41(0,"th",56),e.EFF(1,"Last Restocked"),e.k0s())}function zb(n,o){if(1&n&&(e.j41(0,"td",57)(1,"span",72),e.EFF(2),e.nI1(3,"date"),e.k0s()()),2&n){const t=o.$implicit;e.R7$(2),e.JRh(e.i5U(3,1,t.lastRestocked,"short"))}}function Vb(n,o){1&n&&(e.j41(0,"th",64),e.EFF(1,"Actions"),e.k0s())}const Yb=function(n){return{item:n}};function Xb(n,o){if(1&n){const t=e.RV6();e.j41(0,"td",57)(1,"div",73)(2,"button",74),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.updateStock(a))}),e.j41(3,"mat-icon"),e.EFF(4,"add_box"),e.k0s()(),e.j41(5,"button",75),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.editSettings(a))}),e.j41(6,"mat-icon"),e.EFF(7,"settings"),e.k0s()(),e.j41(8,"button",76)(9,"mat-icon"),e.EFF(10,"more_vert"),e.k0s()()()()}if(2&n){const t=o.$implicit;e.XpG();const r=e.sdS(137);e.R7$(8),e.Y8G("matMenuTriggerFor",r)("matMenuTriggerData",e.eq3(2,Yb,t))}}function Hb(n,o){1&n&&e.nrm(0,"tr",77)}function Wb(n,o){1&n&&e.nrm(0,"tr",78)}function qb(n,o){if(1&n&&(e.j41(0,"mat-option",55),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.Y8G("value",t.id),e.R7$(1),e.SpI(" ",t.productName," ")}}function Zb(n,o){if(1&n){const t=e.RV6();e.j41(0,"mat-card",79)(1,"mat-card-header")(2,"mat-card-title"),e.EFF(3,"Quick Stock Update"),e.k0s(),e.j41(4,"button",80),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeQuickUpdate())}),e.j41(5,"mat-icon"),e.EFF(6,"close"),e.k0s()()(),e.j41(7,"mat-card-content")(8,"form",81),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.submitQuickUpdate())}),e.j41(9,"div",82)(10,"mat-form-field",23)(11,"mat-label"),e.EFF(12,"Product"),e.k0s(),e.j41(13,"mat-select",83),e.DNE(14,qb,2,2,"mat-option",28),e.k0s()(),e.j41(15,"mat-form-field",23)(16,"mat-label"),e.EFF(17,"Update Type"),e.k0s(),e.j41(18,"mat-select",84)(19,"mat-option",85),e.EFF(20,"Add Stock"),e.k0s(),e.j41(21,"mat-option",86),e.EFF(22,"Remove Stock"),e.k0s(),e.j41(23,"mat-option",87),e.EFF(24,"Set Stock"),e.k0s()()(),e.j41(25,"mat-form-field",23)(26,"mat-label"),e.EFF(27,"Quantity"),e.k0s(),e.nrm(28,"input",88),e.k0s(),e.j41(29,"mat-form-field",23)(30,"mat-label"),e.EFF(31,"Reason"),e.k0s(),e.j41(32,"mat-select",89)(33,"mat-option",90),e.EFF(34,"Purchase"),e.k0s(),e.j41(35,"mat-option",91),e.EFF(36,"Customer Return"),e.k0s(),e.j41(37,"mat-option",92),e.EFF(38,"Damage/Loss"),e.k0s(),e.j41(39,"mat-option",93),e.EFF(40,"Manual Sale"),e.k0s(),e.j41(41,"mat-option",94),e.EFF(42,"Stock Audit"),e.k0s()()()(),e.j41(43,"div",95)(44,"button",96),e.EFF(45," Update Stock "),e.k0s(),e.j41(46,"button",97),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeQuickUpdate())}),e.EFF(47," Cancel "),e.k0s()()()()()}if(2&n){const t=e.XpG();e.R7$(8),e.Y8G("formGroup",t.quickUpdateForm),e.R7$(6),e.Y8G("ngForOf",t.inventoryData),e.R7$(30),e.Y8G("disabled",t.quickUpdateForm.invalid)}}function Qb(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",98),e.bIt("click",function(){const a=e.eBV(t).item,s=e.XpG();return e.Njj(s.updateStock(a))}),e.j41(1,"mat-icon"),e.EFF(2,"add_box"),e.k0s(),e.j41(3,"span"),e.EFF(4,"Update Stock"),e.k0s()(),e.j41(5,"button",98),e.bIt("click",function(){const a=e.eBV(t).item,s=e.XpG();return e.Njj(s.editSettings(a))}),e.j41(6,"mat-icon"),e.EFF(7,"settings"),e.k0s(),e.j41(8,"span"),e.EFF(9,"Edit Settings"),e.k0s()(),e.j41(10,"button",98),e.bIt("click",function(){const a=e.eBV(t).item,s=e.XpG();return e.Njj(s.viewHistory(a))}),e.j41(11,"mat-icon"),e.EFF(12,"history"),e.k0s(),e.j41(13,"span"),e.EFF(14,"Stock History"),e.k0s()(),e.j41(15,"button",98),e.bIt("click",function(){const a=e.eBV(t).item,s=e.XpG();return e.Njj(s.reorderProduct(a))}),e.j41(16,"mat-icon"),e.EFF(17,"shopping_cart"),e.k0s(),e.j41(18,"span"),e.EFF(19,"Reorder"),e.k0s()()}}const Jb=function(){return[10,25,50]};let Kb=(()=>{class n{constructor(t,r,i,a,s,l){this.fb=t,this.dialog=r,this.snackBar=i,this.http=a,this.authService=s,this.offlineStorage=l,this.destroy$=new _n.B,this.apiUrl=Oe.c.apiUrl,this.displayedColumns=["product","currentStock","minMaxStock","status","pricing","lastRestocked","actions"],this.dataSource=new _e.I6,this.searchControl=new b.MJ,this.selectedCategory="",this.selectedStatus="",this.showOnlyLowStock=!1,this.showOnlyCritical=!1,this.showQuickUpdate=!1,this.showTamil=!1,this.categories=[],this.inventoryData=[],this.loading=!1,this.exporting=!1,this.loadedFromCache=!1,this.rawProductData=[],this.dataSource.data=[],this.quickUpdateForm=this.fb.group({productId:["",b.k0.required],updateType:["add",b.k0.required],quantity:["",[b.k0.required,b.k0.min(1)]],reason:["",b.k0.required]})}ngOnInit(){this.setupFilters(),this.loadInventoryData()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadInventoryData(){var t=this;return(0,fe.A)(function*(){t.loading=!0,console.log("Loading inventory data...");try{const r=yield t.offlineStorage.getProducts();r.length>0&&(console.log(`Loaded ${r.length} products from local cache`),t.loadedFromCache=!0,t.mapCachedProductsToInventory(r),t.loading=!1)}catch(r){console.warn("Error loading from cache:",r)}t.syncFromServer()})()}mapCachedProductsToInventory(t){const r=t.map(a=>{const s=a.stock||0,l=a.minStockLevel||10,u=a.maxStockLevel||100,p=a.price||0;return{id:a.id,productName:a.name||"Unknown Product",productNameTamil:a.nameTamil||"",category:a.category||"Uncategorized",categoryTamil:"",currentStock:s,minStock:l,maxStock:u,unit:a.unit||"piece",price:p,cost:a.costPrice||Math.round(.7*p),supplier:"Local Supplier",lastRestocked:new Date,status:this.getStockStatus(s,l,u),location:"Main Store",reorderPoint:l,barcode:a.barcode||"",barcode1:a.barcode1||"",barcode2:a.barcode2||"",barcode3:a.barcode3||"",sku:a.sku||""}});this.inventoryData=r,this.dataSource.data=this.inventoryData;const i=new Set(r.map(a=>a.category));this.categories=Array.from(i).filter(a=>"Uncategorized"!==a),console.log("Mapped inventory data:",r.length,"items")}syncFromServer(){const t=(new gt.Nl).set("page","0").set("size","100000");this.http.get(`${this.apiUrl}/shop-products/my-products`,{params:t}).pipe((0,ot.Q)(this.destroy$)).subscribe({next:r=>{console.log("Inventory API response:",r);let i=[];r&&r.data&&(r.data.content?i=r.data.content:Array.isArray(r.data)&&(i=r.data)),this.rawProductData=i;const a=i.map(l=>{const u=l.stockQuantity||0,p=l.minStockLevel||10,f=l.maxStockLevel||100,h=l.price||l.sellingPrice||0;return{id:l.id,productName:l.customName||l.displayName||l.masterProduct?.name||"Unknown Product",productNameTamil:l.customNameTamil||l.displayNameTamil||l.nameTamil||l.masterProduct?.nameTamil||"",category:l.masterProduct?.category?.name||l.category||"Uncategorized",categoryTamil:l.masterProduct?.category?.nameTamil||"",currentStock:u,minStock:p,maxStock:f,unit:l.masterProduct?.baseUnit||l.unit||"piece",price:h,cost:l.costPrice||Math.round(.7*h),supplier:"Local Supplier",lastRestocked:new Date(l.updatedAt||new Date),status:this.getStockStatus(u,p,f),location:"Main Store",reorderPoint:p,barcode:l.barcode||l.masterProduct?.barcode||"",barcode1:l.barcode1||"",barcode2:l.barcode2||"",barcode3:l.barcode3||"",sku:l.sku||l.masterProduct?.sku||""}});this.inventoryData=a,this.dataSource.data=this.inventoryData;const s=new Set(a.map(l=>l.category));this.categories=Array.from(s).filter(l=>"Uncategorized"!==l),this.loading=!1,this.loadedFromCache=!1,console.log("Synced inventory from server:",a.length,"items")},error:r=>{console.error("Error syncing from server:",r),this.loading=!1,this.loadedFromCache||this.snackBar.open("Failed to load inventory data","Close",{duration:3e3})}})}getStockStatus(t,r,i){return 0===t||t<=.5*r?"critical":t<=1.5*r?"low":t>i?"overstock":"healthy"}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}setupFilters(){this.searchControl.valueChanges.subscribe(()=>{this.applyFilters()})}applyFilters(){this.dataSource.filterPredicate=(t,r)=>{const i=this.searchControl.value?.toLowerCase()||"",a=t.productName.toLowerCase().includes(i)||t.category.toLowerCase().includes(i),s=!!(t.barcode&&t.barcode.toLowerCase().includes(i)||t.barcode1&&t.barcode1.toLowerCase().includes(i)||t.barcode2&&t.barcode2.toLowerCase().includes(i)||t.barcode3&&t.barcode3.toLowerCase().includes(i)||t.sku&&t.sku.toLowerCase().includes(i));return(a||s)&&(!this.selectedCategory||t.category===this.selectedCategory)&&(!this.selectedStatus||t.status===this.selectedStatus)&&(!this.showOnlyLowStock||"low"===t.status||"critical"===t.status)&&(!this.showOnlyCritical||"critical"===t.status)},this.dataSource.filter=Math.random().toString()}getHealthyStock(){return this.dataSource.filteredData.filter(t=>"healthy"===t.status).length}getLowStock(){return this.dataSource.filteredData.filter(t=>"low"===t.status).length}getCriticalStock(){return this.dataSource.filteredData.filter(t=>"critical"===t.status).length}getOverstock(){return this.dataSource.filteredData.filter(t=>"overstock"===t.status).length}getStockClass(t){return t.status}getStockPercentage(t){return Math.min(t.currentStock/t.maxStock*100,100)}getStatusIcon(t){switch(t){case"healthy":return"check_circle";case"low":return"warning";case"critical":return"error";case"overstock":return"trending_up";default:return"help"}}getStatusLabel(t){switch(t){case"healthy":return"Healthy";case"low":return"Low Stock";case"critical":return"Critical";case"overstock":return"Overstock";default:return t}}showLowStockOnly(){this.showOnlyLowStock=!this.showOnlyLowStock,this.showOnlyCritical=!1,this.applyFilters()}showCriticalOnly(){this.showOnlyCritical=!this.showOnlyCritical,this.showOnlyLowStock=!1,this.applyFilters()}updateStock(t){this.showQuickUpdate=!0,this.quickUpdateForm.patchValue({productId:t.id})}editSettings(t){console.log("Edit settings for:",t)}viewHistory(t){console.log("View history for:",t)}reorderProduct(t){console.log("Reorder product:",t)}openBulkUpdate(){console.log("Open bulk update")}generateReport(){console.log("Generate inventory report")}closeQuickUpdate(){this.showQuickUpdate=!1,this.quickUpdateForm.reset()}submitQuickUpdate(){if(this.quickUpdateForm.valid){const t=this.quickUpdateForm.value;console.log("Update stock:",t);const r=this.inventoryData.find(i=>i.id===t.productId);if(r){switch(t.updateType){case"add":r.currentStock+=t.quantity;break;case"remove":r.currentStock=Math.max(0,r.currentStock-t.quantity);break;case"set":r.currentStock=t.quantity}r.status=r.currentStock<=r.reorderPoint?r.currentStock<=r.reorderPoint/2?"critical":"low":r.currentStock>r.maxStock?"overstock":"healthy",r.lastRestocked=new Date,this.dataSource.data=[...this.inventoryData]}this.snackBar.open("Stock updated successfully","Close",{duration:3e3}),this.closeQuickUpdate()}}bulkDownload(){var t=this;return(0,fe.A)(function*(){t.exporting=!0;try{if(0===t.rawProductData.length){const C=(new gt.Nl).set("page","0").set("size","100000"),P=yield t.http.get(`${t.apiUrl}/shop-products/my-products`,{params:C}).toPromise();P&&P.data&&(P.data.content?t.rawProductData=P.data.content:Array.isArray(P.data)&&(t.rawProductData=P.data))}if(0===t.rawProductData.length)return t.snackBar.open("No products to export","Close",{duration:3e3}),void(t.exporting=!1);const r=t.rawProductData.map(C=>{const P=C.price||0,x=C.originalPrice||P,k=x>0?Math.round((x-P)/x*100):0;return{name:C.customName||C.displayName||C.masterProduct?.name||"",nameTamil:C.customNameTamil||C.masterProduct?.nameTamil||"",description:C.customDescription||C.masterProduct?.description||"",descriptionTamil:C.masterProduct?.descriptionTamil||"",categoryName:C.masterProduct?.category?.name||"",brand:C.masterProduct?.brand||"",sku:C.sku||C.masterProduct?.sku||"",searchQuery:C.masterProduct?.searchQuery||"",downloadLink:"",baseUnit:C.masterProduct?.baseUnit||C.unit||"piece",baseWeight:C.masterProduct?.baseWeight||0,originalPrice:x,discountPercentage:k,sellingPrice:P,costPrice:C.costPrice||0,stockQuantity:C.stockQuantity||0,minStockLevel:C.minStockLevel||10,maxStockLevel:C.maxStockLevel||500,trackInventory:!1!==C.trackInventory?"TRUE":"FALSE",status:C.status||"ACTIVE",isFeatured:C.isFeatured?"TRUE":"FALSE",isAvailable:!1!==C.isAvailable?"TRUE":"FALSE",tags:C.tags||C.masterProduct?.tags||"",imagePath:C.primaryImageUrl||C.masterProduct?.primaryImageUrl||"",barcode:C.barcode||C.masterProduct?.barcode||"",barcode1:C.barcode1||"",barcode2:C.barcode2||"",barcode3:C.barcode3||""}}),i=Hd.json_to_sheet(r),a=Hd.book_new();Hd.book_append_sheet(a,i,"Products"),i["!cols"]=[{wch:30},{wch:25},{wch:40},{wch:30},{wch:15},{wch:15},{wch:15},{wch:15},{wch:20},{wch:10},{wch:12},{wch:12},{wch:18},{wch:12},{wch:12},{wch:14},{wch:14},{wch:14},{wch:14},{wch:10},{wch:12},{wch:12},{wch:20},{wch:40},{wch:20},{wch:20},{wch:20},{wch:20}];const l=Rc(a,{bookType:"xlsx",type:"array"}),u=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),f=`products_export_${(new Date).toISOString().slice(0,10)}.xlsx`,h=window.URL.createObjectURL(u),_=document.createElement("a");_.href=h,_.download=f,_.click(),window.URL.revokeObjectURL(h),t.snackBar.open(`Exported ${r.length} products successfully!`,"Close",{duration:3e3})}catch(r){console.error("Export failed:",r),t.snackBar.open("Failed to export products","Close",{duration:3e3})}finally{t.exporting=!1}})()}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(b.ok),e.rXU(Pe.bZ),e.rXU(Ce.UG),e.rXU(gt.Qq),e.rXU(Gt.u),e.rXU(at.m))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-inventory-management"]],viewQuery:function(r,i){if(1&r&&(e.GBs(lt.iy,5),e.GBs($t.B4,5)),2&r){let a;e.mGM(a=e.lsd())&&(i.paginator=a.first),e.mGM(a=e.lsd())&&(i.sort=a.first)}},decls:139,vars:26,consts:[[1,"inventory-container"],[1,"page-header"],[1,"header-content"],[1,"page-title"],[1,"page-subtitle"],[1,"header-actions"],[1,"language-toggle-container"],[1,"lang-label"],["color","primary",1,"language-toggle",3,"ngModel","ngModelChange"],[1,"lang-label","tamil"],["mat-raised-button","","color","accent",3,"disabled","click"],["mat-stroked-button","",3,"click"],[1,"summary-cards"],[1,"summary-card","healthy"],[1,"card-content"],[1,"card-icon"],[1,"card-details"],[1,"summary-card","low"],[1,"summary-card","critical"],[1,"summary-card","overstock"],[1,"filters-card"],[1,"filters-section"],[1,"filter-group"],["appearance","outline"],["matInput","","placeholder","Search by name, category, or barcode",3,"formControl"],["matPrefix",""],[3,"value","valueChange","selectionChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["value","healthy"],["value","low"],["value","critical"],["value","overstock"],[1,"action-group"],["mat-button","","color","warn",3,"click"],["mat-button","",3,"click"],[1,"table-card"],[1,"table-container"],["mat-table","","matSort","",1,"inventory-table",3,"dataSource"],["matColumnDef","product"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","currentStock"],["matColumnDef","minMaxStock"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","status"],["matColumnDef","pricing"],["matColumnDef","lastRestocked"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["class","quick-update-card",4,"ngIf"],["actionMenu","matMenu"],["matMenuContent",""],[3,"value"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"product-cell"],[1,"product-info"],[1,"stock-cell"],[1,"stock-value"],[1,"stock-bar"],[1,"stock-fill"],["mat-header-cell",""],[1,"min-max-cell"],[1,"min-stock"],[1,"max-stock"],[1,"status-badge"],[1,"pricing-cell"],[1,"price"],[1,"cost"],[1,"date-value"],[1,"action-buttons"],["mat-icon-button","","color","primary","matTooltip","Update Stock",3,"click"],["mat-icon-button","","color","accent","matTooltip","Edit Settings",3,"click"],["mat-icon-button","",3,"matMenuTriggerFor","matMenuTriggerData"],["mat-header-row",""],["mat-row",""],[1,"quick-update-card"],["mat-icon-button","",3,"click"],[3,"formGroup","ngSubmit"],[1,"quick-update-grid"],["formControlName","productId"],["formControlName","updateType"],["value","add"],["value","remove"],["value","set"],["matInput","","type","number","formControlName","quantity","placeholder","Enter quantity"],["formControlName","reason"],["value","purchase"],["value","return"],["value","damage"],["value","sale"],["value","audit"],[1,"form-actions"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-button","","type","button",3,"click"],["mat-menu-item","",3,"click"]],template:function(r,i){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),e.EFF(4,"Inventory Management"),e.k0s(),e.j41(5,"p",4),e.EFF(6,"Monitor and manage your stock levels"),e.k0s()(),e.j41(7,"div",5)(8,"div",6)(9,"span",7),e.EFF(10,"EN"),e.k0s(),e.j41(11,"mat-slide-toggle",8),e.bIt("ngModelChange",function(s){return i.showTamil=s}),e.k0s(),e.j41(12,"span",9),e.EFF(13,"\u0ba4\u0bae\u0bbf\u0bb4\u0bcd"),e.k0s()(),e.j41(14,"button",10),e.bIt("click",function(){return i.bulkDownload()}),e.j41(15,"mat-icon"),e.EFF(16),e.k0s(),e.EFF(17),e.k0s(),e.j41(18,"button",11),e.bIt("click",function(){return i.generateReport()}),e.j41(19,"mat-icon"),e.EFF(20,"assessment"),e.k0s(),e.EFF(21," Generate Report "),e.k0s()()(),e.j41(22,"div",12)(23,"mat-card",13)(24,"mat-card-content")(25,"div",14)(26,"div",15)(27,"mat-icon"),e.EFF(28,"check_circle"),e.k0s()(),e.j41(29,"div",16)(30,"h3"),e.EFF(31),e.k0s(),e.j41(32,"p"),e.EFF(33,"Healthy Stock"),e.k0s()()()()(),e.j41(34,"mat-card",17)(35,"mat-card-content")(36,"div",14)(37,"div",15)(38,"mat-icon"),e.EFF(39,"warning"),e.k0s()(),e.j41(40,"div",16)(41,"h3"),e.EFF(42),e.k0s(),e.j41(43,"p"),e.EFF(44,"Low Stock"),e.k0s()()()()(),e.j41(45,"mat-card",18)(46,"mat-card-content")(47,"div",14)(48,"div",15)(49,"mat-icon"),e.EFF(50,"error"),e.k0s()(),e.j41(51,"div",16)(52,"h3"),e.EFF(53),e.k0s(),e.j41(54,"p"),e.EFF(55,"Critical Stock"),e.k0s()()()()(),e.j41(56,"mat-card",19)(57,"mat-card-content")(58,"div",14)(59,"div",15)(60,"mat-icon"),e.EFF(61,"trending_up"),e.k0s()(),e.j41(62,"div",16)(63,"h3"),e.EFF(64),e.k0s(),e.j41(65,"p"),e.EFF(66,"Overstock"),e.k0s()()()()()(),e.j41(67,"mat-card",20)(68,"mat-card-content")(69,"div",21)(70,"div",22)(71,"mat-form-field",23)(72,"mat-label"),e.EFF(73,"Search Products"),e.k0s(),e.nrm(74,"input",24),e.j41(75,"mat-icon",25),e.EFF(76,"search"),e.k0s()(),e.j41(77,"mat-form-field",23)(78,"mat-label"),e.EFF(79,"Category"),e.k0s(),e.j41(80,"mat-select",26),e.bIt("valueChange",function(s){return i.selectedCategory=s})("selectionChange",function(){return i.applyFilters()}),e.j41(81,"mat-option",27),e.EFF(82,"All Categories"),e.k0s(),e.DNE(83,Tb,2,2,"mat-option",28),e.k0s()(),e.j41(84,"mat-form-field",23)(85,"mat-label"),e.EFF(86,"Stock Status"),e.k0s(),e.j41(87,"mat-select",26),e.bIt("valueChange",function(s){return i.selectedStatus=s})("selectionChange",function(){return i.applyFilters()}),e.j41(88,"mat-option",27),e.EFF(89,"All Status"),e.k0s(),e.j41(90,"mat-option",29),e.EFF(91,"Healthy"),e.k0s(),e.j41(92,"mat-option",30),e.EFF(93,"Low Stock"),e.k0s(),e.j41(94,"mat-option",31),e.EFF(95,"Critical"),e.k0s(),e.j41(96,"mat-option",32),e.EFF(97,"Overstock"),e.k0s()()()(),e.j41(98,"div",33)(99,"button",34),e.bIt("click",function(){return i.showLowStockOnly()}),e.j41(100,"mat-icon"),e.EFF(101,"warning"),e.k0s(),e.EFF(102," Low Stock Only "),e.k0s(),e.j41(103,"button",35),e.bIt("click",function(){return i.showCriticalOnly()}),e.j41(104,"mat-icon"),e.EFF(105,"error"),e.k0s(),e.EFF(106," Critical Only "),e.k0s()()()()(),e.j41(107,"mat-card",36)(108,"mat-card-content")(109,"div",37)(110,"table",38),e.qex(111,39),e.DNE(112,Ib,2,1,"th",40),e.DNE(113,Rb,7,6,"td",41),e.bVm(),e.qex(114,42),e.DNE(115,Nb,2,0,"th",40),e.DNE(116,Ab,6,8,"td",41),e.bVm(),e.qex(117,43),e.DNE(118,Db,2,0,"th",44),e.DNE(119,jb,6,2,"td",41),e.bVm(),e.qex(120,45),e.DNE(121,Bb,2,0,"th",44),e.DNE(122,Lb,5,4,"td",41),e.bVm(),e.qex(123,46),e.DNE(124,$b,2,0,"th",44),e.DNE(125,Gb,6,2,"td",41),e.bVm(),e.qex(126,47),e.DNE(127,Ub,2,0,"th",40),e.DNE(128,zb,4,4,"td",41),e.bVm(),e.qex(129,48),e.DNE(130,Vb,2,0,"th",44),e.DNE(131,Xb,11,4,"td",41),e.bVm(),e.DNE(132,Hb,1,0,"tr",49),e.DNE(133,Wb,1,0,"tr",50),e.k0s(),e.nrm(134,"mat-paginator",51),e.k0s()()(),e.DNE(135,Zb,48,3,"mat-card",52),e.k0s(),e.j41(136,"mat-menu",null,53),e.DNE(138,Qb,20,0,"ng-template",54),e.k0s()),2&r&&(e.R7$(9),e.AVh("active",!i.showTamil),e.R7$(2),e.Y8G("ngModel",i.showTamil),e.R7$(1),e.AVh("active",i.showTamil),e.R7$(2),e.Y8G("disabled",i.exporting),e.R7$(2),e.JRh(i.exporting?"hourglass_empty":"download"),e.R7$(1),e.SpI(" ",i.exporting?"Exporting...":"Bulk Download"," "),e.R7$(14),e.JRh(i.getHealthyStock()),e.R7$(11),e.JRh(i.getLowStock()),e.R7$(11),e.JRh(i.getCriticalStock()),e.R7$(11),e.JRh(i.getOverstock()),e.R7$(10),e.Y8G("formControl",i.searchControl),e.R7$(6),e.Y8G("value",i.selectedCategory),e.R7$(3),e.Y8G("ngForOf",i.categories),e.R7$(4),e.Y8G("value",i.selectedStatus),e.R7$(12),e.AVh("active",i.showOnlyLowStock),e.R7$(4),e.AVh("active",i.showOnlyCritical),e.R7$(7),e.Y8G("dataSource",i.dataSource),e.R7$(22),e.Y8G("matHeaderRowDef",i.displayedColumns),e.R7$(1),e.Y8G("matRowDefColumns",i.displayedColumns),e.R7$(1),e.Y8G("pageSizeOptions",e.lJ4(25,Jb)),e.R7$(1),e.Y8G("ngIf",i.showQuickUpdate))},dependencies:[D.Sq,D.bT,b.qT,b.me,b.Q0,b.BC,b.cb,b.l_,b.j4,b.JD,b.vS,j.RN,j.m2,j.MM,j.dh,B.$z,B.iY,H.An,ae.kk,ae.fb,ae.z8,ae.Cp,ge.rl,ge.nJ,ge.JW,Ee.fg,_e.Zl,_e.tL,_e.ji,_e.cC,_e.YV,_e.iL,_e.KS,_e.$R,_e.YZ,_e.NB,lt.iy,$t.B4,$t.aE,ze.VO,Bt.wT,qe.oV,Ae.sG,D.vh],styles:[".inventory-container[_ngcontent-%COMP%]{padding:24px;background-color:#f5f5f5;min-height:calc(100vh - 64px)}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.page-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:600;margin:0 0 4px;color:#1f2937}.page-subtitle[_ngcontent-%COMP%]{font-size:1rem;color:#6b7280;margin:0}.header-actions[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.language-toggle-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);padding:8px 16px;border-radius:24px;margin-right:8px;box-shadow:0 2px 8px #667eea4d}.lang-label[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600;color:#fff9;transition:all .3s ease}.lang-label.active[_ngcontent-%COMP%]{color:#fff;text-shadow:0 0 8px rgba(255,255,255,.5)}.lang-label.tamil[_ngcontent-%COMP%]{font-family:Noto Sans Tamil,Latha,sans-serif}.language-toggle[_ngcontent-%COMP%]     .mat-mdc-slide-toggle .mdc-switch__track{background-color:#ffffff4d!important}.language-toggle[_ngcontent-%COMP%]     .mat-mdc-slide-toggle.mat-mdc-slide-toggle-checked .mdc-switch__track{background-color:#ffffff80!important}.tamil-text[_ngcontent-%COMP%]{font-family:Noto Sans Tamil,Latha,Tamil Sangam MN,sans-serif}.summary-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:24px}.summary-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #0000001a;overflow:hidden}.summary-card.healthy[_ngcontent-%COMP%]{border-left:4px solid #10b981}.summary-card.low[_ngcontent-%COMP%]{border-left:4px solid #f59e0b}.summary-card.critical[_ngcontent-%COMP%]{border-left:4px solid #ef4444}.summary-card.overstock[_ngcontent-%COMP%]{border-left:4px solid #6366f1}.card-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.card-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff}.summary-card.healthy[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{background:#10b981}.summary-card.low[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{background:#f59e0b}.summary-card.critical[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{background:#ef4444}.summary-card.overstock[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{background:#6366f1}.card-details[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;margin:0;color:#1f2937}.card-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem;color:#6b7280;margin:0}.filters-card[_ngcontent-%COMP%]{margin-bottom:16px;border-radius:12px;box-shadow:0 2px 8px #0000001a}.filters-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:16px}.filter-group[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center}.action-group[_ngcontent-%COMP%]{display:flex;gap:8px}.action-group[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.table-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #0000001a;margin-bottom:16px}.table-container[_ngcontent-%COMP%]{overflow-x:auto}.inventory-table[_ngcontent-%COMP%]{width:100%;min-width:1000px}.product-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.product-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 2px;font-size:.9rem;font-weight:600;color:#1f2937}.product-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.8rem;color:#6b7280}.stock-cell[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.stock-value[_ngcontent-%COMP%]{font-weight:600;font-size:.9rem}.stock-value.healthy[_ngcontent-%COMP%]{color:#10b981}.stock-value.low[_ngcontent-%COMP%]{color:#f59e0b}.stock-value.critical[_ngcontent-%COMP%]{color:#ef4444}.stock-value.overstock[_ngcontent-%COMP%]{color:#6366f1}.stock-bar[_ngcontent-%COMP%]{width:60px;height:4px;background:#e5e7eb;border-radius:2px;overflow:hidden}.stock-fill[_ngcontent-%COMP%]{height:100%;transition:width .3s ease}.stock-fill.healthy[_ngcontent-%COMP%]{background:#10b981}.stock-fill.low[_ngcontent-%COMP%]{background:#f59e0b}.stock-fill.critical[_ngcontent-%COMP%]{background:#ef4444}.stock-fill.overstock[_ngcontent-%COMP%]{background:#6366f1}.min-max-cell[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.min-stock[_ngcontent-%COMP%], .max-stock[_ngcontent-%COMP%]{font-size:.8rem;color:#6b7280}.status-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:4px 8px;border-radius:16px;font-size:.8rem;font-weight:500}.status-badge.status-healthy[_ngcontent-%COMP%]{background:#dcfce7;color:#16a34a}.status-badge.status-low[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.status-badge.status-critical[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626}.status-badge.status-overstock[_ngcontent-%COMP%]{background:#ede9fe;color:#7c3aed}.pricing-cell[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.price[_ngcontent-%COMP%]{font-weight:600;color:#1f2937}.cost[_ngcontent-%COMP%], .date-value[_ngcontent-%COMP%]{font-size:.8rem;color:#6b7280}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:4px}.quick-update-card[_ngcontent-%COMP%]{position:fixed;bottom:24px;right:24px;width:400px;z-index:1000;border-radius:12px;box-shadow:0 8px 24px #0003}.quick-update-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px}.form-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:flex-end}@media (max-width: 768px){.inventory-container[_ngcontent-%COMP%]{padding:16px}.page-header[_ngcontent-%COMP%]{flex-direction:column;gap:16px;text-align:center}.summary-cards[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}.filters-section[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.filter-group[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.quick-update-card[_ngcontent-%COMP%]{position:static;width:100%;margin-top:16px}.quick-update-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})}}return n})();var e4=E(8032),sn=E.n(e4);let t4=(()=>{class n{constructor(t){this.http=t,this.apiUrl=`${Oe.c.apiUrl}/delivery/assignments`}assignOrder(t){return this.http.post(this.apiUrl,t)}getOrderAssignments(t){return this.http.get(`${this.apiUrl}/order/${t}`)}getPartnerAssignments(t){return this.http.get(`${this.apiUrl}/partner/${t}`)}getActiveAssignments(t){return this.http.get(`${this.apiUrl}/partner/${t}/active`)}acceptAssignment(t,r){return this.http.put(`${this.apiUrl}/${t}/accept`,{partnerId:r})}rejectAssignment(t,r,i){return this.http.put(`${this.apiUrl}/${t}/reject`,{partnerId:r,reason:i})}markPickedUp(t,r){return this.http.put(`${this.apiUrl}/${t}/pickup`,{partnerId:r})}markDelivered(t,r,i){return this.http.put(`${this.apiUrl}/${t}/complete`,{partnerId:r,notes:i})}static{this.\u0275fac=function(r){return new(r||n)(e.KVO(gt.Qq))}}static{this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var n4=E(2150);function r4(n,o){if(1&n&&(e.j41(0,"span",33),e.EFF(1),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.SpI("Last synced: ",t.getTimeSinceSync(),"")}}function i4(n,o){if(1&n&&(e.j41(0,"div",30)(1,"mat-icon"),e.EFF(2,"cloud_off"),e.k0s(),e.j41(3,"span",31),e.EFF(4,"You're offline. Showing cached data."),e.k0s(),e.DNE(5,r4,2,1,"span",32),e.k0s()),2&n){const t=e.XpG();e.R7$(5),e.Y8G("ngIf",t.lastSyncTime)}}function o4(n,o){if(1&n&&(e.j41(0,"div",58)(1,"span",59),e.EFF(2),e.k0s(),e.j41(3,"span",60),e.EFF(4),e.nI1(5,"number"),e.k0s()()),2&n){const t=o.$implicit;e.R7$(2),e.Lme("",t.quantity,"x ",t.name,""),e.R7$(2),e.SpI("\u20b9",e.bMT(5,3,(t.price||t.unitPrice)*t.quantity),"")}}function a4(n,o){if(1&n&&(e.j41(0,"div",61)(1,"mat-icon"),e.EFF(2,"location_on"),e.k0s(),e.j41(3,"span"),e.EFF(4),e.k0s()()),2&n){const t=e.XpG().$implicit;e.R7$(4),e.JRh(t.deliveryAddress)}}function s4(n,o){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"button",62),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.acceptOrder(i))}),e.j41(2,"mat-icon"),e.EFF(3,"check"),e.k0s(),e.EFF(4," Accept "),e.k0s(),e.j41(5,"button",63),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.rejectOrder(i))}),e.j41(6,"mat-icon"),e.EFF(7,"close"),e.k0s(),e.EFF(8," Reject "),e.k0s(),e.bVm()}}function c4(n,o){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"button",64),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.startPreparing(i.id))}),e.j41(2,"mat-icon"),e.EFF(3,"restaurant"),e.k0s(),e.EFF(4," Start Preparing "),e.k0s(),e.bVm()}}function l4(n,o){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"button",65),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.markReady(i.id))}),e.j41(2,"mat-icon"),e.EFF(3,"done"),e.k0s(),e.EFF(4," Mark Ready "),e.k0s(),e.bVm()}}function d4(n,o){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"button",66),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.assignDelivery(i.id))}),e.j41(2,"mat-icon"),e.EFF(3,"local_shipping"),e.k0s(),e.EFF(4," Assign Delivery "),e.k0s(),e.bVm()}}function u4(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",56),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.callCustomer(i.customerPhone))}),e.j41(1,"mat-icon"),e.EFF(2,"phone"),e.k0s(),e.EFF(3," Call Customer "),e.k0s()}}function g4(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",34)(1,"div",35)(2,"div",36)(3,"h3"),e.EFF(4),e.k0s(),e.j41(5,"mat-chip",37),e.EFF(6),e.k0s()(),e.j41(7,"div",38)(8,"mat-icon"),e.EFF(9,"access_time"),e.k0s(),e.j41(10,"span"),e.EFF(11),e.k0s()()(),e.j41(12,"div",39)(13,"div",40)(14,"div",41)(15,"mat-icon"),e.EFF(16,"person"),e.k0s(),e.j41(17,"div")(18,"p",42),e.EFF(19),e.k0s(),e.j41(20,"p",43),e.EFF(21),e.k0s()()(),e.j41(22,"div",44)(23,"span",45),e.EFF(24),e.nI1(25,"number"),e.k0s(),e.j41(26,"span",46),e.EFF(27),e.k0s()()(),e.j41(28,"div",47)(29,"div",48),e.DNE(30,o4,6,5,"div",49),e.k0s()(),e.DNE(31,a4,5,1,"div",50),e.k0s(),e.j41(32,"div",51),e.DNE(33,s4,9,0,"ng-container",52),e.DNE(34,c4,5,0,"ng-container",52),e.DNE(35,l4,5,0,"ng-container",52),e.DNE(36,d4,5,0,"ng-container",52),e.j41(37,"button",53),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.printReceipt(a.id))}),e.j41(38,"mat-icon"),e.EFF(39,"print"),e.k0s()(),e.j41(40,"button",54)(41,"mat-icon"),e.EFF(42,"more_vert"),e.k0s()(),e.j41(43,"mat-menu",null,55)(45,"button",56),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.viewOrderDetails(a))}),e.j41(46,"mat-icon"),e.EFF(47,"visibility"),e.k0s(),e.EFF(48," View Details "),e.k0s(),e.DNE(49,u4,4,0,"button",57),e.j41(50,"button",56),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.reportIssue(a.id))}),e.j41(51,"mat-icon"),e.EFF(52,"report_problem"),e.k0s(),e.EFF(53," Report Issue "),e.k0s()()()()}if(2&n){const t=o.$implicit,r=e.sdS(44),i=e.XpG();e.Y8G("ngClass","status-"+t.status.toLowerCase()),e.R7$(4),e.SpI("Order #",t.orderNumber,""),e.R7$(1),e.Y8G("ngClass",i.getStatusClass(t.status)),e.R7$(1),e.SpI(" ",i.getStatusLabel(t.status)," "),e.R7$(5),e.JRh(i.formatDate(t.createdAt)),e.R7$(8),e.JRh(t.customerName),e.R7$(2),e.JRh(t.customerPhone||"No phone"),e.R7$(3),e.SpI("\u20b9",e.bMT(25,17,t.totalAmount),""),e.R7$(3),e.JRh("CASH_ON_DELIVERY"===t.paymentMethod?"COD":"Paid"),e.R7$(3),e.Y8G("ngForOf",t.items),e.R7$(1),e.Y8G("ngIf",t.deliveryAddress),e.R7$(2),e.Y8G("ngIf","PENDING"===t.status),e.R7$(1),e.Y8G("ngIf","CONFIRMED"===t.status),e.R7$(1),e.Y8G("ngIf","PREPARING"===t.status),e.R7$(1),e.Y8G("ngIf","READY_FOR_PICKUP"===t.status),e.R7$(4),e.Y8G("matMenuTriggerFor",r),e.R7$(9),e.Y8G("ngIf",t.customerPhone)}}function p4(n,o){if(1&n&&(e.j41(0,"div",67)(1,"mat-icon"),e.EFF(2,"inbox"),e.k0s(),e.j41(3,"h3"),e.EFF(4,"No orders found"),e.k0s(),e.j41(5,"p"),e.EFF(6),e.k0s()()),2&n){const t=e.XpG();e.R7$(6),e.JRh(t.searchTerm?"Try adjusting your search terms":"No orders available at this time")}}function f4(n,o){if(1&n&&(e.j41(0,"div",68)(1,"mat-icon"),e.EFF(2,"check_circle"),e.k0s(),e.EFF(3),e.k0s()),2&n){const t=e.XpG();e.R7$(3),e.SpI(" ",t.successMessage," ")}}function m4(n,o){if(1&n&&(e.j41(0,"div",69)(1,"mat-icon"),e.EFF(2,"error"),e.k0s(),e.EFF(3),e.k0s()),2&n){const t=e.XpG();e.R7$(3),e.SpI(" ",t.errorMessage," ")}}let Qp=(()=>{class n{constructor(t,r,i,a,s,l,u,p){this.http=t,this.router=r,this.orderService=i,this.assignmentService=a,this.partnerService=s,this.shopContext=l,this.snackBar=u,this.offlineStorage=p,this.destroy$=new _n.B,this.shopId=null,this.pendingOrders=[],this.activeOrders=[],this.completedOrders=[],this.selectedTab=0,this.loading=!1,this.autoRefreshEnabled=!0,this.refreshInterval=3e4,this.totalOrders=0,this.todayRevenue=0,this.searchTerm="",this.filteredOrders=[],this.successMessage="",this.errorMessage="",this.selectedStatus="",this.todayStats={totalOrders:0,pendingOrders:0,completedOrders:0,revenue:0,averageOrderValue:0,totalProfit:0,profitMargin:0},this.showProfitDetails=!1,this.profitBreakdown={totalRevenue:0,totalCost:0,totalProfit:0,topProfitableItems:[]},this.isOffline=!1,this.lastSyncTime=null,this.apiUrl=Oe.c.apiUrl,this.showAssignmentModal=!1,this.selectedOrder=null,this.availablePartners=[],this.loadingPartners=!1,this.partnerAssignments={}}ngOnInit(){console.log("Order Management Component initialized"),this.isOffline=!navigator.onLine,window.addEventListener("online",()=>this.handleOnline()),window.addEventListener("offline",()=>this.handleOffline());const t=localStorage.getItem("current_shop_id");t?(this.shopId=t,console.log("Using shop ID from localStorage:",this.shopId)):console.warn("No shop ID in localStorage"),this.shopId&&(this.loadAllData(),this.startAutoRefresh(),this.loadLastSyncTime()),this.shopContext.shop$.pipe((0,ot.Q)(this.destroy$)).subscribe(r=>{r?(console.log("Shop context loaded:",r,"Updating shopId to:",r.id),this.shopId=r.id.toString(),localStorage.setItem("current_shop_id",this.shopId),this.loadAllData(),this.loadLastSyncTime()):this.shopId||console.error("No shop context available and no shop ID in localStorage")})}handleOnline(){console.log("Network online - refreshing orders"),this.isOffline=!1,this.snackBar.open("Back online! Refreshing orders...","Close",{duration:3e3}),this.loadAllData()}handleOffline(){console.log("Network offline - using cached data"),this.isOffline=!0,this.snackBar.open("You are offline. Showing cached orders.","Close",{duration:3e3})}loadLastSyncTime(){var t=this;return(0,fe.A)(function*(){if(t.shopId)try{t.lastSyncTime=yield t.offlineStorage.getOrdersCacheSyncTime(parseInt(t.shopId,10))}catch(r){console.warn("Error loading last sync time:",r)}})()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadAllData(){this.shopId&&this.loadOrders()}loadOrders(){var r,t=this;console.log("=== loadOrders called ==="),console.log("shopId:",this.shopId),console.log("isOffline:",this.isOffline),this.shopId?(this.loading=!0,navigator.onLine?(console.log("Starting to load orders for shop ID:",this.shopId),this.orderService.getOrdersByShop(this.shopId,0,100).pipe((0,ot.Q)(this.destroy$)).subscribe({next:(r=(0,fe.A)(function*(i){console.log("=== API Response received ==="),console.log("Full API response:",i),console.log("Response type:",typeof i),console.log("Response keys:",Object.keys(i));const a=i.data.content||[];console.log("Extracted orders:",a),console.log("Orders count:",a.length),t.categorizeOrders(a),t.calculateTodayStats(a),t.loading=!1,t.isOffline=!1,console.log("=== Orders successfully loaded ==="),console.log("Pending:",t.pendingOrders.length),console.log("Active:",t.activeOrders.length),console.log("Completed:",t.completedOrders.length),console.log("Today Stats:",t.todayStats);try{yield t.offlineStorage.saveOrdersCache(a,parseInt(t.shopId,10)),t.lastSyncTime=new Date,console.log("Orders cached successfully")}catch(s){console.warn("Error caching orders:",s)}}),function(a){return r.apply(this,arguments)}),error:function(){var r=(0,fe.A)(function*(i){console.error("=== API Error ==="),console.error("Error loading orders:",i),console.error("Error status:",i.status),console.error("Error message:",i.message),yield t.loadOrdersFromCache()});return function(a){return r.apply(this,arguments)}}()})):this.loadOrdersFromCache()):console.log("No shopId available, aborting load")}loadOrdersFromCache(){var t=this;return(0,fe.A)(function*(){if(t.shopId){console.log("Loading orders from cache..."),t.isOffline=!0;try{const r=yield t.offlineStorage.getOrdersCache(parseInt(t.shopId,10));t.lastSyncTime=yield t.offlineStorage.getOrdersCacheSyncTime(parseInt(t.shopId,10)),r&&r.length>0?(console.log("Loaded",r.length,"orders from cache"),t.categorizeOrders(r),t.calculateTodayStats(r),t.snackBar.open(`Showing ${r.length} cached orders`,"Close",{duration:3e3})):(console.log("No cached orders found"),t.pendingOrders=[],t.activeOrders=[],t.completedOrders=[],t.snackBar.open("No cached orders available. Connect to internet to load orders.","Close",{duration:5e3}))}catch(r){console.error("Error loading orders from cache:",r),t.handleError("Failed to load cached orders")}t.loading=!1}else t.loading=!1})()}categorizeOrders(t){this.pendingOrders=t.filter(r=>"PENDING"===r.status),this.activeOrders=t.filter(r=>["CONFIRMED","PREPARING","READY_FOR_PICKUP","OUT_FOR_DELIVERY"].includes(r.status)),this.completedOrders=t.filter(r=>["DELIVERED","CANCELLED","SELF_PICKUP_COLLECTED"].includes(r.status))}calculateTodayStats(t){const r=(new Date).toDateString(),i=t.filter(p=>new Date(p.createdAt).toDateString()===r),a=i.length,s=i.filter(p=>"PENDING"===p.status).length,l=i.filter(p=>["DELIVERED","SELF_PICKUP_COLLECTED"].includes(p.status)).length,u=i.filter(p=>["DELIVERED","SELF_PICKUP_COLLECTED"].includes(p.status)).reduce((p,f)=>p+f.totalAmount,0);this.todayStats={totalOrders:a,pendingOrders:s,completedOrders:l,revenue:u,averageOrderValue:a>0?u/a:0,totalProfit:.2*u,profitMargin:20}}getAllOrders(){return[...this.pendingOrders,...this.activeOrders,...this.completedOrders]}startAutoRefresh(){this.autoRefreshEnabled&&(0,_r.Y)(this.refreshInterval).pipe((0,ot.Q)(this.destroy$)).subscribe(()=>{console.log("Auto-refreshing orders..."),this.loadAllData()})}refreshOrders(){this.loadAllData(),this.snackBar.open("Orders refreshed","Close",{duration:2e3}),console.log("Orders refreshed manually")}acceptOrder(t){console.log("Accepting order:",t.id),sn().fire({title:"Accept Order?",text:`Accept order ${t.orderNumber}?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#28a745",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, Accept!",cancelButtonText:"Cancel"}).then(r=>{r.isConfirmed&&this.performOrderAction(t.id,"accept","Order accepted successfully!")})}rejectOrder(t){console.log("Rejecting order:",t.id),sn().fire({title:"Reject Order",text:`Please provide a reason for rejecting order ${t.orderNumber}:`,input:"textarea",inputPlaceholder:"Enter rejection reason...",inputValidator:r=>r?r.length<10?"Rejection reason must be at least 10 characters long":null:"Please provide a reason for rejection",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Reject Order",cancelButtonText:"Cancel",allowOutsideClick:!1,allowEscapeKey:!1}).then(r=>{r.isConfirmed&&r.value&&this.performOrderReject(t.id,r.value)})}markAsReady(t){console.log("Marking order as ready:",t.id),sn().fire({title:"Mark as Ready?",text:`Mark order ${t.orderNumber} as ready for pickup/delivery?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#007bff",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, Mark Ready!",cancelButtonText:"Cancel"}).then(r=>{r.isConfirmed&&this.performOrderAction(t.id,"ready","Order marked as ready for delivery!")})}markAsPreparing(t){this.performOrderAction(t.id,"prepare","Order is now being prepared!")}performOrderReject(t,r){this.orderService.rejectOrder(t,r).pipe((0,ot.Q)(this.destroy$)).subscribe({next:i=>{console.log("Order reject response:",i),this.loadAllData(),this.snackBar.open("Order rejected successfully!","Close",{duration:3e3}),sn().fire({title:"Order Rejected!",text:"Order has been rejected successfully.",icon:"success",timer:3e3,timerProgressBar:!0})},error:i=>{console.error("Error rejecting order:",i),this.handleError("Failed to reject order. Please try again.")}})}performOrderAction(t,r,i){let a;switch(r){case"accept":a=this.orderService.acceptOrder(t);break;case"ready":a=this.orderService.markOrderAsReady(t);break;case"prepare":a=this.orderService.markOrderAsPreparing(t);break;default:return void console.error("Unknown action:",r)}a.pipe((0,ot.Q)(this.destroy$)).subscribe({next:s=>{console.log(`Order ${r} response:`,s),this.loadAllData(),this.snackBar.open(i,"Close",{duration:3e3}),sn().fire({title:"Success!",text:i,icon:"success",timer:3e3,timerProgressBar:!0})},error:s=>{console.error(`Error performing order action ${r}:`,s),this.handleError(`Failed to ${r} order. Please try again.`)}})}viewOrderDetails(t){let r="";t.orderItems&&t.orderItems.length>0&&(r=t.orderItems.map(i=>`<div class="order-item">\n          <span>${i.productName}</span> \n          <span>\xd7 ${i.quantity}</span>\n          <span>\u20b9${i.totalPrice}</span>\n        </div>`).join("")),sn().fire({title:`Order ${t.orderNumber}`,html:`\n        <div class="order-details">\n          <p><strong>Customer:</strong> ${t.customerName||"N/A"}</p>\n          <p><strong>Phone:</strong> ${t.customerPhone||"N/A"}</p>\n          <p><strong>Status:</strong> <span class="badge ${this.getStatusBadgeClass(t.status)}">${t.status}</span></p>\n          <p><strong>Payment:</strong> ${t.paymentMethod} (${t.paymentStatus})</p>\n          <p><strong>Total:</strong> \u20b9${t.totalAmount}</p>\n          <hr>\n          <h4>Items:</h4>\n          ${r||"<p>No items available</p>"}\n          ${t.specialInstructions?`<hr><p><strong>Instructions:</strong> ${t.specialInstructions}</p>`:""}\n        </div>\n      `,width:600,showCloseButton:!0,showConfirmButton:!1})}handleError(t){this.snackBar.open(t,"Close",{duration:5e3,panelClass:["error-snackbar"]})}toggleAutoRefresh(){this.autoRefreshEnabled=!this.autoRefreshEnabled,console.log("Auto-refresh:",this.autoRefreshEnabled?"enabled":"disabled"),this.autoRefreshEnabled&&this.startAutoRefresh()}getStatusBadgeClass(t){switch(t){case"PENDING":return"badge-warning";case"CONFIRMED":case"OUT_FOR_DELIVERY":return"badge-info";case"PREPARING":return"badge-primary";case"READY_FOR_PICKUP":case"DELIVERED":return"badge-success";case"CANCELLED":return"badge-danger";default:return"badge-secondary"}}formatCurrency(t){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(t)}formatDate(t){return new Date(t).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}getOrderCount(t){switch(t){case 0:return this.pendingOrders.length;case 1:return this.activeOrders.length;case 2:return this.completedOrders.length;default:return 0}}selectTab(t){this.selectedTab=t}getStatusColor(t){switch(t){case"PENDING":return"#ffc107";case"CONFIRMED":case"OUT_FOR_DELIVERY":return"#17a2b8";case"PREPARING":return"#007bff";case"READY_FOR_PICKUP":case"DELIVERED":return"#28a745";case"CANCELLED":return"#dc3545";default:return"#6c757d"}}getStatusIcon(t){switch(t){case"PENDING":return"schedule";case"CONFIRMED":return"check_circle";case"PREPARING":return"restaurant";case"READY_FOR_PICKUP":return"done_all";case"OUT_FOR_DELIVERY":return"local_shipping";case"DELIVERED":return"verified";case"CANCELLED":return"cancel";default:return"help"}}printOrder(t){const r=localStorage.getItem("shop_name")||"Shop",i=t.orderItems||t.items||[],a=new Date(t.createdAt),s=a.toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric"}),l=a.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0}),u=i.map(_=>{const P=_.quantity||1,x=_.unitPrice||_.price||0;return`\n        <tr>\n          <td style="text-align: left; padding: 4px 0; font-size: 11px;">${_.productName||_.name||"Item"}</td>\n          <td style="text-align: right; font-size: 11px;">${x}</td>\n          <td style="text-align: center; font-size: 11px;">${P}</td>\n          <td style="text-align: right; font-size: 11px;">${_.totalPrice||P*x}</td>\n        </tr>\n      `}).join(""),p=i.reduce((_,C)=>_+(C.quantity||1),0),f=`\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <meta charset="UTF-8">\n        <title>Receipt - ${t.orderNumber}</title>\n        <style>\n          @page { size: 58mm auto; margin: 1mm; }\n          @media print {\n            body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }\n            .no-print { display: none !important; }\n          }\n          body {\n            font-family: 'Noto Sans Tamil', Arial, sans-serif;\n            font-size: 12px;\n            width: 180px;\n            max-width: 180px;\n            margin: 0 auto;\n            padding: 8px;\n            line-height: 1.3;\n          }\n          .center { text-align: center; }\n          .divider { border-top: 1px dashed #000; margin: 6px 0; }\n          table { width: 100%; border-collapse: collapse; }\n          .shop-name { font-size: 16px; font-weight: 700; margin-bottom: 3px; }\n          .order-number {\n            background: #1a1a1a;\n            color: white;\n            padding: 4px 10px;\n            border-radius: 4px;\n            display: inline-block;\n            font-size: 11px;\n            font-weight: 600;\n          }\n          .total-row { font-weight: 700; font-size: 14px; }\n          .print-btn {\n            background: #22c55e;\n            color: white;\n            border: none;\n            padding: 12px 32px;\n            font-size: 14px;\n            font-weight: 600;\n            border-radius: 8px;\n            cursor: pointer;\n            margin: 10px 5px;\n          }\n          .close-btn {\n            background: #666;\n            color: white;\n            border: none;\n            padding: 10px 24px;\n            font-size: 13px;\n            border-radius: 8px;\n            cursor: pointer;\n            margin: 10px 5px;\n          }\n        </style>\n      </head>\n      <body>\n        <div class="center">\n          <div class="shop-name">${r}</div>\n          <div style="font-size: 10px; color: #666;">Order Receipt</div>\n        </div>\n        <div class="divider"></div>\n\n        <div class="center">\n          <div class="order-number">#${t.orderNumber}</div>\n        </div>\n        <div style="font-size: 10px; text-align: center; margin: 4px 0;">\n          ${s} | ${l}\n        </div>\n        <div class="divider"></div>\n\n        ${t.customerName||t.customerPhone?`\n        <div style="margin-bottom: 4px;">\n          ${t.customerName?`<div style="font-weight: 600;">${t.customerName}</div>`:""}\n          ${t.customerPhone?`<div style="font-size: 11px;">${t.customerPhone}</div>`:""}\n        </div>\n        <div class="divider"></div>\n        `:""}\n\n        <table>\n          <thead>\n            <tr style="border-bottom: 1px solid #ddd;">\n              <th style="text-align: left; font-size: 10px; padding-bottom: 4px;">ITEM</th>\n              <th style="text-align: right; font-size: 10px;">RATE</th>\n              <th style="text-align: center; font-size: 10px;">QTY</th>\n              <th style="text-align: right; font-size: 10px;">AMT</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${u}\n          </tbody>\n        </table>\n        <div class="divider"></div>\n\n        <div style="display: flex; justify-content: space-between; font-size: 11px;">\n          <span>Items: ${i.length} (Qty: ${p})</span>\n          <span>\u20b9${t.subtotal||t.totalAmount}</span>\n        </div>\n        ${t.discountAmount>0?`\n        <div style="display: flex; justify-content: space-between; font-size: 11px; color: #22c55e;">\n          <span>You Save</span>\n          <span>\u20b9${t.discountAmount}</span>\n        </div>\n        `:""}\n        <div class="divider" style="border-top: 1px solid #000;"></div>\n\n        <div style="display: flex; justify-content: space-between;" class="total-row">\n          <span>TOTAL</span>\n          <span>\u20b9${t.totalAmount}</span>\n        </div>\n        <div class="divider"></div>\n\n        <div class="center" style="margin: 4px 0;">\n          <span style="background: #e8f5e9; padding: 3px 10px; border-radius: 4px; font-size: 11px;">\n            \u{1f4b5} ${t.paymentMethod||"CASH"}\n          </span>\n        </div>\n        <div class="divider"></div>\n\n        <div class="center" style="font-size: 10px; color: #666;">\n          Thank you for your order!<br>\n          Printed: ${(new Date).toLocaleString("en-IN")}\n        </div>\n\n        <div class="center no-print" style="margin-top: 15px;">\n          <button class="print-btn" onclick="window.print()">\u{1f5a8}\ufe0f PRINT</button>\n          <button class="close-btn" onclick="window.close()">Close</button>\n        </div>\n      </body>\n      </html>\n    `,h=window.open("","_blank","width=300,height=600");h&&(h.document.write(f),h.document.close())}toggleProfitDetails(){this.showProfitDetails=!this.showProfitDetails}sendDailySummary(){this.snackBar.open("Daily summary sent!","Close",{duration:2e3})}assignDeliveryPartner(t){this.selectedOrder=t,this.showAssignmentModal=!0,this.loadAvailablePartners()}closeAssignmentModal(){this.showAssignmentModal=!1,this.selectedOrder=null,this.availablePartners=[],this.partnerAssignments={}}loadAvailablePartners(){this.loadingPartners=!0,this.partnerService.getAvailablePartners().pipe((0,ot.Q)(this.destroy$)).subscribe({next:t=>{t&&t.data?(this.availablePartners=t.data,this.loadPartnerWorkloads()):this.availablePartners=[],this.loadingPartners=!1},error:t=>{console.error("Error loading partners:",t),this.availablePartners=[],this.loadingPartners=!1,this.snackBar.open("Failed to load delivery partners","Close",{duration:3e3})}})}loadPartnerWorkloads(){this.availablePartners.forEach(t=>{this.assignmentService.getActiveAssignments(t.id).pipe((0,ot.Q)(this.destroy$)).subscribe({next:r=>{this.partnerAssignments[t.id]=r&&r.data?r.data.length:0},error:r=>{console.error(`Error loading assignments for partner ${t.id}:`,r),this.partnerAssignments[t.id]=0}})})}assignToPartner(t,r){this.assignmentService.assignOrder({orderId:t,deliveryPartnerId:r,notes:"Assigned from order management dashboard"}).pipe((0,ot.Q)(this.destroy$)).subscribe({next:a=>{console.log("Order assigned successfully:",a),this.snackBar.open("Order assigned to delivery partner!","Close",{duration:3e3}),sn().fire({title:"Success!",text:"Order has been assigned to delivery partner.",icon:"success",timer:3e3,timerProgressBar:!0}),this.closeAssignmentModal(),this.loadAllData()},error:a=>{console.error("Error assigning order:",a),this.snackBar.open("Failed to assign order. Please try again.","Close",{duration:3e3}),sn().fire({title:"Error!",text:"Failed to assign order to delivery partner.",icon:"error"})}})}getActiveOrdersCount(t){return this.partnerAssignments[t]||0}getVehicleIcon(t){switch(t){case"BIKE":return"\u{1f3cd}\ufe0f";case"SCOOTER":return"\u{1f6f5}";case"BICYCLE":return"\u{1f6b2}";case"CAR":return"\u{1f697}";case"AUTO":return"\u{1f6fa}";default:return"\u{1f69a}"}}assignDelivery(t){console.log("Navigating to delivery management for order:",t),this.router.navigate(["/shop-owner/delivery-management"],{queryParams:{orderId:t}})}printReceipt(t){this.snackBar.open("Receipt printing feature will be implemented","Close",{duration:3e3})}callCustomer(t){t&&window.open(`tel:${t}`,"_self")}reportIssue(t){this.snackBar.open("Issue reporting feature will be implemented","Close",{duration:3e3})}applyFilter(){this.filteredOrders=this.pendingOrders.filter(t=>!this.searchTerm||t.orderNumber.toLowerCase().includes(this.searchTerm.toLowerCase())||t.customerName&&t.customerName.toLowerCase().includes(this.searchTerm.toLowerCase()))}getStatusClass(t){switch(t){case"PENDING":return"status-pending";case"CONFIRMED":return"status-confirmed";case"PREPARING":return"status-preparing";case"READY_FOR_PICKUP":return"status-ready";case"OUT_FOR_DELIVERY":return"status-delivery";case"DELIVERED":return"status-delivered";case"CANCELLED":return"status-cancelled";default:return""}}getStatusLabel(t){switch(t){case"PENDING":return"Pending";case"CONFIRMED":return"Confirmed";case"PREPARING":return"Preparing";case"READY_FOR_PICKUP":return"Ready";case"OUT_FOR_DELIVERY":return"Out for Delivery";case"DELIVERED":return"Delivered";case"CANCELLED":return"Cancelled";default:return t}}startPreparing(t){this.markAsPreparing(this.pendingOrders.find(r=>r.id===t))}markReady(t){this.markAsReady(this.activeOrders.find(r=>r.id===t))}getTimeSinceSync(){if(!this.lastSyncTime)return"Never synced";const r=(new Date).getTime()-this.lastSyncTime.getTime(),i=Math.floor(r/6e4);if(i<1)return"Just now";if(1===i)return"1 minute ago";if(i<60)return`${i} minutes ago`;const a=Math.floor(i/60);if(1===a)return"1 hour ago";if(a<24)return`${a} hours ago`;const s=Math.floor(a/24);return 1===s?"1 day ago":`${s} days ago`}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(gt.Qq),e.rXU(Xe.Ix),e.rXU(At.Q),e.rXU(t4),e.rXU(n4.WS),e.rXU($r.h),e.rXU(Ce.UG),e.rXU(at.m))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-order-management"]],decls:84,vars:14,consts:[[1,"simple-order-management"],["class","offline-banner",4,"ngIf"],[1,"stats-dashboard"],[1,"stat-card","total"],[1,"stat-icon"],[1,"stat-content"],[1,"stat-card","pending"],[1,"stat-card","active"],[1,"stat-card","completed"],[1,"stat-card","revenue"],[1,"search-filter-bar"],[1,"search-field"],["matInput","","placeholder","Order number, customer name",3,"ngModel","ngModelChange"],["matSuffix",""],[1,"filter-field"],[3,"ngModel","ngModelChange","selectionChange"],["value",""],["value","PENDING"],["value","CONFIRMED"],["value","PREPARING"],["value","READY_FOR_PICKUP"],["value","OUT_FOR_DELIVERY"],["value","DELIVERED"],["mat-raised-button","","color","primary",1,"refresh-btn",3,"click"],[1,"orders-container"],["class","order-card",3,"ngClass",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],[1,"message-container"],["class","success-message",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"offline-banner"],[1,"offline-text"],["class","sync-time",4,"ngIf"],[1,"sync-time"],[1,"order-card",3,"ngClass"],[1,"order-header"],[1,"order-title"],[3,"ngClass"],[1,"order-time"],[1,"order-content"],[1,"customer-section"],[1,"customer-info"],[1,"customer-name"],[1,"customer-phone"],[1,"order-total"],[1,"amount"],[1,"payment-method"],[1,"items-section"],[1,"items-list"],["class","order-item",4,"ngFor","ngForOf"],["class","address-section",4,"ngIf"],[1,"order-actions"],[4,"ngIf"],["mat-icon-button","","matTooltip","Print Receipt",1,"print-btn",3,"click"],["mat-icon-button","",1,"more-btn",3,"matMenuTriggerFor"],["orderMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],[1,"order-item"],[1,"item-name"],[1,"item-price"],[1,"address-section"],["mat-raised-button","",1,"accept-btn",3,"click"],["mat-stroked-button","",1,"reject-btn",3,"click"],["mat-raised-button","",1,"prepare-btn",3,"click"],["mat-raised-button","",1,"ready-btn",3,"click"],["mat-raised-button","",1,"assign-delivery-btn",3,"click"],[1,"empty-state"],[1,"success-message"],[1,"error-message"]],template:function(r,i){1&r&&(e.j41(0,"div",0),e.DNE(1,i4,6,1,"div",1),e.j41(2,"div",2)(3,"div",3)(4,"div",4)(5,"mat-icon"),e.EFF(6,"shopping_cart"),e.k0s()(),e.j41(7,"div",5)(8,"h3"),e.EFF(9),e.k0s(),e.j41(10,"p"),e.EFF(11,"Total Orders"),e.k0s()()(),e.j41(12,"div",6)(13,"div",4)(14,"mat-icon"),e.EFF(15,"hourglass_empty"),e.k0s()(),e.j41(16,"div",5)(17,"h3"),e.EFF(18),e.k0s(),e.j41(19,"p"),e.EFF(20,"Pending"),e.k0s()()(),e.j41(21,"div",7)(22,"div",4)(23,"mat-icon"),e.EFF(24,"restaurant"),e.k0s()(),e.j41(25,"div",5)(26,"h3"),e.EFF(27),e.k0s(),e.j41(28,"p"),e.EFF(29,"Preparing"),e.k0s()()(),e.j41(30,"div",8)(31,"div",4)(32,"mat-icon"),e.EFF(33,"check_circle"),e.k0s()(),e.j41(34,"div",5)(35,"h3"),e.EFF(36),e.k0s(),e.j41(37,"p"),e.EFF(38,"Completed"),e.k0s()()(),e.j41(39,"div",9)(40,"div",4)(41,"mat-icon"),e.EFF(42,"account_balance_wallet"),e.k0s()(),e.j41(43,"div",5)(44,"h3"),e.EFF(45),e.nI1(46,"number"),e.k0s(),e.j41(47,"p"),e.EFF(48,"Today's Revenue"),e.k0s()()()(),e.j41(49,"div",10)(50,"mat-form-field",11)(51,"mat-label"),e.EFF(52,"Search orders..."),e.k0s(),e.j41(53,"input",12),e.bIt("ngModelChange",function(s){return i.searchTerm=s})("ngModelChange",function(){return i.applyFilter()}),e.k0s(),e.j41(54,"mat-icon",13),e.EFF(55,"search"),e.k0s()(),e.j41(56,"mat-form-field",14)(57,"mat-label"),e.EFF(58,"Status"),e.k0s(),e.j41(59,"mat-select",15),e.bIt("ngModelChange",function(s){return i.selectedStatus=s})("selectionChange",function(){return i.applyFilter()}),e.j41(60,"mat-option",16),e.EFF(61,"All Orders"),e.k0s(),e.j41(62,"mat-option",17),e.EFF(63,"Pending"),e.k0s(),e.j41(64,"mat-option",18),e.EFF(65,"Confirmed"),e.k0s(),e.j41(66,"mat-option",19),e.EFF(67,"Preparing"),e.k0s(),e.j41(68,"mat-option",20),e.EFF(69,"Ready"),e.k0s(),e.j41(70,"mat-option",21),e.EFF(71,"Out for Delivery"),e.k0s(),e.j41(72,"mat-option",22),e.EFF(73,"Delivered"),e.k0s()()(),e.j41(74,"button",23),e.bIt("click",function(){return i.refreshOrders()}),e.j41(75,"mat-icon"),e.EFF(76,"refresh"),e.k0s(),e.EFF(77," Refresh "),e.k0s()(),e.j41(78,"div",24),e.DNE(79,g4,54,19,"div",25),e.DNE(80,p4,7,1,"div",26),e.k0s()(),e.j41(81,"div",27),e.DNE(82,f4,4,1,"div",28),e.DNE(83,m4,4,1,"div",29),e.k0s()),2&r&&(e.R7$(1),e.Y8G("ngIf",i.isOffline),e.R7$(8),e.JRh(i.totalOrders),e.R7$(9),e.JRh(i.pendingOrders.length),e.R7$(9),e.JRh(i.activeOrders.length),e.R7$(9),e.JRh(i.completedOrders.length),e.R7$(9),e.SpI("\u20b9",e.bMT(46,12,i.todayRevenue),""),e.R7$(8),e.Y8G("ngModel",i.searchTerm),e.R7$(6),e.Y8G("ngModel",i.selectedStatus),e.R7$(20),e.Y8G("ngForOf",i.filteredOrders),e.R7$(1),e.Y8G("ngIf",0===i.filteredOrders.length),e.R7$(2),e.Y8G("ngIf",i.successMessage),e.R7$(1),e.Y8G("ngIf",i.errorMessage))},dependencies:[D.YU,D.Sq,D.bT,b.me,b.BC,b.vS,B.$z,B.iY,H.An,ae.kk,ae.fb,ae.Cp,Ve.Jl,ge.rl,ge.nJ,ge.yw,Ee.fg,ze.VO,Bt.wT,qe.oV,D.QX],styles:[".offline-banner[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 20px;background:linear-gradient(135deg,#fff3e0 0%,#ffe0b2 100%);border:1px solid #ffb74d;border-radius:8px;margin-bottom:16px;color:#e65100;font-weight:500}.offline-banner[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px;color:#e65100}.offline-banner[_ngcontent-%COMP%]   .offline-text[_ngcontent-%COMP%]{flex:1}.offline-banner[_ngcontent-%COMP%]   .sync-time[_ngcontent-%COMP%]{font-size:13px;color:#f57c00;background:rgba(255,255,255,.6);padding:4px 12px;border-radius:12px}.order-management[_ngcontent-%COMP%]{padding:20px}.order-management[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:30px}.order-management[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin-bottom:12px}.order-management[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-icon.pending[_ngcontent-%COMP%]{background:#ff9800;color:#fff}.order-management[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-icon.completed[_ngcontent-%COMP%]{background:#4caf50;color:#fff}.order-management[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-icon.revenue[_ngcontent-%COMP%]{background:#2196f3;color:#fff}.order-management[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-icon.profit[_ngcontent-%COMP%]{background:#10b981;color:#fff}.order-management[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px}.order-management[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 4px;font-size:24px;font-weight:600}.order-management[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666;font-size:14px}.order-management[_ngcontent-%COMP%]   .profit-details[_ngcontent-%COMP%]{margin-bottom:20px}.order-management[_ngcontent-%COMP%]   .profit-details[_ngcontent-%COMP%]   .profit-breakdown[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:20px}.order-management[_ngcontent-%COMP%]   .profit-details[_ngcontent-%COMP%]   .profit-breakdown[_ngcontent-%COMP%]   .profit-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:12px;border-radius:8px;background:#f8f9fa}.order-management[_ngcontent-%COMP%]   .profit-details[_ngcontent-%COMP%]   .top-profitable-items[_ngcontent-%COMP%]   .item-profit[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #eee}.order-management[_ngcontent-%COMP%]   .profit-details[_ngcontent-%COMP%]   .top-profitable-items[_ngcontent-%COMP%]   .item-profit[_ngcontent-%COMP%]:last-child{border-bottom:none}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .tab-icon[_ngcontent-%COMP%]{margin-right:8px}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]{margin-top:20px}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]{margin-bottom:16px;box-shadow:0 2px 8px #0000001a;border-radius:8px;overflow:hidden}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card.pending[_ngcontent-%COMP%]{border-left:4px solid #ff9800;background:linear-gradient(135deg,#fff8e1 0%,#ffffff 100%)}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card.active[_ngcontent-%COMP%]{border-left:4px solid #2196f3;background:linear-gradient(135deg,#e3f2fd 0%,#ffffff 100%)}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card.completed[_ngcontent-%COMP%]{border-left:4px solid #4caf50;background:linear-gradient(135deg,#e8f5e8 0%,#ffffff 100%)}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{background:rgba(255,255,255,.8);padding:16px 20px}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:20px}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]{margin-bottom:16px}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0;display:flex;align-items:center;gap:8px}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#666;font-size:18px;width:18px;height:18px}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   .order-items[_ngcontent-%COMP%]{margin-bottom:16px}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   .order-items[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;font-size:16px;color:#333}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   .order-items[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:4px 0;font-size:14px}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   .order-total[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   .order-total[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:18px;color:#333}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap;justify-content:flex-end;align-items:center;padding:16px 20px;background:#fafafa;border-top:1px solid #eee}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   .accept-btn[_ngcontent-%COMP%]{background-color:#4caf50!important;color:#fff!important;font-weight:500;padding:10px 20px;min-width:100px}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   .accept-btn[_ngcontent-%COMP%]:hover{background-color:#45a049!important}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   .accept-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:6px}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   .reject-btn[_ngcontent-%COMP%]{background-color:#f44336!important;color:#fff!important;font-weight:500;padding:10px 20px;min-width:100px}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   .reject-btn[_ngcontent-%COMP%]:hover{background-color:#da190b!important}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   .reject-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:6px}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   .details-btn[_ngcontent-%COMP%]{background-color:transparent;color:#666;border:1px solid #ddd;padding:10px 16px}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   .details-btn[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   .details-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:4px}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]{padding:10px 16px;font-weight:500;min-width:110px}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:6px}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:#666}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#ddd;margin-bottom:16px}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;color:#999}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 16px}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);display:flex;justify-content:center;align-items:center;z-index:1000}.assignment-modal[_ngcontent-%COMP%]{background:white;border-radius:12px;max-width:600px;width:90%;max-height:80vh;overflow-y:auto;box-shadow:0 8px 32px #0003}.assignment-modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px;border-bottom:1px solid #e0e0e0}.assignment-modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#333}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:20px}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .order-summary[_ngcontent-%COMP%]{background:#f8f9fa;padding:15px;border-radius:8px;margin-bottom:20px}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .order-summary[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 10px;color:#2196f3}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .order-summary[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0;font-size:14px}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 15px;color:#333}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;padding:40px;justify-content:center;color:#666}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .partner-list[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .partner-list[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:15px;border:2px solid #e0e0e0;border-radius:8px;margin-bottom:12px;transition:all .2s ease}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .partner-list[_ngcontent-%COMP%]   .partner-card.online[_ngcontent-%COMP%]{border-color:#4caf50;background:#f8fff8}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .partner-list[_ngcontent-%COMP%]   .partner-card.offline[_ngcontent-%COMP%]{border-color:#ff9800;background:#fff8f0;opacity:.7}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .partner-list[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]{flex:1}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .partner-list[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   .partner-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .partner-list[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   .partner-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0;color:#333;font-size:16px}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .partner-list[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   .partner-header[_ngcontent-%COMP%]   .status-indicators[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .partner-list[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   .partner-header[_ngcontent-%COMP%]   .status-indicators[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{font-size:12px;padding:4px 8px;border-radius:12px;font-weight:500}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .partner-list[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   .partner-header[_ngcontent-%COMP%]   .status-indicators[_ngcontent-%COMP%]   .status.online[_ngcontent-%COMP%]{background:#4caf50;color:#fff}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .partner-list[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   .partner-header[_ngcontent-%COMP%]   .status-indicators[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]:not(.online){background:#ff9800;color:#fff}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .partner-list[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   .partner-header[_ngcontent-%COMP%]   .status-indicators[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#ff9800}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .partner-list[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   .partner-details[_ngcontent-%COMP%]{display:flex;gap:15px;font-size:13px;color:#666}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .partner-list[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   .partner-details[_ngcontent-%COMP%]   .vehicle[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .partner-list[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   .partner-details[_ngcontent-%COMP%]   .workload[_ngcontent-%COMP%]{color:#2196f3;font-weight:500}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .partner-list[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:120px;height:40px;font-weight:500}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .partner-list[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background:#ccc!important;color:#666!important}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .partner-list[_ngcontent-%COMP%]   .no-partners[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#666}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .partner-list[_ngcontent-%COMP%]   .no-partners[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:10px;color:#ccc}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partners-section[_ngcontent-%COMP%]   .partner-list[_ngcontent-%COMP%]   .no-partners[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px}@media (max-width: 768px){.order-management[_ngcontent-%COMP%]{padding:16px}.order-management[_ngcontent-%COMP%]   .stats-row[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.order-management[_ngcontent-%COMP%]   .orders-tabs[_ngcontent-%COMP%]   .orders-list[_ngcontent-%COMP%]   .order-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:12px;padding:8px 12px}.assignment-modal[_ngcontent-%COMP%]{width:95%;margin:20px}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]{flex-direction:column;gap:15px;text-align:center}.assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%], .assignment-modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}"]})}}return n})();var Jp=E(6932);let Kp=(()=>{class n{constructor(t,r,i){this.http=t,this.firebaseService=r,this.authService=i,this.apiUrl=`${Oe.c.apiUrl}`}getShopOrders(t,r=0,i=20){const a=(new gt.Nl).set("page",r.toString()).set("size",i.toString()),s=this.authService.getToken(),l=this.authService.isAuthenticated();return console.log("Making API request to:",`${this.apiUrl}/orders/shop/${t}`),console.log("Token from authService:",s),console.log("Full token value:",s?s.substring(0,20)+"...":"No token"),console.log("Authentication status:",l),this.http.get(`${this.apiUrl}/orders/shop/${t}`,{params:a}).pipe((0,vt.n)(u=>{const p=u.data?.content||[];console.log("API Response received - Orders:",p.length,"Total items:",u.data?.totalItems);const f=p.map(h=>({...h,items:(h.orderItems||[]).map(_=>({id:_.id,name:_.productName,productName:_.productName,quantity:_.quantity,price:_.unitPrice,unitPrice:_.unitPrice,total:_.totalPrice,totalPrice:_.totalPrice,unit:"pcs",image:_.productImageUrl,productImageUrl:_.productImageUrl,addedByShopOwner:_.addedByShopOwner||!1})),customerName:h.customerName,customerPhone:h.customerPhone||h.deliveryPhone,customerEmail:h.customerEmail,customerAddress:h.fullDeliveryAddress||h.deliveryAddress,deliveryAddress:h.fullDeliveryAddress||h.deliveryAddress}));return console.log("Transformed orders:",f),(0,He.of)(f)}),(0,wt.W)(u=>(console.error("API Error details:",u),console.error("Error status:",u.status),console.error("Error message:",u.message),(0,He.of)([]))))}acceptOrder(t,r,i){return this.http.post(`${this.apiUrl}/orders/${t}/accept`,{estimatedPreparationTime:r,notes:i}).pipe((0,vt.n)(s=>{const l=this.transformOrder(s.data);return this.firebaseService.sendOrderNotification(l.orderNumber,"CONFIRMED","Your order has been accepted and is being prepared"),(0,He.of)(l)}),(0,wt.W)(s=>{throw console.error("Error accepting order:",s),s}))}getOrderById(t){return this.http.get(`${this.apiUrl}/orders/${t}`).pipe((0,wi.T)(r=>this.transformOrder(r.data)),(0,wt.W)(r=>{throw console.error("Error fetching order:",r),r}))}rejectOrder(t,r){return this.http.post(`${this.apiUrl}/orders/${t}/reject`,{reason:r}).pipe((0,vt.n)(a=>{const s=this.transformOrder(a.data);return this.firebaseService.sendOrderNotification(s.orderNumber,"CANCELLED",`Order cancelled: ${r}`),(0,He.of)(s)}),(0,wt.W)(a=>{throw console.error("Error rejecting order:",a),a}))}updateOrderStatus(t,r){const i=(new gt.Nl).set("status",r);return this.http.put(`${this.apiUrl}/orders/${t}/status`,null,{params:i}).pipe((0,vt.n)(a=>{const s=this.transformOrder(a.data);let l="";switch(r){case"PREPARING":l="Your order is being prepared";break;case"READY_FOR_PICKUP":l="Your order is ready for pickup";break;case"OUT_FOR_DELIVERY":l="Your order is out for delivery";break;case"DELIVERED":l="Your order has been delivered"}return l&&this.firebaseService.sendOrderNotification(s.orderNumber,r,l),(0,He.of)(s)}),(0,wt.W)(a=>{throw console.error("Error updating order status:",a),a}))}startPreparing(t){return this.updateOrderStatus(t,"PREPARING")}markReady(t){return this.updateOrderStatus(t,"READY_FOR_PICKUP")}markDelivered(t){return this.updateOrderStatus(t,"DELIVERED")}handoverSelfPickup(t){return this.http.post(`${this.apiUrl}/orders/${t}/handover-self-pickup`,{}).pipe((0,wt.W)(r=>{throw console.error("Error handing over self-pickup order:",r),r}))}verifyPickupOTP(t,r){return this.http.post(`${this.apiUrl}/orders/${t}/verify-pickup-otp`,{otp:r}).pipe((0,wt.W)(a=>{throw console.error("Error verifying pickup OTP:",a),a}))}getPendingOrders(t){return this.getShopOrders(t).pipe((0,vt.n)(r=>(0,He.of)(r.filter(i=>"PENDING"===i.status))))}getProcessingOrders(t){return this.getShopOrders(t).pipe((0,vt.n)(r=>(0,He.of)(r.filter(i=>["CONFIRMED","PREPARING","READY_FOR_PICKUP"].includes(i.status)))))}getTodayOrders(t){return this.getShopOrders(t).pipe((0,vt.n)(r=>{const i=(new Date).toDateString(),a=r.filter(s=>new Date(s.createdAt).toDateString()===i);return(0,He.of)(a)}))}verifyDriverForPickup(t,r){return this.http.post(`${this.apiUrl}/orders/${t}/verify-pickup`,{otp:r}).pipe((0,wt.W)(a=>{throw console.error("Error verifying driver:",a),a}))}cancelOrder(t,r){return this.http.post(`${this.apiUrl}/orders/${t}/cancel`,{reason:r}).pipe((0,vt.n)(a=>{const s=this.transformOrder(a.data);return this.firebaseService.sendOrderNotification(s.orderNumber,"CANCELLED",`Order cancelled: ${r}`),(0,He.of)(s)}),(0,wt.W)(a=>{throw console.error("Error cancelling order:",a),a}))}addItemToOrder(t,r,i,a){return this.http.post(`${this.apiUrl}/orders/${t}/add-item`,{shopProductId:r,quantity:i,specialInstructions:a}).pipe((0,wi.T)(l=>this.transformOrder(l.data)),(0,wt.W)(l=>{throw console.error("Error adding item to order:",l),l}))}removeItemFromOrder(t,r){return this.http.delete(`${this.apiUrl}/orders/${t}/items/${r}`).pipe((0,wi.T)(i=>this.transformOrder(i.data)),(0,wt.W)(i=>{throw console.error("Error removing item from order:",i),i}))}transformOrder(t){return{...t,items:(t.orderItems||t.items||[]).map(r=>({id:r.id,name:r.productName,productName:r.productName,quantity:r.quantity,price:r.unitPrice,unitPrice:r.unitPrice,total:r.totalPrice,totalPrice:r.totalPrice,unit:"pcs",image:r.productImageUrl,productImageUrl:r.productImageUrl,addedByShopOwner:r.addedByShopOwner||!1})),customerName:t.customerName,customerPhone:t.customerPhone||t.deliveryPhone,customerEmail:t.customerEmail,customerAddress:t.fullDeliveryAddress||t.deliveryAddress,deliveryAddress:t.fullDeliveryAddress||t.deliveryAddress}}static{this.\u0275fac=function(r){return new(r||n)(e.KVO(gt.Qq),e.KVO(Jp.f),e.KVO(Gt.u))}}static{this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),h4=(()=>{class n{constructor(t){this.http=t,this.apiUrl=`${Oe.c.apiUrl}/assignments`}autoAssignOrder(t,r){return this.http.post(`${this.apiUrl}/orders/${t}/auto-assign`,{},{params:{assignedBy:r.toString()}})}manualAssignOrder(t,r,i){return this.http.post(`${this.apiUrl}/orders/${t}/manual-assign`,{},{params:{deliveryPartnerId:r.toString(),assignedBy:i.toString()}})}getAvailablePartners(){return this.http.get(`${this.apiUrl}/available-partners`)}getOrderAssignments(t){return this.http.get(`${this.apiUrl}/orders/${t}`)}static{this.\u0275fac=function(r){return new(r||n)(e.KVO(gt.Qq))}}static{this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Wd=(()=>{class n{constructor(){}success(t,r,i=2e3){return sn().fire({title:t,text:r,icon:"success",confirmButtonText:"OK",confirmButtonColor:"#667eea",timer:i,timerProgressBar:!0,showConfirmButton:!(i>0)})}error(t,r,i){return sn().fire({title:t,text:r,icon:"error",confirmButtonText:"OK",confirmButtonColor:"#ef4444",timer:i,timerProgressBar:!!i})}warning(t,r){return sn().fire({title:t,text:r,icon:"warning",confirmButtonText:"OK",confirmButtonColor:"#f59e0b"})}info(t,r){return sn().fire({title:t,text:r,icon:"info",confirmButtonText:"OK",confirmButtonColor:"#3b82f6"})}confirm(t,r,i="Yes",a="Cancel"){return sn().fire({title:t,text:r,icon:"question",showCancelButton:!0,confirmButtonText:i,cancelButtonText:a,confirmButtonColor:"#667eea",cancelButtonColor:"#6b7280",reverseButtons:!0})}confirmDelete(t){return sn().fire({title:"Are you sure?",text:t?`You are about to delete "${t}". This action cannot be undone!`:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel",confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280",reverseButtons:!0})}loading(t="Processing...",r){sn().fire({title:t,text:r,allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1,didOpen:()=>{sn().showLoading()}})}close(){sn().close()}custom(t){return sn().fire(t)}toast(t,r="success"){sn().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:a=>{a.addEventListener("mouseenter",sn().stopTimer),a.addEventListener("mouseleave",sn().resumeTimer)}}).fire({icon:r,title:t})}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var _4=E(8370),e0=E(3726),x4=E(7786);let t0=(()=>{class n{constructor(t,r){this.http=t,this.offlineStorage=r,this.apiUrl=Oe.c.apiUrl,this.destroy$=new _n.B,this.syncStatus$=new to.t({isOnline:navigator.onLine,pendingOrders:0,pendingEdits:0,pendingProductCreations:0,lastProductSync:null,isSyncing:!1}),this.initNetworkListener()}getSyncStatus(){return this.syncStatus$.asObservable()}getCurrentStatus(){return this.syncStatus$.getValue()}initNetworkListener(){const t=(0,e0.R)(window,"online"),r=(0,e0.R)(window,"offline");(0,x4.h)(t,r).pipe((0,ot.Q)(this.destroy$),(0,xr.B)(1e3)).subscribe(()=>{const i=navigator.onLine;this.updateStatus({isOnline:i}),i?(console.log("Network online - triggering sync"),this.syncPendingOrders(),this.syncPendingEdits().then(()=>this.syncPendingProductCreations())):console.log("Network offline")}),this.updatePendingCount()}updateStatus(t){const r=this.syncStatus$.getValue();this.syncStatus$.next({...r,...t})}updatePendingCount(){var t=this;return(0,fe.A)(function*(){const r=yield t.offlineStorage.getPendingOrdersCount(),i=yield t.offlineStorage.getPendingEditsCount(),a=yield t.offlineStorage.getPendingProductCreationsCount();t.updateStatus({pendingOrders:r,pendingEdits:i,pendingProductCreations:a})})()}refreshProductCache(t){var r=this;return(0,fe.A)(function*(){if(navigator.onLine)try{r.updateStatus({isSyncing:!0}),console.log("Fetching products for cache, shopId:",t);const i=yield r.http.get(`${r.apiUrl}/shop-products/my-products?page=0&size=100000`).toPromise();console.log("Products API response:",i);let a=[];i?.data?.content?a=i.data.content.map(s=>r.mapToCache(s)):i?.data&&Array.isArray(i.data)&&(a=i.data.map(s=>r.mapToCache(s))),a.length>0?(yield r.offlineStorage.saveProducts(a,t),r.updateStatus({lastProductSync:new Date,isSyncing:!1}),console.log(`Cached ${a.length} products`)):(console.warn("No products in response:",i),r.updateStatus({isSyncing:!1}))}catch(i){console.error("Failed to refresh product cache:",i),r.updateStatus({isSyncing:!1})}else console.log("Offline - using cached products")})()}mapToCache(t){return{id:t.id,shopId:t.shopId,name:t.displayName||t.customName||t.masterProduct?.name||"Unknown",nameTamil:t.nameTamil||t.displayNameTamil||t.masterProduct?.nameTamil,description:t.displayDescription||t.customDescription||t.masterProduct?.description||"",price:t.price,originalPrice:t.originalPrice||t.price,costPrice:t.costPrice,stock:t.stockQuantity||0,minStockLevel:t.minStockLevel||10,maxStockLevel:t.maxStockLevel||100,trackInventory:t.trackInventory??!0,isAvailable:t.isAvailable??!0,sku:t.sku||t.masterProduct?.sku||"",barcode:t.barcode||t.masterProduct?.barcode||"",barcode1:t.barcode1||"",barcode2:t.barcode2||"",barcode3:t.barcode3||"",image:t.primaryImageUrl||t.masterProduct?.primaryImageUrl||"",imageUrl:t.primaryImageUrl||t.masterProduct?.primaryImageUrl||"",categoryId:t.masterProduct?.category?.id||t.categoryId,categoryName:t.masterProduct?.category?.name||t.categoryName||"",category:t.masterProduct?.category?.name||t.categoryName||"",unit:t.baseUnit||t.masterProduct?.baseUnit||"piece",weight:t.baseWeight||t.masterProduct?.baseWeight,masterProductId:t.masterProduct?.id,tags:t.tags||t.masterProduct?.tags||[]}}shouldRefreshProducts(t){var r=this;return(0,fe.A)(function*(){const i=yield r.offlineStorage.getProductsSyncTime(t);return!i||Date.now()-i.getTime()>36e5})()}initializeProductCache(t){var r=this;return(0,fe.A)(function*(){return(yield r.shouldRefreshProducts(t))&&navigator.onLine&&(yield r.refreshProductCache(t)),r.offlineStorage.getProducts()})()}createPosOrder(t,r,i){var a=this;return(0,fe.A)(function*(){const s=i||localStorage.getItem("shop_name")||"Shop";if(navigator.onLine)try{return{success:!0,order:(yield a.http.post(`${a.apiUrl}/pos/orders`,{...t,shopId:r}).toPromise())?.data,offline:!1}}catch(u){console.error("Failed to create online order, saving offline:",u)}const l={offlineOrderId:a.offlineStorage.generateOfflineOrderId(),shopId:r,items:t.items,paymentMethod:t.paymentMethod,customerName:t.customerName,customerPhone:t.customerPhone,notes:t.notes,totalAmount:t.totalAmount,subtotal:t.subtotal,taxAmount:t.taxAmount,createdAt:(new Date).toISOString(),synced:!1};yield a.offlineStorage.saveOfflineOrder(l);for(const u of t.items)yield a.offlineStorage.updateLocalStock(u.shopProductId,u.quantity);return yield a.updatePendingCount(),{success:!0,order:{orderNumber:l.offlineOrderId,shopName:s,customerName:t.customerName||"Walk-in Customer",customerPhone:t.customerPhone||"",...l},offline:!0}})()}syncPendingOrders(){var t=this;return(0,fe.A)(function*(){if(!navigator.onLine)return console.log("Cannot sync - offline"),{synced:0,failed:0};const r=yield t.offlineStorage.getPendingOrders();if(0===r.length)return console.log("No pending orders to sync"),{synced:0,failed:0};t.updateStatus({isSyncing:!0}),console.log(`Syncing ${r.length} pending orders...`);let i=0,a=0;for(const s of r)try{const l={shopId:s.shopId,items:s.items.map(u=>({shopProductId:u.shopProductId,quantity:u.quantity,unitPrice:u.unitPrice})),paymentMethod:s.paymentMethod,customerName:s.customerName,customerPhone:s.customerPhone,notes:s.notes,offlineOrderId:s.offlineOrderId};yield t.http.post(`${t.apiUrl}/pos/orders`,l).toPromise(),yield t.offlineStorage.markOrderSynced(s.offlineOrderId),i++,console.log(`Synced order: ${s.offlineOrderId}`)}catch(l){console.error(`Failed to sync order ${s.offlineOrderId}:`,l),a++}return yield t.updatePendingCount(),t.updateStatus({isSyncing:!1}),console.log(`Sync complete: ${i} synced, ${a} failed`),{synced:i,failed:a}})()}syncPendingEdits(){var t=this;return(0,fe.A)(function*(){if(!navigator.onLine)return console.log("Cannot sync edits - offline"),{synced:0,failed:0};const r=yield t.offlineStorage.getPendingEdits();if(0===r.length)return console.log("No pending edits to sync"),{synced:0,failed:0};t.updateStatus({isSyncing:!0}),console.log(`Syncing ${r.length} pending product edits...`);let i=0,a=0;for(const s of r)try{if(s.productId<0){console.log(`Merging edit ${s.editId} into offline creation for temp product ${s.productId}`),yield t.offlineStorage.applyEditToProductCreation(s.productId,s.changes),yield t.offlineStorage.markEditSynced(s.editId),yield t.offlineStorage.removeOfflineEdit(s.editId),i++;continue}void 0!==s.changes.isAvailable&&(yield t.http.patch(`${t.apiUrl}/shop-products/${s.productId}/availability`,{isAvailable:s.changes.isAvailable}).toPromise());const l={};void 0!==s.changes.customName&&(l.customName=s.changes.customName),void 0!==s.changes.nameTamil&&(l.nameTamil=s.changes.nameTamil),void 0!==s.changes.price&&(l.price=s.changes.price),void 0!==s.changes.originalPrice&&(l.originalPrice=s.changes.originalPrice),void 0!==s.changes.stockQuantity&&(l.stockQuantity=s.changes.stockQuantity),void 0!==s.changes.sku&&(l.sku=s.changes.sku),void 0!==s.changes.barcode&&(l.barcode=s.changes.barcode),void 0!==s.changes.barcode1&&(l.barcode1=s.changes.barcode1),void 0!==s.changes.barcode2&&(l.barcode2=s.changes.barcode2),void 0!==s.changes.barcode3&&(l.barcode3=s.changes.barcode3),Object.keys(l).length>0&&(yield t.http.patch(`${t.apiUrl}/shop-products/${s.productId}/quick-update`,l).toPromise()),yield t.offlineStorage.markEditSynced(s.editId),yield t.offlineStorage.removeOfflineEdit(s.editId),i++,console.log(`Synced edit: ${s.editId} for product ${s.productId}`)}catch(l){console.error(`Failed to sync edit ${s.editId}:`,l),a++}return yield t.updatePendingCount(),t.updateStatus({isSyncing:!1}),console.log(`Edit sync complete: ${i} synced, ${a} failed`),{synced:i,failed:a}})()}syncPendingProductCreations(){var t=this;return(0,fe.A)(function*(){if(!navigator.onLine)return console.log("Cannot sync product creations - offline"),{synced:0,failed:0};const r=yield t.offlineStorage.getPendingProductCreations(),i=parseInt(localStorage.getItem("current_shop_id")||"0",10),a=i?r.filter(u=>u.shopId===i):r;if(0===a.length)return console.log("No pending product creations to sync for current shop"),{synced:0,failed:0};t.updateStatus({isSyncing:!0}),console.log(`Syncing ${a.length} pending product creations...`);let s=0,l=0;for(const u of a)try{console.log("Syncing creation record:",JSON.stringify({offlineProductId:u.offlineProductId,name:u.name,barcode1:u.barcode1,barcode2:u.barcode2,barcode3:u.barcode3,price:u.price}));const p={masterProductId:u.masterProductId,price:u.price,originalPrice:u.originalPrice,costPrice:u.costPrice,stockQuantity:u.stockQuantity,minStockLevel:u.minStockLevel||10,trackInventory:u.trackInventory,customName:u.customName||u.name,customDescription:u.customDescription,isFeatured:u.isFeatured||!1,tags:u.tags,sku:u.sku||"",barcode1:u.barcode1,barcode2:u.barcode2,barcode3:u.barcode3,nameTamil:u.nameTamil,categoryId:u.categoryId,categoryName:u.categoryName,isAvailable:!0,status:"ACTIVE"},_=(yield t.http.post(`${t.apiUrl}/shop-products/create`,p).toPromise())?.data?.id;if(!_)throw new Error("No product ID returned from API");yield t.offlineStorage.markProductCreationSynced(u.offlineProductId,_),u.tempProductId&&(yield t.offlineStorage.updateLocalProductId(u.tempProductId,_)),yield t.offlineStorage.removeOfflineProductCreation(u.offlineProductId),s++,console.log(`Synced product creation: ${u.offlineProductId} -> ID ${_}`)}catch(p){console.error(`Failed to sync product creation ${u.offlineProductId}:`,p),yield t.offlineStorage.updateProductCreationError(u.offlineProductId,p.message||"Sync failed"),l++}return yield t.updatePendingCount(),t.updateStatus({isSyncing:!1}),console.log(`Product creation sync complete: ${s} synced, ${l} failed`),{synced:s,failed:l}})()}createProductOffline(t){var r=this;return(0,fe.A)(function*(){try{const i=r.offlineStorage.generateOfflineProductId(),a=r.offlineStorage.generateTempProductId();if(yield r.offlineStorage.isBarcodeExists(t.barcode1))return{success:!1,tempProductId:0,offlineProductId:"",message:`Barcode "${t.barcode1}" already exists. Please use a unique barcode.`};const l={offlineProductId:i,...t,tempProductId:a,createdAt:(new Date).toISOString(),synced:!1};return yield r.offlineStorage.saveOfflineProductCreation(l),yield r.offlineStorage.addOfflineProductToLocalCache(l,a),yield r.updatePendingCount(),console.log(`Product created offline: ${i}, temp ID: ${a}`),{success:!0,tempProductId:a,offlineProductId:i,message:"Product saved offline. Will sync when online."}}catch(i){return console.error("Failed to create product offline:",i),{success:!1,tempProductId:0,offlineProductId:"",message:i.message||"Failed to save product offline"}}})()}forceSyncNow(t){var r=this;return(0,fe.A)(function*(){if(!navigator.onLine)throw new Error("Cannot sync while offline");yield r.syncPendingOrders(),yield r.syncPendingEdits(),yield r.syncPendingProductCreations(),yield r.refreshProductCache(t)})()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(r){return new(r||n)(e.KVO(gt.Qq),e.KVO(at.m))}}static{this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const C4=["tableContainer"];function v4(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",49),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.clearDateFilter())}),e.j41(1,"mat-icon"),e.EFF(2,"close"),e.k0s()()}}function P4(n,o){1&n&&(e.j41(0,"td",52)(1,"div",53)(2,"mat-icon",54),e.EFF(3,"sync"),e.k0s(),e.j41(4,"span"),e.EFF(5,"Processing..."),e.k0s()()())}function b4(n,o){if(1&n&&(e.j41(0,"div",71),e.EFF(1),e.k0s()),2&n){const t=e.XpG(2).$implicit;e.R7$(1),e.JRh(t.customerPhone)}}function k4(n,o){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"button",72),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG();return e.Njj(a.acceptOrder(i))}),e.j41(2,"mat-icon"),e.EFF(3,"check"),e.k0s()(),e.j41(4,"button",73),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG();return e.Njj(a.rejectOrder(i))}),e.j41(5,"mat-icon"),e.EFF(6,"close"),e.k0s()(),e.bVm()}}function O4(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",74),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG();return e.Njj(a.startPreparing(i.id))}),e.j41(1,"mat-icon"),e.EFF(2,"restaurant"),e.k0s()()}}function y4(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",75),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG();return e.Njj(a.markReady(i.id))}),e.j41(1,"mat-icon"),e.EFF(2,"done"),e.k0s()()}}function M4(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",80),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3).$implicit,a=e.XpG();return e.Njj(a.handoverSelfPickup(i.id))}),e.j41(1,"mat-icon"),e.EFF(2,"handshake"),e.k0s()()}}function w4(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",81),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3).$implicit,a=e.XpG();return e.Njj(a.verifyPickupOTP(i.id))}),e.j41(1,"mat-icon"),e.EFF(2,"pin"),e.k0s()()}}function F4(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",82),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3).$implicit,a=e.XpG();return e.Njj(a.retryDriverSearch(i.id))}),e.j41(1,"mat-icon"),e.EFF(2,"person_search"),e.k0s()()}}function E4(n,o){1&n&&(e.j41(0,"mat-icon",83),e.EFF(1,"sync"),e.k0s())}function S4(n,o){if(1&n&&(e.qex(0),e.DNE(1,M4,3,0,"button",76),e.DNE(2,w4,3,0,"button",77),e.DNE(3,F4,3,0,"button",78),e.DNE(4,E4,2,0,"mat-icon",79),e.bVm()),2&n){const t=e.XpG(2).$implicit,r=e.XpG();e.R7$(1),e.Y8G("ngIf","SELF_PICKUP"===t.deliveryType),e.R7$(1),e.Y8G("ngIf","HOME_DELIVERY"===t.deliveryType&&t.assignedToDeliveryPartner),e.R7$(1),e.Y8G("ngIf","HOME_DELIVERY"===t.deliveryType&&!t.assignedToDeliveryPartner&&!r.isSearchingDriver(t.id)),e.R7$(1),e.Y8G("ngIf",r.isSearchingDriver(t.id))}}function T4(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",84),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG();return e.Njj(a.confirmReturnReceipt(i.id))}),e.j41(1,"mat-icon"),e.EFF(2,"inventory"),e.k0s()()}}function I4(n,o){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"td",37)(2,"span",55),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.showOrderDetailsModal(i))}),e.EFF(3),e.k0s(),e.j41(4,"div",56),e.EFF(5),e.k0s()(),e.j41(6,"td",38)(7,"div",57)(8,"div",58),e.EFF(9),e.k0s(),e.j41(10,"div",59)(11,"div",60),e.EFF(12),e.k0s(),e.DNE(13,b4,2,1,"div",61),e.k0s()()(),e.j41(14,"td",39)(15,"div",62)(16,"mat-icon"),e.EFF(17),e.k0s(),e.j41(18,"span"),e.EFF(19),e.k0s()()(),e.j41(20,"td",40)(21,"span",63),e.EFF(22),e.k0s()(),e.j41(23,"td",41)(24,"span",64),e.EFF(25),e.nI1(26,"currency"),e.k0s()(),e.j41(27,"td",42)(28,"div",65),e.DNE(29,k4,7,0,"ng-container",44),e.DNE(30,O4,3,0,"button",66),e.DNE(31,y4,3,0,"button",67),e.DNE(32,S4,5,4,"ng-container",44),e.DNE(33,T4,3,0,"button",68),e.j41(34,"button",69),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.printOrderSmall(i.id))}),e.j41(35,"mat-icon"),e.EFF(36,"print"),e.k0s()(),e.j41(37,"button",70),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.showOrderDetailsModal(i))}),e.EFF(38," Details "),e.k0s()()(),e.bVm()}if(2&n){const t=e.XpG().$implicit,r=e.XpG();e.R7$(3),e.SpI("#",t.orderNumber,""),e.R7$(2),e.JRh(r.formatOrderTime(t.createdAt)),e.R7$(4),e.JRh(r.getCustomerInitials(t.customerName)),e.R7$(3),e.JRh(t.customerName),e.R7$(1),e.Y8G("ngIf",t.customerPhone),e.R7$(2),e.Y8G("ngClass",r.getDeliveryTypeClass(t)),e.R7$(2),e.JRh(r.getDeliveryTypeIcon(t)),e.R7$(2),e.JRh(r.getDeliveryTypeLabel(t)),e.R7$(2),e.Y8G("ngClass",r.getStatusBadgeClass(t.status)),e.R7$(1),e.SpI(" ",r.getStatusLabel(t.status)," "),e.R7$(3),e.JRh(e.ii3(26,16,t.totalAmount,"INR","symbol","1.0-0")),e.R7$(4),e.Y8G("ngIf","PENDING"===t.status),e.R7$(1),e.Y8G("ngIf","CONFIRMED"===t.status),e.R7$(1),e.Y8G("ngIf","PREPARING"===t.status),e.R7$(1),e.Y8G("ngIf","READY_FOR_PICKUP"===t.status),e.R7$(1),e.Y8G("ngIf","RETURNED_TO_SHOP"===t.status)}}function R4(n,o){if(1&n&&(e.j41(0,"tr",50),e.DNE(1,P4,6,0,"td",51),e.DNE(2,I4,39,21,"ng-container",44),e.k0s()),2&n){const t=o.$implicit,r=e.XpG();e.AVh("pending-row","PENDING"===t.status),e.R7$(1),e.Y8G("ngIf",r.isProcessingOrder(t.id)),e.R7$(1),e.Y8G("ngIf",!r.isProcessingOrder(t.id))}}function N4(n,o){1&n&&(e.j41(0,"div",89),e.EFF(1,"Try adjusting your search or filter"),e.k0s())}function A4(n,o){1&n&&(e.j41(0,"div",89),e.EFF(1,"Orders will appear here when customers place them"),e.k0s())}function D4(n,o){if(1&n&&(e.j41(0,"tr")(1,"td",85)(2,"div",86)(3,"mat-icon"),e.EFF(4,"inbox"),e.k0s(),e.j41(5,"div",87),e.EFF(6,"No orders found"),e.k0s(),e.DNE(7,N4,2,0,"div",88),e.DNE(8,A4,2,0,"div",88),e.k0s()()()),2&n){const t=e.XpG();e.R7$(7),e.Y8G("ngIf",t.searchTerm||"ALL"!==t.statusFilter),e.R7$(1),e.Y8G("ngIf",!t.searchTerm&&"ALL"===t.statusFilter)}}function j4(n,o){1&n&&(e.j41(0,"span",92)(1,"mat-icon",54),e.EFF(2,"sync"),e.k0s(),e.EFF(3," Loading more... "),e.k0s())}function B4(n,o){if(1&n&&(e.j41(0,"div",90)(1,"span"),e.EFF(2),e.k0s(),e.DNE(3,j4,4,0,"span",91),e.k0s()),2&n){const t=e.XpG();e.R7$(2),e.Lme("Showing ",t.getDisplayedOrdersCount()," of ",t.filteredOrders.length," orders"),e.R7$(1),e.Y8G("ngIf",t.isLoadingMore)}}function L4(n,o){if(1&n&&(e.j41(0,"div",113)(1,"span",104),e.EFF(2,"Address"),e.k0s(),e.j41(3,"span",105),e.EFF(4),e.k0s()()),2&n){const t=e.XpG(3);e.R7$(4),e.JRh(t.selectedOrder.customerAddress||t.selectedOrder.deliveryAddress)}}function $4(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",114),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.toggleAddItemSearch())}),e.j41(1,"mat-icon"),e.EFF(2),e.k0s(),e.EFF(3),e.k0s()}if(2&n){const t=e.XpG(3);e.R7$(2),e.JRh(t.showAddItemSearch?"close":"add"),e.R7$(1),e.SpI(" ",t.showAddItemSearch?"Cancel":"Add Item"," ")}}function G4(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",124)(1,"div",125)(2,"span",126),e.EFF(3),e.k0s(),e.j41(4,"span",127),e.EFF(5),e.nI1(6,"currency"),e.k0s()(),e.j41(7,"div",128)(8,"input",129),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG(5);return e.Njj(a.addItemQty=i)})("click",function(i){return i.stopPropagation()}),e.k0s(),e.j41(9,"button",130),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(5);return e.Njj(s.addItemToExistingOrder(a))}),e.j41(10,"mat-icon"),e.EFF(11,"add_shopping_cart"),e.k0s()()()()}if(2&n){const t=o.$implicit,r=e.XpG(5);e.R7$(3),e.JRh(t.name),e.R7$(2),e.JRh(e.ii3(6,4,t.price,"INR","symbol","1.0-0")),e.R7$(3),e.Y8G("ngModel",r.addItemQty),e.R7$(1),e.Y8G("disabled",r.isAddingItem)}}function U4(n,o){if(1&n&&(e.j41(0,"div",122),e.DNE(1,G4,12,9,"div",123),e.k0s()),2&n){const t=e.XpG(4);e.R7$(1),e.Y8G("ngForOf",t.addItemSearchResults)}}function z4(n,o){1&n&&(e.j41(0,"div",131),e.EFF(1," No products found "),e.k0s())}function V4(n,o){1&n&&(e.j41(0,"div",132),e.EFF(1," Searching... "),e.k0s())}function Y4(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",115)(1,"div",116)(2,"mat-icon",117),e.EFF(3,"search"),e.k0s(),e.j41(4,"input",118),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG(3);return e.Njj(a.addItemSearchTerm=i)})("input",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.searchProductsForOrder())}),e.k0s()(),e.DNE(5,U4,2,1,"div",119),e.DNE(6,z4,2,0,"div",120),e.DNE(7,V4,2,0,"div",121),e.k0s()}if(2&n){const t=e.XpG(3);e.R7$(4),e.Y8G("ngModel",t.addItemSearchTerm),e.R7$(1),e.Y8G("ngIf",t.addItemSearchResults.length>0),e.R7$(1),e.Y8G("ngIf",t.addItemSearchTerm.length>=1&&0===t.addItemSearchResults.length&&t.productsLoaded&&!t.isSearchingProducts),e.R7$(1),e.Y8G("ngIf",t.isSearchingProducts)}}function X4(n,o){if(1&n){const t=e.RV6();e.j41(0,"img",142),e.bIt("error",function(i){e.eBV(t);const a=e.XpG(4);return e.Njj(a.onImageError(i))}),e.k0s()}if(2&n){const t=e.XpG().$implicit,r=e.XpG(3);e.Y8G("src",r.getImageUrl(t.image||t.productImageUrl||""),e.B4B)("alt",t.name||t.productName)}}function H4(n,o){if(1&n&&(e.j41(0,"div",143),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.SpI(" ",(t.name||t.productName||"P")[0].toUpperCase()," ")}}function W4(n,o){1&n&&(e.j41(0,"span",144),e.EFF(1,"Added"),e.k0s())}function q4(n,o){if(1&n&&(e.j41(0,"div",133)(1,"div",134),e.DNE(2,X4,1,2,"img",135),e.DNE(3,H4,2,1,"div",136),e.k0s(),e.j41(4,"div",137)(5,"div",138),e.EFF(6),e.DNE(7,W4,2,0,"span",139),e.k0s(),e.j41(8,"div",140),e.EFF(9),e.nI1(10,"currency"),e.k0s()(),e.j41(11,"div",141),e.EFF(12),e.nI1(13,"currency"),e.k0s()()),2&n){const t=o.$implicit;e.R7$(2),e.Y8G("ngIf",t.image||t.productImageUrl),e.R7$(1),e.Y8G("ngIf",!t.image&&!t.productImageUrl),e.R7$(3),e.SpI(" ",t.name||t.productName," "),e.R7$(1),e.Y8G("ngIf",t.addedByShopOwner),e.R7$(2),e.Lme("",t.quantity," x ",e.ii3(10,7,t.price||t.unitPrice,"INR","symbol","1.0-0"),""),e.R7$(3),e.JRh(e.ii3(13,12,t.quantity*(t.price||t.unitPrice),"INR","symbol","1.0-0"))}}const Z4=function(){return["CANCELLED","RETURNING_TO_SHOP","RETURNED_TO_SHOP"]};function Q4(n,o){if(1&n&&(e.j41(0,"div",100)(1,"div",101)(2,"h4"),e.EFF(3,"Order Information"),e.k0s(),e.j41(4,"div",102)(5,"div",103)(6,"span",104),e.EFF(7,"Order Date"),e.k0s(),e.j41(8,"span",105),e.EFF(9),e.nI1(10,"date"),e.k0s()(),e.j41(11,"div",103)(12,"span",104),e.EFF(13,"Payment Method"),e.k0s(),e.j41(14,"span",105),e.EFF(15),e.k0s()(),e.j41(16,"div",103)(17,"span",104),e.EFF(18,"Delivery Type"),e.k0s(),e.j41(19,"span",105),e.EFF(20),e.k0s()(),e.j41(21,"div",103)(22,"span",104),e.EFF(23,"Payment Status"),e.k0s(),e.j41(24,"span",105),e.EFF(25),e.k0s()()()(),e.j41(26,"div",101)(27,"h4"),e.EFF(28,"Customer Information"),e.k0s(),e.j41(29,"div",102)(30,"div",103)(31,"span",104),e.EFF(32,"Name"),e.k0s(),e.j41(33,"span",105),e.EFF(34),e.k0s()(),e.j41(35,"div",103)(36,"span",104),e.EFF(37,"Phone"),e.k0s(),e.j41(38,"span",105),e.EFF(39),e.k0s()(),e.DNE(40,L4,5,1,"div",106),e.k0s()(),e.j41(41,"div",101)(42,"div",107)(43,"h4"),e.EFF(44),e.k0s(),e.DNE(45,$4,4,2,"button",108),e.k0s(),e.DNE(46,Y4,8,4,"div",109),e.j41(47,"div",110),e.DNE(48,q4,14,17,"div",111),e.k0s(),e.j41(49,"div",112)(50,"span"),e.EFF(51,"Total"),e.k0s(),e.j41(52,"span"),e.EFF(53),e.nI1(54,"currency"),e.k0s()()()()),2&n){const t=e.XpG(2);e.R7$(9),e.JRh(e.i5U(10,12,t.selectedOrder.createdAt,"medium")),e.R7$(6),e.JRh("CASH_ON_DELIVERY"===t.selectedOrder.paymentMethod?"Cash on Delivery":"Online Payment"),e.R7$(5),e.JRh(t.getDeliveryTypeLabel(t.selectedOrder)),e.R7$(5),e.JRh(t.selectedOrder.paymentStatus),e.R7$(9),e.JRh(t.selectedOrder.customerName),e.R7$(5),e.JRh(t.selectedOrder.customerPhone||"Not provided"),e.R7$(1),e.Y8G("ngIf",t.selectedOrder.customerAddress||t.selectedOrder.deliveryAddress),e.R7$(4),e.SpI("Order Items (",(null==t.selectedOrder.items?null:t.selectedOrder.items.length)||0,")"),e.R7$(1),e.Y8G("ngIf",!e.lJ4(20,Z4).includes(t.selectedOrder.status)),e.R7$(1),e.Y8G("ngIf",t.showAddItemSearch),e.R7$(2),e.Y8G("ngForOf",t.selectedOrder.items),e.R7$(5),e.JRh(e.ii3(54,15,t.selectedOrder.totalAmount,"INR","symbol","1.0-0"))}}function J4(n,o){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"button",149),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return i.acceptOrder(i.selectedOrder),e.Njj(i.closeDetailsModal())}),e.j41(2,"mat-icon"),e.EFF(3,"check"),e.k0s(),e.EFF(4," Accept Order "),e.k0s(),e.j41(5,"button",150),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return i.rejectOrder(i.selectedOrder),e.Njj(i.closeDetailsModal())}),e.j41(6,"mat-icon"),e.EFF(7,"close"),e.k0s(),e.EFF(8," Reject Order "),e.k0s(),e.bVm()}}function K4(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",151),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return i.startPreparing(i.selectedOrder.id),e.Njj(i.closeDetailsModal())}),e.j41(1,"mat-icon"),e.EFF(2,"restaurant"),e.k0s(),e.EFF(3," Start Preparing "),e.k0s()}}function ek(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",151),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return i.markReady(i.selectedOrder.id),e.Njj(i.closeDetailsModal())}),e.j41(1,"mat-icon"),e.EFF(2,"done_all"),e.k0s(),e.EFF(3," Mark Ready "),e.k0s()}}function tk(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",152),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return i.cancelOrder(i.selectedOrder),e.Njj(i.closeDetailsModal())}),e.j41(1,"mat-icon"),e.EFF(2,"cancel"),e.k0s(),e.EFF(3," Cancel Order "),e.k0s()}}const nk=function(){return["CONFIRMED","PREPARING"]};function rk(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",145)(1,"button",146),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.printOrderSmall(i.selectedOrder.id))}),e.j41(2,"mat-icon"),e.EFF(3,"print"),e.k0s(),e.EFF(4," Print Receipt "),e.k0s(),e.DNE(5,J4,9,0,"ng-container",44),e.DNE(6,K4,4,0,"button",147),e.DNE(7,ek,4,0,"button",147),e.DNE(8,tk,4,0,"button",148),e.k0s()}if(2&n){const t=e.XpG(2);e.R7$(5),e.Y8G("ngIf","PENDING"===t.selectedOrder.status),e.R7$(1),e.Y8G("ngIf","CONFIRMED"===t.selectedOrder.status),e.R7$(1),e.Y8G("ngIf","PREPARING"===t.selectedOrder.status),e.R7$(1),e.Y8G("ngIf",e.lJ4(4,nk).includes(t.selectedOrder.status))}}function ik(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",93),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeDetailsModal())}),e.j41(1,"div",94),e.bIt("click",function(i){return i.stopPropagation()}),e.j41(2,"div",95)(3,"div",96)(4,"h3"),e.EFF(5),e.k0s(),e.j41(6,"span",63),e.EFF(7),e.k0s()(),e.j41(8,"button",97),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeDetailsModal())}),e.j41(9,"mat-icon"),e.EFF(10,"close"),e.k0s()()(),e.DNE(11,Q4,55,21,"div",98),e.DNE(12,rk,9,5,"div",99),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(5),e.SpI("Order #",null==t.selectedOrder?null:t.selectedOrder.orderNumber,""),e.R7$(1),e.Y8G("ngClass",t.getStatusBadgeClass((null==t.selectedOrder?null:t.selectedOrder.status)||"")),e.R7$(1),e.SpI(" ",t.getStatusLabel((null==t.selectedOrder?null:t.selectedOrder.status)||"")," "),e.R7$(4),e.Y8G("ngIf",t.selectedOrder),e.R7$(1),e.Y8G("ngIf",t.selectedOrder)}}function ok(n,o){if(1&n&&(e.j41(0,"div",153),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.JRh(t.successMessage)}}function ak(n,o){if(1&n&&(e.j41(0,"div",154),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.JRh(t.errorMessage)}}let sk=(()=>{class n{constructor(t,r,i,a,s,l,u,p,f,h,_,C,P){this.orderService=t,this.productService=r,this.assignmentService=i,this.authService=a,this.shopContextService=s,this.snackBar=l,this.swal=u,this.router=p,this.http=f,this.webSocketService=h,this.ngZone=_,this.offlineStorage=C,this.posSyncService=P,this.displayedCount=20,this.isLoadingMore=!1,this.scrollThreshold=100,this.orders=[],this.filteredOrders=[],this.pendingOrders=[],this.processingOrders=[],this.activeOrders=[],this.completedOrders=[],this.todayOrders=[],this.inProgressOrders=[],this.shopId=null,this.mainTab="realtime",this.searchTerm="",this.selectedStatus="REALTIME_ALL",this.selectedTabIndex=0,this.startDate=null,this.endDate=null,this.fromDate="",this.toDate="",this.statusFilter="ALL",this.totalOrders=0,this.pageSize=10,this.currentPage=1,this.showDetailsModal=!1,this.selectedOrder=null,this.showAddItemSearch=!1,this.addItemSearchTerm="",this.addItemSearchResults=[],this.allCachedProducts=[],this.addItemQty=1,this.isAddingItem=!1,this.isSearchingProducts=!1,this.productsLoaded=!1,this.todayRevenue=0,this.todayProfit=0,this.profitMargin=20,this.isAssigningPartner=!1,this.searchingDriverOrders=new Set,this.processingOrderIds=new Set,this.verificationCodes={},this.successMessage="",this.errorMessage="",this.isSendingSummary=!1,this.destroy$=new _n.B}ngOnInit(){if(!this.authService.isAuthenticated())return console.error("User not authenticated. Redirecting to login..."),void this.router.navigate(["/auth/login"]);const r=(new Date).toISOString().split("T")[0];this.fromDate=r,this.toDate=r,this.loadOrdersFromCache()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.webSocketService.disconnect()}loadOrdersFromCache(){const t=localStorage.getItem("current_shop_id");if(t)return this.shopId=parseInt(t,10),console.log("Using cached shop ID:",this.shopId),this.loadOrders(),void this.subscribeToWebSocketUpdates();console.log("No cached shop ID - calling /api/shops/my-shop"),this.http.get(`${Oe.c.apiUrl}/shops/my-shop`).subscribe({next:r=>{const i=r?.data||r;if(i&&i.id){this.shopId=i.id,localStorage.setItem("current_shop_id",i.id.toString());const a=i.name||i.businessName;a&&localStorage.setItem("shop_name",a),console.log("Got shop ID from API:",this.shopId),this.loadOrders(),this.subscribeToWebSocketUpdates()}else console.error("Invalid shop response:",r),this.swal.error("Error","Failed to load shop information. Please try refreshing the page.")},error:r=>{console.error("Error getting shop ID:",r),this.swal.error("Error","Failed to load shop information. Please check your connection.")}})}subscribeToWebSocketUpdates(){if(!this.shopId)return void console.log("Cannot subscribe to WebSocket - no shop ID");console.log("\u{1f4e1} Connecting to WebSocket for shop:",this.shopId);const t=localStorage.getItem("auth_token");this.webSocketService.connect(t||void 0).pipe((0,ot.Q)(this.destroy$)).subscribe({next:r=>{r&&(console.log("\u2705 WebSocket connected, subscribing to shop orders"),this.subscribeToShopOrders())},error:r=>{console.error("\u274c WebSocket connection error:",r)}})}subscribeToShopOrders(){this.shopId&&this.webSocketService.subscribeToShopOrders(this.shopId).pipe((0,ot.Q)(this.destroy$)).subscribe({next:t=>{console.log("\u{1f4ec} WebSocket message received:",t),this.handleWebSocketMessage(t)},error:t=>{console.error("\u274c WebSocket subscription error:",t)}})}handleWebSocketMessage(t){!t||!t.type||this.ngZone.run(()=>{switch(t.type){case"NEW_ORDER":console.log("\u{1f195} New order received:",t.orderNumber),this.playNotificationSound(),this.swal.toast(`New order #${t.orderNumber} received!`,"success"),this.loadOrders();break;case"ORDER_STATUS_UPDATE":console.log("\u{1f504} Order status updated:",t.orderNumber,t.oldStatus,"->",t.newStatus),this.loadOrders();break;case"ORDER_RETURNING":console.log("\u{1f519} Order returning to shop:",t.orderNumber),this.playNotificationSound(),this.swal.toast(`Order #${t.orderNumber} - Driver returning products!`,"warning"),this.loadOrders();break;case"ORDER_RETURNED":console.log("\u{1f4e6} Order returned to shop:",t.orderNumber),this.playNotificationSound(),this.swal.toast(`Order #${t.orderNumber} - Products returned. Please verify!`,"info"),this.loadOrders();break;default:console.log("Unknown WebSocket message type:",t.type)}})}playNotificationSound(){try{const r=new(window.AudioContext||window.webkitAudioContext),i=r.createOscillator(),a=r.createGain();i.connect(a),a.connect(r.destination),i.frequency.value=880,i.type="sine",a.gain.setValueAtTime(0,r.currentTime),a.gain.linearRampToValueAtTime(.3,r.currentTime+.05),a.gain.linearRampToValueAtTime(0,r.currentTime+.3),i.start(r.currentTime),i.stop(r.currentTime+.3),setTimeout(()=>{const s=r.createOscillator(),l=r.createGain();s.connect(l),l.connect(r.destination),s.frequency.value=1046.5,s.type="sine",l.gain.setValueAtTime(0,r.currentTime),l.gain.linearRampToValueAtTime(.3,r.currentTime+.05),l.gain.linearRampToValueAtTime(0,r.currentTime+.3),s.start(r.currentTime),s.stop(r.currentTime+.3)},200),console.log("\u{1f514} Notification sound played")}catch(t){console.log("Error playing notification sound:",t)}}loadDashboardData(){console.log("Loading dashboard data..."),this.loadOrders()}sendDailySummary(){this.isSendingSummary=!0,this.http.post("/api/shops/dashboard/send-daily-summary",{}).subscribe({next:t=>{this.isSendingSummary=!1,t.success?this.swal.success("Email Sent",t.message||"Daily summary email sent to your registered email."):this.swal.error("Failed",t.message||"Failed to send daily summary.")},error:t=>{this.isSendingSummary=!1,console.error("Error sending daily summary:",t),this.swal.error("Error","Failed to send daily summary email. Please try again.")}})}loadOrders(){this.shopId?(console.log("Loading orders for shop:",this.shopId),this.orderService.getShopOrders(this.shopId).subscribe({next:t=>{console.log("Orders loaded successfully:",t.length),this.orders=t,this.updateOrderLists();const r=this.getRealtimeOrdersCount(),i=this.getHistoryOrdersCount();0===r&&i>0&&"realtime"===this.mainTab&&(console.log("No real-time orders, switching to history tab"),this.switchMainTab("history")),t.length>0&&(this.successMessage=`Loaded ${t.length} orders successfully`,setTimeout(()=>this.successMessage="",3e3))},error:t=>{console.error("Error loading orders:",t),401===t.status||403===t.status?this.swal.error("Authentication Required","Please login to view orders."):this.swal.error("Error","Failed to load orders. Please try again.")}})):console.log("No shop ID available, cannot load orders")}updateOrderLists(){this.filteredOrders=[...this.orders],this.pendingOrders=this.orders.filter(t=>"PENDING"===t.status),this.processingOrders=this.orders.filter(t=>"CONFIRMED"===t.status),this.activeOrders=this.orders.filter(t=>["CONFIRMED","PREPARING","READY_FOR_PICKUP","OUT_FOR_DELIVERY"].includes(t.status)),this.completedOrders=this.orders.filter(t=>"DELIVERED"===t.status),this.todayOrders=this.orders.filter(t=>this.isToday(new Date(t.createdAt))),this.inProgressOrders=this.orders.filter(t=>["CONFIRMED","PREPARING","READY_FOR_PICKUP","OUT_FOR_DELIVERY"].includes(t.status)),this.totalOrders=this.orders.length,this.calculateStatistics(),this.applyFilter()}calculateStatistics(){this.orders.filter(a=>"DELIVERED"===a.status||"PAID"===a.paymentStatus);const r=new Date,i=this.orders.filter(a=>new Date(a.createdAt).toDateString()===r.toDateString());this.todayRevenue=i.reduce((a,s)=>a+(s.totalAmount||0),0),0===this.todayRevenue&&(this.todayRevenue=this.orders.reduce((a,s)=>a+(s.totalAmount||0),0)),this.todayProfit=this.todayRevenue*(this.profitMargin/100),console.log("Statistics calculated:",{totalOrders:this.totalOrders,pendingOrders:this.pendingOrders.length,completedOrders:this.completedOrders.length,todayOrders:this.todayOrders.length,todayRevenue:this.todayRevenue,todayProfit:this.todayProfit})}isToday(t){const r=new Date;return t.toDateString()===r.toDateString()}applyFilter(){this.filteredOrders=this.orders.filter(t=>{const r=!this.searchTerm||t.orderNumber.toLowerCase().includes(this.searchTerm.toLowerCase())||t.customerName.toLowerCase().includes(this.searchTerm.toLowerCase());let i=!0;"ALL"!==this.statusFilter&&(i="WALK_IN"===this.statusFilter?"WALK_IN"===t.orderType:"ONLINE"===this.statusFilter?"WALK_IN"!==t.orderType:t.status===this.statusFilter);const a=this.matchesDateFilter(t);return r&&i&&a}),this.displayedCount=20,this.currentPage=1}matchesDateFilter(t){if(!this.fromDate&&!this.toDate)return!0;const r=new Date(t.createdAt),i=new Date(r.getFullYear(),r.getMonth(),r.getDate());if(this.fromDate){const a=new Date(this.fromDate);if(i<new Date(a.getFullYear(),a.getMonth(),a.getDate()))return!1}if(this.toDate){const a=new Date(this.toDate);if(i>new Date(a.getFullYear(),a.getMonth(),a.getDate()))return!1}return!0}onFilterChange(){this.applyFilter()}matchesDateRange(t){if(!this.fromDate&&!this.toDate)return!0;try{const r=new Date(t.createdAt),i=new Date(r.getFullYear(),r.getMonth(),r.getDate());if(this.fromDate){const a=this.fromDate.split("-");if(i<new Date(parseInt(a[0]),parseInt(a[1])-1,parseInt(a[2])))return!1}if(this.toDate){const a=this.toDate.split("-");if(i>new Date(parseInt(a[0]),parseInt(a[1])-1,parseInt(a[2])))return!1}return!0}catch(r){return console.error("Error in date filtering:",r),!0}}clearDateFilter(){this.fromDate="",this.toDate="",this.applyFilter()}onFromDateChange(){this.fromDate&&this.toDate&&new Date(this.fromDate)>new Date(this.toDate)&&(this.toDate=this.fromDate),this.applyFilter()}onToDateChange(){if(this.fromDate&&this.toDate){const t=new Date(this.fromDate);new Date(this.toDate)<t&&(this.fromDate=this.toDate)}this.applyFilter()}getMaxFromDate(){return this.toDate||""}getMinToDate(){return this.fromDate||""}onTabChange(t){this.selectedTabIndex=t.index}acceptOrder(t){this.startProcessing(t.id),this.orderService.acceptOrder(t.id).subscribe({next:r=>{const i=this.orders.findIndex(a=>a.id===t.id);-1!==i&&(this.orders[i]=r,this.updateOrderLists(),this.applyFilter()),this.stopProcessing(t.id),this.swal.toast("Order accepted","success")},error:r=>{console.error("Error accepting order:",r),this.stopProcessing(t.id),this.swal.error("Error","Failed to accept order. Please try again.")}})}rejectOrder(t){this.swal.custom({title:"Reject Order",text:"Please provide a reason for rejection:",input:"text",inputPlaceholder:"Enter reason...",showCancelButton:!0,confirmButtonText:"Reject",cancelButtonText:"Cancel",confirmButtonColor:"#ef4444",inputValidator:r=>r?null:"You need to provide a reason!"}).then(r=>{r.isConfirmed&&r.value&&(this.swal.loading("Rejecting order..."),this.orderService.rejectOrder(t.id,r.value).subscribe({next:i=>{const a=this.orders.findIndex(s=>s.id===t.id);-1!==a&&(this.orders[a]=i,this.updateOrderLists(),this.applyFilter()),this.swal.close(),this.swal.success("Order Rejected",`Order #${t.orderNumber} has been rejected.`)},error:i=>{console.error("Error rejecting order:",i),this.swal.close(),this.swal.error("Error","Failed to reject order. Please try again.")}}))})}cancelOrder(t){const i=["Item out of stock","Customer request","Damaged items","Wrong items packed","Unable to prepare on time","Other (please specify)"].map((a,s)=>`\n        <label style="display: block; margin: 8px 0; cursor: pointer;">\n          <input type="radio" name="cancelReason" value="${a}" ${0===s?"checked":""} style="margin-right: 8px;">\n          <span>${a}</span>\n        </label>\n      `).join("");this.swal.custom({title:"Cancel Order",html:`\n        <div style="text-align: left; padding: 10px 0;">\n          <p style="margin-bottom: 15px; font-weight: 500;">Why are you cancelling this order?</p>\n          <div style="border: 1px solid #ddd; padding: 12px; border-radius: 4px; max-height: 250px; overflow-y: auto;">\n            ${i}\n          </div>\n          <textarea id="customReason" placeholder="If 'Other', please specify reason here..." style="width: 100%; margin-top: 12px; padding: 8px; border: 1px solid #ddd; border-radius: 4px; display: none; min-height: 60px;" maxlength="255"></textarea>\n        </div>\n      `,showCancelButton:!0,confirmButtonText:"Cancel Order",cancelButtonText:"Go Back",confirmButtonColor:"#ef4444",didOpen:()=>{const a=document.querySelectorAll('input[name="cancelReason"]'),s=document.getElementById("customReason");a.forEach(l=>{l.addEventListener("change",u=>{s.style.display="Other (please specify)"===u.target.value?"block":"none"})})},inputValidator:()=>{const a=document.querySelector('input[name="cancelReason"]:checked')?.value,s=document.getElementById("customReason");return a?"Other (please specify)"!==a||s.value.trim()?null:"Please specify the reason":"Please select a cancellation reason"}}).then(a=>{if(a.isConfirmed){const s=document.querySelector('input[name="cancelReason"]:checked')?.value,l=document.getElementById("customReason"),u="Other (please specify)"===s?l.value.trim():s;this.swal.loading("Cancelling order..."),this.orderService.cancelOrder(t.id,u).subscribe({next:p=>{const f=this.orders.findIndex(h=>h.id===t.id);-1!==f&&(this.orders[f]=p,this.updateOrderLists(),this.applyFilter()),this.swal.close(),this.swal.success("Order Cancelled",`Order #${t.orderNumber} has been cancelled successfully.`)},error:p=>{console.error("Error cancelling order:",p),this.swal.close();let f="Failed to cancel order. Please try again.";p?.error?.message?f=p.error.message:p?.message&&"string"==typeof p.message&&!p.message.includes("Http failure")&&(f=p.message),this.swal.error("Error",f)}})}})}startPreparing(t){this.startProcessing(t),this.orderService.startPreparing(t).subscribe({next:r=>{const i=this.orders.findIndex(a=>a.id===t);-1!==i&&(this.orders[i]=r,this.updateOrderLists()),this.stopProcessing(t),this.swal.toast("Preparation started","success")},error:r=>{console.error("Error starting preparation:",r),this.stopProcessing(t),this.swal.error("Error","Failed to start preparation. Please try again.")}})}markReady(t){this.startProcessing(t),this.orderService.markReady(t).subscribe({next:r=>{const i=this.orders.findIndex(a=>a.id===t);-1!==i&&(this.orders[i]=r,this.updateOrderLists()),this.stopProcessing(t),"HOME_DELIVERY"===r.deliveryType?(this.searchingDriverOrders.add(t),this.swal.toast("Searching for driver...","info"),this.pollForDriverAssignment(t)):this.swal.toast("Order ready for pickup","success")},error:r=>{console.error("Error marking ready:",r),this.stopProcessing(t),this.swal.error("Error","Failed to mark order as ready. Please try again.")}})}pollForDriverAssignment(t,r=0){if(r>=10)return this.searchingDriverOrders.delete(t),void this.refreshSingleOrder(t);setTimeout(()=>{this.orderService.getOrderById(t).subscribe({next:s=>{const l=this.orders.findIndex(u=>u.id===t);-1!==l&&(this.orders[l]=s,this.updateOrderLists()),s.assignedToDeliveryPartner?(this.searchingDriverOrders.delete(t),this.swal.success("Driver Assigned!","A delivery partner has been assigned. Please verify pickup OTP.")):this.pollForDriverAssignment(t,r+1)},error:s=>{console.error("Error polling for driver assignment:",s),this.searchingDriverOrders.delete(t)}})},1500)}refreshSingleOrder(t){this.orderService.getOrderById(t).subscribe({next:r=>{const i=this.orders.findIndex(a=>a.id===t);-1!==i&&(this.orders[i]=r,this.updateOrderLists())},error:r=>{console.error("Error refreshing order:",r)}})}isSearchingDriver(t){return this.searchingDriverOrders.has(t)}isProcessingOrder(t){return this.processingOrderIds.has(t)}startProcessing(t){this.processingOrderIds.add(t)}stopProcessing(t){this.processingOrderIds.delete(t)}markPickedUp(t){this.orderService.markDelivered(t).subscribe({next:r=>{const i=this.orders.findIndex(a=>a.id===t);-1!==i&&(this.orders[i]=r,this.updateOrderLists()),this.swal.toast("Order marked as delivered","success")},error:r=>{console.error("Error marking delivered:",r),this.swal.error("Error","Failed to mark order as delivered.")}})}handoverSelfPickup(t){this.swal.confirm("Handover Order","Are you sure you want to handover this order to the customer?","Yes, Handover","Cancel").then(r=>{r.isConfirmed&&(this.swal.loading("Processing handover..."),this.orderService.handoverSelfPickup(t).subscribe({next:i=>{const a=this.orders.findIndex(s=>s.id===t);-1!==a&&(this.orders[a].status="SELF_PICKUP_COLLECTED",this.updateOrderLists()),this.swal.close(),this.swal.success("Order Handed Over!","Order has been successfully handed over to the customer."),this.loadOrders()},error:i=>{console.error("Error handing over order:",i),this.swal.close(),this.swal.error("Error",i.error?.message||"Failed to handover order. Please try again.")}}))})}verifyPickupOTP(t){this.swal.custom({title:"Verify Pickup OTP",text:"Enter the 4-digit OTP shown by the delivery partner:",input:"text",inputPlaceholder:"Enter 4-digit OTP...",showCancelButton:!0,confirmButtonText:"Verify",cancelButtonText:"Cancel",confirmButtonColor:"#FF9800",inputValidator:r=>r?4!==r.trim().length?"Please enter a valid 4-digit OTP":null:"You need to enter the OTP!"}).then(r=>{if(r.isConfirmed&&r.value){const i=r.value.trim();this.swal.loading("Verifying OTP..."),this.orderService.verifyPickupOTP(t,i).subscribe({next:a=>{const s=this.orders.findIndex(l=>l.id===t);-1!==s&&(this.orders[s].status="OUT_FOR_DELIVERY",this.updateOrderLists()),this.swal.close(),this.swal.success("OTP Verified!","Order handed over to delivery partner successfully."),this.loadOrders()},error:a=>{console.error("Error verifying OTP:",a),this.swal.close(),this.swal.error("Invalid OTP",a.error?.message||"The OTP you entered is incorrect. Please try again.")}})}})}quickAccept(t){this.acceptOrder(t)}quickReject(t){this.rejectOrder(t)}moveToNextStage(t){const r=this.orders.find(i=>i.id===t);if(r)switch(r.status){case"CONFIRMED":this.startPreparing(t);break;case"PREPARING":this.markReady(t)}}getStatusColor(t){switch(t){case"PENDING":case"CANCELLED":return"warn";case"CONFIRMED":case"READY_FOR_PICKUP":case"DELIVERED":return"primary";case"PREPARING":return"accent";default:return"basic"}}isUrgent(t){const r=new Date,i=new Date(t);return(r.getTime()-i.getTime())/6e4>15}getTimeAgo(t){const r=new Date,i=new Date(t),a=Math.floor((r.getTime()-i.getTime())/6e4);if(a<1)return"Just now";if(a<60)return`${a} min ago`;const s=Math.floor(a/60);return`${s} hour${s>1?"s":""} ago`}getEstimatedTime(t){switch(t){case"CONFIRMED":return 25;case"PREPARING":return 15;case"READY_FOR_PICKUP":return 5;default:return 0}}getNextStageAction(t){switch(t){case"CONFIRMED":return"Start Preparing";case"PREPARING":return"Mark Ready";default:return"Next Stage"}}shouldShowNextStageButton(t){return"CONFIRMED"===t||"PREPARING"===t}getStatusLabel(t){switch(t){case"PENDING":return"Pending";case"CONFIRMED":return"Confirmed";case"PREPARING":return"Preparing";case"READY_FOR_PICKUP":return"Ready for Pickup";case"OUT_FOR_DELIVERY":return"Out for Delivery";case"DELIVERED":return"Delivered";case"CANCELLED":return"Cancelled";case"RETURNING_TO_SHOP":return"Driver Returning";case"RETURNED_TO_SHOP":return"Products Returned";case"SELF_PICKUP_COLLECTED":return"Collected";default:return t.replace(/_/g," ")}}printOrder(t){const r=this.orders.find(s=>s.id===t);if(!r)return void this.swal.error("Error","Order not found");const i=this.generatePrintContent(r),a=window.open("","_blank","width=800,height=600");a&&(a.document.write(i),a.document.close(),a.focus(),a.print(),a.close()),this.swal.toast(`Order #${r.orderNumber} sent to printer`,"success")}printOrderSmall(t){const r=this.orders.find(s=>s.id===t);if(!r)return void this.swal.error("Error","Order not found");const i=this.generateSmallPrintContent(r),a=window.open("","_blank","width=300,height=600");a&&(a.document.write(i),a.document.close(),a.focus(),a.print(),a.close()),this.swal.toast("Receipt sent to printer","success")}generateSmallPrintContent(t){const r=t.items.map(a=>{const s=a.price||a.unitPrice||0,u=a.name||a.productName||"",p=a.productNameTamil||"";return`\n        <tr>\n          <td style="font-size: 9px; padding: 2px 0; font-weight: 600; word-wrap: break-word; max-width: 60px;">${p?`${u}<br><span style="font-size: 8px; color: #333;">${p}</span>`:u}</td>\n          <td style="font-size: 9px; text-align: right; padding: 2px 0; font-weight: 600; white-space: nowrap;">${s}</td>\n          <td style="font-size: 9px; text-align: center; padding: 2px 0; font-weight: 700; white-space: nowrap;">${a.quantity}</td>\n          <td style="font-size: 9px; text-align: right; padding: 2px 0; font-weight: 700; white-space: nowrap;">${a.total||a.totalPrice||a.quantity*s||0}</td>\n        </tr>\n      `}).join(""),i=t.shopName||localStorage.getItem("shop_name")||"NammaOoru";return`\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <meta charset="UTF-8">\n        <title>Receipt - ${t.orderNumber}</title>\n        <style>\n          @page {\n            size: 58mm auto;\n            margin: 1mm;\n          }\n          @media print {\n            body {\n              -webkit-print-color-adjust: exact;\n              print-color-adjust: exact;\n            }\n          }\n          body {\n            font-family: 'Noto Sans Tamil', 'Latha', 'Tamil Sangam MN', Arial, sans-serif;\n            font-size: 11px;\n            width: 180px;\n            max-width: 180px;\n            margin: 0 auto;\n            padding: 8px;\n            line-height: 1.3;\n          }\n          .center { text-align: center; }\n          .bold { font-weight: bold; }\n          .divider {\n            border-top: 1px dashed #000;\n            margin: 6px 0;\n          }\n          .divider-solid {\n            border-top: 1px solid #000;\n            margin: 6px 0;\n          }\n          table { width: 100%; border-collapse: collapse; }\n          .total-row {\n            font-weight: bold;\n            font-size: 14px;\n            border-top: 1px solid #000;\n            padding-top: 6px;\n            margin-top: 6px;\n          }\n          .shop-name {\n            font-family: 'Noto Sans Tamil', 'Latha', 'Tamil Sangam MN', Arial, sans-serif;\n            font-size: 14px;\n            font-weight: 700;\n            margin-bottom: 3px;\n          }\n          .order-number {\n            font-size: 12px;\n            font-weight: 700;\n            background: #000;\n            color: #fff;\n            padding: 4px 8px;\n            display: inline-block;\n            border-radius: 3px;\n            margin: 4px 0;\n          }\n          .customer-name {\n            font-size: 12px;\n            font-weight: 700;\n          }\n          .customer-phone {\n            font-size: 10px;\n            color: #333;\n          }\n          .item-header th {\n            font-size: 10px;\n            padding: 4px 0;\n            border-bottom: 1px solid #000;\n            text-transform: uppercase;\n            font-weight: 700;\n          }\n          .payment-badge {\n            font-size: 10px;\n            font-weight: 700;\n            padding: 4px 8px;\n            background: #f0f0f0;\n            border-radius: 3px;\n            display: inline-block;\n            margin: 4px 0;\n          }\n          .footer-text {\n            font-size: 9px;\n            color: #666;\n            margin-top: 6px;\n          }\n          .flex-row {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n          }\n        </style>\n      </head>\n      <body>\n        <div class="center shop-name">${i}</div>\n        <div class="center" style="font-size: 9px; color: #666;">Order Receipt</div>\n        <div class="divider"></div>\n\n        <div class="center">\n          <div class="order-number">#${t.orderNumber}</div>\n        </div>\n        <div style="font-size: 9px; text-align: center; margin-bottom: 4px;">\n          ${new Date(t.createdAt).toLocaleDateString("en-IN",{timeZone:"Asia/Kolkata",day:"2-digit",month:"short",year:"numeric"})} | ${new Date(t.createdAt).toLocaleTimeString("en-IN",{timeZone:"Asia/Kolkata",hour:"2-digit",minute:"2-digit",hour12:!0})}\n        </div>\n        <div class="divider"></div>\n\n        <div style="margin-bottom: 4px;">\n          <div class="customer-name">${t.customerName}</div>\n          <div class="customer-phone">${t.customerPhone||""}</div>\n        </div>\n        <div class="divider"></div>\n\n        <table>\n          <thead>\n            <tr class="item-header">\n              <th style="text-align: left;">ITEM</th>\n              <th style="text-align: right;">RATE</th>\n              <th style="text-align: center;">QTY</th>\n              <th style="text-align: right;">AMT</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${r}\n          </tbody>\n        </table>\n        <div class="divider-solid"></div>\n\n        <div class="flex-row" style="font-size: 10px; padding: 4px 0;">\n          <span style="font-weight: 600;">Items: ${t.items?.length||0}</span>\n          <span style="font-weight: 700;">\u20b9${t.totalAmount||0}</span>\n        </div>\n\n        <div class="flex-row" style="border-top: 1px solid #000; padding-top: 6px; margin-top: 4px;">\n          <span style="font-size: 14px; font-weight: 700;">TOTAL</span>\n          <span style="font-size: 16px; font-weight: 700;">\u20b9${t.totalAmount||0}</span>\n        </div>\n\n        <div class="divider"></div>\n        <div class="center">\n          <span class="payment-badge">\n            ${"CASH_ON_DELIVERY"===t.paymentMethod?"\u{1f4b5} CASH ON DELIVERY":"\u2713 PAID ONLINE"}\n          </span>\n        </div>\n        <div class="divider"></div>\n\n        <div class="center footer-text">\n          Thank you for your order!<br>\n          Printed: ${(new Date).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})}\n        </div>\n      </body>\n      </html>\n    `}generatePrintContent(t){const r=t.items.map(a=>`\n      <tr>\n        <td>${a.name||a.productName}</td>\n        <td style="text-align: center;">${a.quantity}</td>\n        <td style="text-align: right;">\u20b9${a.price||a.unitPrice}</td>\n        <td style="text-align: right;">\u20b9${a.total||a.totalPrice}</td>\n      </tr>\n    `).join(""),i=localStorage.getItem("shop_name")||"NammaOoru";return`\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <meta charset="UTF-8">\n        <title>Order #${t.orderNumber}</title>\n        <style>\n          body { font-family: 'Noto Sans Tamil', 'Latha', 'Tamil Sangam MN', Arial, sans-serif; padding: 20px; }\n          .header { text-align: center; margin-bottom: 30px; }\n          .order-info { margin-bottom: 20px; }\n          .customer-info { margin-bottom: 20px; }\n          table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }\n          th, td { padding: 8px; border: 1px solid #ddd; }\n          th { background-color: #f5f5f5; }\n          .total { font-weight: bold; font-size: 16px; }\n          .footer { margin-top: 30px; text-align: center; font-size: 12px; }\n        </style>\n      </head>\n      <body>\n        <div class="header">\n          <h1>${i}</h1>\n          <h2>Order #${t.orderNumber}</h2>\n        </div>\n\n        <div class="order-info">\n          <p><strong>Date:</strong> ${new Date(t.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})}</p>\n          <p><strong>Status:</strong> ${this.getStatusLabel(t.status)}</p>\n          <p><strong>Payment Method:</strong> ${"CASH_ON_DELIVERY"===t.paymentMethod?"Cash on Delivery":"Paid Online"}</p>\n        </div>\n\n        <div class="customer-info">\n          <h3>Customer Details</h3>\n          <p><strong>Name:</strong> ${t.customerName}</p>\n          <p><strong>Phone:</strong> ${t.customerPhone}</p>\n          <p><strong>Address:</strong> ${t.customerAddress||t.deliveryAddress}</p>\n        </div>\n\n        <h3>Order Items</h3>\n        <table>\n          <thead>\n            <tr>\n              <th>Item</th>\n              <th>Quantity</th>\n              <th>Unit Price</th>\n              <th>Total</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${r}\n          </tbody>\n          <tfoot>\n            <tr class="total">\n              <td colspan="3">Total Amount</td>\n              <td style="text-align: right;">\u20b9${t.totalAmount}</td>\n            </tr>\n          </tfoot>\n        </table>\n\n        <div class="footer">\n          <p>Thank you for your order!</p>\n          <p>Printed on: ${(new Date).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})}</p>\n        </div>\n      </body>\n      </html>\n    `}viewCustomer(t){this.swal.info("Coming Soon","Customer details feature is under development.")}refundOrder(t){this.swal.info("Refund Initiated","Refund process has been started.")}reportIssue(t){this.swal.info("Coming Soon","Issue reporting feature is under development.")}assignDeliveryPartner(t){this.isAssigningPartner=!0,this.assignmentService.autoAssignOrder(t,1).subscribe({next:i=>{if(this.isAssigningPartner=!1,i.success&&i.assignment){const a=this.orders.findIndex(s=>s.id===t);-1!==a&&(this.orders[a].status="OUT_FOR_DELIVERY",this.updateOrderLists()),this.swal.success("Order Assigned",`Order assigned to ${i.assignment.deliveryPartner.name}`)}else this.swal.error("Assignment Failed",i.message||"Failed to assign delivery partner")},error:i=>{this.isAssigningPartner=!1,console.error("Error assigning delivery partner:",i),this.swal.error("Error","Failed to assign delivery partner. Please try again.")}})}onPageChange(t){}verifyDriver(t,r){!r||r.length<4?this.swal.warning("Invalid Code","Please enter a valid verification code"):this.orderService.verifyDriverForPickup(t,r).subscribe({next:i=>{if(i.success){const a=this.orders.findIndex(s=>s.id===t);-1!==a&&(this.orders[a].driverVerified=!0,this.updateOrderLists()),this.swal.success("Driver Verified!","Order can be handed over to the delivery partner."),delete this.verificationCodes[t]}else this.swal.error("Verification Failed",i.message||"Invalid verification code")},error:i=>{console.error("Error verifying driver:",i),this.swal.error("Error","Failed to verify driver. Please try again.")}})}getStatusClass(t){switch(t){case"PENDING":return"status-pending";case"CONFIRMED":return"status-confirmed";case"PREPARING":return"status-preparing";case"READY_FOR_PICKUP":return"status-ready";case"OUT_FOR_DELIVERY":return"status-delivery";case"DELIVERED":return"status-delivered";case"CANCELLED":return"status-cancelled";case"RETURNING_TO_SHOP":return"status-returning";case"RETURNED_TO_SHOP":return"status-returned";case"SELF_PICKUP_COLLECTED":return"status-collected";default:return""}}assignDelivery(t){this.assignDeliveryPartner(t)}viewOrderDetails(t){const r=this.generateOrderDetailsContent(t),i=window.open("","_blank","width=900,height=700,scrollbars=yes");i&&(i.document.write(r),i.document.close(),i.focus()),this.successMessage=`Viewing details for Order #${t.orderNumber}`,setTimeout(()=>this.successMessage="",3e3)}generateOrderDetailsContent(t){const r=t.items.map(i=>{const a=i.price||i.unitPrice||0,s=i.quantity*a;return`\n        <tr>\n          <td style="display: flex; align-items: center; padding: 12px;">\n            ${i.image||i.productImageUrl?`<img src="${this.getImageUrl(i.image||i.productImageUrl||"")}" alt="${i.name||i.productName}" style="width: 50px; height: 50px; object-fit: cover; border-radius: 4px; margin-right: 10px;">`:`<div style="width: 50px; height: 50px; background: #ecf0f1; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin-right: 10px; font-size: 18px; color: #7f8c8d; font-weight: bold;">${(i.name||i.productName||"P")[0].toUpperCase()}</div>`}\n            <div>\n              <div style="font-weight: 600; margin-bottom: 4px; color: #2c3e50;">${i.name||i.productName}</div>\n              <div style="color: #7f8c8d; font-size: 12px;">Unit Price: \u20b9${a}</div>\n            </div>\n          </td>\n          <td style="text-align: center; font-weight: 600; color: #3498db;">${i.quantity}</td>\n          <td style="text-align: center; color: #7f8c8d;">${i.quantity} \xd7 \u20b9${a}</td>\n          <td style="text-align: right; font-weight: 700; color: #2c3e50;">\u20b9${s.toFixed(0)}</td>\n        </tr>\n      `}).join("");return`\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <title>Order Details - #${t.orderNumber}</title>\n        <style>\n          body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;\n            padding: 20px;\n            background: #f5f6fa;\n            margin: 0;\n          }\n          .container {\n            max-width: 800px;\n            margin: 0 auto;\n            background: white;\n            border-radius: 8px;\n            box-shadow: 0 2px 4px rgba(44, 62, 80, 0.08);\n            overflow: hidden;\n          }\n          .header {\n            background: #2c3e50;\n            color: white;\n            padding: 24px;\n            text-align: center;\n          }\n          .content { padding: 24px; }\n          .section {\n            margin-bottom: 24px;\n            background: #ecf0f1;\n            padding: 16px;\n            border-radius: 6px;\n            border-left: 3px solid #3498db;\n          }\n          .section h3 {\n            margin: 0 0 12px 0;\n            color: #2c3e50;\n            font-size: 16px;\n            font-weight: 600;\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n          }\n          .info-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 12px;\n          }\n          .info-item {\n            background: white;\n            padding: 12px;\n            border-radius: 4px;\n            border: 1px solid #dfe6e9;\n          }\n          .info-label {\n            font-weight: 500;\n            color: #7f8c8d;\n            font-size: 11px;\n            text-transform: uppercase;\n            margin-bottom: 4px;\n            letter-spacing: 0.5px;\n          }\n          .info-value {\n            color: #2c3e50;\n            font-weight: 600;\n          }\n          table {\n            width: 100%;\n            border-collapse: collapse;\n            background: white;\n            border-radius: 6px;\n            overflow: hidden;\n            box-shadow: 0 1px 3px rgba(44, 62, 80, 0.08);\n          }\n          th {\n            background: #34495e;\n            color: white;\n            padding: 12px;\n            text-align: left;\n            font-weight: 500;\n            font-size: 13px;\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n          }\n          td {\n            padding: 12px;\n            border-bottom: 1px solid #ecf0f1;\n          }\n          tr:last-child td {\n            border-bottom: none;\n          }\n          .status-badge {\n            display: inline-block;\n            padding: 4px 10px;\n            border-radius: 4px;\n            font-size: 11px;\n            font-weight: 500;\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n          }\n          .status-pending { background: rgba(52, 152, 219, 0.15); color: #2980b9; border: 1px solid rgba(52, 152, 219, 0.3); }\n          .status-confirmed { background: rgba(52, 152, 219, 0.1); color: #3498db; border: 1px solid #3498db; }\n          .status-preparing { background: rgba(41, 128, 185, 0.1); color: #2980b9; border: 1px solid #2980b9; }\n          .status-ready { background: rgba(44, 62, 80, 0.1); color: #2c3e50; border: 1px solid #2c3e50; }\n          .status-delivered { background: #ecf0f1; color: #7f8c8d; border: 1px solid #dfe6e9; }\n          .total-section {\n            background: rgba(44, 62, 80, 0.05);\n            border: 1px solid rgba(44, 62, 80, 0.1);\n            color: #2c3e50;\n            padding: 20px;\n            border-radius: 6px;\n            margin-top: 20px;\n          }\n          .print-btn {\n            background: #2c3e50;\n            color: white;\n            border: none;\n            padding: 10px 20px;\n            border-radius: 4px;\n            cursor: pointer;\n            font-weight: 500;\n            margin-top: 20px;\n            font-size: 14px;\n          }\n          .print-btn:hover {\n            background: #34495e;\n          }\n        </style>\n      </head>\n      <body>\n        <div class="container">\n          <div class="header">\n            <h1 style="margin: 0 0 8px 0; font-size: 20px; font-weight: 600;">Order Details</h1>\n            <h2 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 400;">Order #${t.orderNumber}</h2>\n            <div class="status-badge ${this.getStatusClass(t.status)}">\n              ${this.getStatusLabel(t.status)}\n            </div>\n          </div>\n\n          <div class="content">\n            <div class="section">\n              <h3>Order Information</h3>\n              <div class="info-grid">\n                <div class="info-item">\n                  <div class="info-label">Order Date</div>\n                  <div class="info-value">${new Date(t.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})}</div>\n                </div>\n                <div class="info-item">\n                  <div class="info-label">Payment Method</div>\n                  <div class="info-value">${"CASH_ON_DELIVERY"===t.paymentMethod?"Cash on Delivery":"Online Payment"}</div>\n                </div>\n                <div class="info-item">\n                  <div class="info-label">Payment Status</div>\n                  <div class="info-value">${t.paymentStatus}</div>\n                </div>\n                <div class="info-item">\n                  <div class="info-label">Total Amount</div>\n                  <div class="info-value" style="font-size: 18px; font-weight: 700; color: #2c3e50;">\u20b9${t.totalAmount}</div>\n                </div>\n              </div>\n            </div>\n\n            <div class="section">\n              <h3>Customer Information</h3>\n              <div class="info-grid">\n                <div class="info-item">\n                  <div class="info-label">Customer Name</div>\n                  <div class="info-value">${t.customerName}</div>\n                </div>\n                <div class="info-item">\n                  <div class="info-label">Phone Number</div>\n                  <div class="info-value">${t.customerPhone||"Not provided"}</div>\n                </div>\n                <div class="info-item">\n                  <div class="info-label">Email</div>\n                  <div class="info-value">${t.customerEmail||"Not provided"}</div>\n                </div>\n                <div class="info-item">\n                  <div class="info-label">Delivery Address</div>\n                  <div class="info-value">${t.customerAddress||t.deliveryAddress||"Not provided"}</div>\n                </div>\n              </div>\n            </div>\n\n            <div class="section">\n              <h3>Order Items (${t.items?.length||0})</h3>\n              <table>\n                <thead>\n                  <tr>\n                    <th>Item Details</th>\n                    <th style="text-align: center;">Quantity</th>\n                    <th style="text-align: center;">Calculation</th>\n                    <th style="text-align: right;">Total</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  ${r}\n                </tbody>\n              </table>\n            </div>\n\n            <div class="total-section">\n              <div style="display: flex; justify-content: space-between; align-items: center;">\n                <div>\n                  <div style="font-size: 16px; font-weight: 500; color: #7f8c8d;">Order Total</div>\n                  <div style="font-size: 12px; color: #95a5a6;">${t.items?.length||0} items</div>\n                </div>\n                <div style="font-size: 24px; font-weight: 600; color: #2c3e50;">\u20b9${t.totalAmount}</div>\n              </div>\n            </div>\n\n            <button class="print-btn" onclick="window.print()">Print Order Details</button>\n          </div>\n        </div>\n      </body>\n      </html>\n    `}getItemIcon(t){if(!t)return"\u{1f37d}\ufe0f";const r=t.toLowerCase();return r.includes("coffee")?"\u2615":r.includes("tea")?"\u{1f375}":r.includes("pizza")?"\u{1f355}":r.includes("burger")?"\u{1f354}":r.includes("cake")?"\u{1f382}":r.includes("bread")?"\u{1f35e}":r.includes("milk")?"\u{1f95b}":r.includes("water")?"\u{1f4a7}":r.includes("juice")?"\u{1f9c3}":r.includes("rice")?"\u{1f35a}":r.includes("chicken")?"\u{1f357}":r.includes("fish")?"\u{1f41f}":r.includes("egg")?"\u{1f95a}":r.includes("fruit")?"\u{1f34e}":r.includes("vegetable")?"\u{1f955}":r.includes("abc")?"\u{1f964}":"\u{1f37d}\ufe0f"}selectStatusTab(t){this.selectedStatus=t,this.applyFilter()}getOrdersByStatus(t){return this.orders.filter(r=>r.status===t)}getReturnOrders(){return this.orders.filter(t=>"RETURNING_TO_SHOP"===t.status||"RETURNED_TO_SHOP"===t.status)}getSelfPickupOrders(){return this.orders.filter(t=>"SELF_PICKUP"===t.deliveryType)}getWalkInOrders(){return this.orders.filter(t=>"WALK_IN"===t.orderType)}getOnlineOrders(){return this.orders.filter(t=>"WALK_IN"!==t.orderType)}switchMainTab(t){this.mainTab=t,this.selectedStatus="realtime"===t?"REALTIME_ALL":"HISTORY_ALL",this.applyFilter()}getRealtimeOrdersCount(){const t=["PENDING","CONFIRMED","PREPARING","READY_FOR_PICKUP","PICKED_UP","OUT_FOR_DELIVERY","RETURNING_TO_SHOP","RETURNED_TO_SHOP"];return this.orders.filter(r=>t.includes(r.status)).length}getHistoryOrdersCount(){const t=["DELIVERED","CANCELLED","SELF_PICKUP_COLLECTED"];return this.orders.filter(r=>t.includes(r.status)).length}getRealtimeOrders(){const t=["PENDING","CONFIRMED","PREPARING","READY_FOR_PICKUP","PICKED_UP","OUT_FOR_DELIVERY","RETURNING_TO_SHOP","RETURNED_TO_SHOP"];return this.orders.filter(r=>t.includes(r.status))}getHistoryOrders(){const t=["DELIVERED","CANCELLED","SELF_PICKUP_COLLECTED"];return this.orders.filter(r=>t.includes(r.status))}getActiveSelfPickupOrders(){const t=["PENDING","CONFIRMED","PREPARING","READY_FOR_PICKUP"];return this.orders.filter(r=>"SELF_PICKUP"===r.deliveryType&&t.includes(r.status))}retryDriverSearch(t){this.swal.loading("Searching for available drivers..."),this.http.post(`${Oe.c.apiUrl}/orders/${t}/retry-driver-search`,{}).subscribe({next:r=>{this.swal.close(),r.data?.driverAssigned?this.swal.success("Driver Found!","A delivery partner has been assigned to this order."):this.swal.custom({icon:"warning",title:"Searching for Drivers",text:r.data?.message||"We are looking for available drivers. Please wait or try again later.",confirmButtonText:"OK"}),this.loadOrders()},error:r=>{console.error("Error retrying driver search:",r),this.swal.close(),this.swal.error("Error",r.error?.message||"Failed to search for drivers. Please try again.")}})}confirmReturnReceipt(t){this.swal.custom({icon:"question",title:"Verify & Collect Products",html:'\n        <div style="text-align: left; padding: 10px;">\n          <p style="margin-bottom: 15px;">Please verify the following before confirming:</p>\n          <ul style="margin: 0; padding-left: 20px; color: #666;">\n            <li style="margin-bottom: 8px;">All items have been returned</li>\n            <li style="margin-bottom: 8px;">Products are in good condition</li>\n            <li style="margin-bottom: 8px;">Quantities match the order</li>\n          </ul>\n          <p style="margin-top: 15px; font-size: 13px; color: #888;">\n            Stock will be automatically restored after confirmation.\n          </p>\n        </div>\n      ',showCancelButton:!0,confirmButtonText:"Confirm Collection",cancelButtonText:"Cancel",confirmButtonColor:"#4CAF50"}).then(r=>{r.isConfirmed&&(this.swal.loading("Processing return receipt..."),this.http.post(`${Oe.c.apiUrl}/orders/${t}/confirm-return-receipt`,{}).subscribe({next:i=>{this.swal.close(),this.swal.success("Products Collected!","Return receipt confirmed and stock has been restored."),this.loadOrders()},error:i=>{console.error("Error confirming return receipt:",i),this.swal.close(),this.swal.error("Error",i.error?.message||"Failed to confirm return receipt. Please try again.")}}))})}getImageUrl(t){return(0,Mr.V)(t)}onImageError(t){const r=t.target;if(r){r.style.display="none";const i=r.parentElement;if(i&&!i.querySelector(".fallback-icon")){const a=document.createElement("div");a.className="item-icon fallback-icon",a.textContent="\u{1f37d}\ufe0f",i.appendChild(a)}}}formatOrderTime(t){if(!t)return"";let i;return i=t.endsWith("Z")||/[+-]\d{2}:\d{2}$/.test(t)||/[+-]\d{4}$/.test(t)?new Date(t):new Date(t+"Z"),i.toLocaleString("en-IN",{timeZone:"Asia/Kolkata",day:"2-digit",month:"2-digit",hour:"numeric",minute:"2-digit",hour12:!0})}removeItemFromOrder(t,r){["PENDING","CONFIRMED","PREPARING"].includes(t.status)?t.items.length<=1?this.swal.error("Cannot Remove Item","Cannot remove the last item from an order. Cancel the order instead."):this.swal.confirm("Remove Item",`Are you sure you want to remove "${r.name||r.productName}" from this order?`,"Yes, Remove","Cancel").then(i=>{i.isConfirmed&&(this.swal.loading("Removing item..."),this.orderService.removeItemFromOrder(t.id,r.id).subscribe({next:a=>{const s=this.orders.findIndex(l=>l.id===t.id);-1!==s&&(this.orders[s]=a,this.updateOrderLists(),this.applyFilter()),this.swal.close(),this.swal.success("Item Removed",`Item removed from order #${t.orderNumber}. New total: \u20b9${a.totalAmount}`)},error:a=>{console.error("Error removing item from order:",a),this.swal.close();let s="Failed to remove item from order.";a?.error?.message&&(s=a.error.message),this.swal.error("Error",s)}}))}):this.swal.error("Cannot Remove Item","Items can only be removed from orders that are Pending, Confirmed, or Preparing.")}openUpdateOrderModal(t){this.shopId?this.productService.getShopProducts(this.shopId,0,100).subscribe({next:r=>{if(!r||0===r.length)return void this.swal.error("No Products","No products found in your shop");const i=r.map(a=>`<option value="${a.id}" data-price="${a.price}">${a.name||a.masterProduct?.name} - \u20b9${a.price}</option>`).join("");sn().fire({title:`Add Item to Order #${t.orderNumber}`,html:`\n            <div style="text-align: left; padding: 10px 0;">\n              <label style="font-weight: 600; margin-bottom: 8px; display: block;">Select Product:</label>\n              <select id="productSelect" class="swal2-select" style="width: 100%; padding: 10px; border-radius: 6px; border: 1px solid #ddd; margin-bottom: 15px;">\n                <option value="">-- Select Product --</option>\n                ${i}\n              </select>\n\n              <label style="font-weight: 600; margin-bottom: 8px; display: block;">Quantity:</label>\n              <input type="number" id="quantityInput" class="swal2-input" min="1" value="1" style="width: 100%; margin: 0 0 15px 0;">\n\n              <label style="font-weight: 600; margin-bottom: 8px; display: block;">Special Instructions (optional):</label>\n              <textarea id="instructionsInput" class="swal2-textarea" placeholder="Any special instructions..." style="width: 100%; margin: 0;"></textarea>\n\n              <div id="itemPreview" style="margin-top: 15px; padding: 12px; background: #f5f5f5; border-radius: 8px; display: none;">\n                <strong>Item Total:</strong> <span id="itemTotal">\u20b90</span>\n              </div>\n            </div>\n          `,showCancelButton:!0,confirmButtonText:"Add Item",confirmButtonColor:"#4CAF50",cancelButtonText:"Cancel",didOpen:()=>{const a=document.getElementById("productSelect"),s=document.getElementById("quantityInput"),l=document.getElementById("itemPreview"),u=document.getElementById("itemTotal"),p=()=>{const f=a.selectedOptions[0];if(f&&f.value){const h=parseFloat(f.getAttribute("data-price")||"0"),_=parseInt(s.value)||1;u.textContent=`\u20b9${(h*_).toFixed(0)}`,l.style.display="block"}else l.style.display="none"};a.addEventListener("change",p),s.addEventListener("input",p)},preConfirm:()=>{const a=document.getElementById("productSelect"),s=document.getElementById("quantityInput"),l=document.getElementById("instructionsInput"),u=parseInt(a.value),p=parseInt(s.value),f=l.value.trim();return u?!p||p<1?(sn().showValidationMessage("Quantity must be at least 1"),!1):{shopProductId:u,quantity:p,specialInstructions:f}:(sn().showValidationMessage("Please select a product"),!1)}}).then(a=>{if(a.isConfirmed&&a.value){const{shopProductId:s,quantity:l,specialInstructions:u}=a.value;this.swal.loading("Adding item to order..."),this.orderService.addItemToOrder(t.id,s,l,u).subscribe({next:p=>{const f=this.orders.findIndex(h=>h.id===t.id);-1!==f&&(this.orders[f]=p,this.updateOrderLists(),this.applyFilter()),this.swal.close(),this.swal.success("Item Added",`Item added to order #${t.orderNumber}. New total: \u20b9${p.totalAmount}`)},error:p=>{console.error("Error adding item to order:",p),this.swal.close();let f="Failed to add item to order.";p?.error?.message&&(f=p.error.message),this.swal.error("Error",f)}})}})},error:r=>{console.error("Error loading products:",r),this.swal.error("Error","Failed to load products")}}):this.swal.error("Error","Shop ID not found")}getPagedOrders(){return this.filteredOrders.slice(0,this.displayedCount)}onTableScroll(t){const r=t.target;r.scrollHeight-r.scrollTop<=r.clientHeight+this.scrollThreshold&&!this.isLoadingMore&&this.displayedCount<this.filteredOrders.length&&this.loadMoreOrders()}loadMoreOrders(){this.isLoadingMore=!0,setTimeout(()=>{this.displayedCount=Math.min(this.displayedCount+10,this.filteredOrders.length),this.isLoadingMore=!1},300)}getDisplayedOrdersCount(){return Math.min(this.displayedCount,this.filteredOrders.length)}onDateFilterChange(){this.displayedCount=20,this.applyFilter()}getTotalPages(){return Math.ceil(this.filteredOrders.length/this.pageSize)}getPaginationStart(){return Math.min((this.currentPage-1)*this.pageSize+1,this.filteredOrders.length)}getPaginationEnd(){return Math.min(this.currentPage*this.pageSize,this.filteredOrders.length)}goToPage(t){"number"==typeof t&&(this.currentPage=Math.max(1,Math.min(t,this.getTotalPages())))}getPageNumbers(){const t=this.getTotalPages(),r=this.currentPage,i=[];if(t<=7)for(let a=1;a<=t;a++)i.push(a);else{i.push(1),r>3&&i.push("...");for(let a=Math.max(2,r-1);a<=Math.min(t-1,r+1);a++)i.push(a);r<t-2&&i.push("..."),i.push(t)}return i}showOrderDetailsModal(t){this.selectedOrder=t,this.showDetailsModal=!0}closeDetailsModal(){this.showDetailsModal=!1,this.selectedOrder=null,this.showAddItemSearch=!1,this.addItemSearchTerm="",this.addItemSearchResults=[],this.addItemQty=1}toggleAddItemSearch(){this.showAddItemSearch=!this.showAddItemSearch,this.showAddItemSearch&&!this.productsLoaded&&this.loadAllProducts(),this.showAddItemSearch||(this.addItemSearchTerm="",this.addItemSearchResults=[],this.addItemQty=1)}loadAllProducts(){var t=this;return(0,fe.A)(function*(){t.isSearchingProducts=!0;try{t.allCachedProducts=yield t.offlineStorage.getProducts(),0===t.allCachedProducts.length&&t.shopId&&(yield t.posSyncService.refreshProductCache(t.shopId),t.allCachedProducts=yield t.offlineStorage.getProducts()),t.productsLoaded=!0,t.isSearchingProducts=!1,t.addItemSearchTerm&&t.searchProductsForOrder()}catch{t.allCachedProducts=[],t.isSearchingProducts=!1}})()}searchProductsForOrder(){const t=this.addItemSearchTerm?.trim().toLowerCase();this.addItemSearchResults=!t||t.length<1?[]:this.allCachedProducts.filter(r=>r.name&&r.name.toLowerCase().includes(t)||r.sku&&r.sku.toLowerCase().includes(t)||r.barcode&&r.barcode.toLowerCase().includes(t)||r.barcode1&&r.barcode1.toLowerCase().includes(t)||r.barcode2&&r.barcode2.toLowerCase().includes(t)||r.nameTamil&&r.nameTamil.toLowerCase().includes(t)).slice(0,20)}addItemToExistingOrder(t){if(!this.selectedOrder||this.isAddingItem)return;const r=this.addItemQty||1;this.isAddingItem=!0,this.orderService.addItemToOrder(this.selectedOrder.id,t.id,r).subscribe({next:i=>{this.selectedOrder=i;const a=this.orders.findIndex(s=>s.id===i.id);-1!==a&&(this.orders[a]=i,this.applyFilter()),this.isAddingItem=!1,this.addItemQty=1,this.swal.toast(`${t.name} added to order`,"success")},error:i=>{this.isAddingItem=!1,this.swal.error("Error",i?.error?.message||"Failed to add item to order")}})}getStatusBadgeClass(t){switch(t){case"PENDING":return"badge-pending";case"CONFIRMED":return"badge-confirmed";case"PREPARING":return"badge-preparing";case"READY_FOR_PICKUP":return"badge-ready";case"OUT_FOR_DELIVERY":return"badge-out-for-delivery";case"DELIVERED":return"badge-delivered";case"SELF_PICKUP_COLLECTED":return"badge-completed";case"CANCELLED":return"badge-cancelled";case"RETURNING_TO_SHOP":return"badge-returning";case"RETURNED_TO_SHOP":return"badge-returned";default:return""}}getDeliveryTypeClass(t){return"WALK_IN"===t.orderType?"type-walkin":"SELF_PICKUP"===t.deliveryType?"type-pickup":"type-delivery"}getDeliveryTypeIcon(t){return"WALK_IN"===t.orderType?"store":"SELF_PICKUP"===t.deliveryType?"shopping_bag":"local_shipping"}getDeliveryTypeLabel(t){return"WALK_IN"===t.orderType?"Walk-in":"SELF_PICKUP"===t.deliveryType?"Self Pickup":"Delivery"}getCustomerInitials(t){if(!t)return"U";const r=t.trim().split(" ");return r.length>=2?(r[0][0]+r[1][0]).toUpperCase():t.substring(0,2).toUpperCase()}getActiveDeliveriesCount(){return this.orders.filter(t=>["CONFIRMED","PREPARING","READY_FOR_PICKUP","OUT_FOR_DELIVERY"].includes(t.status)).length}exportOrders(){if(0===this.filteredOrders.length)return void this.swal.warning("No Data","No orders to export");const r=this.filteredOrders.map(l=>[l.orderNumber,l.customerName,l.customerPhone||"",this.getDeliveryTypeLabel(l),this.getStatusLabel(l.status),l.totalAmount.toString(),new Date(l.createdAt).toLocaleString("en-IN",{timeZone:"Asia/Kolkata"})]),i=[["Order ID","Customer","Phone","Type","Status","Total","Date"].join(","),...r.map(l=>l.map(u=>`"${u}"`).join(","))].join("\n"),a=new Blob([i],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");s.href=URL.createObjectURL(a),s.download=`orders_${(new Date).toISOString().split("T")[0]}.csv`,s.click(),this.swal.toast("Orders exported successfully","success")}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(Kp),e.rXU(Gr),e.rXU(h4),e.rXU(Gt.u),e.rXU($r.h),e.rXU(Ce.UG),e.rXU(Wd),e.rXU(Xe.Ix),e.rXU(gt.Qq),e.rXU(_4.V),e.rXU(e.SKi),e.rXU(at.m),e.rXU(t0))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-orders-management"]],viewQuery:function(r,i){if(1&r&&e.GBs(C4,5),2&r){let a;e.mGM(a=e.lsd())&&(i.tableContainer=a.first)}},decls:110,vars:22,consts:[[1,"orders-page"],[1,"stats-cards-row"],[1,"stat-card","stat-total"],[1,"stat-icon"],[1,"stat-content"],[1,"stat-value"],[1,"stat-label"],[1,"stat-card","stat-revenue"],[1,"stat-card","stat-active"],[1,"stat-card","stat-delivered"],[1,"table-header"],[1,"table-title"],[1,"table-actions"],[1,"filter-dropdown"],[1,"filter-select",3,"ngModel","ngModelChange","change"],["value","ALL"],["value","PENDING"],["value","CONFIRMED"],["value","PREPARING"],["value","READY_FOR_PICKUP"],["value","OUT_FOR_DELIVERY"],["value","DELIVERED"],["value","CANCELLED"],["value","WALK_IN"],["value","ONLINE"],[1,"filter-icon"],[1,"date-filters"],["type","date","title","From Date",1,"date-input",3,"ngModel","ngModelChange","change"],[1,"date-separator"],["type","date","title","To Date",1,"date-input",3,"ngModel","ngModelChange","change"],["class","clear-date-btn","title","Clear dates",3,"click",4,"ngIf"],["type","text","placeholder","Search orders...",1,"search-input",3,"ngModel","ngModelChange","input"],[1,"export-btn",3,"click"],[1,"refresh-btn",3,"click"],[1,"orders-table-container",3,"scroll"],["tableContainer",""],[1,"orders-table"],[1,"col-order-id"],[1,"col-customer"],[1,"col-type"],[1,"col-status"],[1,"col-total"],[1,"col-action"],["class","order-row",3,"pending-row",4,"ngFor","ngForOf"],[4,"ngIf"],["class","scroll-info",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],["class","message success",4,"ngIf"],["class","message error",4,"ngIf"],["title","Clear dates",1,"clear-date-btn",3,"click"],[1,"order-row"],["colspan","6","class","processing-cell",4,"ngIf"],["colspan","6",1,"processing-cell"],[1,"processing-indicator"],[1,"spin"],[1,"order-number",3,"click"],[1,"order-time"],[1,"customer-info"],[1,"customer-avatar"],[1,"customer-details"],[1,"customer-name"],["class","customer-phone",4,"ngIf"],[1,"delivery-type",3,"ngClass"],[1,"status-badge",3,"ngClass"],[1,"total-amount"],[1,"action-buttons"],["class","btn-action btn-prepare","title","Start Preparing",3,"click",4,"ngIf"],["class","btn-action btn-ready","title","Mark Ready",3,"click",4,"ngIf"],["class","btn-action btn-collect","title","Collect Products",3,"click",4,"ngIf"],["title","Print Receipt",1,"btn-action","btn-print",3,"click"],["title","View Details",1,"btn-details",3,"click"],[1,"customer-phone"],["title","Accept Order",1,"btn-accept",3,"click"],["title","Reject Order",1,"btn-reject",3,"click"],["title","Start Preparing",1,"btn-action","btn-prepare",3,"click"],["title","Mark Ready",1,"btn-action","btn-ready",3,"click"],["class","btn-action btn-handover","title","Handover",3,"click",4,"ngIf"],["class","btn-action btn-verify","title","Verify OTP",3,"click",4,"ngIf"],["class","btn-action btn-find-driver","title","Find Driver",3,"click",4,"ngIf"],["class","spin searching-icon",4,"ngIf"],["title","Handover",1,"btn-action","btn-handover",3,"click"],["title","Verify OTP",1,"btn-action","btn-verify",3,"click"],["title","Find Driver",1,"btn-action","btn-find-driver",3,"click"],[1,"spin","searching-icon"],["title","Collect Products",1,"btn-action","btn-collect",3,"click"],["colspan","6",1,"empty-state"],[1,"empty-content"],[1,"empty-title"],["class","empty-subtitle",4,"ngIf"],[1,"empty-subtitle"],[1,"scroll-info"],["class","loading-more",4,"ngIf"],[1,"loading-more"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"modal-title"],[1,"modal-close",3,"click"],["class","modal-body",4,"ngIf"],["class","modal-footer",4,"ngIf"],[1,"modal-body"],[1,"detail-section"],[1,"detail-grid"],[1,"detail-item"],[1,"detail-label"],[1,"detail-value"],["class","detail-item full-width",4,"ngIf"],[1,"items-header-row"],["class","btn-add-item",3,"click",4,"ngIf"],["class","add-item-section",4,"ngIf"],[1,"items-list"],["class","item-row",4,"ngFor","ngForOf"],[1,"order-total"],[1,"detail-item","full-width"],[1,"btn-add-item",3,"click"],[1,"add-item-section"],[1,"add-item-search"],[1,"search-icon"],["type","text","placeholder","Search product by name...","autofocus","",1,"add-item-input",3,"ngModel","ngModelChange","input"],["class","add-item-results",4,"ngIf"],["class","add-item-empty",4,"ngIf"],["class","add-item-loading",4,"ngIf"],[1,"add-item-results"],["class","add-item-result",4,"ngFor","ngForOf"],[1,"add-item-result"],[1,"result-info"],[1,"result-name"],[1,"result-price"],[1,"result-actions"],["type","number","min","1","step","1",1,"result-qty-input",3,"ngModel","ngModelChange","click"],[1,"btn-add-result",3,"disabled","click"],[1,"add-item-empty"],[1,"add-item-loading"],[1,"item-row"],[1,"item-image"],[3,"src","alt","error",4,"ngIf"],["class","item-placeholder",4,"ngIf"],[1,"item-details"],[1,"item-name"],["class","added-badge",4,"ngIf"],[1,"item-calc"],[1,"item-total"],[3,"src","alt","error"],[1,"item-placeholder"],[1,"added-badge"],[1,"modal-footer"],[1,"btn-modal","btn-print-modal",3,"click"],["class","btn-modal btn-action-modal",3,"click",4,"ngIf"],["class","btn-modal btn-cancel-modal",3,"click",4,"ngIf"],[1,"btn-modal","btn-accept-modal",3,"click"],[1,"btn-modal","btn-reject-modal",3,"click"],[1,"btn-modal","btn-action-modal",3,"click"],[1,"btn-modal","btn-cancel-modal",3,"click"],[1,"message","success"],[1,"message","error"]],template:function(r,i){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"mat-icon"),e.EFF(5,"shopping_cart"),e.k0s()(),e.j41(6,"div",4)(7,"div",5),e.EFF(8),e.nI1(9,"number"),e.k0s(),e.j41(10,"div",6),e.EFF(11,"Total Orders"),e.k0s()()(),e.j41(12,"div",7)(13,"div",3)(14,"mat-icon"),e.EFF(15,"account_balance_wallet"),e.k0s()(),e.j41(16,"div",4)(17,"div",5),e.EFF(18),e.nI1(19,"currency"),e.k0s(),e.j41(20,"div",6),e.EFF(21,"Revenue"),e.k0s()()(),e.j41(22,"div",8)(23,"div",3)(24,"mat-icon"),e.EFF(25,"local_shipping"),e.k0s()(),e.j41(26,"div",4)(27,"div",5),e.EFF(28),e.k0s(),e.j41(29,"div",6),e.EFF(30,"Active Deliveries"),e.k0s()()(),e.j41(31,"div",9)(32,"div",3)(33,"mat-icon"),e.EFF(34,"check_circle"),e.k0s()(),e.j41(35,"div",4)(36,"div",5),e.EFF(37),e.k0s(),e.j41(38,"div",6),e.EFF(39,"Delivered"),e.k0s()()()(),e.j41(40,"div",10)(41,"div",11)(42,"h2"),e.EFF(43,"Order Management"),e.k0s(),e.j41(44,"p"),e.EFF(45,"Manage and track all store transactions"),e.k0s()(),e.j41(46,"div",12)(47,"div",13)(48,"select",14),e.bIt("ngModelChange",function(s){return i.statusFilter=s})("change",function(){return i.onFilterChange()}),e.j41(49,"option",15),e.EFF(50,"All Orders"),e.k0s(),e.j41(51,"option",16),e.EFF(52,"Pending"),e.k0s(),e.j41(53,"option",17),e.EFF(54,"Confirmed"),e.k0s(),e.j41(55,"option",18),e.EFF(56,"Preparing"),e.k0s(),e.j41(57,"option",19),e.EFF(58,"Ready for Pickup"),e.k0s(),e.j41(59,"option",20),e.EFF(60,"Out for Delivery"),e.k0s(),e.j41(61,"option",21),e.EFF(62,"Delivered"),e.k0s(),e.j41(63,"option",22),e.EFF(64,"Cancelled"),e.k0s(),e.j41(65,"option",23),e.EFF(66,"Walk-in Only"),e.k0s(),e.j41(67,"option",24),e.EFF(68,"Online Only"),e.k0s()(),e.j41(69,"mat-icon",25),e.EFF(70,"filter_list"),e.k0s()(),e.j41(71,"div",26)(72,"input",27),e.bIt("ngModelChange",function(s){return i.fromDate=s})("change",function(){return i.onDateFilterChange()}),e.k0s(),e.j41(73,"span",28),e.EFF(74,"to"),e.k0s(),e.j41(75,"input",29),e.bIt("ngModelChange",function(s){return i.toDate=s})("change",function(){return i.onDateFilterChange()}),e.k0s(),e.DNE(76,v4,3,0,"button",30),e.k0s(),e.j41(77,"input",31),e.bIt("ngModelChange",function(s){return i.searchTerm=s})("input",function(){return i.applyFilter()}),e.k0s(),e.j41(78,"button",32),e.bIt("click",function(){return i.exportOrders()}),e.j41(79,"mat-icon"),e.EFF(80,"file_download"),e.k0s(),e.EFF(81," Export "),e.k0s(),e.j41(82,"button",33),e.bIt("click",function(){return i.loadDashboardData()}),e.j41(83,"mat-icon"),e.EFF(84,"refresh"),e.k0s(),e.EFF(85," Refresh "),e.k0s()()(),e.j41(86,"div",34,35),e.bIt("scroll",function(s){return i.onTableScroll(s)}),e.j41(88,"table",36)(89,"thead")(90,"tr")(91,"th",37),e.EFF(92,"ORDER ID"),e.k0s(),e.j41(93,"th",38),e.EFF(94,"CUSTOMER"),e.k0s(),e.j41(95,"th",39),e.EFF(96,"TYPE"),e.k0s(),e.j41(97,"th",40),e.EFF(98,"STATUS"),e.k0s(),e.j41(99,"th",41),e.EFF(100,"TOTAL"),e.k0s(),e.j41(101,"th",42),e.EFF(102,"ACTION"),e.k0s()()(),e.j41(103,"tbody"),e.DNE(104,R4,3,4,"tr",43),e.DNE(105,D4,9,2,"tr",44),e.k0s()()(),e.DNE(106,B4,4,3,"div",45),e.DNE(107,ik,13,5,"div",46),e.DNE(108,ok,2,1,"div",47),e.DNE(109,ak,2,1,"div",48),e.k0s()),2&r&&(e.R7$(8),e.JRh(e.bMT(9,15,i.orders.length)),e.R7$(10),e.JRh(e.ii3(19,17,i.todayRevenue,"INR","symbol","1.0-0")),e.R7$(10),e.JRh(i.getActiveDeliveriesCount()),e.R7$(9),e.JRh(i.completedOrders.length),e.R7$(11),e.Y8G("ngModel",i.statusFilter),e.R7$(24),e.Y8G("ngModel",i.fromDate),e.R7$(3),e.Y8G("ngModel",i.toDate),e.R7$(1),e.Y8G("ngIf",i.fromDate||i.toDate),e.R7$(1),e.Y8G("ngModel",i.searchTerm),e.R7$(27),e.Y8G("ngForOf",i.getPagedOrders()),e.R7$(1),e.Y8G("ngIf",0===i.getPagedOrders().length),e.R7$(1),e.Y8G("ngIf",i.filteredOrders.length>0),e.R7$(1),e.Y8G("ngIf",i.showDetailsModal),e.R7$(1),e.Y8G("ngIf",i.successMessage),e.R7$(1),e.Y8G("ngIf",i.errorMessage))},dependencies:[D.YU,D.Sq,D.bT,b.xH,b.y7,b.me,b.Q0,b.wz,b.BC,b.VZ,b.vS,H.An,D.QX,D.oe,D.vh],styles:[".orders-page[_ngcontent-%COMP%]{padding:16px 24px;max-width:1600px;margin:0 auto;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;background:#f8f9fa;min-height:100vh}.stats-cards-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:20px;flex-wrap:wrap}.stat-card[_ngcontent-%COMP%]{flex:1;min-width:180px;background:#ffffff;border-radius:8px;padding:16px;display:flex;align-items:center;gap:12px;box-shadow:0 1px 3px #00000014;border:1px solid #e0e0e0;transition:transform .2s,box-shadow .2s}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:10px;display:flex;align-items:center;justify-content:center}.stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px;color:#fff}.stat-card[_ngcontent-%COMP%]   .stat-content[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:#2c3e50;line-height:1.2}.stat-card[_ngcontent-%COMP%]   .stat-content[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:12px;color:#7f8c8d;margin-top:2px}.stat-card.stat-total[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#27ae60,#1e8449)}.stat-card.stat-revenue[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3498db,#217dbb)}.stat-card.stat-active[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f39c12,#c87f0a)}.stat-card.stat-delivered[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#7f8c8d,#667273)}.table-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px;background:#ffffff;padding:16px 20px;border-radius:8px 8px 0 0;border:1px solid #e0e0e0;border-bottom:none;flex-wrap:wrap;gap:16px}.table-header[_ngcontent-%COMP%]   .table-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:#2c3e50}.table-header[_ngcontent-%COMP%]   .table-title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0 0;font-size:13px;color:#7f8c8d}.table-header[_ngcontent-%COMP%]   .table-actions[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center;flex-wrap:wrap}.filter-dropdown[_ngcontent-%COMP%]{position:relative}.filter-dropdown[_ngcontent-%COMP%]   .filter-select[_ngcontent-%COMP%]{appearance:none;padding:8px 36px 8px 12px;border:1px solid #e0e0e0;border-radius:6px;font-size:13px;color:#2c3e50;background:#ffffff;cursor:pointer;min-width:140px}.filter-dropdown[_ngcontent-%COMP%]   .filter-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#3498db}.filter-dropdown[_ngcontent-%COMP%]   .filter-icon[_ngcontent-%COMP%]{position:absolute;right:10px;top:50%;transform:translateY(-50%);font-size:18px;color:#7f8c8d;pointer-events:none}.date-filters[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px}.date-filters[_ngcontent-%COMP%]   .date-input[_ngcontent-%COMP%]{padding:7px 10px;border:1px solid #e0e0e0;border-radius:6px;font-size:13px;color:#2c3e50;background:#ffffff;cursor:pointer}.date-filters[_ngcontent-%COMP%]   .date-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3498db}.date-filters[_ngcontent-%COMP%]   .date-separator[_ngcontent-%COMP%]{color:#7f8c8d;font-size:12px}.date-filters[_ngcontent-%COMP%]   .clear-date-btn[_ngcontent-%COMP%]{width:28px;height:28px;border:none;border-radius:50%;background:rgba(231,76,60,.1);color:#e74c3c;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}.date-filters[_ngcontent-%COMP%]   .clear-date-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.date-filters[_ngcontent-%COMP%]   .clear-date-btn[_ngcontent-%COMP%]:hover{background:#e74c3c;color:#fff}.search-input[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #e0e0e0;border-radius:6px;font-size:13px;min-width:180px;transition:border-color .2s}.search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3498db}.search-input[_ngcontent-%COMP%]::placeholder{color:#7f8c8d}.export-btn[_ngcontent-%COMP%], .refresh-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 14px;border:1px solid #e0e0e0;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;background:#ffffff;color:#2c3e50;transition:all .2s}.export-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .refresh-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.export-btn[_ngcontent-%COMP%]:hover, .refresh-btn[_ngcontent-%COMP%]:hover{background:#ecf0f1;border-color:#2c3e50}.refresh-btn[_ngcontent-%COMP%]{background:#3498db;color:#fff;border-color:#3498db}.refresh-btn[_ngcontent-%COMP%]:hover{background:#2383c4}.orders-table-container[_ngcontent-%COMP%]{background:#ffffff;border:1px solid #e0e0e0;border-bottom:none;overflow:auto;max-height:calc(100vh - 340px);min-height:400px}.scroll-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:#ffffff;border:1px solid #e0e0e0;border-top:none;border-radius:0 0 8px 8px;font-size:13px;color:#7f8c8d}.scroll-info[_ngcontent-%COMP%]   .loading-more[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;color:#3498db}.scroll-info[_ngcontent-%COMP%]   .loading-more[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.orders-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;min-width:800px}.orders-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:#ecf0f1}.orders-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:12px 16px;text-align:left;font-size:11px;font-weight:600;color:#7f8c8d;text-transform:uppercase;letter-spacing:.5px;border-bottom:1px solid #e0e0e0;white-space:nowrap}.orders-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #e0e0e0;transition:background .15s}.orders-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child{border-bottom:none}.orders-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:rgba(52,152,219,.03)}.orders-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.pending-row[_ngcontent-%COMP%]{background:rgba(243,156,18,.06)}.orders-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.pending-row[_ngcontent-%COMP%]:hover{background:rgba(243,156,18,.1)}.orders-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 16px;font-size:13px;color:#2c3e50;vertical-align:middle}.orders-table[_ngcontent-%COMP%]   .col-order-id[_ngcontent-%COMP%]{width:15%}.orders-table[_ngcontent-%COMP%]   .col-customer[_ngcontent-%COMP%]{width:25%}.orders-table[_ngcontent-%COMP%]   .col-type[_ngcontent-%COMP%]{width:12%}.orders-table[_ngcontent-%COMP%]   .col-status[_ngcontent-%COMP%]{width:15%}.orders-table[_ngcontent-%COMP%]   .col-total[_ngcontent-%COMP%]{width:12%}.orders-table[_ngcontent-%COMP%]   .col-action[_ngcontent-%COMP%]{width:21%}.order-number[_ngcontent-%COMP%]{font-weight:600;color:#27ae60;cursor:pointer;transition:color .2s}.order-number[_ngcontent-%COMP%]:hover{color:#1e8449;text-decoration:underline}.order-time[_ngcontent-%COMP%]{font-size:11px;color:#7f8c8d;margin-top:2px}.customer-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.customer-avatar[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;background:#2c3e50;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:13px;flex-shrink:0}.customer-details[_ngcontent-%COMP%]   .customer-name[_ngcontent-%COMP%]{font-weight:500;color:#2c3e50}.customer-details[_ngcontent-%COMP%]   .customer-phone[_ngcontent-%COMP%]{font-size:11px;color:#7f8c8d;margin-top:1px}.delivery-type[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;padding:4px 8px;border-radius:4px;font-size:11px;font-weight:500}.delivery-type[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px}.delivery-type.type-delivery[_ngcontent-%COMP%]{background:rgba(243,156,18,.1);color:#f39c12}.delivery-type.type-walkin[_ngcontent-%COMP%]{background:rgba(156,39,176,.1);color:#9c27b0}.delivery-type.type-pickup[_ngcontent-%COMP%]{background:rgba(52,152,219,.1);color:#3498db}.status-badge[_ngcontent-%COMP%]{display:inline-block;padding:4px 10px;border-radius:4px;font-size:10px;font-weight:600;text-transform:uppercase;letter-spacing:.3px}.status-badge.badge-pending[_ngcontent-%COMP%]{background:#fef3c7;color:#d97706}.status-badge.badge-confirmed[_ngcontent-%COMP%]{background:#dbeafe;color:#2563eb}.status-badge.badge-preparing[_ngcontent-%COMP%]{background:#fed7aa;color:#ea580c}.status-badge.badge-ready[_ngcontent-%COMP%]{background:#d1fae5;color:#059669}.status-badge.badge-out-for-delivery[_ngcontent-%COMP%]{background:#dbeafe;color:#2563eb}.status-badge.badge-delivered[_ngcontent-%COMP%], .status-badge.badge-completed[_ngcontent-%COMP%]{background:#d1fae5;color:#059669}.status-badge.badge-cancelled[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.status-badge.badge-returning[_ngcontent-%COMP%], .status-badge.badge-returned[_ngcontent-%COMP%]{background:#fef3c7;color:#d97706}.total-amount[_ngcontent-%COMP%]{font-weight:600;color:#2c3e50}.action-buttons[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;flex-wrap:wrap}.btn-accept[_ngcontent-%COMP%], .btn-reject[_ngcontent-%COMP%], .btn-action[_ngcontent-%COMP%], .btn-details[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;border:none;border-radius:4px;cursor:pointer;transition:all .2s;font-size:12px;font-weight:500}.btn-accept[_ngcontent-%COMP%]{width:30px;height:30px;background:#27ae60;color:#fff}.btn-accept[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.btn-accept[_ngcontent-%COMP%]:hover{background:#1e8449}.btn-reject[_ngcontent-%COMP%]{width:30px;height:30px;background:#7f8c8d;color:#fff}.btn-reject[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.btn-reject[_ngcontent-%COMP%]:hover{background:#667273}.btn-action[_ngcontent-%COMP%]{width:30px;height:30px;background:#ecf0f1;color:#2c3e50}.btn-action[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.btn-action[_ngcontent-%COMP%]:hover{background:#2c3e50;color:#fff}.btn-action.btn-prepare[_ngcontent-%COMP%]{background:rgba(243,156,18,.1);color:#f39c12}.btn-action.btn-prepare[_ngcontent-%COMP%]:hover{background:#f39c12;color:#fff}.btn-action.btn-ready[_ngcontent-%COMP%]{background:rgba(39,174,96,.1);color:#27ae60}.btn-action.btn-ready[_ngcontent-%COMP%]:hover{background:#27ae60;color:#fff}.btn-action.btn-handover[_ngcontent-%COMP%], .btn-action.btn-collect[_ngcontent-%COMP%]{background:rgba(39,174,96,.1);color:#27ae60}.btn-action.btn-handover[_ngcontent-%COMP%]:hover, .btn-action.btn-collect[_ngcontent-%COMP%]:hover{background:#27ae60;color:#fff}.btn-action.btn-verify[_ngcontent-%COMP%]{background:rgba(243,156,18,.1);color:#f39c12}.btn-action.btn-verify[_ngcontent-%COMP%]:hover{background:#f39c12;color:#fff}.btn-action.btn-find-driver[_ngcontent-%COMP%]{background:rgba(156,39,176,.1);color:#9c27b0}.btn-action.btn-find-driver[_ngcontent-%COMP%]:hover{background:#9C27B0;color:#fff}.btn-action.btn-print[_ngcontent-%COMP%]{background:rgba(127,140,141,.1);color:#7f8c8d}.btn-action.btn-print[_ngcontent-%COMP%]:hover{background:#7f8c8d;color:#fff}.btn-details[_ngcontent-%COMP%]{padding:6px 12px;background:#ffffff;color:#3498db;border:1px solid #3498db}.btn-details[_ngcontent-%COMP%]:hover{background:#3498db;color:#fff}.searching-icon[_ngcontent-%COMP%]{color:#f39c12;font-size:20px}.spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.processing-cell[_ngcontent-%COMP%]{text-align:center;padding:20px!important}.processing-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px;color:#3498db;font-size:13px}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:48px 20px!important}.empty-content[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#e0e0e0;margin-bottom:12px}.empty-content[_ngcontent-%COMP%]   .empty-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#2c3e50;margin-bottom:4px}.empty-content[_ngcontent-%COMP%]   .empty-subtitle[_ngcontent-%COMP%]{font-size:13px;color:#7f8c8d}.pagination-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:16px;padding:12px 16px;background:#ffffff;border-radius:8px;border:1px solid #e0e0e0;flex-wrap:wrap;gap:12px}.pagination-info[_ngcontent-%COMP%]{font-size:13px;color:#7f8c8d}.pagination-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.page-btn[_ngcontent-%COMP%]{min-width:32px;height:32px;padding:0 8px;border:1px solid #e0e0e0;border-radius:4px;background:#ffffff;color:#2c3e50;font-size:13px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}.page-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.page-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#ecf0f1;border-color:#2c3e50}.page-btn.active[_ngcontent-%COMP%]{background:#3498db;border-color:#3498db;color:#fff}.page-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.page-ellipsis[_ngcontent-%COMP%]{padding:0 8px;color:#7f8c8d}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000;padding:20px}.modal-content[_ngcontent-%COMP%]{background:#ffffff;border-radius:12px;width:100%;max-width:600px;max-height:90vh;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 20px 40px #0003}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;border-bottom:1px solid #e0e0e0;background:#ecf0f1}.modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.modal-header[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:#2c3e50}.modal-header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]{width:32px;height:32px;border:none;border-radius:50%;background:transparent;color:#7f8c8d;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}.modal-header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]:hover{background:rgba(231,76,60,.1);color:#e74c3c}.modal-body[_ngcontent-%COMP%]{padding:20px;overflow-y:auto;flex:1}.detail-section[_ngcontent-%COMP%]{margin-bottom:20px}.detail-section[_ngcontent-%COMP%]:last-child{margin-bottom:0}.detail-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;font-size:14px;font-weight:600;color:#2c3e50;text-transform:uppercase;letter-spacing:.5px}.detail-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}.detail-item.full-width[_ngcontent-%COMP%]{grid-column:1/-1}.detail-item[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]{display:block;font-size:11px;color:#7f8c8d;text-transform:uppercase;letter-spacing:.3px;margin-bottom:2px}.detail-item[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]{font-size:14px;color:#2c3e50;font-weight:500}.items-list[_ngcontent-%COMP%]{border:1px solid #e0e0e0;border-radius:6px;overflow:hidden}.item-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:10px;border-bottom:1px solid #e0e0e0}.item-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.item-row[_ngcontent-%COMP%]   .item-image[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:6px;overflow:hidden;background:#ecf0f1;flex-shrink:0}.item-row[_ngcontent-%COMP%]   .item-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.item-row[_ngcontent-%COMP%]   .item-image[_ngcontent-%COMP%]   .item-placeholder[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;font-weight:600;color:#7f8c8d;font-size:14px}.item-row[_ngcontent-%COMP%]   .item-details[_ngcontent-%COMP%]{flex:1;min-width:0}.item-row[_ngcontent-%COMP%]   .item-details[_ngcontent-%COMP%]   .item-name[_ngcontent-%COMP%]{font-weight:500;color:#2c3e50;font-size:13px}.item-row[_ngcontent-%COMP%]   .item-details[_ngcontent-%COMP%]   .item-calc[_ngcontent-%COMP%]{font-size:11px;color:#7f8c8d;margin-top:2px}.item-row[_ngcontent-%COMP%]   .item-total[_ngcontent-%COMP%]{font-weight:600;color:#2c3e50;font-size:13px}.order-total[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:12px;background:#ecf0f1;font-weight:600;font-size:15px;color:#2c3e50;border-radius:0 0 6px 6px}.items-header-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}.items-header-row[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0}.items-header-row[_ngcontent-%COMP%]   .btn-add-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:4px 12px;border:1px solid #27ae60;background:transparent;color:#27ae60;border-radius:20px;font-size:12px;font-weight:600;cursor:pointer}.items-header-row[_ngcontent-%COMP%]   .btn-add-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.items-header-row[_ngcontent-%COMP%]   .btn-add-item[_ngcontent-%COMP%]:hover{background:#27ae60;color:#fff}.add-item-section[_ngcontent-%COMP%]{margin-bottom:10px;border:1px solid #e0e0e0;border-radius:8px;overflow:hidden}.add-item-section[_ngcontent-%COMP%]   .add-item-search[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 12px;background:#f8f9fa}.add-item-section[_ngcontent-%COMP%]   .add-item-search[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{color:#7f8c8d;font-size:20px}.add-item-section[_ngcontent-%COMP%]   .add-item-search[_ngcontent-%COMP%]   .add-item-input[_ngcontent-%COMP%]{flex:1;border:none;background:transparent;font-size:13px;outline:none}.add-item-section[_ngcontent-%COMP%]   .add-item-results[_ngcontent-%COMP%]{max-height:200px;overflow-y:auto}.add-item-section[_ngcontent-%COMP%]   .add-item-result[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:8px 12px;border-top:1px solid #e0e0e0}.add-item-section[_ngcontent-%COMP%]   .add-item-result[_ngcontent-%COMP%]:hover{background:rgba(52,152,219,.05)}.add-item-section[_ngcontent-%COMP%]   .add-item-result[_ngcontent-%COMP%]   .result-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;min-width:0}.add-item-section[_ngcontent-%COMP%]   .add-item-result[_ngcontent-%COMP%]   .result-info[_ngcontent-%COMP%]   .result-name[_ngcontent-%COMP%]{font-size:13px;font-weight:500;color:#2c3e50;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.add-item-section[_ngcontent-%COMP%]   .add-item-result[_ngcontent-%COMP%]   .result-info[_ngcontent-%COMP%]   .result-price[_ngcontent-%COMP%]{font-size:12px;color:#27ae60;font-weight:600}.add-item-section[_ngcontent-%COMP%]   .add-item-result[_ngcontent-%COMP%]   .result-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px}.add-item-section[_ngcontent-%COMP%]   .add-item-result[_ngcontent-%COMP%]   .result-actions[_ngcontent-%COMP%]   .result-qty-input[_ngcontent-%COMP%]{width:40px;border:1px solid #e0e0e0;border-radius:4px;padding:4px 6px;font-size:13px;text-align:center;outline:none;-moz-appearance:textfield}.add-item-section[_ngcontent-%COMP%]   .add-item-result[_ngcontent-%COMP%]   .result-actions[_ngcontent-%COMP%]   .result-qty-input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none}.add-item-section[_ngcontent-%COMP%]   .add-item-result[_ngcontent-%COMP%]   .result-actions[_ngcontent-%COMP%]   .result-qty-input[_ngcontent-%COMP%]:focus{border-color:#3498db}.add-item-section[_ngcontent-%COMP%]   .add-item-result[_ngcontent-%COMP%]   .result-actions[_ngcontent-%COMP%]   .btn-add-result[_ngcontent-%COMP%]{width:32px;height:32px;border:none;background:#27ae60;color:#fff;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center}.add-item-section[_ngcontent-%COMP%]   .add-item-result[_ngcontent-%COMP%]   .result-actions[_ngcontent-%COMP%]   .btn-add-result[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.add-item-section[_ngcontent-%COMP%]   .add-item-result[_ngcontent-%COMP%]   .result-actions[_ngcontent-%COMP%]   .btn-add-result[_ngcontent-%COMP%]:hover{background:#208d4e}.add-item-section[_ngcontent-%COMP%]   .add-item-result[_ngcontent-%COMP%]   .result-actions[_ngcontent-%COMP%]   .btn-add-result[_ngcontent-%COMP%]:disabled{background:#e0e0e0;cursor:not-allowed}.add-item-section[_ngcontent-%COMP%]   .add-item-empty[_ngcontent-%COMP%], .add-item-section[_ngcontent-%COMP%]   .add-item-loading[_ngcontent-%COMP%]{padding:12px;text-align:center;font-size:12px;color:#7f8c8d;border-top:1px solid #e0e0e0}.added-badge[_ngcontent-%COMP%]{display:inline-block;font-size:9px;padding:1px 6px;background:rgba(52,152,219,.15);color:#3498db;border-radius:10px;font-weight:600;margin-left:4px;vertical-align:middle}.modal-footer[_ngcontent-%COMP%]{display:flex;gap:10px;padding:16px 20px;border-top:1px solid #e0e0e0;flex-wrap:wrap}.btn-modal[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:10px 16px;border:none;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s}.btn-modal[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.btn-modal.btn-print-modal[_ngcontent-%COMP%]{background:#ecf0f1;color:#2c3e50}.btn-modal.btn-print-modal[_ngcontent-%COMP%]:hover{background:#dde4e6}.btn-modal.btn-accept-modal[_ngcontent-%COMP%]{background:#27ae60;color:#fff}.btn-modal.btn-accept-modal[_ngcontent-%COMP%]:hover{background:#1e8449}.btn-modal.btn-reject-modal[_ngcontent-%COMP%]{background:#7f8c8d;color:#fff}.btn-modal.btn-reject-modal[_ngcontent-%COMP%]:hover{background:#667273}.btn-modal.btn-action-modal[_ngcontent-%COMP%]{background:#3498db;color:#fff}.btn-modal.btn-action-modal[_ngcontent-%COMP%]:hover{background:#217dbb}.btn-modal.btn-cancel-modal[_ngcontent-%COMP%]{background:#e74c3c;color:#fff}.btn-modal.btn-cancel-modal[_ngcontent-%COMP%]:hover{background:#d62c1a}.message[_ngcontent-%COMP%]{position:fixed;top:16px;right:16px;padding:12px 16px;border-radius:6px;font-size:13px;font-weight:500;z-index:1001;box-shadow:0 4px 12px #00000026}.message.success[_ngcontent-%COMP%]{background:#d1fae5;color:#059669;border:1px solid #10b981}.message.error[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626;border:1px solid #ef4444}@media (max-width: 1024px){.orders-page[_ngcontent-%COMP%]{padding:12px 16px}.stats-cards-row[_ngcontent-%COMP%]{gap:12px}.stat-card[_ngcontent-%COMP%]{min-width:140px;padding:12px}.stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{width:40px;height:40px}.stat-card[_ngcontent-%COMP%]   .stat-content[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:18px}.table-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.table-header[_ngcontent-%COMP%]   .table-actions[_ngcontent-%COMP%]{justify-content:flex-start}}@media (max-width: 768px){.stats-cards-row[_ngcontent-%COMP%]{flex-direction:column}.stat-card[_ngcontent-%COMP%]{min-width:100%}.table-actions[_ngcontent-%COMP%]{flex-direction:column}.table-actions[_ngcontent-%COMP%]   .filter-dropdown[_ngcontent-%COMP%], .table-actions[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%], .table-actions[_ngcontent-%COMP%]   .export-btn[_ngcontent-%COMP%], .table-actions[_ngcontent-%COMP%]   .refresh-btn[_ngcontent-%COMP%], .table-actions[_ngcontent-%COMP%]   .filter-select[_ngcontent-%COMP%]{width:100%}.pagination-container[_ngcontent-%COMP%]{flex-direction:column;text-align:center}.detail-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-content[_ngcontent-%COMP%]{max-height:85vh}.modal-footer[_ngcontent-%COMP%]{flex-direction:column}.modal-footer[_ngcontent-%COMP%]   .btn-modal[_ngcontent-%COMP%]{width:100%;justify-content:center}}"]})}}return n})();function ck(n,o){if(1&n&&(e.j41(0,"mat-icon"),e.EFF(1,"assignment"),e.k0s(),e.EFF(2)),2&n){const t=e.XpG();e.R7$(2),e.SpI(" Ready for Assignment (",t.readyOrders.length,") ")}}function lk(n,o){if(1&n&&(e.j41(0,"mat-option",40)(1,"div",41)(2,"div",42)(3,"strong"),e.EFF(4),e.k0s(),e.j41(5,"span",43),e.EFF(6),e.k0s()(),e.j41(7,"div",44)(8,"span",45),e.EFF(9),e.k0s(),e.j41(10,"span",46),e.EFF(11),e.k0s()()()()),2&n){const t=o.$implicit;e.Y8G("value",t.id),e.R7$(4),e.JRh(t.fullName),e.R7$(2),e.SpI("\u2b50 ",t.rating,""),e.R7$(2),e.Y8G("ngClass",t.isOnline?"online":"offline"),e.R7$(1),e.SpI(" ",t.isOnline?"Online":"Offline"," "),e.R7$(2),e.JRh(t.vehicleType)}}function dk(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",24)(1,"div",25)(2,"h3"),e.EFF(3),e.k0s(),e.j41(4,"mat-chip",26),e.EFF(5,"Ready for Pickup"),e.k0s()(),e.j41(6,"div",27)(7,"div",28)(8,"mat-icon"),e.EFF(9,"person"),e.k0s(),e.j41(10,"div")(11,"p",29),e.EFF(12),e.k0s(),e.j41(13,"p",30),e.EFF(14),e.k0s()()(),e.j41(15,"div",31)(16,"mat-icon"),e.EFF(17,"location_on"),e.k0s(),e.j41(18,"span"),e.EFF(19),e.k0s()(),e.j41(20,"div",32)(21,"mat-icon"),e.EFF(22,"account_balance_wallet"),e.k0s(),e.j41(23,"span"),e.EFF(24),e.nI1(25,"number"),e.k0s()()(),e.j41(26,"div",33)(27,"h4"),e.EFF(28,"Assign Delivery Partner"),e.k0s(),e.j41(29,"mat-form-field",34)(30,"mat-label"),e.EFF(31,"Select Partner"),e.k0s(),e.j41(32,"mat-select",35),e.bIt("ngModelChange",function(i){const s=e.eBV(t).$implicit;return e.Njj(s.selectedPartnerId=i)})("selectionChange",function(i){const s=e.eBV(t).$implicit,l=e.XpG();return e.Njj(l.onPartnerSelect(s,i))}),e.DNE(33,lk,12,6,"mat-option",36),e.k0s()(),e.j41(34,"div",37)(35,"button",38),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.assignDeliveryPartner(a))}),e.j41(36,"mat-icon"),e.EFF(37,"send"),e.k0s(),e.EFF(38," Assign Order "),e.k0s(),e.j41(39,"button",39),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.viewOrderDetails(a.id))}),e.j41(40,"mat-icon"),e.EFF(41,"visibility"),e.k0s(),e.EFF(42," Details "),e.k0s()()()()}if(2&n){const t=o.$implicit,r=e.XpG();e.R7$(3),e.SpI("Order #",t.orderNumber,""),e.R7$(9),e.JRh(t.customerName),e.R7$(2),e.JRh(t.customerPhone),e.R7$(5),e.JRh(t.deliveryAddress),e.R7$(5),e.Lme("\u20b9",e.bMT(25,9,t.totalAmount)," - ",t.paymentMethod,""),e.R7$(8),e.Y8G("ngModel",t.selectedPartnerId),e.R7$(1),e.Y8G("ngForOf",r.availablePartners),e.R7$(2),e.Y8G("disabled",!t.selectedPartnerId)}}function uk(n,o){1&n&&(e.j41(0,"div",47)(1,"mat-icon"),e.EFF(2,"inbox"),e.k0s(),e.j41(3,"h3"),e.EFF(4,"No orders ready for assignment"),e.k0s(),e.j41(5,"p"),e.EFF(6,"Orders will appear here when they're ready for delivery pickup"),e.k0s()())}function gk(n,o){if(1&n&&(e.j41(0,"mat-icon"),e.EFF(1,"gps_fixed"),e.k0s(),e.EFF(2)),2&n){const t=e.XpG();e.R7$(2),e.SpI(" Active Deliveries (",t.activeDeliveries.length,") ")}}function pk(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",69)(1,"div",70)(2,"div",71)(3,"mat-icon"),e.EFF(4,"person"),e.k0s()(),e.j41(5,"div",72)(6,"p",73),e.EFF(7),e.k0s(),e.j41(8,"p",74),e.EFF(9),e.k0s(),e.j41(10,"p",75),e.EFF(11),e.k0s()()(),e.j41(12,"div",76)(13,"button",77),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.callDriver(i.assignedDriver.phone))}),e.j41(14,"mat-icon"),e.EFF(15,"phone"),e.k0s()(),e.j41(16,"button",78),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.messageDriver(i.assignedDriver.id,i.id))}),e.j41(17,"mat-icon"),e.EFF(18,"message"),e.k0s()(),e.j41(19,"button",79),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.trackDriver(i.assignedDriver.id))}),e.j41(20,"mat-icon"),e.EFF(21,"gps_fixed"),e.k0s()()()()}if(2&n){const t=e.XpG().$implicit;e.R7$(7),e.JRh(t.assignedDriver.name),e.R7$(2),e.Lme("",t.assignedDriver.vehicleType," - ",t.assignedDriver.vehicleNumber,""),e.R7$(2),e.SpI("\u2b50 ",t.assignedDriver.rating," rating")}}function fk(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",80)(1,"h4"),e.EFF(2,"Driver Verification Required"),e.k0s(),e.j41(3,"div",81)(4,"mat-form-field")(5,"mat-label"),e.EFF(6,"Enter OTP from Driver"),e.k0s(),e.j41(7,"input",82),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG().$implicit;return e.Njj(a.otpCode=i)}),e.k0s(),e.j41(8,"mat-icon",83),e.EFF(9,"security"),e.k0s()(),e.j41(10,"button",38),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.verifyDriver(i.id,i.otpCode))}),e.j41(11,"mat-icon"),e.EFF(12,"verified_user"),e.k0s(),e.EFF(13," Verify & Release "),e.k0s()()()}if(2&n){const t=e.XpG().$implicit;e.R7$(7),e.Y8G("ngModel",t.otpCode),e.R7$(3),e.Y8G("disabled",!t.otpCode||t.otpCode.length<6)}}const n0=function(n){return{completed:n}},mk=function(n,o){return{completed:n,active:o}};function hk(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",48)(1,"div",49)(2,"div",50)(3,"h3"),e.EFF(4),e.k0s(),e.j41(5,"mat-chip",45),e.EFF(6),e.nI1(7,"titlecase"),e.k0s()(),e.j41(8,"div",51)(9,"mat-icon"),e.EFF(10,"schedule"),e.k0s(),e.j41(11,"span"),e.EFF(12),e.k0s()()(),e.DNE(13,pk,22,4,"div",52),e.j41(14,"div",53)(15,"div",28)(16,"mat-icon"),e.EFF(17,"person_outline"),e.k0s(),e.j41(18,"div")(19,"p"),e.EFF(20),e.k0s(),e.j41(21,"p"),e.EFF(22),e.k0s(),e.j41(23,"p",54),e.EFF(24),e.k0s()()(),e.j41(25,"div",55)(26,"button",56),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.callCustomer(a.customerPhone))}),e.j41(27,"mat-icon"),e.EFF(28,"phone"),e.k0s()(),e.j41(29,"button",57),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.messageCustomer(a.customerId,a.id))}),e.j41(30,"mat-icon"),e.EFF(31,"message"),e.k0s()()()(),e.j41(32,"div",58)(33,"h4"),e.EFF(34,"Delivery Progress"),e.k0s(),e.j41(35,"div",59)(36,"div",60),e.nrm(37,"div",61),e.j41(38,"div",62)(39,"p"),e.EFF(40,"Order Picked Up"),e.k0s(),e.j41(41,"small"),e.EFF(42),e.nI1(43,"date"),e.k0s()()(),e.j41(44,"div",60),e.nrm(45,"div",61),e.j41(46,"div",62)(47,"p"),e.EFF(48,"In Transit"),e.k0s(),e.j41(49,"small"),e.EFF(50),e.nI1(51,"date"),e.k0s()()(),e.j41(52,"div",60),e.nrm(53,"div",61),e.j41(54,"div",62)(55,"p"),e.EFF(56,"Delivered"),e.k0s(),e.j41(57,"small"),e.EFF(58),e.nI1(59,"date"),e.k0s()()()()(),e.j41(60,"div",63)(61,"div",64)(62,"mat-icon"),e.EFF(63,"payment"),e.k0s(),e.j41(64,"div")(65,"p"),e.EFF(66),e.nI1(67,"number"),e.k0s(),e.j41(68,"p",65),e.EFF(69),e.k0s()()()(),e.DNE(70,fk,14,2,"div",66),e.j41(71,"div",67)(72,"button",39),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.viewOrderDetails(a.orderId))}),e.j41(73,"mat-icon"),e.EFF(74,"visibility"),e.k0s(),e.EFF(75," Order Details "),e.k0s(),e.j41(76,"button",68),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.reportDeliveryIssue(a.id))}),e.j41(77,"mat-icon"),e.EFF(78,"report_problem"),e.k0s(),e.EFF(79," Report Issue "),e.k0s()()()}if(2&n){const t=o.$implicit,r=e.XpG();e.R7$(4),e.SpI("Order #",t.orderNumber,""),e.R7$(1),e.Y8G("ngClass",r.getDeliveryStatusClass(t.status)),e.R7$(1),e.SpI(" ",e.bMT(7,18,t.status)," "),e.R7$(6),e.JRh(r.getDeliveryETA(t)),e.R7$(1),e.Y8G("ngIf",t.assignedDriver),e.R7$(7),e.JRh(t.customerName),e.R7$(2),e.JRh(t.customerPhone),e.R7$(2),e.JRh(t.deliveryAddress),e.R7$(12),e.Y8G("ngClass",e.eq3(31,n0,r.isTimelineStepCompleted(t,"pickup"))),e.R7$(6),e.JRh(e.i5U(43,20,t.pickupTime,"short")),e.R7$(2),e.Y8G("ngClass",e.l_i(33,mk,r.isTimelineStepCompleted(t,"transit"),"OUT_FOR_DELIVERY"===t.status)),e.R7$(6),e.JRh(e.i5U(51,23,t.transitTime,"short")),e.R7$(2),e.Y8G("ngClass",e.eq3(36,n0,r.isTimelineStepCompleted(t,"delivered"))),e.R7$(6),e.JRh(e.i5U(59,26,t.deliveryTime,"short")),e.R7$(8),e.SpI("\u20b9",e.bMT(67,29,t.totalAmount),""),e.R7$(2),e.Y8G("ngClass",t.paymentStatus.toLowerCase()),e.R7$(1),e.SpI(" ",t.paymentStatus," "),e.R7$(1),e.Y8G("ngIf","ASSIGNED"===t.status&&!t.driverVerified)}}function _k(n,o){1&n&&(e.j41(0,"div",47)(1,"mat-icon"),e.EFF(2,"local_shipping"),e.k0s(),e.j41(3,"h3"),e.EFF(4,"No active deliveries"),e.k0s(),e.j41(5,"p"),e.EFF(6,"Assigned deliveries will appear here for tracking"),e.k0s()())}function xk(n,o){if(1&n&&(e.j41(0,"mat-icon"),e.EFF(1,"done_all"),e.k0s(),e.EFF(2)),2&n){const t=e.XpG();e.R7$(2),e.SpI(" Completed (",t.completedDeliveries.length,") ")}}function Ck(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",99)(1,"img",100),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2).$implicit,a=e.XpG();return e.Njj(a.viewProofPhoto(i.proofOfDelivery.photo))}),e.k0s()()}if(2&n){const t=e.XpG(2).$implicit;e.R7$(1),e.Y8G("src",t.proofOfDelivery.photo,e.B4B)}}function vk(n,o){if(1&n&&(e.j41(0,"div",101)(1,"p"),e.EFF(2),e.k0s(),e.j41(3,"p"),e.EFF(4,"Signature verified"),e.k0s()()),2&n){const t=e.XpG(2).$implicit;e.R7$(2),e.SpI("Received by: ",t.proofOfDelivery.receiverName,"")}}function Pk(n,o){if(1&n&&(e.j41(0,"div",95)(1,"h4"),e.EFF(2,"Proof of Delivery"),e.k0s(),e.j41(3,"div",96),e.DNE(4,Ck,2,1,"div",97),e.DNE(5,vk,5,1,"div",98),e.k0s()()),2&n){const t=e.XpG().$implicit;e.R7$(4),e.Y8G("ngIf",t.proofOfDelivery.photo),e.R7$(1),e.Y8G("ngIf",t.proofOfDelivery.signature)}}function bk(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",102)(1,"h4"),e.EFF(2,"Delivery Failed"),e.k0s(),e.j41(3,"div",103)(4,"mat-icon",104),e.EFF(5,"error"),e.k0s(),e.j41(6,"div")(7,"p"),e.EFF(8),e.k0s(),e.j41(9,"p",105),e.EFF(10),e.nI1(11,"date"),e.k0s()()(),e.j41(12,"div",106)(13,"button",107),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.rescheduleDelivery(i.id))}),e.j41(14,"mat-icon"),e.EFF(15,"schedule"),e.k0s(),e.EFF(16," Reschedule "),e.k0s(),e.j41(17,"button",107),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.processRefund(i.id))}),e.j41(18,"mat-icon"),e.EFF(19,"money"),e.k0s(),e.EFF(20," Process Refund "),e.k0s()()()}if(2&n){const t=e.XpG().$implicit;e.R7$(8),e.JRh(t.failureReason),e.R7$(2),e.SpI("Failed at: ",e.i5U(11,2,t.failedAt,"short"),"")}}function kk(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",84)(1,"div",85)(2,"div",86)(3,"h3"),e.EFF(4),e.k0s(),e.j41(5,"mat-chip",87)(6,"mat-icon"),e.EFF(7,"check_circle"),e.k0s(),e.EFF(8),e.k0s()(),e.j41(9,"div",88)(10,"mat-icon"),e.EFF(11,"schedule"),e.k0s(),e.j41(12,"span"),e.EFF(13),e.nI1(14,"date"),e.k0s()()(),e.j41(15,"div",89)(16,"div",90)(17,"span",91),e.EFF(18,"Customer:"),e.k0s(),e.j41(19,"span"),e.EFF(20),e.k0s()(),e.j41(21,"div",90)(22,"span",91),e.EFF(23,"Driver:"),e.k0s(),e.j41(24,"span"),e.EFF(25),e.k0s()(),e.j41(26,"div",90)(27,"span",91),e.EFF(28,"Amount:"),e.k0s(),e.j41(29,"span"),e.EFF(30),e.nI1(31,"number"),e.k0s()(),e.j41(32,"div",90)(33,"span",91),e.EFF(34,"Duration:"),e.k0s(),e.j41(35,"span"),e.EFF(36),e.k0s()()(),e.DNE(37,Pk,6,2,"div",92),e.DNE(38,bk,21,5,"div",93),e.j41(39,"div",94)(40,"button",39),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.viewDeliveryReceipt(a.id))}),e.j41(41,"mat-icon"),e.EFF(42,"receipt"),e.k0s(),e.EFF(43," Receipt "),e.k0s(),e.j41(44,"button",39),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.downloadDeliveryReport(a.id))}),e.j41(45,"mat-icon"),e.EFF(46,"download"),e.k0s(),e.EFF(47," Report "),e.k0s()()()}if(2&n){const t=o.$implicit;e.R7$(4),e.SpI("Order #",t.orderNumber,""),e.R7$(4),e.SpI(" ","DELIVERED"===t.status?"Delivered":"Failed"," "),e.R7$(5),e.JRh(e.i5U(14,9,t.completedAt,"short")),e.R7$(7),e.JRh(t.customerName),e.R7$(5),e.JRh(null==t.assignedDriver?null:t.assignedDriver.name),e.R7$(5),e.SpI("\u20b9",e.bMT(31,12,t.totalAmount),""),e.R7$(6),e.SpI("",t.deliveryDuration," min"),e.R7$(1),e.Y8G("ngIf",t.proofOfDelivery),e.R7$(1),e.Y8G("ngIf","FAILED"===t.status)}}function Ok(n,o){1&n&&(e.j41(0,"div",47)(1,"mat-icon"),e.EFF(2,"history"),e.k0s(),e.j41(3,"h3"),e.EFF(4,"No completed deliveries today"),e.k0s(),e.j41(5,"p"),e.EFF(6,"Completed deliveries will appear here"),e.k0s()())}function yk(n,o){if(1&n&&(e.j41(0,"mat-icon"),e.EFF(1,"people"),e.k0s(),e.EFF(2)),2&n){const t=e.XpG();e.R7$(2),e.SpI(" Partners (",t.deliveryPartners.length,") ")}}function Mk(n,o){if(1&n&&e.nrm(0,"img",122),2&n){const t=e.XpG().$implicit;e.Y8G("src",t.profilePhoto,e.B4B)("alt",t.fullName)}}function wk(n,o){1&n&&(e.j41(0,"mat-icon"),e.EFF(1,"person"),e.k0s())}function Fk(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",108)(1,"div",109)(2,"div",110),e.DNE(3,Mk,1,2,"img",111),e.DNE(4,wk,2,0,"mat-icon",112),e.k0s(),e.j41(5,"div",42)(6,"h3"),e.EFF(7),e.k0s(),e.j41(8,"p",113),e.EFF(9),e.k0s(),e.j41(10,"div",44)(11,"span",45),e.EFF(12),e.k0s(),e.j41(13,"span",114),e.EFF(14),e.k0s()()()(),e.j41(15,"div",115)(16,"div",116)(17,"mat-icon"),e.EFF(18,"phone"),e.k0s(),e.j41(19,"span"),e.EFF(20),e.k0s()(),e.j41(21,"div",116)(22,"mat-icon"),e.EFF(23,"two_wheeler"),e.k0s(),e.j41(24,"span"),e.EFF(25),e.k0s()(),e.j41(26,"div",116)(27,"mat-icon"),e.EFF(28,"delivery_dining"),e.k0s(),e.j41(29,"span"),e.EFF(30),e.k0s()(),e.j41(31,"div",116)(32,"mat-icon"),e.EFF(33,"schedule"),e.k0s(),e.j41(34,"span"),e.EFF(35),e.k0s()()(),e.j41(36,"div",117)(37,"div",118)(38,"span",119),e.EFF(39),e.k0s(),e.j41(40,"span",120),e.EFF(41,"Deliveries"),e.k0s()(),e.j41(42,"div",118)(43,"span",119),e.EFF(44),e.k0s(),e.j41(45,"span",120),e.EFF(46,"Success Rate"),e.k0s()(),e.j41(47,"div",118)(48,"span",119),e.EFF(49),e.nI1(50,"currency"),e.k0s(),e.j41(51,"span",120),e.EFF(52,"This Month"),e.k0s()()(),e.j41(53,"div",121)(54,"button",39),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.callPartner(a.phone))}),e.j41(55,"mat-icon"),e.EFF(56,"phone"),e.k0s(),e.EFF(57," Call "),e.k0s(),e.j41(58,"button",39),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.messagePartner(a.id))}),e.j41(59,"mat-icon"),e.EFF(60,"message"),e.k0s(),e.EFF(61," Message "),e.k0s(),e.j41(62,"button",39),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.viewPartnerDetails(a.id))}),e.j41(63,"mat-icon"),e.EFF(64,"visibility"),e.k0s(),e.EFF(65," Details "),e.k0s()()()}if(2&n){const t=o.$implicit;e.Y8G("ngClass",t.isOnline?"online":"offline"),e.R7$(3),e.Y8G("ngIf",t.profilePhoto),e.R7$(1),e.Y8G("ngIf",!t.profilePhoto),e.R7$(3),e.JRh(t.fullName),e.R7$(2),e.SpI("ID: ",t.partnerId,""),e.R7$(2),e.Y8G("ngClass",t.isOnline?"online":"offline"),e.R7$(1),e.SpI(" ",t.isOnline?"Online":"Offline"," "),e.R7$(2),e.SpI("\u2b50 ",t.rating,"/5"),e.R7$(6),e.JRh(t.phone),e.R7$(5),e.Lme("",t.vehicleType," - ",t.vehicleNumber,""),e.R7$(5),e.SpI("",t.activeOrders," active orders"),e.R7$(5),e.SpI("Avg: ",t.avgDeliveryTime,"min"),e.R7$(4),e.JRh(t.totalDeliveries),e.R7$(5),e.SpI("",t.successRate,"%"),e.R7$(5),e.JRh(e.ii3(50,16,t.monthlyEarnings,"INR","symbol","1.0-0"))}}function Ek(n,o){1&n&&(e.j41(0,"div",47)(1,"mat-icon"),e.EFF(2,"person_add"),e.k0s(),e.j41(3,"h3"),e.EFF(4,"No delivery partners"),e.k0s(),e.j41(5,"p"),e.EFF(6,"Register delivery partners to start accepting deliveries"),e.k0s(),e.j41(7,"button",123)(8,"mat-icon"),e.EFF(9,"add"),e.k0s(),e.EFF(10," Add Partner "),e.k0s()())}function Sk(n,o){if(1&n&&(e.j41(0,"div",124),e.nrm(1,"mat-spinner"),e.j41(2,"p"),e.EFF(3),e.k0s()()),2&n){const t=e.XpG();e.R7$(3),e.JRh(t.loadingMessage||"Loading...")}}function Tk(n,o){if(1&n&&(e.j41(0,"div",125)(1,"mat-icon"),e.EFF(2,"check_circle"),e.k0s(),e.EFF(3),e.k0s()),2&n){const t=e.XpG();e.R7$(3),e.SpI(" ",t.successMessage," ")}}function Ik(n,o){if(1&n&&(e.j41(0,"div",126)(1,"mat-icon"),e.EFF(2,"error"),e.k0s(),e.EFF(3),e.k0s()),2&n){const t=e.XpG();e.R7$(3),e.SpI(" ",t.errorMessage," ")}}let Rk=(()=>{class n{constructor(t,r){this.router=t,this.snackBar=r,this.destroy$=new _n.B,this.selectedTabIndex=0,this.isLoading=!1,this.loadingMessage="",this.successMessage="",this.errorMessage="",this.deliveryStats={activeDeliveries:0,onlinePartners:0,avgDeliveryTime:0,completedToday:0},this.readyOrders=[],this.activeDeliveries=[],this.completedDeliveries=[],this.deliveryPartners=[],this.availablePartners=[]}ngOnInit(){this.loadDeliveryData(),this.setupAutoRefresh()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadDeliveryData(){var t=this;return(0,fe.A)(function*(){t.isLoading=!0,t.loadingMessage="Loading delivery data...";try{yield Promise.all([t.loadDeliveryStats(),t.loadReadyOrders(),t.loadActiveDeliveries(),t.loadCompletedDeliveries(),t.loadDeliveryPartners()])}catch{t.showError("Failed to load delivery data")}finally{t.isLoading=!1,t.loadingMessage=""}})()}loadDeliveryStats(){var t=this;return(0,fe.A)(function*(){t.deliveryStats={activeDeliveries:8,onlinePartners:12,avgDeliveryTime:25,completedToday:45}})()}loadReadyOrders(){var t=this;return(0,fe.A)(function*(){t.readyOrders=[{id:1,orderNumber:"ORD-2025-001",customerName:"Rajesh Kumar",customerPhone:"+91 98765 43210",deliveryAddress:"123 MG Road, T. Nagar, Chennai - 600017",totalAmount:850,paymentMethod:"COD",selectedPartnerId:null,createdAt:new Date},{id:2,orderNumber:"ORD-2025-002",customerName:"Priya Sharma",customerPhone:"+91 87654 32109",deliveryAddress:"456 Anna Salai, Nandanam, Chennai - 600035",totalAmount:1250,paymentMethod:"PAID",selectedPartnerId:null,createdAt:new Date}]})()}loadActiveDeliveries(){var t=this;return(0,fe.A)(function*(){t.activeDeliveries=[{id:1,orderId:3,orderNumber:"ORD-2025-003",customerName:"Suresh Babu",customerId:123,customerPhone:"+91 76543 21098",deliveryAddress:"789 GST Road, Pallikaranai, Chennai - 600100",totalAmount:650,paymentMethod:"COD",paymentStatus:"PENDING",status:"OUT_FOR_DELIVERY",assignedDriver:{id:1,name:"Muthu Kumar",phone:"+91 99887 76655",vehicleType:"Bike",vehicleNumber:"TN01AB1234",rating:4.5},pickupTime:new Date(Date.now()-12e5),estimatedDeliveryTime:new Date(Date.now()+6e5),driverVerified:!0,otpCode:""},{id:2,orderId:4,orderNumber:"ORD-2025-004",customerName:"Lakshmi Devi",customerId:124,customerPhone:"+91 65432 10987",deliveryAddress:"321 ECR Road, Sholinganallur, Chennai - 600119",totalAmount:980,paymentMethod:"PAID",paymentStatus:"COMPLETED",status:"ASSIGNED",assignedDriver:{id:2,name:"Karthik Raja",phone:"+91 88776 65544",vehicleType:"Bike",vehicleNumber:"TN02CD5678",rating:4.2},assignedAt:new Date(Date.now()-3e5),driverVerified:!1,otpCode:""}]})()}loadCompletedDeliveries(){var t=this;return(0,fe.A)(function*(){t.completedDeliveries=[{id:1,orderId:5,orderNumber:"ORD-2025-005",customerName:"Venkat Raman",totalAmount:750,status:"DELIVERED",assignedDriver:{name:"Arjun Prasad"},completedAt:new Date(Date.now()-72e5),deliveryDuration:35,proofOfDelivery:{photo:"assets/images/delivery-proof.jpg",signature:!0,receiverName:"Venkat Raman"}},{id:2,orderId:6,orderNumber:"ORD-2025-006",customerName:"Meera Nair",totalAmount:450,status:"FAILED",assignedDriver:{name:"Raj Mohan"},failedAt:new Date(Date.now()-36e5),failureReason:"Customer not available after multiple attempts"}]})()}loadDeliveryPartners(){var t=this;return(0,fe.A)(function*(){t.deliveryPartners=[{id:1,partnerId:"DP001",fullName:"Muthu Kumar",phone:"+91 99887 76655",isOnline:!0,rating:4.5,vehicleType:"Bike",vehicleNumber:"TN01AB1234",activeOrders:2,avgDeliveryTime:22,totalDeliveries:458,successRate:96,monthlyEarnings:45e3,profilePhoto:null},{id:2,partnerId:"DP002",fullName:"Karthik Raja",phone:"+91 88776 65544",isOnline:!0,rating:4.2,vehicleType:"Bike",vehicleNumber:"TN02CD5678",activeOrders:1,avgDeliveryTime:28,totalDeliveries:312,successRate:94,monthlyEarnings:38e3,profilePhoto:null},{id:3,partnerId:"DP003",fullName:"Arjun Prasad",phone:"+91 77665 54433",isOnline:!1,rating:4.7,vehicleType:"Bike",vehicleNumber:"TN03EF9012",activeOrders:0,avgDeliveryTime:20,totalDeliveries:623,successRate:98,monthlyEarnings:52e3,profilePhoto:null}],t.availablePartners=t.deliveryPartners.filter(r=>r.isOnline)})()}setupAutoRefresh(){(0,_r.Y)(3e4).pipe((0,ot.Q)(this.destroy$)).subscribe(()=>{this.isLoading||this.loadDeliveryData()})}onPartnerSelect(t,r){t.selectedPartnerId=r.value}assignDeliveryPartner(t){var r=this;return(0,fe.A)(function*(){if(t.selectedPartnerId){r.isLoading=!0,r.loadingMessage="Assigning delivery partner...";try{yield r.delay(1500);const i=r.availablePartners.find(a=>a.id===t.selectedPartnerId);if(i){r.readyOrders=r.readyOrders.filter(s=>s.id!==t.id);const a={id:Date.now(),orderId:t.id,orderNumber:t.orderNumber,customerName:t.customerName,customerId:t.customerId,customerPhone:t.customerPhone,deliveryAddress:t.deliveryAddress,totalAmount:t.totalAmount,paymentMethod:t.paymentMethod,paymentStatus:"PENDING",status:"ASSIGNED",assignedDriver:i,assignedAt:new Date,driverVerified:!1,otpCode:""};r.activeDeliveries.unshift(a),r.deliveryStats.activeDeliveries++,r.showSuccess(`Order assigned to ${i.fullName}`),r.selectedTabIndex=1}}catch{r.showError("Failed to assign delivery partner")}finally{r.isLoading=!1,r.loadingMessage=""}}else r.showError("Please select a delivery partner")})()}verifyDriver(t,r){var i=this;return(0,fe.A)(function*(){if(!r||r.length<6)i.showError("Please enter a valid 6-digit OTP");else{i.isLoading=!0,i.loadingMessage="Verifying driver...";try{yield i.delay(1e3);const a=i.activeDeliveries.find(s=>s.id===t);a&&(a.driverVerified=!0,a.status="PICKED_UP",a.pickupTime=new Date,a.estimatedDeliveryTime=new Date(Date.now()+15e5),i.showSuccess("Driver verified successfully. Order released for delivery."))}catch{i.showError("Invalid OTP. Please try again.")}finally{i.isLoading=!1,i.loadingMessage=""}}})()}callDriver(t){t&&window.open(`tel:${t}`,"_self")}callCustomer(t){t&&window.open(`tel:${t}`,"_self")}callPartner(t){t&&window.open(`tel:${t}`,"_self")}messageDriver(t,r){this.showInfo("Messaging feature will be implemented")}messageCustomer(t,r){this.showInfo("Messaging feature will be implemented")}messagePartner(t){this.showInfo("Messaging feature will be implemented")}trackDriver(t){this.showInfo("GPS tracking feature will be implemented")}isTimelineStepCompleted(t,r){switch(r){case"pickup":return["PICKED_UP","OUT_FOR_DELIVERY","DELIVERED"].includes(t.status);case"transit":return["OUT_FOR_DELIVERY","DELIVERED"].includes(t.status);case"delivered":return"DELIVERED"===t.status;default:return!1}}getDeliveryETA(t){if(t.estimatedDeliveryTime){const r=new Date(t.estimatedDeliveryTime),i=new Date,a=Math.ceil((r.getTime()-i.getTime())/6e4);return a>0?`ETA: ${a} min`:"Overdue"}return"Calculating..."}getDeliveryStatusClass(t){switch(t){case"ASSIGNED":return"status-assigned";case"PICKED_UP":return"status-picked";case"OUT_FOR_DELIVERY":return"status-transit";case"DELIVERED":return"status-delivered";case"FAILED":return"status-failed";default:return""}}refreshDeliveries(){var t=this;return(0,fe.A)(function*(){yield t.loadDeliveryData(),t.showSuccess("Delivery data refreshed")})()}viewOrderDetails(t){this.router.navigate(["/shop-owner/orders-management",t])}reportDeliveryIssue(t){this.showInfo("Issue reporting feature will be implemented")}rescheduleDelivery(t){this.showInfo("Delivery rescheduling feature will be implemented")}processRefund(t){this.showInfo("Refund processing feature will be implemented")}viewDeliveryReceipt(t){this.showInfo("Receipt viewing feature will be implemented")}downloadDeliveryReport(t){this.showInfo("Report download feature will be implemented")}viewProofPhoto(t){window.open(t,"_blank")}viewPartnerDetails(t){this.showInfo("Partner details feature will be implemented")}delay(t){return new Promise(r=>setTimeout(r,t))}showSuccess(t){this.successMessage=t,this.errorMessage="",setTimeout(()=>this.successMessage="",5e3)}showError(t){this.errorMessage=t,this.successMessage="",setTimeout(()=>this.errorMessage="",5e3)}showInfo(t){this.snackBar.open(t,"Close",{duration:3e3,horizontalPosition:"center",verticalPosition:"top"})}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(Xe.Ix),e.rXU(Ce.UG))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-delivery-management"]],decls:76,vars:16,consts:[[1,"delivery-management"],[1,"page-header"],[1,"header-content"],[1,"header-actions"],["mat-raised-button","","color","primary",3,"click"],[1,"delivery-stats"],[1,"stat-card"],[1,"stat-info"],[1,"delivery-tabs",3,"selectedIndex","selectedIndexChange"],["mat-tab-label",""],[1,"tab-content"],[1,"orders-grid"],["class","assignment-card",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],[1,"delivery-grid"],["class","delivery-card",4,"ngFor","ngForOf"],[1,"completed-grid"],["class","completed-card",4,"ngFor","ngForOf"],[1,"partners-grid"],["class","partner-card",3,"ngClass",4,"ngFor","ngForOf"],["class","loading-overlay",4,"ngIf"],[1,"message-container"],["class","success-message",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"assignment-card"],[1,"order-header"],["color","accent"],[1,"order-details"],[1,"customer-info"],[1,"customer-name"],[1,"customer-phone"],[1,"delivery-address"],[1,"order-value"],[1,"assignment-section"],[1,"partner-select"],[3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"assignment-actions"],["mat-raised-button","","color","primary",3,"disabled","click"],["mat-button","",3,"click"],[3,"value"],[1,"partner-option"],[1,"partner-info"],[1,"partner-rating"],[1,"partner-status"],[3,"ngClass"],[1,"vehicle"],[1,"empty-state"],[1,"delivery-card"],[1,"delivery-header"],[1,"delivery-info"],[1,"delivery-time"],["class","driver-section",4,"ngIf"],[1,"customer-section"],[1,"address"],[1,"customer-actions"],["mat-icon-button","","matTooltip","Call Customer",3,"click"],["mat-icon-button","","matTooltip","Message Customer",3,"click"],[1,"timeline-section"],[1,"timeline"],[1,"timeline-item",3,"ngClass"],[1,"timeline-marker"],[1,"timeline-content"],[1,"payment-section"],[1,"payment-info"],[1,"payment-status",3,"ngClass"],["class","verification-section",4,"ngIf"],[1,"delivery-actions"],["mat-button","","color","warn",3,"click"],[1,"driver-section"],[1,"driver-info"],[1,"driver-avatar"],[1,"driver-details"],[1,"driver-name"],[1,"driver-vehicle"],[1,"driver-rating"],[1,"driver-actions"],["mat-icon-button","","matTooltip","Call Driver",3,"click"],["mat-icon-button","","matTooltip","Message Driver",3,"click"],["mat-icon-button","","matTooltip","Track Location",3,"click"],[1,"verification-section"],[1,"verification-form"],["matInput","","placeholder","6-digit code","maxlength","6",3,"ngModel","ngModelChange"],["matSuffix",""],[1,"completed-card"],[1,"completed-header"],[1,"completion-info"],["color","primary"],[1,"completion-time"],[1,"completion-details"],[1,"completion-info-row"],[1,"label"],["class","proof-section",4,"ngIf"],["class","failed-section",4,"ngIf"],[1,"completed-actions"],[1,"proof-section"],[1,"proof-content"],["class","proof-photo",4,"ngIf"],["class","proof-signature",4,"ngIf"],[1,"proof-photo"],["alt","Delivery proof",3,"src","click"],[1,"proof-signature"],[1,"failed-section"],[1,"failed-reason"],["color","warn"],[1,"failed-time"],[1,"failed-actions"],["mat-stroked-button","",3,"click"],[1,"partner-card",3,"ngClass"],[1,"partner-header"],[1,"partner-avatar"],[3,"src","alt",4,"ngIf"],[4,"ngIf"],[1,"partner-id"],[1,"rating"],[1,"partner-details"],[1,"detail-row"],[1,"partner-stats"],[1,"stat"],[1,"stat-value"],[1,"stat-label"],[1,"partner-actions"],[3,"src","alt"],["mat-raised-button","","color","primary","routerLink","/delivery/partner/register"],[1,"loading-overlay"],[1,"success-message"],[1,"error-message"]],template:function(r,i){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1")(4,"mat-icon"),e.EFF(5,"local_shipping"),e.k0s(),e.EFF(6," Delivery Management "),e.k0s(),e.j41(7,"p"),e.EFF(8,"Manage delivery assignments, track orders, and monitor delivery partners"),e.k0s()(),e.j41(9,"div",3)(10,"button",4),e.bIt("click",function(){return i.refreshDeliveries()}),e.j41(11,"mat-icon"),e.EFF(12,"refresh"),e.k0s(),e.EFF(13," Refresh "),e.k0s()()(),e.j41(14,"div",5)(15,"div",6)(16,"mat-icon"),e.EFF(17,"local_shipping"),e.k0s(),e.j41(18,"div",7)(19,"h3"),e.EFF(20),e.k0s(),e.j41(21,"p"),e.EFF(22,"Active Deliveries"),e.k0s()()(),e.j41(23,"div",6)(24,"mat-icon"),e.EFF(25,"person"),e.k0s(),e.j41(26,"div",7)(27,"h3"),e.EFF(28),e.k0s(),e.j41(29,"p"),e.EFF(30,"Online Partners"),e.k0s()()(),e.j41(31,"div",6)(32,"mat-icon"),e.EFF(33,"schedule"),e.k0s(),e.j41(34,"div",7)(35,"h3"),e.EFF(36),e.k0s(),e.j41(37,"p"),e.EFF(38,"Avg Delivery Time"),e.k0s()()(),e.j41(39,"div",6)(40,"mat-icon"),e.EFF(41,"check_circle"),e.k0s(),e.j41(42,"div",7)(43,"h3"),e.EFF(44),e.k0s(),e.j41(45,"p"),e.EFF(46,"Completed Today"),e.k0s()()()(),e.j41(47,"mat-tab-group",8),e.bIt("selectedIndexChange",function(s){return i.selectedTabIndex=s}),e.j41(48,"mat-tab"),e.DNE(49,ck,3,1,"ng-template",9),e.j41(50,"div",10)(51,"div",11),e.DNE(52,dk,43,11,"div",12),e.DNE(53,uk,7,0,"div",13),e.k0s()()(),e.j41(54,"mat-tab"),e.DNE(55,gk,3,1,"ng-template",9),e.j41(56,"div",10)(57,"div",14),e.DNE(58,hk,80,38,"div",15),e.DNE(59,_k,7,0,"div",13),e.k0s()()(),e.j41(60,"mat-tab"),e.DNE(61,xk,3,1,"ng-template",9),e.j41(62,"div",10)(63,"div",16),e.DNE(64,kk,48,14,"div",17),e.DNE(65,Ok,7,0,"div",13),e.k0s()()(),e.j41(66,"mat-tab"),e.DNE(67,yk,3,1,"ng-template",9),e.j41(68,"div",10)(69,"div",18),e.DNE(70,Fk,66,21,"div",19),e.DNE(71,Ek,11,0,"div",13),e.k0s()()()()(),e.DNE(72,Sk,4,1,"div",20),e.j41(73,"div",21),e.DNE(74,Tk,4,1,"div",22),e.DNE(75,Ik,4,1,"div",23),e.k0s()),2&r&&(e.R7$(20),e.JRh(i.deliveryStats.activeDeliveries),e.R7$(8),e.JRh(i.deliveryStats.onlinePartners),e.R7$(8),e.SpI("",i.deliveryStats.avgDeliveryTime,"min"),e.R7$(8),e.JRh(i.deliveryStats.completedToday),e.R7$(3),e.Y8G("selectedIndex",i.selectedTabIndex),e.R7$(5),e.Y8G("ngForOf",i.readyOrders),e.R7$(1),e.Y8G("ngIf",0===i.readyOrders.length),e.R7$(5),e.Y8G("ngForOf",i.activeDeliveries),e.R7$(1),e.Y8G("ngIf",0===i.activeDeliveries.length),e.R7$(5),e.Y8G("ngForOf",i.completedDeliveries),e.R7$(1),e.Y8G("ngIf",0===i.completedDeliveries.length),e.R7$(5),e.Y8G("ngForOf",i.deliveryPartners),e.R7$(1),e.Y8G("ngIf",0===i.deliveryPartners.length),e.R7$(1),e.Y8G("ngIf",i.isLoading),e.R7$(2),e.Y8G("ngIf",i.successMessage),e.R7$(1),e.Y8G("ngIf",i.errorMessage))},dependencies:[D.YU,D.Sq,D.bT,b.me,b.BC,b.tU,b.vS,Xe.Wk,B.$z,B.iY,H.An,X.LG,Ve.Jl,ge.rl,ge.nJ,ge.yw,Ee.fg,ze.VO,Bt.wT,qe.oV,Ue.ES,Ue.mq,Ue.T8,D.QX,D.PV,D.oe,D.vh],styles:[".delivery-management[_ngcontent-%COMP%]{padding:24px;background:linear-gradient(135deg,#f8fafc 0%,#e2e8f0 100%);min-height:100vh;font-family:Inter,system-ui,-apple-system,sans-serif}.delivery-management[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:32px;background:linear-gradient(135deg,rgba(255,255,255,.95) 0%,rgba(248,250,252,.98) 100%);padding:24px;border-radius:16px;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);box-shadow:0 8px 32px #00000014;border:1px solid rgba(226,232,240,.8)}.delivery-management[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 8px;font-size:2rem;font-weight:800;color:#0f172a;display:flex;align-items:center;gap:12px}.delivery-management[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#3b82f6}.delivery-management[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#64748b;font-size:.9375rem}.delivery-management[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6 0%,#2563eb 100%);color:#fff;border-radius:10px;font-weight:600;padding:12px 24px}.delivery-management[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 24px #3b82f64d}.delivery-management[_ngcontent-%COMP%]   .delivery-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:32px}.delivery-management[_ngcontent-%COMP%]   .delivery-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;background:linear-gradient(135deg,rgba(255,255,255,.95) 0%,rgba(248,250,252,.98) 100%);padding:20px;border-radius:12px;border:1px solid rgba(226,232,240,.8);box-shadow:0 4px 16px #0000000d;transition:transform .3s ease}.delivery-management[_ngcontent-%COMP%]   .delivery-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 8px 32px #0000001a}.delivery-management[_ngcontent-%COMP%]   .delivery-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:48px;height:48px;font-size:24px;background:linear-gradient(135deg,#3b82f6 0%,#2563eb 100%);color:#fff;border-radius:12px;display:flex;align-items:center;justify-content:center}.delivery-management[_ngcontent-%COMP%]   .delivery-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:700;color:#0f172a}.delivery-management[_ngcontent-%COMP%]   .delivery-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0 0;color:#64748b;font-size:.875rem;font-weight:500}.delivery-management[_ngcontent-%COMP%]   .delivery-tabs[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(255,255,255,.95) 0%,rgba(248,250,252,.98) 100%);border-radius:16px;padding:24px;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);box-shadow:0 8px 32px #00000014;border:1px solid rgba(226,232,240,.8)}.delivery-management[_ngcontent-%COMP%]   .delivery-tabs[_ngcontent-%COMP%]     .mat-tab-group .mat-tab-header{border-bottom:2px solid #e2e8f0;margin-bottom:24px}.delivery-management[_ngcontent-%COMP%]   .delivery-tabs[_ngcontent-%COMP%]     .mat-tab-group .mat-tab-header .mat-tab-label-container .mat-tab-list .mat-tab-labels .mat-tab-label{padding:16px 24px;margin-right:8px;border-radius:12px 12px 0 0;font-weight:600;transition:all .3s ease}.delivery-management[_ngcontent-%COMP%]   .delivery-tabs[_ngcontent-%COMP%]     .mat-tab-group .mat-tab-header .mat-tab-label-container .mat-tab-list .mat-tab-labels .mat-tab-label.mat-tab-label-active{background:linear-gradient(135deg,#3b82f6 0%,#2563eb 100%);color:#fff;box-shadow:0 4px 12px #3b82f64d}.delivery-management[_ngcontent-%COMP%]   .delivery-tabs[_ngcontent-%COMP%]     .mat-tab-group .mat-tab-header .mat-tab-label-container .mat-tab-list .mat-tab-labels .mat-tab-label mat-icon{margin-right:8px}.delivery-management[_ngcontent-%COMP%]   .orders-grid[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .delivery-grid[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .completed-grid[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .partners-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(400px,1fr));gap:20px}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(255,255,255,.98) 0%,rgba(248,250,252,.95) 100%);border:1px solid rgba(226,232,240,.8);border-radius:16px;padding:24px;box-shadow:0 8px 32px #00000014;transition:all .3s cubic-bezier(.4,0,.2,1)}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 16px 48px #0000001f}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .order-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:16px;border-bottom:2px solid #f1f5f9}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .order-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:700;color:#0f172a}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]{margin-bottom:24px}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]   .customer-info[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]   .delivery-address[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]   .order-value[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:12px;padding:8px;background:#f8fafc;border-radius:8px}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]   .customer-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]   .delivery-address[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]   .order-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#64748b;font-size:18px}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]   .customer-info[_ngcontent-%COMP%]   .customer-name[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]   .delivery-address[_ngcontent-%COMP%]   .customer-name[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]   .order-value[_ngcontent-%COMP%]   .customer-name[_ngcontent-%COMP%]{font-weight:600;color:#0f172a;margin-bottom:2px}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]   .customer-info[_ngcontent-%COMP%]   .customer-phone[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]   .delivery-address[_ngcontent-%COMP%]   .customer-phone[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]   .order-value[_ngcontent-%COMP%]   .customer-phone[_ngcontent-%COMP%]{color:#64748b;font-size:.875rem}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .assignment-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;font-size:1rem;font-weight:600;color:#374151}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .assignment-section[_ngcontent-%COMP%]   .partner-select[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .assignment-section[_ngcontent-%COMP%]   .partner-select[_ngcontent-%COMP%]   .partner-option[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .assignment-section[_ngcontent-%COMP%]   .partner-select[_ngcontent-%COMP%]   .partner-option[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   .partner-rating[_ngcontent-%COMP%]{font-size:.875rem;color:#f59e0b}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .assignment-section[_ngcontent-%COMP%]   .partner-select[_ngcontent-%COMP%]   .partner-option[_ngcontent-%COMP%]   .partner-status[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:.75rem}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .assignment-section[_ngcontent-%COMP%]   .partner-select[_ngcontent-%COMP%]   .partner-option[_ngcontent-%COMP%]   .partner-status[_ngcontent-%COMP%]   .online[_ngcontent-%COMP%]{color:#10b981;font-weight:600}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .assignment-section[_ngcontent-%COMP%]   .partner-select[_ngcontent-%COMP%]   .partner-option[_ngcontent-%COMP%]   .partner-status[_ngcontent-%COMP%]   .offline[_ngcontent-%COMP%]{color:#ef4444;font-weight:600}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .assignment-section[_ngcontent-%COMP%]   .partner-select[_ngcontent-%COMP%]   .partner-option[_ngcontent-%COMP%]   .partner-status[_ngcontent-%COMP%]   .vehicle[_ngcontent-%COMP%]{color:#64748b}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .assignment-section[_ngcontent-%COMP%]   .assignment-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .assignment-section[_ngcontent-%COMP%]   .assignment-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;border-radius:10px;font-weight:600;padding:12px 16px}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%]   .assignment-section[_ngcontent-%COMP%]   .assignment-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(255,255,255,.98) 0%,rgba(248,250,252,.95) 100%);border:1px solid rgba(226,232,240,.8);border-radius:16px;padding:24px;box-shadow:0 8px 32px #00000014;transition:all .3s cubic-bezier(.4,0,.2,1)}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 16px 48px #0000001f}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .delivery-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:16px;border-bottom:2px solid #f1f5f9}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .delivery-header[_ngcontent-%COMP%]   .delivery-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:1.25rem;font-weight:700;color:#0f172a}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .delivery-header[_ngcontent-%COMP%]   .delivery-time[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;color:#64748b;font-size:.875rem;font-weight:500}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .delivery-header[_ngcontent-%COMP%]   .status-assigned[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fbbf24 0%,#f59e0b 100%)}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .delivery-header[_ngcontent-%COMP%]   .status-picked[_ngcontent-%COMP%]{background:linear-gradient(135deg,#34d399 0%,#10b981 100%)}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .delivery-header[_ngcontent-%COMP%]   .status-transit[_ngcontent-%COMP%]{background:linear-gradient(135deg,#60a5fa 0%,#3b82f6 100%)}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .delivery-header[_ngcontent-%COMP%]   .status-delivered[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981 0%,#059669 100%)}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .delivery-header[_ngcontent-%COMP%]   .status-failed[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f87171 0%,#ef4444 100%)}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .driver-section[_ngcontent-%COMP%]{background:#f8fafc;border-radius:12px;padding:16px;margin-bottom:20px}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .driver-section[_ngcontent-%COMP%]   .driver-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:12px}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .driver-section[_ngcontent-%COMP%]   .driver-info[_ngcontent-%COMP%]   .driver-avatar[_ngcontent-%COMP%]{width:48px;height:48px;background:linear-gradient(135deg,#3b82f6 0%,#2563eb 100%);border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .driver-section[_ngcontent-%COMP%]   .driver-info[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]{flex:1}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .driver-section[_ngcontent-%COMP%]   .driver-info[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-name[_ngcontent-%COMP%]{margin:0 0 4px;font-weight:600;color:#0f172a}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .driver-section[_ngcontent-%COMP%]   .driver-info[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-vehicle[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .driver-section[_ngcontent-%COMP%]   .driver-info[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-rating[_ngcontent-%COMP%]{margin:2px 0;font-size:.875rem;color:#64748b}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .driver-section[_ngcontent-%COMP%]   .driver-info[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-rating[_ngcontent-%COMP%]{color:#f59e0b}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .driver-section[_ngcontent-%COMP%]   .driver-actions[_ngcontent-%COMP%]{display:flex;gap:8px}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .driver-section[_ngcontent-%COMP%]   .driver-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:white;border:1px solid #e2e8f0}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .driver-section[_ngcontent-%COMP%]   .driver-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#3b82f6;color:#fff;border-color:#3b82f6}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .customer-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;background:#f1f5f9;border-radius:12px;padding:16px;margin-bottom:20px}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .customer-section[_ngcontent-%COMP%]   .customer-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .customer-section[_ngcontent-%COMP%]   .customer-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#64748b}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .customer-section[_ngcontent-%COMP%]   .customer-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:2px 0;font-size:.875rem}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .customer-section[_ngcontent-%COMP%]   .customer-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:first-child{font-weight:600;color:#0f172a}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .customer-section[_ngcontent-%COMP%]   .customer-info[_ngcontent-%COMP%]   p.address[_ngcontent-%COMP%]{color:#64748b;font-size:.8125rem}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .customer-section[_ngcontent-%COMP%]   .customer-actions[_ngcontent-%COMP%]{display:flex;gap:8px}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .customer-section[_ngcontent-%COMP%]   .customer-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .customer-section[_ngcontent-%COMP%]   .customer-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#10b981;color:#fff}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .timeline-section[_ngcontent-%COMP%]{margin-bottom:20px}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .timeline-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;font-size:.9375rem;font-weight:600;color:#374151}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .timeline-section[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:16px;padding:8px;border-radius:8px;transition:background .3s ease}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .timeline-section[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item.completed[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dcfce7 0%,#bbf7d0 100%)}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .timeline-section[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item.completed[_ngcontent-%COMP%]   .timeline-marker[_ngcontent-%COMP%]{background:#10b981}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .timeline-section[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dbeafe 0%,#bfdbfe 100%)}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .timeline-section[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item.active[_ngcontent-%COMP%]   .timeline-marker[_ngcontent-%COMP%]{background:#3b82f6;animation:_ngcontent-%COMP%_pulse 2s infinite}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .timeline-section[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-marker[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%;background:#d1d5db;flex-shrink:0}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .timeline-section[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-weight:500;color:#374151}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .timeline-section[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]   .timeline-item[_ngcontent-%COMP%]   .timeline-content[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#64748b;font-size:.75rem}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]{background:#fff7ed;border-radius:12px;padding:16px;margin-bottom:20px}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]   .payment-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]   .payment-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#f59e0b}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]   .payment-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:2px 0}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]   .payment-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:first-child{font-size:1.125rem;font-weight:700;color:#0f172a}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]   .payment-info[_ngcontent-%COMP%]   .payment-status[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]   .payment-info[_ngcontent-%COMP%]   .payment-status.pending[_ngcontent-%COMP%]{color:#f59e0b}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]   .payment-info[_ngcontent-%COMP%]   .payment-status.completed[_ngcontent-%COMP%]{color:#10b981}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]   .payment-info[_ngcontent-%COMP%]   .payment-status.failed[_ngcontent-%COMP%]{color:#ef4444}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .verification-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fef3c7 0%,#fde68a 100%);border:2px solid #f59e0b;border-radius:12px;padding:16px;margin-bottom:20px}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .verification-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;color:#92400e;font-size:.9375rem;font-weight:600}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .verification-section[_ngcontent-%COMP%]   .verification-form[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:end}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .verification-section[_ngcontent-%COMP%]   .verification-form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .verification-section[_ngcontent-%COMP%]   .verification-form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]     .mat-form-field-wrapper{background:white;border-radius:8px}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .verification-section[_ngcontent-%COMP%]   .verification-form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:56px;border-radius:10px;font-weight:600}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .verification-section[_ngcontent-%COMP%]   .verification-form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .delivery-actions[_ngcontent-%COMP%]{display:flex;gap:12px;padding-top:16px;border-top:2px solid #f1f5f9}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .delivery-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;border-radius:10px;font-weight:500}.delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%]   .delivery-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(255,255,255,.98) 0%,rgba(248,250,252,.95) 100%);border:1px solid rgba(226,232,240,.8);border-radius:16px;padding:24px;box-shadow:0 8px 32px #00000014;transition:all .3s cubic-bezier(.4,0,.2,1)}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .completed-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:16px;border-bottom:2px solid #f1f5f9}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .completed-header[_ngcontent-%COMP%]   .completion-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:700;color:#0f172a}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .completed-header[_ngcontent-%COMP%]   .completion-time[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;color:#64748b;font-size:.875rem}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .completion-details[_ngcontent-%COMP%]{margin-bottom:20px}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .completion-details[_ngcontent-%COMP%]   .completion-info-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #f1f5f9}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .completion-details[_ngcontent-%COMP%]   .completion-info-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .completion-details[_ngcontent-%COMP%]   .completion-info-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#64748b;font-weight:500}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .completion-details[_ngcontent-%COMP%]   .completion-info-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{color:#0f172a;font-weight:600}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .proof-section[_ngcontent-%COMP%]{background:#f0f9ff;border-radius:12px;padding:16px;margin-bottom:20px}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .proof-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;color:#1e40af;font-size:.9375rem;font-weight:600}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .proof-section[_ngcontent-%COMP%]   .proof-content[_ngcontent-%COMP%]   .proof-photo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-width:200px;border-radius:8px;cursor:pointer;transition:transform .3s ease}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .proof-section[_ngcontent-%COMP%]   .proof-content[_ngcontent-%COMP%]   .proof-photo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .proof-section[_ngcontent-%COMP%]   .proof-content[_ngcontent-%COMP%]   .proof-signature[_ngcontent-%COMP%]{margin-top:12px}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .proof-section[_ngcontent-%COMP%]   .proof-content[_ngcontent-%COMP%]   .proof-signature[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0;font-size:.875rem;color:#1e40af}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .failed-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fee2e2 0%,#fecaca 100%);border:2px solid #ef4444;border-radius:12px;padding:16px;margin-bottom:20px}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .failed-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;color:#dc2626;font-size:.9375rem;font-weight:600}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .failed-section[_ngcontent-%COMP%]   .failed-reason[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:16px}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .failed-section[_ngcontent-%COMP%]   .failed-reason[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:2px 0;color:#dc2626;font-size:.875rem}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .failed-section[_ngcontent-%COMP%]   .failed-reason[_ngcontent-%COMP%]   p.failed-time[_ngcontent-%COMP%]{color:#7f1d1d;font-size:.8125rem}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .failed-section[_ngcontent-%COMP%]   .failed-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .failed-section[_ngcontent-%COMP%]   .failed-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;border-radius:8px}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .completed-actions[_ngcontent-%COMP%]{display:flex;gap:12px;padding-top:16px;border-top:2px solid #f1f5f9}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .completed-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;border-radius:10px}.delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%]   .completed-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(255,255,255,.98) 0%,rgba(248,250,252,.95) 100%);border:1px solid rgba(226,232,240,.8);border-radius:16px;padding:24px;box-shadow:0 8px 32px #00000014;transition:all .3s cubic-bezier(.4,0,.2,1)}.delivery-management[_ngcontent-%COMP%]   .partner-card.online[_ngcontent-%COMP%]{border-left:6px solid #10b981}.delivery-management[_ngcontent-%COMP%]   .partner-card.offline[_ngcontent-%COMP%]{border-left:6px solid #ef4444;opacity:.7}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 16px 48px #0000001f}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;margin-bottom:20px}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-header[_ngcontent-%COMP%]   .partner-avatar[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:50%;background:linear-gradient(135deg,#3b82f6 0%,#2563eb 100%);display:flex;align-items:center;justify-content:center;color:#fff;font-size:24px}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-header[_ngcontent-%COMP%]   .partner-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:50%;object-fit:cover}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-header[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]{flex:1}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-header[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 4px;font-size:1.25rem;font-weight:700;color:#0f172a}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-header[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   .partner-id[_ngcontent-%COMP%]{margin:0 0 8px;color:#64748b;font-size:.875rem}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-header[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   .partner-status[_ngcontent-%COMP%]{display:flex;gap:16px}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-header[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   .partner-status[_ngcontent-%COMP%]   .online[_ngcontent-%COMP%]{color:#10b981;font-weight:600}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-header[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   .partner-status[_ngcontent-%COMP%]   .offline[_ngcontent-%COMP%]{color:#ef4444;font-weight:600}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-header[_ngcontent-%COMP%]   .partner-info[_ngcontent-%COMP%]   .partner-status[_ngcontent-%COMP%]   .rating[_ngcontent-%COMP%]{color:#f59e0b;font-weight:600}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-details[_ngcontent-%COMP%]{margin-bottom:20px}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:8px;padding:6px;background:#f8fafc;border-radius:6px}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#64748b;font-size:18px}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#374151;font-size:.875rem}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-stats[_ngcontent-%COMP%]{display:flex;justify-content:space-around;margin-bottom:20px;padding:16px;background:#f8fafc;border-radius:12px}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]{text-align:center}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{display:block;font-size:1.25rem;font-weight:700;color:#0f172a}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-stats[_ngcontent-%COMP%]   .stat[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:.75rem;color:#64748b;text-transform:uppercase;letter-spacing:.05em}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;border-radius:10px;font-weight:500}.delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]   .partner-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.delivery-management[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:48px 24px;background:linear-gradient(135deg,rgba(255,255,255,.98) 0%,rgba(248,250,252,.95) 100%);border:2px dashed #d1d5db;border-radius:16px;color:#64748b}.delivery-management[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#9ca3af;margin-bottom:16px}.delivery-management[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;color:#374151;font-weight:600}.delivery-management[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 16px;font-size:.9375rem}.delivery-management[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:16px}.delivery-management[_ngcontent-%COMP%]   .loading-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:rgba(0,0,0,.5);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.delivery-management[_ngcontent-%COMP%]   .loading-overlay[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin-bottom:16px}.delivery-management[_ngcontent-%COMP%]   .loading-overlay[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff;font-weight:500}.delivery-management[_ngcontent-%COMP%]   .message-container[_ngcontent-%COMP%]{position:fixed;top:24px;right:24px;z-index:1000}.delivery-management[_ngcontent-%COMP%]   .message-container[_ngcontent-%COMP%]   .success-message[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .message-container[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:16px 20px;border-radius:12px;color:#fff;font-weight:600;box-shadow:0 8px 32px #00000026;animation:_ngcontent-%COMP%_slideIn .3s ease-out}.delivery-management[_ngcontent-%COMP%]   .message-container[_ngcontent-%COMP%]   .success-message[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981 0%,#059669 100%)}.delivery-management[_ngcontent-%COMP%]   .message-container[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef4444 0%,#dc2626 100%)}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1;transform:scale(1)}50%{opacity:.8;transform:scale(1.05)}}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translate(100%)}to{opacity:1;transform:translate(0)}}@media (max-width: 768px){.delivery-management[_ngcontent-%COMP%]{padding:16px}.delivery-management[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]{flex-direction:column;gap:16px;align-items:stretch;padding:20px}.delivery-management[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.75rem;text-align:center}.delivery-management[_ngcontent-%COMP%]   .delivery-stats[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .orders-grid[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .delivery-grid[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .completed-grid[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .partners-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]{padding:20px}.delivery-management[_ngcontent-%COMP%]   .assignment-actions[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .delivery-actions[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .completed-actions[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .partner-actions[_ngcontent-%COMP%]{flex-direction:column}.delivery-management[_ngcontent-%COMP%]   .assignment-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .delivery-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .completed-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .partner-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}.delivery-management[_ngcontent-%COMP%]   .verification-form[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.delivery-management[_ngcontent-%COMP%]   .verification-form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}@media (prefers-reduced-motion: reduce){*[_ngcontent-%COMP%]{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}@media (prefers-contrast: high){.delivery-management[_ngcontent-%COMP%]   .assignment-card[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .delivery-card[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .completed-card[_ngcontent-%COMP%], .delivery-management[_ngcontent-%COMP%]   .partner-card[_ngcontent-%COMP%]{border:2px solid #000}}"]})}}return n})();var Dc=E(155),r0=E(2180),Nk=E(1108),i0=E(8262),o0=E(2218);const Ak=["barcode1Input"],Dk=["barcode2Input"],jk=["barcode3Input"];function Bk(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Product name is required "),e.k0s())}function Lk(n,o){if(1&n&&(e.j41(0,"mat-option",72),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.Y8G("value",t.id),e.R7$(1),e.SpI(" ",t.name," ")}}function $k(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Category is required "),e.k0s())}function Gk(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Price is required "),e.k0s())}function Uk(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Price must be greater than 0 "),e.k0s())}function zk(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Unit is required "),e.k0s())}function Vk(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Initial stock is required "),e.k0s())}function Yk(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Stock must be 0 or greater "),e.k0s())}function Xk(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",73),e.nrm(1,"img",74),e.j41(2,"button",75),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.removeImage())}),e.j41(3,"mat-icon"),e.EFF(4,"close"),e.k0s()()()}if(2&n){const t=e.XpG();e.R7$(1),e.Y8G("src",t.imagePreview,e.B4B)}}function Hk(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",76),e.bIt("click",function(){e.eBV(t),e.XpG();const i=e.sdS(189);return e.Njj(i.click())}),e.j41(1,"mat-icon",77),e.EFF(2,"cloud_upload"),e.k0s(),e.j41(3,"p",78),e.EFF(4,"Click to upload product image"),e.k0s(),e.j41(5,"p",79),e.EFF(6,"Supported formats: JPG, PNG, WEBP (Max 5MB)"),e.k0s()()}}function Wk(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",80)(1,"button",81),e.bIt("click",function(){e.eBV(t),e.XpG();const i=e.sdS(189);return e.Njj(i.click())}),e.j41(2,"mat-icon"),e.EFF(3,"edit"),e.k0s(),e.EFF(4," Change Image "),e.k0s()()}}function qk(n,o){1&n&&e.nrm(0,"mat-spinner",82)}function Zk(n,o){1&n&&(e.j41(0,"mat-icon",70),e.EFF(1,"save"),e.k0s())}let a0=(()=>{class n{constructor(t,r,i,a,s,l,u,p,f,h,_,C){this.fb=t,this.snackBar=r,this.router=i,this.route=a,this.productService=s,this.shopProductService=l,this.shopService=u,this.categoryService=p,this.authService=f,this.offlineStorage=h,this.httpClient=_,this.categoryDialog=C,this.isLoading=!1,this.imagePreview=null,this.selectedFile=null,this.currentShop=null,this.productCategories=[],this.isEditMode=!1,this.editingProductId=null,this.categories=["Groceries","Vegetables","Fruits","Dairy Products","Bakery Items","Beverages","Snacks","Personal Care","Household Items","Frozen Foods"],this.productForm=this.fb.group({name:["",b.k0.required],nameTamil:[""],tags:[""],category:["",b.k0.required],brand:[""],description:[""],price:["",[b.k0.required,b.k0.min(.01)]],originalPrice:[""],costPrice:[""],unit:["",b.k0.required],initialStock:["",[b.k0.required,b.k0.min(0)]],minStock:[""],maxStock:[""],sku:[""],barcode1:[""],barcode2:[""],barcode3:[""],supplier:[""],location:[""],expiryDate:[""],isActive:[!0],isFeatured:[!1],trackStock:[!0]})}ngOnInit(){this.route.params.subscribe(t=>{if(t.id){const r=parseInt(t.id,10);isNaN(r)?(console.error("Invalid product ID:",t.id),this.snackBar.open("Invalid product ID provided","Close",{duration:3e3}),this.router.navigate(["/shop-owner/my-products"])):(this.isEditMode=!0,this.editingProductId=r,this.loadProductForEdit(this.editingProductId))}}),this.loadInitialData(),this.isEditMode||this.productForm.get("name")?.valueChanges.subscribe(t=>{if(t&&!this.productForm.get("sku")?.value){const r=this.generateSKU(t);this.productForm.patchValue({sku:r})}})}getShopId(){const t=localStorage.getItem("current_shop_id");if(t){const i=parseInt(t,10);if(!isNaN(i)&&i>0)return console.log("Using shop ID from current_shop_id:",i),i}const r=localStorage.getItem("shop_management_user")||localStorage.getItem("currentUser");if(r)try{const i=JSON.parse(r);if(i.shopId&&i.shopId>0)return console.log("Using shop ID from user data:",i.shopId),i.shopId}catch(i){console.error("Error parsing user data:",i)}return console.error("No valid shop ID found for current user! Products will not be created correctly."),0}loadInitialData(){this.isLoading=!0;const r={id:this.getShopId(),name:"My Shop",description:"Default shop for product management",shopId:"DEFAULT001",slug:"my-shop",ownerName:"Shop Owner",ownerEmail:"owner@myshop.com",ownerPhone:"+1234567890",businessName:"My Business",businessType:r0.Vp.GROCERY,addressLine1:"123 Main Street",city:"Default City",state:"Default State",postalCode:"12345",country:"India",latitude:0,longitude:0,minOrderAmount:100,deliveryRadius:5,freeDeliveryAbove:500,commissionRate:15,status:r0.LA.APPROVED,isActive:!0,isVerified:!0,isFeatured:!1,rating:0,totalOrders:0,totalRevenue:0,productCount:0,createdBy:"system",updatedBy:"system",createdAt:new Date,updatedAt:new Date,images:[],documents:[]};this.currentShop=r,this.loadCategories()}cacheCategories(t){try{const r=t.map(a=>({id:a.id,name:a.name,slug:a.slug}));localStorage.setItem("cached_product_categories",JSON.stringify(r));const i=t.map(a=>a.name).filter(a=>!!a);localStorage.setItem("cached_product_category_names",JSON.stringify(i))}catch(r){console.warn("Failed to cache categories:",r)}}getCachedCategories(){try{const t=localStorage.getItem("cached_product_categories");if(t){const r=JSON.parse(t);if(Array.isArray(r)&&r.length>0)return r.map((i,a)=>({id:i.id,name:i.name,description:`${i.name} category`,slug:i.slug||i.name.toLowerCase().replace(/\s+/g,"-"),parentId:void 0,parentName:void 0,fullPath:i.name,isActive:!0,sortOrder:a,iconUrl:void 0,createdBy:"system",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),level:0,subcategories:[],hasSubcategories:!1,isRootCategory:!0,productCount:0,subcategoryCount:0}))}}catch(t){console.warn("Failed to read cached categories:",t)}return[]}getCategoryNameById(t){if(!t)return"";const r=this.productCategories.find(i=>i.id===t||i.id===Number(t));return r?r.name:String(t)}loadCategories(){navigator.onLine?this.categoryService.getCategories(void 0,!0,void 0,0,200).subscribe({next:t=>{t&&t.content&&t.content.length>0?(this.productCategories=t.content,this.cacheCategories(this.productCategories),console.log("Loaded",this.productCategories.length,"categories from API")):this.loadCategoriesFallback(),this.isLoading=!1},error:t=>{console.warn("Failed to load categories from API:",t),this.loadCategoriesFallback(),this.isLoading=!1}}):this.loadCategoriesFallback()}loadCategoriesFallback(){try{const t=localStorage.getItem("cached_product_categories");if(t)return this.productCategories=JSON.parse(t),void console.log("Loaded",this.productCategories.length,"categories from cache")}catch(t){console.warn("Failed to load cached categories:",t)}this.productCategories=this.getDefaultCategories(),console.log("Using default categories")}onCategorySelectChange(t){if("__NEW__"===t){this.productForm.patchValue({category:""});const r=this.productCategories.map(a=>a.name);this.categoryDialog.open(so,{width:"420px",maxWidth:"95vw",data:{existingCategories:r},disableClose:!1}).afterClosed().subscribe(a=>{if(a?.name){const s={id:a.id||-Date.now(),name:a.name,description:"",slug:a.slug||a.name.toLowerCase().replace(/\s+/g,"-"),fullPath:a.name,isActive:!0,createdBy:"system",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),subcategories:[],hasSubcategories:!1,isRootCategory:!0,productCount:0,subcategoryCount:0};this.productCategories.push(s),this.productCategories.sort((l,u)=>l.name.localeCompare(u.name)),this.productForm.patchValue({category:s.id}),this.cacheCategories(this.productCategories)}})}}loadProductForEdit(t){const i=[{id:1,name:"Organic Rice",category:"Groceries",brand:"Organic Farm",description:"Premium quality organic rice",price:120,stock:50,unit:"kg",sku:"ORG-RICE-001",isActive:!0,isFeatured:!1,trackStock:!0,image:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDE1MCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxNTAiIGhlaWdodD0iMTUwIiBmaWxsPSIjRjNGNEY2Ii8+Cjx0ZXh0IHg9Ijc1IiB5PSI3NSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZG9taW5hbnQtYmFzZWxpbmU9ImNlbnRyYWwiIGZpbGw9IiM5Q0EzQUYiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxOCI+UmljZTwvdGV4dD4KPC9zdmc+"},{id:2,name:"Fresh Tomatoes",category:"Vegetables",brand:"Fresh Farm",description:"Farm fresh red tomatoes",price:40,stock:3,unit:"kg",sku:"FRS-TOM-002",isActive:!0,isFeatured:!1,trackStock:!0,image:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDE1MCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxNTAiIGhlaWdodD0iMTUwIiBmaWxsPSIjRkVGMkYyIi8+Cjx0ZXh0IHg9Ijc1IiB5PSI3NSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZG9taW5hbnQtYmFzZWxpbmU9ImNlbnRyYWwiIGZpbGw9IiNEQzI2MjYiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNiI+VG9tYXRvPC90ZXh0Pgo8L3N2Zz4="},{id:3,name:"Whole Wheat Bread",category:"Bakery",brand:"Healthy Bakery",description:"Nutritious whole wheat bread",price:35,stock:25,unit:"piece",sku:"WW-BREAD-003",isActive:!0,isFeatured:!1,trackStock:!0,image:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDE1MCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxNTAiIGhlaWdodD0iMTUwIiBmaWxsPSIjRkZGQkVCIi8+Cjx0ZXh0IHg9Ijc1IiB5PSI3NSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZG9taW5hbnQtYmFzZWxpbmU9ImNlbnRyYWwiIGZpbGw9IiNBRjY1MDkiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNiI+QnJlYWQ8L3RleHQ+Cjwvc3ZnPg=="},{id:4,name:"Fresh Milk",category:"Dairy",brand:"Pure Dairy",description:"Fresh pasteurized milk",price:60,stock:0,unit:"liter",sku:"FRS-MILK-004",isActive:!1,isFeatured:!1,trackStock:!0,image:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDE1MCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxNTAiIGhlaWdodD0iMTUwIiBmaWxsPSIjRkNGRkZGIi8+Cjx0ZXh0IHg9Ijc1IiB5PSI3NSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZG9taW5hbnQtYmFzZWxpbmU9ImNlbnRyYWwiIGZpbGw9IiM2Mzc1OEYiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxOCI+TWlsazwvdGV4dD4KPC9zdmc+"}].find(a=>a.id===t);i&&(this.productForm.patchValue({name:i.name,category:i.category,brand:i.brand,description:i.description,price:i.price,stock:i.stock,unit:i.unit,sku:i.sku,isActive:i.isActive,isFeatured:i.isFeatured,trackStock:i.trackStock}),this.imagePreview=i.image)}getDefaultCategories(){return this.categories.map((t,r)=>({id:r+1,name:t,description:`${t} category`,slug:t.toLowerCase().replace(/\s+/g,"-"),parentId:void 0,parentName:void 0,fullPath:t,isActive:!0,sortOrder:r,iconUrl:void 0,createdBy:"system",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),level:0,subcategories:[],hasSubcategories:!1,isRootCategory:!0,productCount:0,subcategoryCount:0}))}flattenCategories(t){const r=[],i=a=>{a.forEach(s=>{r.push(s),s.subcategories&&s.subcategories.length>0&&i(s.subcategories)})};return i(t),r}generateSKU(t){return`${t.substring(0,3).toUpperCase()}${Date.now().toString().slice(-6)}`}generateSingleBarcode(t){var r=this;return(0,fe.A)(function*(){let i="",a=0;for(;a<10&&(i=r.generateRandomBarcode(),yield r.offlineStorage.isBarcodeExists(i));)a++;a>=10?r.snackBar.open("Could not generate unique barcode. Please try again.","Close",{duration:3e3}):r.productForm.patchValue({[t]:i})})()}generateBarcodes(){const t=this.generateRandomBarcode(),r=this.generateRandomBarcode(),i=this.generateRandomBarcode();this.productForm.patchValue({barcode1:t,barcode2:r,barcode3:i}),this.snackBar.open("Barcodes generated!","Close",{duration:2e3})}generateRandomBarcode(){let t="";for(let a=0;a<12;a++)t+=Math.floor(10*Math.random()).toString();let r=0;for(let a=0;a<12;a++){const s=parseInt(t[a],10);r+=a%2==0?s:3*s}return t+(10-r%10)%10}onBarcodeEnter(t,r){t.preventDefault(),setTimeout(()=>{switch(r){case"barcode1":this.barcode1Input?.nativeElement?.focus();break;case"barcode2":this.barcode2Input?.nativeElement?.focus();break;case"barcode3":this.barcode3Input?.nativeElement?.focus();break;case"done":t.target?.blur()}},50)}onImageSelected(t){const r=t.target.files[0];if(r){if(r.size>5242880)return void this.snackBar.open("Image size must be less than 5MB","Close",{duration:3e3});if(!r.type.startsWith("image/"))return void this.snackBar.open("Please select a valid image file","Close",{duration:3e3});this.selectedFile=r;const i=new FileReader;i.onload=a=>{this.imagePreview=a.target?.result},i.readAsDataURL(r)}}removeImage(){this.imagePreview=null,this.selectedFile=null}onSubmit(){if(this.productForm.valid&&this.currentShop){if(!this.currentShop.id||0===this.currentShop.id)return void this.snackBar.open("Shop information not available. Please log out and log in again.","Close",{duration:5e3});const t=this.productForm.value,r=t.barcode1?.trim()||"",i=t.barcode2?.trim()||"",a=t.barcode3?.trim()||"";if(r&&i&&r.toLowerCase()===i.toLowerCase())return void this.snackBar.open("Barcode 1 and Barcode 2 cannot be the same.","Close",{duration:3e3});if(r&&a&&r.toLowerCase()===a.toLowerCase())return void this.snackBar.open("Barcode 1 and Barcode 3 cannot be the same.","Close",{duration:3e3});if(i&&a&&i.toLowerCase()===a.toLowerCase())return void this.snackBar.open("Barcode 2 and Barcode 3 cannot be the same.","Close",{duration:3e3});this.validateBarcodesAndSubmit(t,r,i,a)}}validateBarcodesAndSubmit(t,r,i,a){var s=this;return(0,fe.A)(function*(){const l=yield s.offlineStorage.validateBarcodes(r||null,i||null,a||null);var p;l?s.snackBar.open(l,"Close",{duration:5e3}):navigator.onLine?(s.isLoading=!0,yield Cr(s.httpClient,Oe.c.apiUrl),s.productService.createMasterProduct({name:t.name,nameTamil:t.nameTamil||"",tags:t.tags||"",description:t.description||"",sku:t.sku,categoryId:t.category,brand:t.brand||"",baseUnit:t.unit,status:t.isActive?Dc.S.ACTIVE:Dc.S.INACTIVE,isFeatured:t.isFeatured||!1,isGlobal:!1}).pipe((0,vt.n)(p=>s.shopProductService.addProductToShop(s.currentShop.id,{masterProductId:p.id,price:t.price,originalPrice:t.originalPrice||t.price||0,costPrice:t.costPrice||0,stockQuantity:t.initialStock||0,minStockLevel:t.minStock||0,maxStockLevel:t.maxStock||0,trackInventory:t.trackStock,status:t.isActive?Dc.Q.ACTIVE:Dc.Q.INACTIVE,isAvailable:t.isActive,isFeatured:t.isFeatured||!1,customName:t.name!==p.name?t.name:void 0,customDescription:t.description!==p.description?t.description:void 0}).pipe((0,vt.n)(h=>{if(s.selectedFile){const _=new FormData;return _.append("images",s.selectedFile),s.productService.uploadShopProductImages(s.currentShop.id,h.id,_).pipe((0,wi.T)(()=>h))}return(0,He.of)(h)}))),(0,wt.W)(p=>{console.error("Error creating product:",p),s.isLoading=!1;let f="Failed to create product. Please try again.";throw p.error?.message?f=p.error.message:p.message&&(f=p.message),s.snackBar.open(f,"Close",{duration:5e3,panelClass:["error-snackbar"]}),p})).subscribe({next:(p=(0,fe.A)(function*(f){s.isLoading=!1,localStorage.removeItem("pos_products_last_sync"),localStorage.setItem("pos_products_changed","true");try{const h={id:f.id,shopId:s.currentShop.id,name:f.displayName||f.customName||t.name,nameTamil:t.nameTamil,price:f.price,originalPrice:f.originalPrice||f.price,costPrice:f.costPrice,stock:f.stockQuantity,trackInventory:t.trackStock,isAvailable:f.isAvailable,sku:t.sku||"",barcode:t.barcode1||"",barcode1:t.barcode1||"",barcode2:t.barcode2||"",barcode3:t.barcode3||"",category:t.category||"",unit:t.unit||"piece",imageUrl:f.primaryImageUrl||"",tags:t.tags?t.tags.split(",").map(_=>_.trim()):[]};yield s.offlineStorage.addProductToCache(h),console.log("Added new product to local cache:",h)}catch(h){console.warn("Failed to add product to cache:",h)}s.snackBar.open("Product created and added to your shop successfully!","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["success-snackbar"]}),s.router.navigate(["/shop-owner/my-products"])}),function(h){return p.apply(this,arguments)}),error:()=>{}})):s.saveProductOffline(t)})()}saveDraft(){console.log("Saving as draft:",this.productForm.value),this.snackBar.open("Product saved as draft","Close",{duration:3e3})}resetForm(){this.productForm.reset(),this.removeImage(),this.productForm.patchValue({isActive:!0,isFeatured:!1,trackStock:!0})}markAllFieldsAsTouched(){Object.keys(this.productForm.controls).forEach(t=>{this.productForm.get(t)?.markAsTouched()})}saveProductOffline(t){var r=this;return(0,fe.A)(function*(){if(r.currentShop){r.isLoading=!0;try{const i={offlineProductId:r.offlineStorage.generateOfflineProductId(),shopId:r.currentShop.id,name:t.name?.trim()||"",nameTamil:t.nameTamil?.trim()||"",customName:t.name?.trim()||"",price:t.price||0,originalPrice:t.originalPrice||t.price||0,costPrice:t.costPrice||0,stockQuantity:t.initialStock||0,minStockLevel:t.minStock||0,trackInventory:!1!==t.trackStock,barcode1:t.barcode1?.trim()||"",barcode2:t.barcode2?.trim()||"",barcode3:t.barcode3?.trim()||"",sku:t.sku?.trim()||"",categoryName:r.getCategoryNameById(t.category)||"",categoryId:t.category||void 0,unit:t.unit||"piece",tags:t.tags?.trim()||"",isFeatured:t.isFeatured||!1,tempProductId:r.offlineStorage.generateTempProductId(),createdAt:(new Date).toISOString(),synced:!1};yield r.offlineStorage.saveOfflineProductCreation(i);const s={id:i.tempProductId,shopId:r.currentShop.id,name:i.name,nameTamil:i.nameTamil,price:i.price,originalPrice:i.originalPrice,costPrice:i.costPrice,stock:i.stockQuantity,trackInventory:i.trackInventory,isAvailable:!0,sku:i.sku||"",barcode:i.barcode1||"",barcode1:i.barcode1||"",barcode2:i.barcode2||"",barcode3:i.barcode3||"",category:i.categoryName||"",unit:i.unit||"piece",imageUrl:"",tags:i.tags?i.tags.split(",").map(l=>l.trim()):[]};yield r.offlineStorage.addProductToCache(s),localStorage.removeItem("pos_products_last_sync"),localStorage.setItem("pos_products_changed","true"),r.isLoading=!1,r.snackBar.open("Product saved offline. Will sync when online.","Close",{duration:4e3}),r.router.navigate(["/shop-owner/my-products"])}catch(i){r.isLoading=!1,r.snackBar.open(i?.message||"Failed to save product offline.","Close",{duration:5e3})}}else r.snackBar.open("Shop information not available. Cannot save offline.","Close",{duration:3e3})})()}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(b.ok),e.rXU(Ce.UG),e.rXU(Xe.Ix),e.rXU(Xe.nX),e.rXU(Nk.b),e.rXU(i0.Z),e.rXU(Jt.s),e.rXU(o0.F),e.rXU(Gt.u),e.rXU(at.m),e.rXU(gt.Qq),e.rXU(Pe.bZ))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-add-product"]],viewQuery:function(r,i){if(1&r&&(e.GBs(Ak,5),e.GBs(Dk,5),e.GBs(jk,5)),2&r){let a;e.mGM(a=e.lsd())&&(i.barcode1Input=a.first),e.mGM(a=e.lsd())&&(i.barcode2Input=a.first),e.mGM(a=e.lsd())&&(i.barcode3Input=a.first)}},decls:214,vars:23,consts:[[1,"add-product-container"],[1,"page-header"],[1,"header-left"],["mat-stroked-button","","routerLink","/shop-owner/my-products",1,"back-button"],[1,"header-content"],[1,"page-title"],[1,"page-subtitle"],[1,"form-card"],[1,"product-form",3,"formGroup","ngSubmit"],[1,"form-section"],[1,"section-title"],[1,"form-row"],["appearance","outline",1,"full-width"],["matInput","","formControlName","name","placeholder","Enter product name"],[4,"ngIf"],["appearance","outline",1,"half-width"],["formControlName","category",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"add-new-category-option",3,"value"],["matInput","","formControlName","brand","placeholder","Enter brand name"],["matInput","","formControlName","description","placeholder","Enter product description","rows","3"],["matInput","","formControlName","nameTamil","placeholder","\u0ba4\u0bae\u0bbf\u0bb4\u0bcd \u0baa\u0bc6\u0baf\u0bb0\u0bcd"],["matPrefix",""],["matInput","","formControlName","tags","placeholder","tea, chai, \u0ba4\u0bc7\u0ba8\u0bc0\u0bb0\u0bcd"],["matInput","","type","number","formControlName","price","placeholder","0.00"],["matInput","","type","number","formControlName","originalPrice","placeholder","0.00"],["appearance","outline",1,"third-width"],["matInput","","type","number","formControlName","costPrice","placeholder","0.00"],["formControlName","unit"],["value","kg"],["value","gram"],["value","liter"],["value","ml"],["value","piece"],["value","packet"],["value","dozen"],["matInput","","type","number","formControlName","initialStock","placeholder","0"],["matInput","","type","number","formControlName","minStock","placeholder","0"],["matInput","","type","number","formControlName","maxStock","placeholder","0"],["matInput","","formControlName","sku","placeholder","Enter SKU",3,"keydown.enter"],["matInput","","formControlName","supplier","placeholder","Enter supplier name"],["matInput","","formControlName","location","placeholder","e.g., Aisle 1, Shelf A"],["matInput","","formControlName","expiryDate",3,"matDatepicker"],["matSuffix","",3,"for"],["expiryPicker",""],[1,"barcode-field-group","third-width"],["matInput","","formControlName","barcode1","placeholder","Primary barcode (optional)",3,"keydown.enter"],["barcode1Input",""],["mat-mini-fab","","type","button","color","primary","matTooltip","Generate Barcode 1",1,"generate-single-btn",3,"click"],["matInput","","formControlName","barcode2","placeholder","Secondary barcode (optional)",3,"keydown.enter"],["barcode2Input",""],["mat-mini-fab","","type","button","color","primary","matTooltip","Generate Barcode 2",1,"generate-single-btn",3,"click"],["matInput","","formControlName","barcode3","placeholder","Tertiary barcode (optional)",3,"keydown.enter"],["barcode3Input",""],["mat-mini-fab","","type","button","color","primary","matTooltip","Generate Barcode 3",1,"generate-single-btn",3,"click"],[1,"image-upload-section"],["class","image-preview",4,"ngIf"],["class","upload-area",3,"click",4,"ngIf"],["type","file","hidden","","accept","image/*",3,"change"],["fileInput",""],["class","upload-actions",4,"ngIf"],[1,"settings-row"],["formControlName","isActive"],["formControlName","isFeatured"],["formControlName","trackStock"],[1,"form-actions"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["diameter","20","style","margin-right: 8px;",4,"ngIf"],["style","margin-right: 8px;",4,"ngIf"],["mat-stroked-button","","type","button",3,"disabled","click"],[2,"margin-right","8px"],["mat-button","","type","button",3,"click"],[3,"value"],[1,"image-preview"],["alt","Product preview",1,"preview-image",3,"src"],["mat-icon-button","",1,"remove-image",3,"click"],[1,"upload-area",3,"click"],[1,"upload-icon"],[1,"upload-text"],[1,"upload-hint"],[1,"upload-actions"],["mat-stroked-button","","type","button",3,"click"],["diameter","20",2,"margin-right","8px"]],template:function(r,i){if(1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3)(4,"mat-icon"),e.EFF(5,"arrow_back"),e.k0s(),e.EFF(6," Back to Products "),e.k0s(),e.j41(7,"div",4)(8,"h1",5),e.EFF(9),e.k0s(),e.j41(10,"p",6),e.EFF(11),e.k0s()()()(),e.j41(12,"mat-card",7)(13,"mat-card-header")(14,"mat-card-title")(15,"mat-icon"),e.EFF(16),e.k0s(),e.EFF(17," Product Information "),e.k0s()(),e.j41(18,"mat-card-content")(19,"form",8),e.bIt("ngSubmit",function(){return i.onSubmit()}),e.j41(20,"div",9)(21,"h3",10),e.EFF(22,"Basic Information"),e.k0s(),e.j41(23,"div",11)(24,"mat-form-field",12)(25,"mat-label"),e.EFF(26,"Product Name"),e.k0s(),e.nrm(27,"input",13),e.DNE(28,Bk,2,0,"mat-error",14),e.k0s()(),e.j41(29,"div",11)(30,"mat-form-field",15)(31,"mat-label"),e.EFF(32,"Category"),e.k0s(),e.j41(33,"mat-select",16),e.bIt("selectionChange",function(s){return i.onCategorySelectChange(s.value)}),e.DNE(34,Lk,2,2,"mat-option",17),e.j41(35,"mat-option",18)(36,"mat-icon"),e.EFF(37,"add"),e.k0s(),e.EFF(38," Add New Category "),e.k0s()(),e.DNE(39,$k,2,0,"mat-error",14),e.k0s(),e.j41(40,"mat-form-field",15)(41,"mat-label"),e.EFF(42,"Brand"),e.k0s(),e.nrm(43,"input",19),e.k0s()(),e.j41(44,"div",11)(45,"mat-form-field",12)(46,"mat-label"),e.EFF(47,"Description"),e.k0s(),e.nrm(48,"textarea",20),e.k0s()(),e.j41(49,"div",11)(50,"mat-form-field",15)(51,"mat-label"),e.EFF(52,"Tamil Name"),e.k0s(),e.nrm(53,"input",21),e.j41(54,"mat-icon",22),e.EFF(55,"translate"),e.k0s(),e.j41(56,"mat-hint"),e.EFF(57,"Product name in Tamil for voice search"),e.k0s()(),e.j41(58,"mat-form-field",15)(59,"mat-label"),e.EFF(60,"Voice Search Tags"),e.k0s(),e.nrm(61,"input",23),e.j41(62,"mat-icon",22),e.EFF(63,"mic"),e.k0s(),e.j41(64,"mat-hint"),e.EFF(65,"Comma-separated tags (English and Tamil)"),e.k0s()()()(),e.j41(66,"div",9)(67,"h3",10),e.EFF(68,"Pricing & Stock"),e.k0s(),e.j41(69,"div",11)(70,"mat-form-field",15)(71,"mat-label"),e.EFF(72,"Selling Price (\u20b9)*"),e.k0s(),e.nrm(73,"input",24),e.DNE(74,Gk,2,0,"mat-error",14),e.DNE(75,Uk,2,0,"mat-error",14),e.k0s(),e.j41(76,"mat-form-field",15)(77,"mat-label"),e.EFF(78,"Original Price / MRP (\u20b9)"),e.k0s(),e.nrm(79,"input",25),e.j41(80,"mat-hint"),e.EFF(81,"For discounts: Set higher than selling price"),e.k0s()()(),e.j41(82,"div",11)(83,"mat-form-field",26)(84,"mat-label"),e.EFF(85,"Cost Price (\u20b9)"),e.k0s(),e.nrm(86,"input",27),e.k0s(),e.j41(87,"mat-form-field",26)(88,"mat-label"),e.EFF(89,"Unit*"),e.k0s(),e.j41(90,"mat-select",28)(91,"mat-option",29),e.EFF(92,"Kilogram (kg)"),e.k0s(),e.j41(93,"mat-option",30),e.EFF(94,"Gram (g)"),e.k0s(),e.j41(95,"mat-option",31),e.EFF(96,"Liter (l)"),e.k0s(),e.j41(97,"mat-option",32),e.EFF(98,"Milliliter (ml)"),e.k0s(),e.j41(99,"mat-option",33),e.EFF(100,"Piece"),e.k0s(),e.j41(101,"mat-option",34),e.EFF(102,"Packet"),e.k0s(),e.j41(103,"mat-option",35),e.EFF(104,"Dozen"),e.k0s()(),e.DNE(105,zk,2,0,"mat-error",14),e.k0s()(),e.j41(106,"div",11)(107,"mat-form-field",26)(108,"mat-label"),e.EFF(109,"Initial Stock"),e.k0s(),e.nrm(110,"input",36),e.DNE(111,Vk,2,0,"mat-error",14),e.DNE(112,Yk,2,0,"mat-error",14),e.k0s(),e.j41(113,"mat-form-field",26)(114,"mat-label"),e.EFF(115,"Minimum Stock Alert"),e.k0s(),e.nrm(116,"input",37),e.k0s(),e.j41(117,"mat-form-field",26)(118,"mat-label"),e.EFF(119,"Maximum Stock"),e.k0s(),e.nrm(120,"input",38),e.k0s()()(),e.j41(121,"div",9)(122,"h3",10),e.EFF(123,"Product Details"),e.k0s(),e.j41(124,"div",11)(125,"mat-form-field",15)(126,"mat-label"),e.EFF(127,"SKU"),e.k0s(),e.j41(128,"input",39),e.bIt("keydown.enter",function(s){return i.onBarcodeEnter(s,"barcode1")}),e.k0s()(),e.j41(129,"mat-form-field",15)(130,"mat-label"),e.EFF(131,"Supplier"),e.k0s(),e.nrm(132,"input",40),e.k0s()(),e.j41(133,"div",11)(134,"mat-form-field",15)(135,"mat-label"),e.EFF(136,"Shelf Location"),e.k0s(),e.nrm(137,"input",41),e.k0s(),e.j41(138,"mat-form-field",15)(139,"mat-label"),e.EFF(140,"Expiry Date"),e.k0s(),e.nrm(141,"input",42)(142,"mat-datepicker-toggle",43)(143,"mat-datepicker",null,44),e.k0s()()(),e.j41(145,"div",9)(146,"h3",10),e.EFF(147,"Product Barcodes"),e.k0s(),e.j41(148,"div",11)(149,"div",45)(150,"mat-form-field",12)(151,"mat-label"),e.EFF(152,"Barcode 1"),e.k0s(),e.j41(153,"input",46,47),e.bIt("keydown.enter",function(s){return i.onBarcodeEnter(s,"barcode2")}),e.k0s(),e.j41(155,"mat-icon",22),e.EFF(156,"qr_code"),e.k0s()(),e.j41(157,"button",48),e.bIt("click",function(){return i.generateSingleBarcode("barcode1")}),e.j41(158,"mat-icon"),e.EFF(159,"autorenew"),e.k0s()()(),e.j41(160,"div",45)(161,"mat-form-field",12)(162,"mat-label"),e.EFF(163,"Barcode 2"),e.k0s(),e.j41(164,"input",49,50),e.bIt("keydown.enter",function(s){return i.onBarcodeEnter(s,"barcode3")}),e.k0s(),e.j41(166,"mat-icon",22),e.EFF(167,"qr_code"),e.k0s()(),e.j41(168,"button",51),e.bIt("click",function(){return i.generateSingleBarcode("barcode2")}),e.j41(169,"mat-icon"),e.EFF(170,"autorenew"),e.k0s()()(),e.j41(171,"div",45)(172,"mat-form-field",12)(173,"mat-label"),e.EFF(174,"Barcode 3"),e.k0s(),e.j41(175,"input",52,53),e.bIt("keydown.enter",function(s){return i.onBarcodeEnter(s,"done")}),e.k0s(),e.j41(177,"mat-icon",22),e.EFF(178,"qr_code"),e.k0s()(),e.j41(179,"button",54),e.bIt("click",function(){return i.generateSingleBarcode("barcode3")}),e.j41(180,"mat-icon"),e.EFF(181,"autorenew"),e.k0s()()()()(),e.j41(182,"div",9)(183,"h3",10),e.EFF(184,"Product Image"),e.k0s(),e.j41(185,"div",55),e.DNE(186,Xk,5,1,"div",56),e.DNE(187,Hk,7,0,"div",57),e.j41(188,"input",58,59),e.bIt("change",function(s){return i.onImageSelected(s)}),e.k0s(),e.DNE(190,Wk,5,0,"div",60),e.k0s()(),e.j41(191,"div",9)(192,"h3",10),e.EFF(193,"Product Settings"),e.k0s(),e.j41(194,"div",61)(195,"mat-checkbox",62),e.EFF(196," Active (Available for sale) "),e.k0s(),e.j41(197,"mat-checkbox",63),e.EFF(198," Featured Product "),e.k0s(),e.j41(199,"mat-checkbox",64),e.EFF(200," Track Stock Levels "),e.k0s()()(),e.j41(201,"div",65)(202,"button",66),e.DNE(203,qk,1,0,"mat-spinner",67),e.DNE(204,Zk,2,0,"mat-icon",68),e.EFF(205),e.k0s(),e.j41(206,"button",69),e.bIt("click",function(){return i.saveDraft()}),e.j41(207,"mat-icon",70),e.EFF(208,"draft"),e.k0s(),e.EFF(209," Save as Draft "),e.k0s(),e.j41(210,"button",71),e.bIt("click",function(){return i.resetForm()}),e.j41(211,"mat-icon",70),e.EFF(212,"refresh"),e.k0s(),e.EFF(213," Reset Form "),e.k0s()()()()()()),2&r){const a=e.sdS(144);let s,l,u,p,f,h,_;e.R7$(9),e.JRh(i.isEditMode?"Edit Product":"Add New Product"),e.R7$(2),e.JRh(i.isEditMode?"Update product information":"Add products to your shop inventory"),e.R7$(5),e.JRh(i.isEditMode?"edit":"add_box"),e.R7$(3),e.Y8G("formGroup",i.productForm),e.R7$(9),e.Y8G("ngIf",null==(s=i.productForm.get("name"))?null:s.hasError("required")),e.R7$(6),e.Y8G("ngForOf",i.productCategories),e.R7$(1),e.Y8G("value","__NEW__"),e.R7$(4),e.Y8G("ngIf",null==(l=i.productForm.get("category"))?null:l.hasError("required")),e.R7$(35),e.Y8G("ngIf",null==(u=i.productForm.get("price"))?null:u.hasError("required")),e.R7$(1),e.Y8G("ngIf",null==(p=i.productForm.get("price"))?null:p.hasError("min")),e.R7$(30),e.Y8G("ngIf",null==(f=i.productForm.get("unit"))?null:f.hasError("required")),e.R7$(6),e.Y8G("ngIf",null==(h=i.productForm.get("initialStock"))?null:h.hasError("required")),e.R7$(1),e.Y8G("ngIf",null==(_=i.productForm.get("initialStock"))?null:_.hasError("min")),e.R7$(29),e.Y8G("matDatepicker",a),e.R7$(1),e.Y8G("for",a),e.R7$(44),e.Y8G("ngIf",i.imagePreview),e.R7$(1),e.Y8G("ngIf",!i.imagePreview),e.R7$(3),e.Y8G("ngIf",i.imagePreview),e.R7$(12),e.Y8G("disabled",i.productForm.invalid||i.isLoading),e.R7$(1),e.Y8G("ngIf",i.isLoading),e.R7$(1),e.Y8G("ngIf",!i.isLoading),e.R7$(1),e.SpI(" ",i.isEditMode?"Update Product":"Save Product"," "),e.R7$(1),e.Y8G("disabled",i.isLoading)}},dependencies:[D.Sq,D.bT,b.qT,b.me,b.Q0,b.BC,b.cb,b.j4,b.JD,Xe.Wk,j.RN,j.m2,j.MM,j.dh,B.$z,B.iY,B.$0,H.An,X.LG,ge.rl,ge.nJ,ge.MV,ge.TL,ge.JW,ge.yw,Ee.fg,ze.VO,Bt.wT,qe.oV,Et.Vh,Et.bZ,Et.bU,it.So],styles:[".add-product-container[_ngcontent-%COMP%]{padding:24px;background-color:#f5f5f5;min-height:calc(100vh - 64px)}.page-header[_ngcontent-%COMP%]{margin-bottom:24px}.header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.back-button[_ngcontent-%COMP%]{min-width:auto;height:40px}.page-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:600;margin:0 0 4px;color:#1f2937}.page-subtitle[_ngcontent-%COMP%]{font-size:1rem;color:#6b7280;margin:0}.form-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #0000001a;max-width:1000px;margin:0 auto}.form-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{background:#f8f9fa;margin:-16px -16px 24px;padding:16px;border-radius:12px 12px 0 0}.form-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:1.2rem;font-weight:500}.product-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:32px}.form-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.section-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:#374151;margin:0 0 8px;padding-bottom:8px;border-bottom:2px solid #e5e7eb}.barcode-field-group[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:6px}.barcode-field-group[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1}.generate-single-btn[_ngcontent-%COMP%]{margin-top:4px;width:32px!important;height:32px!important;min-width:32px!important;min-height:32px!important}.generate-single-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:flex-start}.full-width[_ngcontent-%COMP%]{width:100%}.half-width[_ngcontent-%COMP%]{flex:1}.third-width[_ngcontent-%COMP%]{flex:1;min-width:200px}.image-upload-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.image-preview[_ngcontent-%COMP%]{position:relative;width:200px;height:200px;border-radius:8px;overflow:hidden;border:2px solid #e5e7eb}.preview-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.remove-image[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;background:rgba(0,0,0,.7);color:#fff}.upload-area[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:300px;height:200px;border:2px dashed #d1d5db;border-radius:8px;cursor:pointer;transition:border-color .2s ease;background:#fafafa}.upload-area[_ngcontent-%COMP%]:hover{border-color:#6366f1;background:#f8faff}.upload-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#6b7280;margin-bottom:8px}.upload-text[_ngcontent-%COMP%]{font-weight:500;color:#374151;margin:0 0 4px}.upload-hint[_ngcontent-%COMP%]{font-size:.8rem;color:#6b7280;margin:0}.upload-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.settings-row[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.form-actions[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:16px;padding-top:24px;border-top:1px solid #e5e7eb}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:48px}@media (max-width: 768px){.add-product-container[_ngcontent-%COMP%]{padding:16px}.page-header[_ngcontent-%COMP%]{flex-direction:column;gap:16px;text-align:center}.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.half-width[_ngcontent-%COMP%], .third-width[_ngcontent-%COMP%]{width:100%}.page-title[_ngcontent-%COMP%]{font-size:1.5rem}.form-actions[_ngcontent-%COMP%]{flex-direction:column}.upload-area[_ngcontent-%COMP%]{width:100%}.image-preview[_ngcontent-%COMP%]{width:150px;height:150px;align-self:center}}"]})}}return n})();function Qk(n,o){if(1&n){const t=e.RV6();e.j41(0,"mat-card",14)(1,"mat-card-header")(2,"mat-card-title")(3,"mat-icon"),e.EFF(4,"download"),e.k0s(),e.EFF(5," Step 1: Download Template "),e.k0s()(),e.j41(6,"mat-card-content")(7,"div",15)(8,"div",16)(9,"h3"),e.EFF(10,"CSV Template Columns"),e.k0s(),e.j41(11,"div",17)(12,"div",18)(13,"mat-icon"),e.EFF(14,"star"),e.k0s(),e.j41(15,"span"),e.EFF(16,"Product Name"),e.k0s()(),e.j41(17,"div",18)(18,"mat-icon"),e.EFF(19,"star"),e.k0s(),e.j41(20,"span"),e.EFF(21,"Category"),e.k0s()(),e.j41(22,"div",18)(23,"mat-icon"),e.EFF(24,"star"),e.k0s(),e.j41(25,"span"),e.EFF(26,"Price"),e.k0s()(),e.j41(27,"div",18)(28,"mat-icon"),e.EFF(29,"star"),e.k0s(),e.j41(30,"span"),e.EFF(31,"Unit"),e.k0s()(),e.j41(32,"div",18)(33,"mat-icon"),e.EFF(34,"star"),e.k0s(),e.j41(35,"span"),e.EFF(36,"Initial Stock"),e.k0s()(),e.j41(37,"div",19)(38,"mat-icon"),e.EFF(39,"info"),e.k0s(),e.j41(40,"span"),e.EFF(41,"Brand"),e.k0s()(),e.j41(42,"div",19)(43,"mat-icon"),e.EFF(44,"info"),e.k0s(),e.j41(45,"span"),e.EFF(46,"Description"),e.k0s()(),e.j41(47,"div",19)(48,"mat-icon"),e.EFF(49,"info"),e.k0s(),e.j41(50,"span"),e.EFF(51,"Cost Price"),e.k0s()(),e.j41(52,"div",19)(53,"mat-icon"),e.EFF(54,"info"),e.k0s(),e.j41(55,"span"),e.EFF(56,"Min Stock"),e.k0s()(),e.j41(57,"div",19)(58,"mat-icon"),e.EFF(59,"info"),e.k0s(),e.j41(60,"span"),e.EFF(61,"Max Stock"),e.k0s()(),e.j41(62,"div",19)(63,"mat-icon"),e.EFF(64,"info"),e.k0s(),e.j41(65,"span"),e.EFF(66,"SKU"),e.k0s()(),e.j41(67,"div",19)(68,"mat-icon"),e.EFF(69,"info"),e.k0s(),e.j41(70,"span"),e.EFF(71,"Supplier"),e.k0s()()(),e.j41(72,"div",20)(73,"div",21)(74,"mat-icon",22),e.EFF(75,"star"),e.k0s(),e.j41(76,"span"),e.EFF(77,"Required Fields"),e.k0s()(),e.j41(78,"div",21)(79,"mat-icon",23),e.EFF(80,"info"),e.k0s(),e.j41(81,"span"),e.EFF(82,"Optional Fields"),e.k0s()()()(),e.j41(83,"div",24)(84,"button",25),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.downloadTemplate())}),e.j41(85,"mat-icon"),e.EFF(86,"download"),e.k0s(),e.EFF(87," Download CSV Template "),e.k0s(),e.j41(88,"button",26),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.downloadSample())}),e.j41(89,"mat-icon"),e.EFF(90,"description"),e.k0s(),e.EFF(91," Download Sample Data "),e.k0s()(),e.j41(92,"div",27)(93,"h4"),e.EFF(94,"Guidelines:"),e.k0s(),e.j41(95,"ul")(96,"li"),e.EFF(97,"Use the exact column names as shown in the template"),e.k0s(),e.j41(98,"li"),e.EFF(99,"Categories must match existing categories in your shop"),e.k0s(),e.j41(100,"li"),e.EFF(101,"Units: kg, gram, liter, ml, piece, packet, dozen"),e.k0s(),e.j41(102,"li"),e.EFF(103,"Prices should be in rupees (\u20b9)"),e.k0s(),e.j41(104,"li"),e.EFF(105,"Stock quantities should be whole numbers"),e.k0s(),e.j41(106,"li"),e.EFF(107,"SKU should be unique if provided"),e.k0s()()()()(),e.j41(108,"mat-card-actions")(109,"button",25),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.nextStep())}),e.j41(110,"mat-icon"),e.EFF(111,"arrow_forward"),e.k0s(),e.EFF(112," Next: Fill Data "),e.k0s()()()}}function Jk(n,o){if(1&n){const t=e.RV6();e.j41(0,"mat-card",14)(1,"mat-card-header")(2,"mat-card-title")(3,"mat-icon"),e.EFF(4,"edit"),e.k0s(),e.EFF(5," Step 2: Fill Product Data "),e.k0s()(),e.j41(6,"mat-card-content")(7,"div",28)(8,"div",29)(9,"h3"),e.EFF(10,"Fill Your Product Information"),e.k0s(),e.j41(11,"p"),e.EFF(12,"Open the downloaded CSV template in Excel or Google Sheets and fill in your product data."),e.k0s(),e.j41(13,"div",30)(14,"h4"),e.EFF(15,"Tips for better results:"),e.k0s(),e.j41(16,"div",31)(17,"div",32)(18,"mat-icon"),e.EFF(19,"lightbulb"),e.k0s(),e.j41(20,"div")(21,"strong"),e.EFF(22,"Product Names:"),e.k0s(),e.j41(23,"p"),e.EFF(24,'Use clear, descriptive names like "Organic Basmati Rice 1kg"'),e.k0s()()(),e.j41(25,"div",32)(26,"mat-icon"),e.EFF(27,"category"),e.k0s(),e.j41(28,"div")(29,"strong"),e.EFF(30,"Categories:"),e.k0s(),e.j41(31,"p"),e.EFF(32),e.k0s()()(),e.j41(33,"div",32)(34,"mat-icon"),e.EFF(35,"format_list_numbered"),e.k0s(),e.j41(36,"div")(37,"strong"),e.EFF(38,"Numbers:"),e.k0s(),e.j41(39,"p"),e.EFF(40,"Use plain numbers without currency symbols or commas"),e.k0s()()(),e.j41(41,"div",32)(42,"mat-icon"),e.EFF(43,"warning"),e.k0s(),e.j41(44,"div")(45,"strong"),e.EFF(46,"Empty Cells:"),e.k0s(),e.j41(47,"p"),e.EFF(48,"Leave optional fields empty if not applicable"),e.k0s()()()()()()()(),e.j41(49,"mat-card-actions")(50,"button",33),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.previousStep())}),e.j41(51,"mat-icon"),e.EFF(52,"arrow_back"),e.k0s(),e.EFF(53," Previous "),e.k0s(),e.j41(54,"button",25),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.nextStep())}),e.j41(55,"mat-icon"),e.EFF(56,"arrow_forward"),e.k0s(),e.EFF(57," Next: Upload File "),e.k0s()()()}if(2&n){const t=e.XpG();e.R7$(32),e.SpI("Use exact category names: ",t.categories.join(", "),"")}}function Kk(n,o){1&n&&(e.j41(0,"div",44)(1,"mat-icon",45),e.EFF(2,"cloud_upload"),e.k0s(),e.j41(3,"h3"),e.EFF(4,"Choose your CSV file"),e.k0s(),e.j41(5,"p"),e.EFF(6,"Click here or drag and drop your completed CSV file"),e.k0s(),e.j41(7,"small"),e.EFF(8,"Supported formats: .csv, .xlsx (Max 10MB)"),e.k0s()())}function eO(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",46)(1,"mat-icon",47),e.EFF(2,"description"),e.k0s(),e.j41(3,"div",48)(4,"h4"),e.EFF(5),e.k0s(),e.j41(6,"p"),e.EFF(7),e.k0s()(),e.j41(8,"button",49),e.bIt("click",function(i){e.eBV(t);const a=e.XpG(2);return e.Njj(a.removeFile(i))}),e.j41(9,"mat-icon"),e.EFF(10,"close"),e.k0s()()()}if(2&n){const t=e.XpG(2);e.R7$(5),e.JRh(t.selectedFile.name),e.R7$(2),e.JRh(t.formatFileSize(t.selectedFile.size))}}function tO(n,o){if(1&n&&(e.j41(0,"div",50),e.nrm(1,"mat-spinner",51),e.j41(2,"h4"),e.EFF(3,"Processing your file..."),e.k0s(),e.j41(4,"p"),e.EFF(5),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(5),e.SpI("",t.uploadProgress,"% complete")}}function nO(n,o){if(1&n){const t=e.RV6();e.j41(0,"mat-card",14)(1,"mat-card-header")(2,"mat-card-title")(3,"mat-icon"),e.EFF(4,"cloud_upload"),e.k0s(),e.EFF(5," Step 3: Upload Your File "),e.k0s()(),e.j41(6,"mat-card-content")(7,"div",34)(8,"div",35),e.bIt("click",function(){e.eBV(t);const i=e.sdS(13);return e.Njj(i.click())}),e.DNE(9,Kk,9,0,"div",36),e.DNE(10,eO,11,2,"div",37),e.DNE(11,tO,6,1,"div",38),e.k0s(),e.j41(12,"input",39,40),e.bIt("change",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.onFileSelected(i))}),e.k0s(),e.j41(14,"div",41)(15,"h4"),e.EFF(16,"File Requirements:"),e.k0s(),e.j41(17,"ul")(18,"li"),e.EFF(19,"File format: CSV or Excel (.xlsx, .xls)"),e.k0s(),e.j41(20,"li"),e.EFF(21,"Maximum file size: 10MB"),e.k0s(),e.j41(22,"li"),e.EFF(23,"Maximum 1000 products per upload"),e.k0s(),e.j41(24,"li"),e.EFF(25,"Use the provided template format"),e.k0s()()()()(),e.j41(26,"mat-card-actions")(27,"button",42),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.previousStep())}),e.j41(28,"mat-icon"),e.EFF(29,"arrow_back"),e.k0s(),e.EFF(30," Previous "),e.k0s(),e.j41(31,"button",43),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.processFile())}),e.j41(32,"mat-icon"),e.EFF(33,"arrow_forward"),e.k0s(),e.EFF(34," Process File "),e.k0s()()()}if(2&n){const t=e.XpG();e.R7$(8),e.AVh("has-file",t.selectedFile)("uploading",t.isUploading),e.R7$(1),e.Y8G("ngIf",!t.selectedFile&&!t.isUploading),e.R7$(1),e.Y8G("ngIf",t.selectedFile&&!t.isUploading),e.R7$(1),e.Y8G("ngIf",t.isUploading),e.R7$(16),e.Y8G("disabled",t.isUploading),e.R7$(4),e.Y8G("disabled",!t.selectedFile||t.isUploading)}}function rO(n,o){if(1&n&&(e.j41(0,"div",66)(1,"mat-icon"),e.EFF(2,"check_circle"),e.k0s(),e.j41(3,"div")(4,"h3"),e.EFF(5),e.k0s(),e.j41(6,"p"),e.EFF(7,"Products Ready"),e.k0s()()()),2&n){const t=e.XpG(3);e.R7$(5),e.JRh(t.uploadResult.successfulRows)}}function iO(n,o){if(1&n&&(e.j41(0,"div",67)(1,"mat-icon"),e.EFF(2,"error"),e.k0s(),e.j41(3,"div")(4,"h3"),e.EFF(5),e.k0s(),e.j41(6,"p"),e.EFF(7,"Errors Found"),e.k0s()()()),2&n){const t=e.XpG(3);e.R7$(5),e.JRh(t.uploadResult.errorRows)}}function oO(n,o){1&n&&(e.j41(0,"th",79),e.EFF(1,"Row"),e.k0s())}function aO(n,o){if(1&n&&(e.j41(0,"td",80),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.R7$(1),e.JRh(t.row)}}function sO(n,o){1&n&&(e.j41(0,"th",79),e.EFF(1,"Field"),e.k0s())}function cO(n,o){if(1&n&&(e.j41(0,"td",80),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.R7$(1),e.JRh(t.field)}}function lO(n,o){1&n&&(e.j41(0,"th",79),e.EFF(1,"Error"),e.k0s())}function dO(n,o){if(1&n&&(e.j41(0,"td",80),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.R7$(1),e.JRh(t.error)}}function uO(n,o){1&n&&(e.j41(0,"th",79),e.EFF(1,"Value"),e.k0s())}function gO(n,o){if(1&n&&(e.j41(0,"td",80),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.R7$(1),e.JRh(t.value)}}function pO(n,o){1&n&&e.nrm(0,"tr",81)}function fO(n,o){1&n&&e.nrm(0,"tr",82)}function mO(n,o){if(1&n&&(e.j41(0,"div",68)(1,"h3"),e.EFF(2,"Errors to Fix:"),e.k0s(),e.j41(3,"div",69)(4,"table",70),e.qex(5,71),e.DNE(6,oO,2,0,"th",72),e.DNE(7,aO,2,1,"td",73),e.bVm(),e.qex(8,74),e.DNE(9,sO,2,0,"th",72),e.DNE(10,cO,2,1,"td",73),e.bVm(),e.qex(11,75),e.DNE(12,lO,2,0,"th",72),e.DNE(13,dO,2,1,"td",73),e.bVm(),e.qex(14,76),e.DNE(15,uO,2,0,"th",72),e.DNE(16,gO,2,1,"td",73),e.bVm(),e.DNE(17,pO,1,0,"tr",77),e.DNE(18,fO,1,0,"tr",78),e.k0s()()()),2&n){const t=e.XpG(3);e.R7$(4),e.Y8G("dataSource",t.uploadResult.errors),e.R7$(13),e.Y8G("matHeaderRowDef",t.errorColumns),e.R7$(1),e.Y8G("matRowDefColumns",t.errorColumns)}}function hO(n,o){if(1&n&&(e.j41(0,"mat-radio-button",83),e.EFF(1),e.k0s()),2&n){const t=e.XpG(3);e.R7$(1),e.SpI(" Import only valid products (",t.uploadResult.successfulRows," products) ")}}function _O(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",56)(1,"div",57),e.DNE(2,rO,8,1,"div",58),e.DNE(3,iO,8,1,"div",59),e.j41(4,"div",60)(5,"mat-icon"),e.EFF(6,"description"),e.k0s(),e.j41(7,"div")(8,"h3"),e.EFF(9),e.k0s(),e.j41(10,"p"),e.EFF(11,"Total Rows"),e.k0s()()()(),e.DNE(12,mO,19,3,"div",61),e.j41(13,"div",62)(14,"h3"),e.EFF(15,"Import Options:"),e.k0s(),e.j41(16,"mat-radio-group",63),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.Njj(a.importOption=i)}),e.DNE(17,hO,2,1,"mat-radio-button",64),e.j41(18,"mat-radio-button",65),e.EFF(19," Import all products (fix errors first) "),e.k0s()()()()}if(2&n){const t=e.XpG(2);e.R7$(2),e.Y8G("ngIf",t.uploadResult.successfulRows>0),e.R7$(1),e.Y8G("ngIf",t.uploadResult.errorRows>0),e.R7$(6),e.JRh(t.uploadResult.totalRows),e.R7$(3),e.Y8G("ngIf",t.uploadResult.errors&&t.uploadResult.errors.length>0),e.R7$(4),e.Y8G("ngModel",t.importOption),e.R7$(1),e.Y8G("ngIf",t.uploadResult.successfulRows>0),e.R7$(1),e.Y8G("disabled",t.uploadResult.errorRows>0)}}function xO(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",33),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.downloadErrorReport())}),e.j41(1,"mat-icon"),e.EFF(2,"download"),e.k0s(),e.EFF(3," Download Error Report "),e.k0s()}}function CO(n,o){1&n&&e.nrm(0,"mat-spinner",84)}function vO(n,o){1&n&&(e.j41(0,"mat-icon"),e.EFF(1,"save"),e.k0s())}function PO(n,o){if(1&n){const t=e.RV6();e.j41(0,"mat-card",14)(1,"mat-card-header")(2,"mat-card-title")(3,"mat-icon"),e.EFF(4,"check_circle"),e.k0s(),e.EFF(5," Step 4: Review & Import "),e.k0s()(),e.j41(6,"mat-card-content"),e.DNE(7,_O,20,7,"div",52),e.k0s(),e.j41(8,"mat-card-actions")(9,"button",33),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.previousStep())}),e.j41(10,"mat-icon"),e.EFF(11,"arrow_back"),e.k0s(),e.EFF(12," Upload Different File "),e.k0s(),e.DNE(13,xO,4,0,"button",53),e.j41(14,"button",43),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.importProducts())}),e.DNE(15,CO,1,0,"mat-spinner",54),e.DNE(16,vO,2,0,"mat-icon",55),e.EFF(17," Import Products "),e.k0s()()()}if(2&n){const t=e.XpG();e.R7$(7),e.Y8G("ngIf",t.uploadResult),e.R7$(6),e.Y8G("ngIf",t.uploadResult&&t.uploadResult.errors&&t.uploadResult.errors.length>0),e.R7$(1),e.Y8G("disabled",!t.uploadResult||!t.uploadResult.successfulRows||0===t.uploadResult.successfulRows||t.isImporting),e.R7$(1),e.Y8G("ngIf",t.isImporting),e.R7$(1),e.Y8G("ngIf",!t.isImporting)}}let bO=(()=>{class n{constructor(t,r,i,a){this.snackBar=t,this.router=r,this.shopProductService=i,this.authService=a,this.currentStep=1,this.selectedFile=null,this.isUploading=!1,this.isImporting=!1,this.uploadProgress=0,this.uploadResult=null,this.importOption="valid",this.errorColumns=["row","field","error","value"],this.categories=["Groceries","Vegetables","Fruits","Dairy Products","Bakery Items","Beverages","Snacks","Personal Care","Household Items","Frozen Foods"]}ngOnInit(){}nextStep(){this.currentStep<4&&this.currentStep++}previousStep(){this.currentStep>1&&this.currentStep--}downloadTemplate(){const r=["Product Name","Category","Price","Unit","Initial Stock","Brand","Description","Cost Price","Min Stock","Max Stock","SKU","Supplier"].join(","),i=new Blob([r],{type:"text/csv"}),a=window.URL.createObjectURL(i),s=document.createElement("a");s.href=a,s.download="product_upload_template.csv",s.click(),window.URL.revokeObjectURL(a),this.snackBar.open("Template downloaded successfully","Close",{duration:3e3})}downloadSample(){const i=[["Product Name","Category","Price","Unit","Initial Stock","Brand","Description","Cost Price","Min Stock","Max Stock","SKU","Supplier"],["Organic Basmati Rice","Groceries","120","kg","50","Nature Fresh","Premium quality organic basmati rice","90","10","100","ORG001","ABC Suppliers"],["Fresh Tomatoes","Vegetables","40","kg","25","","Fresh red tomatoes","25","5","50","VEG002","Local Farm"],["Whole Wheat Bread","Bakery Items","35","piece","20","Daily Fresh","Healthy whole wheat bread","20","5","30","BAK003","Bakery Co"]].map(u=>u.join(",")).join("\n"),a=new Blob([i],{type:"text/csv"}),s=window.URL.createObjectURL(a),l=document.createElement("a");l.href=s,l.download="product_sample_data.csv",l.click(),window.URL.revokeObjectURL(s),this.snackBar.open("Sample data downloaded successfully","Close",{duration:3e3})}onFileSelected(t){const r=t.target.files[0];if(r){if(r.size>10485760)return void this.snackBar.open("File size must be less than 10MB","Close",{duration:3e3});const i=[".csv",".xlsx",".xls"],a=r.name.toLowerCase().substring(r.name.lastIndexOf("."));if(!i.includes(a))return void this.snackBar.open("Please select a CSV or Excel file","Close",{duration:3e3});this.selectedFile=r}}removeFile(t){t.stopPropagation(),this.selectedFile=null}formatFileSize(t){if(0===t)return"0 Bytes";const a=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]}processFile(){if(!this.selectedFile)return;const t=this.authService.getCurrentUser();if(!t||!t.shopId)return void this.snackBar.open("Shop information not found","Close",{duration:3e3});this.isUploading=!0,this.uploadProgress=0;const r=new FormData;r.append("file",this.selectedFile),r.append("shopId",t.shopId.toString()),this.shopProductService.bulkUploadProducts(r).subscribe({next:i=>{switch(i.type){case gt.hv.UploadProgress:i.total&&(this.uploadProgress=Math.round(100*i.loaded/i.total));break;case gt.hv.Response:this.isUploading=!1,this.uploadProgress=100,i.body&&i.body.success?(this.uploadResult={fileName:this.selectedFile?.name||"uploaded_file.csv",totalRows:i.body.totalRows||0,successfulRows:i.body.successfulRows||0,errorRows:i.body.errorRows||0,errors:i.body.errors||[]},this.nextStep()):this.snackBar.open("Upload failed: "+(i.body.message||"Unknown error"),"Close",{duration:5e3})}},error:i=>{this.isUploading=!1,this.uploadProgress=0,console.error("Bulk upload error:",i),this.snackBar.open("API not available. Using demo mode.","Close",{duration:3e3}),this.simulateMockUpload()}})}simulateMockUpload(){const t=setInterval(()=>{this.uploadProgress+=10,this.uploadProgress>=100&&(clearInterval(t),this.isUploading=!1,this.uploadResult={fileName:this.selectedFile?.name||"uploaded_file.csv",totalRows:10,successfulRows:8,errorRows:2,errors:[{row:3,field:"Price",error:"Price must be a positive number",value:"invalid"},{row:7,field:"Category",error:"Category not found",value:"Unknown Category"}]},this.nextStep())},200)}downloadErrorReport(){if(!this.uploadResult||!this.uploadResult.errors||0===this.uploadResult.errors.length)return;const i=[["Row","Field","Error","Value"],...this.uploadResult.errors.map(u=>[u.row,u.field,u.error,u.value])].map(u=>u.join(",")).join("\n"),a=new Blob([i],{type:"text/csv"}),s=window.URL.createObjectURL(a),l=document.createElement("a");l.href=s,l.download="upload_errors_report.csv",l.click(),window.URL.revokeObjectURL(s),this.snackBar.open("Error report downloaded","Close",{duration:3e3})}importProducts(){!this.uploadResult||!this.uploadResult.successfulRows||0===this.uploadResult.successfulRows||(this.isImporting=!0,setTimeout(()=>{this.isImporting=!1,this.snackBar.open(`Successfully imported ${this.uploadResult?.successfulRows||0} products!`,"Close",{duration:5e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["success-snackbar"]}),this.router.navigate(["/shop-owner/my-products"])},3e3))}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(Ce.UG),e.rXU(Xe.Ix),e.rXU(i0.Z),e.rXU(Gt.u))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-bulk-upload"]],decls:63,vars:12,consts:[[1,"bulk-upload-container"],[1,"page-header"],[1,"header-content"],[1,"page-title"],[1,"page-subtitle"],[1,"header-actions"],["mat-stroked-button","","routerLink","/shop-owner/my-products"],[1,"upload-steps"],[1,"step-card"],[1,"step-content"],[1,"step-number"],[1,"step-info"],[1,"step-arrow"],["class","main-card",4,"ngIf"],[1,"main-card"],[1,"template-section"],[1,"template-info"],[1,"columns-grid"],[1,"column-item","required"],[1,"column-item","optional"],[1,"legend"],[1,"legend-item"],[1,"required-icon"],[1,"optional-icon"],[1,"template-actions"],["mat-raised-button","","color","primary",3,"click"],["mat-stroked-button","",3,"click"],[1,"guidelines"],[1,"fill-data-section"],[1,"instructions"],[1,"tips"],[1,"tips-grid"],[1,"tip-item"],["mat-button","",3,"click"],[1,"upload-section"],[1,"upload-area",3,"click"],["class","upload-content",4,"ngIf"],["class","file-info",4,"ngIf"],["class","uploading-info",4,"ngIf"],["type","file","hidden","","accept",".csv,.xlsx,.xls",3,"change"],["fileInput",""],[1,"file-requirements"],["mat-button","",3,"disabled","click"],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"upload-content"],[1,"upload-icon"],[1,"file-info"],[1,"file-icon"],[1,"file-details"],["mat-icon-button","",1,"remove-file",3,"click"],[1,"uploading-info"],["diameter","48"],["class","review-section",4,"ngIf"],["mat-button","",3,"click",4,"ngIf"],["diameter","20","style","margin-right: 8px;",4,"ngIf"],[4,"ngIf"],[1,"review-section"],[1,"result-summary"],["class","summary-card success",4,"ngIf"],["class","summary-card error",4,"ngIf"],[1,"summary-card","total"],["class","errors-section",4,"ngIf"],[1,"import-options"],[3,"ngModel","ngModelChange"],["value","valid",4,"ngIf"],["value","all",3,"disabled"],[1,"summary-card","success"],[1,"summary-card","error"],[1,"errors-section"],[1,"errors-table"],["mat-table","",1,"errors-table-content",3,"dataSource"],["matColumnDef","row"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","field"],["matColumnDef","error"],["matColumnDef","value"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],["value","valid"],["diameter","20",2,"margin-right","8px"]],template:function(r,i){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),e.EFF(4,"Bulk Product Upload"),e.k0s(),e.j41(5,"p",4),e.EFF(6,"Upload multiple products using CSV/Excel files"),e.k0s()(),e.j41(7,"div",5)(8,"button",6)(9,"mat-icon"),e.EFF(10,"arrow_back"),e.k0s(),e.EFF(11," Back to Products "),e.k0s()()(),e.j41(12,"div",7)(13,"mat-card",8)(14,"mat-card-content")(15,"div",9)(16,"div",10),e.EFF(17,"1"),e.k0s(),e.j41(18,"div",11)(19,"h3"),e.EFF(20,"Download Template"),e.k0s(),e.j41(21,"p"),e.EFF(22,"Get the CSV template with required columns"),e.k0s()()()()(),e.j41(23,"mat-icon",12),e.EFF(24,"arrow_forward"),e.k0s(),e.j41(25,"mat-card",8)(26,"mat-card-content")(27,"div",9)(28,"div",10),e.EFF(29,"2"),e.k0s(),e.j41(30,"div",11)(31,"h3"),e.EFF(32,"Fill Data"),e.k0s(),e.j41(33,"p"),e.EFF(34,"Add your product information to the template"),e.k0s()()()()(),e.j41(35,"mat-icon",12),e.EFF(36,"arrow_forward"),e.k0s(),e.j41(37,"mat-card",8)(38,"mat-card-content")(39,"div",9)(40,"div",10),e.EFF(41,"3"),e.k0s(),e.j41(42,"div",11)(43,"h3"),e.EFF(44,"Upload File"),e.k0s(),e.j41(45,"p"),e.EFF(46,"Upload your completed CSV file"),e.k0s()()()()(),e.j41(47,"mat-icon",12),e.EFF(48,"arrow_forward"),e.k0s(),e.j41(49,"mat-card",8)(50,"mat-card-content")(51,"div",9)(52,"div",10),e.EFF(53,"4"),e.k0s(),e.j41(54,"div",11)(55,"h3"),e.EFF(56,"Review & Import"),e.k0s(),e.j41(57,"p"),e.EFF(58,"Validate and import your products"),e.k0s()()()()()(),e.DNE(59,Qk,113,0,"mat-card",13),e.DNE(60,Jk,58,1,"mat-card",13),e.DNE(61,nO,35,9,"mat-card",13),e.DNE(62,PO,18,5,"mat-card",13),e.k0s()),2&r&&(e.R7$(13),e.AVh("active",1===i.currentStep),e.R7$(12),e.AVh("active",2===i.currentStep),e.R7$(12),e.AVh("active",3===i.currentStep),e.R7$(12),e.AVh("active",4===i.currentStep),e.R7$(10),e.Y8G("ngIf",1===i.currentStep),e.R7$(1),e.Y8G("ngIf",2===i.currentStep),e.R7$(1),e.Y8G("ngIf",3===i.currentStep),e.R7$(1),e.Y8G("ngIf",4===i.currentStep))},dependencies:[D.bT,b.BC,b.vS,Xe.Wk,j.RN,j.YY,j.m2,j.MM,j.dh,B.$z,B.iY,H.An,X.LG,_e.Zl,_e.tL,_e.ji,_e.cC,_e.YV,_e.iL,_e.KS,_e.$R,_e.YZ,_e.NB,Ze.VT,Ze._g],styles:[".bulk-upload-container[_ngcontent-%COMP%]{padding:24px;background-color:#f5f5f5;min-height:calc(100vh - 64px)}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.page-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:600;margin:0 0 4px;color:#1f2937}.page-subtitle[_ngcontent-%COMP%]{font-size:1rem;color:#6b7280;margin:0}.header-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.upload-steps[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin-bottom:32px;gap:16px}.step-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #0000001a;transition:all .3s ease;opacity:.6}.step-card.active[_ngcontent-%COMP%]{opacity:1;transform:scale(1.05);box-shadow:0 4px 16px #3b82f633;border:2px solid #3b82f6}.step-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:8px}.step-number[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;background:#e5e7eb;color:#6b7280;display:flex;align-items:center;justify-content:center;font-weight:600}.step-card.active[_ngcontent-%COMP%]   .step-number[_ngcontent-%COMP%]{background:#3b82f6;color:#fff}.step-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 2px;font-size:.9rem;font-weight:600;color:#374151}.step-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.8rem;color:#6b7280}.step-arrow[_ngcontent-%COMP%]{color:#d1d5db;font-size:20px}.main-card[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;border-radius:12px;box-shadow:0 2px 8px #0000001a}.main-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{background:#f8f9fa;margin:-16px -16px 24px;padding:16px;border-radius:12px 12px 0 0}.main-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:1.2rem;font-weight:500}.columns-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;margin:16px 0}.column-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 12px;border-radius:8px;font-size:.9rem}.column-item.required[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.column-item.optional[_ngcontent-%COMP%]{background:#e0f2fe;color:#0277bd}.legend[_ngcontent-%COMP%]{display:flex;gap:24px;margin:16px 0}.legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:.9rem}.required-icon[_ngcontent-%COMP%]{color:#f59e0b}.optional-icon[_ngcontent-%COMP%]{color:#0284c7}.template-actions[_ngcontent-%COMP%]{display:flex;gap:12px;margin:24px 0}.guidelines[_ngcontent-%COMP%]{background:#f8f9fa;padding:16px;border-radius:8px;margin-top:16px}.guidelines[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;color:#374151}.guidelines[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding-left:20px;color:#6b7280}.guidelines[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:4px}.tips-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px;margin:16px 0}.tip-item[_ngcontent-%COMP%]{display:flex;gap:12px;padding:12px;background:#f8f9fa;border-radius:8px}.tip-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#6366f1;margin-top:2px}.tip-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#374151;font-size:.9rem}.tip-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0 0;font-size:.8rem;color:#6b7280}.upload-area[_ngcontent-%COMP%]{border:2px dashed #d1d5db;border-radius:12px;padding:48px 24px;text-align:center;cursor:pointer;transition:all .3s ease;background:#fafafa;margin-bottom:24px}.upload-area[_ngcontent-%COMP%]:hover{border-color:#6366f1;background:#f8faff}.upload-area.has-file[_ngcontent-%COMP%]{border-color:#10b981;background:#f0fdf4}.upload-area.uploading[_ngcontent-%COMP%]{border-color:#f59e0b;background:#fffbeb}.upload-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#6b7280;margin-bottom:16px}.upload-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;color:#374151}.upload-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 16px;color:#6b7280}.upload-content[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#9ca3af}.file-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;max-width:400px;margin:0 auto}.file-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#10b981}.file-details[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 4px;color:#374151}.file-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:.9rem}.remove-file[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.uploading-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:16px}.uploading-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;color:#374151}.uploading-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#6b7280}.file-requirements[_ngcontent-%COMP%]{background:#f8f9fa;padding:16px;border-radius:8px}.file-requirements[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;color:#374151}.file-requirements[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding-left:20px;color:#6b7280}.result-summary[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:24px}.summary-card[_ngcontent-%COMP%]{flex:1;padding:16px;border-radius:8px;display:flex;align-items:center;gap:12px}.summary-card.success[_ngcontent-%COMP%]{background:#dcfce7;color:#16a34a}.summary-card.error[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626}.summary-card.total[_ngcontent-%COMP%]{background:#e0f2fe;color:#0277bd}.summary-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:600}.summary-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.9rem}.errors-section[_ngcontent-%COMP%]{margin-bottom:24px}.errors-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 16px;color:#dc2626}.errors-table[_ngcontent-%COMP%]{border:1px solid #e5e7eb;border-radius:8px;overflow:hidden}.errors-table-content[_ngcontent-%COMP%]{width:100%}.import-options[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 12px;color:#374151}@media (max-width: 768px){.bulk-upload-container[_ngcontent-%COMP%]{padding:16px}.page-header[_ngcontent-%COMP%]{flex-direction:column;gap:16px;text-align:center}.upload-steps[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.step-arrow[_ngcontent-%COMP%]{transform:rotate(90deg)}.columns-grid[_ngcontent-%COMP%], .tips-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.template-actions[_ngcontent-%COMP%], .result-summary[_ngcontent-%COMP%]{flex-direction:column}.legend[_ngcontent-%COMP%]{flex-direction:column;gap:12px}}"]})}}return n})();function kO(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",31)(1,"div",32)(2,"mat-icon"),e.EFF(3,"category"),e.k0s()(),e.j41(4,"h3"),e.EFF(5,"No Categories Found"),e.k0s(),e.j41(6,"p"),e.EFF(7,"Start organizing your products by creating categories"),e.k0s(),e.j41(8,"button",33),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.openAddDialog())}),e.j41(9,"mat-icon"),e.EFF(10,"add"),e.k0s(),e.EFF(11," Create First Category "),e.k0s()()}}function OO(n,o){if(1&n){const t=e.RV6();e.j41(0,"img",55),e.bIt("error",function(i){e.eBV(t);const a=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.onImageError(i,a))}),e.k0s()}if(2&n){const t=e.XpG().$implicit,r=e.XpG(2);e.FS9("alt",t.name),e.Y8G("src",r.getCategoryImageUrl(t.iconUrl),e.B4B)}}function yO(n,o){if(1&n&&(e.j41(0,"mat-icon",56),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.xc7("color",t.color),e.R7$(1),e.JRh(t.icon)}}function MO(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",36)(1,"div",37)(2,"div",38),e.DNE(3,OO,1,2,"img",39),e.DNE(4,yO,2,3,"mat-icon",40),e.k0s(),e.j41(5,"div",41)(6,"span",42)(7,"mat-icon",43),e.EFF(8),e.k0s(),e.EFF(9),e.k0s()()(),e.j41(10,"div",44)(11,"h3",45),e.EFF(12),e.k0s(),e.j41(13,"p",46),e.EFF(14),e.k0s()(),e.j41(15,"div",47)(16,"div",48)(17,"mat-icon",13),e.EFF(18,"inventory"),e.k0s(),e.j41(19,"span",49),e.EFF(20),e.k0s()(),e.j41(21,"div",48)(22,"mat-icon",13),e.EFF(23,"schedule"),e.k0s(),e.j41(24,"span",49),e.EFF(25),e.nI1(26,"date"),e.k0s()()(),e.j41(27,"div",50)(28,"button",51),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.editCategory(a))}),e.j41(29,"mat-icon"),e.EFF(30,"edit"),e.k0s(),e.EFF(31," Edit "),e.k0s(),e.j41(32,"button",52),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.viewProducts(a))}),e.j41(33,"mat-icon"),e.EFF(34,"visibility"),e.k0s(),e.EFF(35," Products "),e.k0s(),e.j41(36,"button",53),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.toggleCategoryStatus(a))}),e.j41(37,"mat-icon"),e.EFF(38),e.k0s(),e.EFF(39),e.k0s(),e.j41(40,"button",54),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.deleteCategory(a))}),e.j41(41,"mat-icon"),e.EFF(42,"delete"),e.k0s(),e.EFF(43," Delete "),e.k0s()()()}if(2&n){const t=o.$implicit;e.R7$(2),e.xc7("background-color",t.color+"20"),e.R7$(1),e.Y8G("ngIf",t.iconUrl),e.R7$(1),e.Y8G("ngIf",!t.iconUrl),e.R7$(2),e.AVh("active",t.isActive)("inactive",!t.isActive),e.R7$(2),e.SpI(" ",t.isActive?"check_circle":"cancel"," "),e.R7$(1),e.SpI(" ",t.isActive?"Active":"Inactive"," "),e.R7$(3),e.JRh(t.name),e.R7$(2),e.JRh(t.description||"No description available"),e.R7$(6),e.SpI("",t.productCount||0," products"),e.R7$(5),e.JRh(e.i5U(26,21,t.createdAt,"MMM dd")),e.R7$(11),e.AVh("activate",!t.isActive)("deactivate",t.isActive),e.R7$(2),e.JRh(t.isActive?"pause":"play_arrow"),e.R7$(1),e.SpI(" ",t.isActive?"Deactivate":"Activate"," "),e.R7$(1),e.Y8G("disabled",t.productCount>0)}}function wO(n,o){if(1&n&&(e.j41(0,"div",34),e.DNE(1,MO,44,24,"div",35),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.categories)}}function FO(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",57),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeQuickAdd())}),e.k0s()}}function EO(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",83),e.bIt("click",function(){e.eBV(t),e.XpG();const i=e.sdS(18);return e.Njj(i.click())})("dragover",function(i){e.eBV(t);const a=e.XpG(2);return e.Njj(a.onDragOver(i))})("dragleave",function(i){e.eBV(t);const a=e.XpG(2);return e.Njj(a.onDragLeave(i))})("drop",function(i){e.eBV(t);const a=e.XpG(2);return e.Njj(a.onDrop(i))}),e.j41(1,"mat-icon",84),e.EFF(2,"cloud_upload"),e.k0s(),e.j41(3,"h3"),e.EFF(4,"Click to Upload Category Image"),e.k0s(),e.j41(5,"p"),e.EFF(6,"or drag and drop"),e.k0s(),e.j41(7,"span",85),e.EFF(8,"PNG, JPG, GIF up to 5MB"),e.k0s()()}if(2&n){const t=e.XpG(2);e.AVh("dragover",t.isDragging)}}function SO(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",86),e.nrm(1,"img",87),e.j41(2,"div",88)(3,"button",89),e.bIt("click",function(){e.eBV(t),e.XpG();const i=e.sdS(18);return e.Njj(i.click())}),e.j41(4,"mat-icon"),e.EFF(5,"edit"),e.k0s()(),e.j41(6,"button",90),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.removeImage())}),e.j41(7,"mat-icon"),e.EFF(8,"delete"),e.k0s()()()()}if(2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("src",t.previewImageUrl,e.B4B)}}function TO(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Category name is required "),e.k0s())}function IO(n,o){if(1&n&&(e.j41(0,"mat-option",91)(1,"mat-icon"),e.EFF(2),e.k0s(),e.EFF(3),e.k0s()),2&n){const t=o.$implicit;e.Y8G("value",t.value),e.R7$(2),e.JRh(t.value),e.R7$(1),e.SpI(" ",t.label," ")}}function RO(n,o){if(1&n&&(e.j41(0,"mat-option",91)(1,"div",92),e.nrm(2,"div",93),e.EFF(3),e.k0s()()),2&n){const t=o.$implicit;e.Y8G("value",t.value),e.R7$(2),e.xc7("background-color",t.value),e.R7$(1),e.SpI(" ",t.label," ")}}function NO(n,o){1&n&&e.nrm(0,"mat-spinner",94)}function AO(n,o){1&n&&(e.j41(0,"mat-icon"),e.EFF(1,"save"),e.k0s())}function DO(n,o){if(1&n){const t=e.RV6();e.j41(0,"mat-card",58)(1,"mat-card-header")(2,"mat-card-title"),e.EFF(3,"Add New Category"),e.k0s(),e.j41(4,"button",59),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeQuickAdd())}),e.j41(5,"mat-icon"),e.EFF(6,"close"),e.k0s()()(),e.j41(7,"mat-card-content")(8,"form",60),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.submitQuickAdd())}),e.j41(9,"div",61)(10,"label",62)(11,"mat-icon"),e.EFF(12,"image"),e.k0s(),e.EFF(13," Category Image "),e.j41(14,"span",63),e.EFF(15,"*"),e.k0s()(),e.j41(16,"div",64)(17,"input",65,66),e.bIt("change",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.onImageSelected(i))}),e.k0s(),e.DNE(19,EO,9,2,"div",67),e.DNE(20,SO,9,1,"div",68),e.k0s()(),e.j41(21,"div",69)(22,"mat-form-field",70)(23,"mat-label"),e.EFF(24,"Category Name"),e.k0s(),e.nrm(25,"input",71),e.j41(26,"mat-icon",72),e.EFF(27,"category"),e.k0s(),e.DNE(28,TO,2,0,"mat-error",73),e.k0s()(),e.j41(29,"div",69)(30,"mat-form-field",70)(31,"mat-label"),e.EFF(32,"Description"),e.k0s(),e.nrm(33,"textarea",74),e.j41(34,"mat-icon",72),e.EFF(35,"description"),e.k0s()()(),e.j41(36,"div",69)(37,"mat-form-field",75)(38,"mat-label"),e.EFF(39,"Icon (Fallback)"),e.k0s(),e.j41(40,"mat-select",76),e.DNE(41,IO,4,3,"mat-option",77),e.k0s(),e.j41(42,"mat-icon",72),e.EFF(43,"emoji_symbols"),e.k0s()(),e.j41(44,"mat-form-field",75)(45,"mat-label"),e.EFF(46,"Theme Color"),e.k0s(),e.j41(47,"mat-select",78),e.DNE(48,RO,4,4,"mat-option",77),e.k0s(),e.j41(49,"mat-icon",72),e.EFF(50,"palette"),e.k0s()()(),e.j41(51,"div",79)(52,"button",80),e.DNE(53,NO,1,0,"mat-spinner",81),e.DNE(54,AO,2,0,"mat-icon",73),e.EFF(55),e.k0s(),e.j41(56,"button",82),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeQuickAdd())}),e.EFF(57," Cancel "),e.k0s()()()()()}if(2&n){const t=e.XpG();let r;e.R7$(8),e.Y8G("formGroup",t.quickAddForm),e.R7$(11),e.Y8G("ngIf",!t.previewImageUrl),e.R7$(1),e.Y8G("ngIf",t.previewImageUrl),e.R7$(8),e.Y8G("ngIf",null==(r=t.quickAddForm.get("name"))?null:r.hasError("required")),e.R7$(13),e.Y8G("ngForOf",t.availableIcons),e.R7$(7),e.Y8G("ngForOf",t.availableColors),e.R7$(4),e.Y8G("disabled",t.quickAddForm.invalid||t.loading),e.R7$(1),e.Y8G("ngIf",t.loading),e.R7$(1),e.Y8G("ngIf",!t.loading),e.R7$(1),e.SpI(" ",t.loading?"Creating...":"Create Category"," ")}}function jO(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",95),e.bIt("click",function(){const a=e.eBV(t).category,s=e.XpG();return e.Njj(s.editCategory(a))}),e.j41(1,"mat-icon"),e.EFF(2,"edit"),e.k0s(),e.j41(3,"span"),e.EFF(4,"Edit Category"),e.k0s()(),e.j41(5,"button",95),e.bIt("click",function(){const a=e.eBV(t).category,s=e.XpG();return e.Njj(s.viewProducts(a))}),e.j41(6,"mat-icon"),e.EFF(7,"inventory_2"),e.k0s(),e.j41(8,"span"),e.EFF(9),e.k0s()(),e.j41(10,"button",95),e.bIt("click",function(){const a=e.eBV(t).category,s=e.XpG();return e.Njj(s.duplicateCategory(a))}),e.j41(11,"mat-icon"),e.EFF(12,"content_copy"),e.k0s(),e.j41(13,"span"),e.EFF(14,"Duplicate"),e.k0s()(),e.nrm(15,"mat-divider"),e.j41(16,"button",95),e.bIt("click",function(){const a=e.eBV(t).category,s=e.XpG();return e.Njj(s.toggleCategoryStatus(a))}),e.j41(17,"mat-icon"),e.EFF(18),e.k0s(),e.j41(19,"span"),e.EFF(20),e.k0s()(),e.j41(21,"button",96),e.bIt("click",function(){const a=e.eBV(t).category,s=e.XpG();return e.Njj(s.deleteCategory(a))}),e.j41(22,"mat-icon"),e.EFF(23,"delete"),e.k0s(),e.j41(24,"span"),e.EFF(25,"Delete Category"),e.k0s()()}if(2&n){const t=o.category;e.R7$(9),e.SpI("View Products (",t.productCount,")"),e.R7$(9),e.JRh(t.isActive?"visibility_off":"visibility"),e.R7$(2),e.JRh(t.isActive?"Deactivate":"Activate"),e.R7$(1),e.Y8G("disabled",t.productCount>0)}}let s0=(()=>{class n{constructor(t,r,i,a,s){this.fb=t,this.dialog=r,this.snackBar=i,this.categoryService=a,this.swal=s,this.previewImageUrl=null,this.selectedImageFile=null,this.isDragging=!1,this.categories=[{id:1,name:"Groceries",description:"Essential food items and cooking ingredients",productCount:45,isActive:!0,color:"#10b981",icon:"shopping_basket",iconUrl:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=200&h=200&fit=crop",createdAt:new Date("2024-01-15")},{id:2,name:"Vegetables",description:"Fresh vegetables and leafy greens",productCount:32,isActive:!0,color:"#22c55e",icon:"eco",iconUrl:"https://images.unsplash.com/photo-1540420773420-3366772f4999?w=200&h=200&fit=crop",createdAt:new Date("2024-01-16")},{id:3,name:"Fruits",description:"Fresh seasonal fruits",productCount:28,isActive:!0,color:"#f59e0b",icon:"apple",iconUrl:"https://images.unsplash.com/photo-1619566636858-adf3ef46400b?w=200&h=200&fit=crop",createdAt:new Date("2024-01-17")},{id:4,name:"Dairy Products",description:"Milk, cheese, yogurt and dairy items",productCount:15,isActive:!0,color:"#3b82f6",icon:"local_drink",iconUrl:"https://images.unsplash.com/photo-1563636619-e9143da7973b?w=200&h=200&fit=crop",createdAt:new Date("2024-01-18")},{id:5,name:"Bakery Items",description:"Fresh bread, cakes and baked goods",productCount:12,isActive:!0,color:"#8b5cf6",icon:"cake",iconUrl:"https://images.unsplash.com/photo-1509440159596-0249088772ff?w=200&h=200&fit=crop",createdAt:new Date("2024-01-19")},{id:6,name:"Personal Care",description:"Health and hygiene products",productCount:8,isActive:!1,color:"#ec4899",icon:"face",iconUrl:"https://images.unsplash.com/photo-1556228720-195a672e8a03?w=200&h=200&fit=crop",createdAt:new Date("2024-01-20")}],this.showQuickAdd=!1,this.availableIcons=[{value:"shopping_basket",label:"Shopping Basket"},{value:"eco",label:"Eco/Nature"},{value:"apple",label:"Apple/Fruit"},{value:"local_drink",label:"Drinks"},{value:"cake",label:"Cake/Bakery"},{value:"face",label:"Personal Care"},{value:"home",label:"Household"},{value:"fastfood",label:"Fast Food"},{value:"local_grocery_store",label:"Grocery Store"},{value:"restaurant",label:"Restaurant"}],this.availableColors=[{value:"#10b981",label:"Green"},{value:"#22c55e",label:"Light Green"},{value:"#f59e0b",label:"Orange"},{value:"#3b82f6",label:"Blue"},{value:"#8b5cf6",label:"Purple"},{value:"#ec4899",label:"Pink"},{value:"#ef4444",label:"Red"},{value:"#06b6d4",label:"Cyan"},{value:"#84cc16",label:"Lime"},{value:"#f97316",label:"Orange Red"}],this.loading=!1,this.quickAddForm=this.fb.group({name:["",b.k0.required],description:[""],icon:["shopping_basket",b.k0.required],color:["#10b981",b.k0.required]})}ngOnInit(){this.loadCategories()}loadCategories(){this.loading=!0,this.categoryService.getCategories().pipe((0,qr.j)(()=>this.loading=!1)).subscribe({next:t=>{const r=Array.isArray(t)?t:t.content||[];this.categories=r.map(i=>({id:i.id,name:i.name,description:i.description||"",productCount:i.productCount||0,isActive:!1!==i.active,color:this.getRandomColor(),icon:this.getCategoryIcon(i.name),iconUrl:i.iconUrl||i.imageUrl||void 0,createdAt:new Date(i.createdAt||Date.now())}))},error:t=>{console.error("Error loading categories:",t),this.snackBar.open("Failed to load categories. Showing sample data.","Close",{duration:3e3})}})}getRandomColor(){const t=["#10b981","#3b82f6","#8b5cf6","#f59e0b","#ef4444","#06b6d4","#84cc16","#f97316"];return t[Math.floor(Math.random()*t.length)]}getCategoryIcon(t){const r={groceries:"shopping_basket",electronics:"devices",fashion:"style",home:"home",kitchen:"kitchen",health:"health_and_safety",beauty:"face_6",sports:"sports",books:"menu_book",toys:"toys"},i=t.toLowerCase();for(const[a,s]of Object.entries(r))if(i.includes(a))return s;return"category"}openAddDialog(){this.showQuickAdd=!0}closeQuickAdd(){this.showQuickAdd=!1,this.quickAddForm.reset({icon:"shopping_basket",color:"#10b981"}),this.resetImageUpload()}submitQuickAdd(){if(this.quickAddForm.valid){const t=this.quickAddForm.value;this.selectedImageFile?this.uploadCategoryWithImage(t):this.createCategory(t)}}uploadCategoryWithImage(t){const r=new FormData;r.append("name",t.name),r.append("description",t.description||""),this.selectedImageFile&&r.append("image",this.selectedImageFile),this.loading=!0,this.categoryService.createCategoryWithImage(r).subscribe({next:i=>{const a={id:i.id,name:i.name,description:i.description||"",productCount:0,isActive:!1!==i.isActive,color:t.color||this.getRandomColor(),icon:t.icon||this.getCategoryIcon(i.name),iconUrl:i.iconUrl||void 0,createdAt:new Date(i.createdAt||Date.now())};this.categories.unshift(a),this.closeQuickAdd(),this.resetImageUpload(),this.loading=!1,this.swal.success("Success!","Category added successfully with image!")},error:i=>{console.error("Error creating category with image:",i),this.loading=!1,this.swal.error("Error","Failed to create category. Please try again.")}})}createCategory(t){this.categories.unshift({id:this.categories.length+1,name:t.name,description:t.description||`Products related to ${t.name}`,productCount:0,isActive:!0,color:t.color,icon:t.icon,createdAt:new Date}),this.closeQuickAdd(),this.snackBar.open("Category added successfully!","Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:["success-snackbar"]})}onImageSelected(t){const r=t.target;r.files&&r.files[0]&&this.processImageFile(r.files[0])}onDragOver(t){t.preventDefault(),t.stopPropagation(),this.isDragging=!0}onDragLeave(t){t.preventDefault(),t.stopPropagation(),this.isDragging=!1}onDrop(t){t.preventDefault(),t.stopPropagation(),this.isDragging=!1;const r=t.dataTransfer?.files;if(r&&r.length>0){const i=r[0];i.type.startsWith("image/")?this.processImageFile(i):this.swal.error("Invalid File","Please drop an image file")}}processImageFile(t){if(t.size>5242880)return void this.swal.error("File Too Large","Image size should be less than 5MB");if(!["image/jpeg","image/png","image/gif","image/webp"].includes(t.type))return void this.swal.error("Invalid File Type","Please select a valid image file (JPEG, PNG, GIF, or WebP)");this.selectedImageFile=t;const i=new FileReader;i.onload=a=>{this.previewImageUrl=a.target?.result},i.readAsDataURL(t)}removeImage(){this.previewImageUrl=null,this.selectedImageFile=null}resetImageUpload(){this.previewImageUrl=null,this.selectedImageFile=null}editCategory(t){console.log("Edit category:",t)}viewProducts(t){console.log("View products for category:",t)}duplicateCategory(t){const r={...t,id:this.categories.length+1,name:`${t.name} (Copy)`,productCount:0,createdAt:new Date};this.categories.unshift(r),this.snackBar.open("Category duplicated successfully","Close",{duration:3e3})}toggleCategoryStatus(t){t.isActive=!t.isActive,this.swal.toast(`Category ${t.isActive?"activated":"deactivated"} successfully`,"success")}deleteCategory(t){t.productCount>0?this.swal.warning("Cannot Delete","This category contains products. Please remove all products first."):this.swal.confirmDelete(t.name).then(r=>{if(r.isConfirmed){const i=this.categories.indexOf(t);this.categories.splice(i,1),this.swal.success("Deleted!",`Category "${t.name}" has been deleted.`)}})}getTotalCategories(){return this.categories.length}getActiveCategories(){return this.categories.filter(t=>t.isActive).length}getTotalProducts(){return this.categories.reduce((t,r)=>t+r.productCount,0)}getAverageProducts(){const t=this.getActiveCategories();return t>0?Math.round(this.getTotalProducts()/t):0}getCategoryImageUrl(t){if(!t)return"";if(t.startsWith("http://")||t.startsWith("https://"))return t;const r="http://localhost:8080";return t.startsWith("/")?r+t:r+"/"+t}onImageError(t,r){const i=t.target;i&&(i.style.display="none"),r.iconUrl=void 0}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(b.ok),e.rXU(Pe.bZ),e.rXU(Ce.UG),e.rXU(o0.F),e.rXU(Wd))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-categories"]],decls:87,vars:7,consts:[[1,"categories-container"],[1,"page-header"],[1,"header-content"],[1,"breadcrumb"],[1,"breadcrumb-item"],[1,"breadcrumb-separator"],[1,"breadcrumb-item","active"],[1,"page-title"],[1,"page-description"],[1,"header-actions"],["mat-raised-button","",1,"action-button",3,"click"],[1,"stats-row"],[1,"stat-card"],[1,"stat-icon"],[1,"stat-content"],[1,"stat-value"],[1,"stat-label"],[1,"stat-card","active"],[1,"categories-section"],[1,"modern-card"],[1,"card-header"],[1,"card-title"],[1,"card-actions"],["mat-icon-button","","matTooltip","Refresh",3,"click"],["mat-icon-button","","matTooltip","Add Category",3,"click"],["class","empty-state",4,"ngIf"],["class","categories-grid",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],["class","quick-add-card",4,"ngIf"],["categoryMenu","matMenu"],["matMenuContent",""],[1,"empty-state"],[1,"empty-icon"],["mat-raised-button","","color","primary",3,"click"],[1,"categories-grid"],["class","category-card",4,"ngFor","ngForOf"],[1,"category-card"],[1,"category-card-header"],[1,"category-icon-wrapper"],["class","category-image",3,"src","alt","error",4,"ngIf"],["class","category-main-icon",3,"color",4,"ngIf"],[1,"category-badges"],[1,"badge"],[1,"badge-icon"],[1,"category-info"],[1,"category-name"],[1,"category-description"],[1,"category-stats"],[1,"stat-item"],[1,"stat-text"],[1,"category-actions"],["mat-button","",1,"action-btn","edit",3,"click"],["mat-button","",1,"action-btn","view",3,"click"],["mat-button","",1,"action-btn","toggle",3,"click"],["mat-button","",1,"action-btn","delete",3,"disabled","click"],[1,"category-image",3,"src","alt","error"],[1,"category-main-icon"],[1,"modal-overlay",3,"click"],[1,"quick-add-card"],["mat-icon-button","",3,"click"],[1,"quick-form",3,"formGroup","ngSubmit"],[1,"image-upload-section"],[1,"section-label"],[1,"required"],[1,"image-upload-area"],["type","file","accept","image/*",2,"display","none",3,"change"],["fileInput",""],["class","upload-placeholder",3,"dragover","click","dragleave","drop",4,"ngIf"],["class","image-preview-large",4,"ngIf"],[1,"form-row"],["appearance","outline",1,"full-width"],["matInput","","formControlName","name","placeholder","Enter category name"],["matPrefix",""],[4,"ngIf"],["matInput","","formControlName","description","placeholder","Enter category description","rows","3"],["appearance","outline",1,"half-width"],["formControlName","icon"],[3,"value",4,"ngFor","ngForOf"],["formControlName","color"],[1,"form-actions"],["mat-raised-button","","color","primary","type","submit",1,"submit-btn",3,"disabled"],["diameter","20","class","button-spinner",4,"ngIf"],["mat-button","","type","button",3,"click"],[1,"upload-placeholder",3,"click","dragover","dragleave","drop"],[1,"upload-icon"],[1,"file-info"],[1,"image-preview-large"],["alt","Category Preview",3,"src"],[1,"image-actions"],["mat-icon-button","","type","button","matTooltip","Change Image",1,"change-image-btn",3,"click"],["mat-icon-button","","type","button","matTooltip","Remove Image",1,"remove-image-btn",3,"click"],[3,"value"],[1,"color-option"],[1,"color-swatch"],["diameter","20",1,"button-spinner"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"warn-menu-item",3,"disabled","click"]],template:function(r,i){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4)(5,"mat-icon"),e.EFF(6,"dashboard"),e.k0s(),e.EFF(7," Dashboard "),e.k0s(),e.j41(8,"mat-icon",5),e.EFF(9,"chevron_right"),e.k0s(),e.j41(10,"span",4),e.EFF(11,"Shop-owner"),e.k0s(),e.j41(12,"mat-icon",5),e.EFF(13,"chevron_right"),e.k0s(),e.j41(14,"span",4),e.EFF(15,"Products"),e.k0s(),e.j41(16,"mat-icon",5),e.EFF(17,"chevron_right"),e.k0s(),e.j41(18,"span",6),e.EFF(19,"Categories"),e.k0s()(),e.j41(20,"h1",7),e.EFF(21,"Product Categories"),e.k0s(),e.j41(22,"p",8),e.EFF(23," Organize your products into hierarchical categories "),e.k0s()(),e.j41(24,"div",9)(25,"button",10),e.bIt("click",function(){return i.openAddDialog()}),e.j41(26,"mat-icon"),e.EFF(27,"add_circle"),e.k0s(),e.EFF(28," Add Category "),e.k0s()()(),e.j41(29,"div",11)(30,"div",12)(31,"div",13)(32,"mat-icon"),e.EFF(33,"category"),e.k0s()(),e.j41(34,"div",14)(35,"div",15),e.EFF(36),e.k0s(),e.j41(37,"div",16),e.EFF(38,"Total Categories"),e.k0s()()(),e.j41(39,"div",17)(40,"div",13)(41,"mat-icon"),e.EFF(42,"check_circle"),e.k0s()(),e.j41(43,"div",14)(44,"div",15),e.EFF(45),e.k0s(),e.j41(46,"div",16),e.EFF(47,"Active Categories"),e.k0s()()(),e.j41(48,"div",12)(49,"div",13)(50,"mat-icon"),e.EFF(51,"account_tree"),e.k0s()(),e.j41(52,"div",14)(53,"div",15),e.EFF(54,"0"),e.k0s(),e.j41(55,"div",16),e.EFF(56,"Subcategories"),e.k0s()()(),e.j41(57,"div",12)(58,"div",13)(59,"mat-icon"),e.EFF(60,"inventory"),e.k0s()(),e.j41(61,"div",14)(62,"div",15),e.EFF(63),e.k0s(),e.j41(64,"div",16),e.EFF(65,"Products"),e.k0s()()()(),e.j41(66,"div",18)(67,"mat-card",19)(68,"div",20)(69,"h3",21)(70,"mat-icon"),e.EFF(71,"account_tree"),e.k0s(),e.EFF(72," Category Hierarchy "),e.k0s(),e.j41(73,"div",22)(74,"button",23),e.bIt("click",function(){return i.loadCategories()}),e.j41(75,"mat-icon"),e.EFF(76,"refresh"),e.k0s()(),e.j41(77,"button",24),e.bIt("click",function(){return i.openAddDialog()}),e.j41(78,"mat-icon"),e.EFF(79,"add"),e.k0s()()()(),e.DNE(80,kO,12,0,"div",25),e.DNE(81,wO,2,1,"div",26),e.k0s()(),e.DNE(82,FO,1,0,"div",27),e.DNE(83,DO,58,10,"mat-card",28),e.k0s(),e.j41(84,"mat-menu",null,29),e.DNE(86,jO,26,4,"ng-template",30),e.k0s()),2&r&&(e.R7$(36),e.JRh(i.getTotalCategories()),e.R7$(9),e.JRh(i.getActiveCategories()),e.R7$(18),e.JRh(i.getTotalProducts()),e.R7$(17),e.Y8G("ngIf",0===i.categories.length),e.R7$(1),e.Y8G("ngIf",i.categories.length>0),e.R7$(1),e.Y8G("ngIf",i.showQuickAdd),e.R7$(1),e.Y8G("ngIf",i.showQuickAdd))},dependencies:[D.Sq,D.bT,b.qT,b.me,b.BC,b.cb,b.j4,b.JD,j.RN,j.m2,j.MM,j.dh,B.$z,B.iY,H.An,X.LG,me.q,ae.kk,ae.fb,ae.z8,ge.rl,ge.nJ,ge.TL,ge.JW,Ee.fg,ze.VO,Bt.wT,qe.oV,D.vh],styles:[".categories-container[_ngcontent-%COMP%]{background:#f5f5f7;min-height:100vh;padding-bottom:32px}.page-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);padding:48px 32px;color:#fff;display:flex;justify-content:space-between;align-items:center;box-shadow:0 4px 20px #667eea33}.breadcrumb[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:16px;font-size:14px;opacity:.9}.breadcrumb-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px}.breadcrumb-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.breadcrumb-separator[_ngcontent-%COMP%]{margin:0 8px;opacity:.6}.breadcrumb-item.active[_ngcontent-%COMP%]{font-weight:500}.page-title[_ngcontent-%COMP%]{font-size:36px;font-weight:700;margin:0 0 8px;letter-spacing:-.5px}.page-description[_ngcontent-%COMP%]{font-size:16px;opacity:.95;margin:0}.action-button[_ngcontent-%COMP%]{background:white;color:#667eea;font-weight:600;padding:10px 24px;border-radius:8px;font-size:15px}.action-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.stats-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:24px;padding:32px 32px 0}.stat-card[_ngcontent-%COMP%]{background:white;border-radius:16px;padding:24px;display:flex;align-items:center;gap:20px;box-shadow:0 2px 8px #0000000f;transition:all .3s ease;border:2px solid transparent}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 8px 24px #0000001f}.stat-card.active[_ngcontent-%COMP%]{border-color:#4caf50;background:linear-gradient(135deg,#f1f8e9 0%,#fff 100%)}.stat-icon[_ngcontent-%COMP%]{width:56px;height:56px;background:linear-gradient(135deg,rgba(102,126,234,.1254901961) 0%,rgba(118,75,162,.1254901961) 100%);border-radius:12px;display:flex;align-items:center;justify-content:center}.stat-card.active[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(76,175,80,.1254901961) 0%,rgba(129,199,132,.1254901961) 100%)}.stat-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px;color:#667eea}.stat-card.active[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#4caf50}.stat-value[_ngcontent-%COMP%]{font-size:32px;font-weight:700;line-height:1;margin-bottom:4px;color:#1a1a1a}.stat-label[_ngcontent-%COMP%]{font-size:14px;color:#888;font-weight:500}.categories-section[_ngcontent-%COMP%]{padding:32px}.modern-card[_ngcontent-%COMP%]{border-radius:16px;box-shadow:0 2px 8px #0000000f;border:none;overflow:hidden}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px 24px;border-bottom:1px solid #e0e0e0;background:#fafafa}.card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;font-size:18px;font-weight:600;margin:0;color:#1a1a1a}.card-actions[_ngcontent-%COMP%]{display:flex;gap:8px}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:80px 20px;text-align:center}.empty-icon[_ngcontent-%COMP%]{width:120px;height:120px;background:linear-gradient(135deg,#f5f5f7 0%,#e8e8ea 100%);border-radius:24px;display:flex;align-items:center;justify-content:center;margin-bottom:24px}.empty-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#ccc}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:24px;margin:0 0 8px;color:#333}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#888;margin:0 0 24px}.categories-grid[_ngcontent-%COMP%]{padding:24px;display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:24px}.category-card[_ngcontent-%COMP%]{background:white;border-radius:16px;overflow:hidden;box-shadow:0 2px 8px #0000000f;transition:all .3s ease;border:2px solid transparent}.category-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 8px 24px #0000001f;border-color:#667eea}.category-card-header[_ngcontent-%COMP%]{padding:20px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #f0f0f0;background:linear-gradient(135deg,#f8f9fa 0%,#fff 100%)}.category-icon-wrapper[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:12px;display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.category-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.category-main-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px}.category-badges[_ngcontent-%COMP%]{display:flex;gap:8px}.badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:6px 12px;border-radius:20px;font-size:12px;font-weight:600;text-transform:uppercase}.badge.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e8f5e9 0%,#c8e6c9 100%);color:#4caf50}.badge.inactive[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ffebee 0%,#ffcdd2 100%);color:#f44336}.badge-icon[_ngcontent-%COMP%]{font-size:14px!important;width:14px!important;height:14px!important}.category-info[_ngcontent-%COMP%]{padding:20px}.category-name[_ngcontent-%COMP%]{font-size:20px;font-weight:600;margin:0 0 4px;color:#1a1a1a}.category-description[_ngcontent-%COMP%]{font-size:14px;color:#666;line-height:1.5;margin:0}.category-stats[_ngcontent-%COMP%]{padding:0 20px 16px;display:flex;gap:16px;flex-wrap:wrap}.stat-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:13px;color:#666}.stat-icon[_ngcontent-%COMP%]{font-size:16px!important;width:16px!important;height:16px!important;color:#999}.category-actions[_ngcontent-%COMP%]{padding:16px 20px;background:#fafafa;border-top:1px solid #e0e0e0;display:flex;gap:8px;justify-content:flex-end;flex-wrap:wrap}.action-btn[_ngcontent-%COMP%]{border-radius:6px;font-size:12px;padding:6px 12px;min-width:auto}.action-btn.edit[_ngcontent-%COMP%]{color:#2196f3}.action-btn.view[_ngcontent-%COMP%]{color:#9c27b0}.action-btn.toggle.activate[_ngcontent-%COMP%]{color:#4caf50}.action-btn.toggle.deactivate[_ngcontent-%COMP%]{color:#ff9800}.action-btn.delete[_ngcontent-%COMP%]{color:#f44336}.action-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px!important;width:16px!important;height:16px!important;margin-right:4px}.add-category-card[_ngcontent-%COMP%]{border-radius:12px;border:2px dashed #d1d5db;background:#fafafa;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;justify-content:center;min-height:250px}.add-category-card[_ngcontent-%COMP%]:hover{border-color:#6366f1;background:#f8faff}.add-category-content[_ngcontent-%COMP%]{text-align:center;padding:24px}.add-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#6b7280;margin-bottom:12px}.add-category-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;color:#374151}.add-category-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:.9rem}.stats-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #0000001a;margin-bottom:24px}.stats-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{background:#f8f9fa;margin:-16px -16px 16px;padding:16px;border-radius:12px 12px 0 0}.stats-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:1.1rem;font-weight:500}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}.stat-box[_ngcontent-%COMP%]{text-align:center;padding:16px;border-radius:8px;background:#f8f9fa;position:relative}.stat-box[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:600;margin:0 0 4px;color:#1f2937}.stat-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:.9rem}.stat-box[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;color:#6b7280;opacity:.5}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:999;animation:_ngcontent-%COMP%_fadeIn .3s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.quick-add-card[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:90%;max-width:600px;max-height:90vh;overflow-y:auto;border-radius:12px;box-shadow:0 10px 40px #0003;z-index:1000;background:white;animation:_ngcontent-%COMP%_slideUp .3s ease}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translate(-50%,-40%);opacity:0}to{transform:translate(-50%,-50%);opacity:1}}.quick-add-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{background:#f8f9fa;margin:-16px -16px 16px;padding:16px;border-radius:12px 12px 0 0;display:flex;justify-content:space-between;align-items:center}.quick-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:flex-start}.full-width[_ngcontent-%COMP%]{width:100%}.half-width[_ngcontent-%COMP%]{flex:1}.color-option[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.color-swatch[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:50%;border:2px solid #e5e7eb}.image-upload-section[_ngcontent-%COMP%]{margin-bottom:24px}.section-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:15px;font-weight:600;color:#333;margin-bottom:12px}.section-label[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;color:#667eea}.required[_ngcontent-%COMP%]{color:#ef4444}.image-upload-area[_ngcontent-%COMP%]{position:relative}.upload-placeholder[_ngcontent-%COMP%]{border:3px dashed #cbd5e1;border-radius:12px;padding:48px 32px;text-align:center;cursor:pointer;background:#f8fafc;transition:all .3s ease}.upload-placeholder[_ngcontent-%COMP%]:hover{border-color:#667eea;background:#f0f4ff}.upload-placeholder.dragover[_ngcontent-%COMP%]{border-color:#667eea;background:#e0e7ff;transform:scale(1.02)}.upload-icon[_ngcontent-%COMP%]{font-size:64px!important;width:64px!important;height:64px!important;color:#94a3b8;margin-bottom:16px}.upload-placeholder[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:20px;font-weight:600;color:#334155}.upload-placeholder[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;color:#64748b;font-size:14px}.file-info[_ngcontent-%COMP%]{display:block;font-size:12px;color:#94a3b8}.image-preview-large[_ngcontent-%COMP%]{position:relative;border:1px solid #e2e8f0;border-radius:12px;padding:16px;background:white}.image-preview-large[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-height:300px;object-fit:contain;border-radius:8px}.image-actions[_ngcontent-%COMP%]{position:absolute;top:24px;right:24px;display:flex;gap:8px}.change-image-btn[_ngcontent-%COMP%], .remove-image-btn[_ngcontent-%COMP%]{background:white;box-shadow:0 2px 8px #0000001a}.change-image-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#667eea}.remove-image-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#ef4444}.image-upload-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#666;margin-bottom:8px}.image-upload-container[_ngcontent-%COMP%]{border:2px dashed #ddd;border-radius:8px;padding:16px;text-align:center;position:relative;min-height:120px;display:flex;align-items:center;justify-content:center}.image-preview[_ngcontent-%COMP%]{position:relative;display:inline-block}.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:150px;max-height:100px;border-radius:8px;box-shadow:0 2px 8px #0000001a}.remove-image-btn[_ngcontent-%COMP%]{position:absolute;top:-8px;right:-8px;background:#f44336;color:#fff;width:24px;height:24px}.remove-image-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.upload-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.form-actions[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:8px}.warn-menu-item[_ngcontent-%COMP%]{color:#dc2626!important}@media (max-width: 768px){.categories-container[_ngcontent-%COMP%]{padding:16px}.page-header[_ngcontent-%COMP%]{flex-direction:column;gap:16px;text-align:center}.categories-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.stats-grid[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.half-width[_ngcontent-%COMP%]{width:100%}.page-title[_ngcontent-%COMP%]{font-size:1.5rem}}"]})}}return n})();var BO=E(5680);function LO(n,o){1&n&&(e.j41(0,"div",17),e.nrm(1,"mat-spinner"),e.j41(2,"p"),e.EFF(3,"Loading customer data..."),e.k0s()())}function $O(n,o){1&n&&(e.j41(0,"th",36),e.EFF(1,"Customer Name"),e.k0s())}function GO(n,o){if(1&n&&(e.j41(0,"td",37)(1,"div",38)(2,"span",39),e.EFF(3),e.k0s(),e.j41(4,"span",40),e.EFF(5),e.k0s()()()),2&n){const t=o.$implicit;e.R7$(3),e.Lme("",t.firstName," ",t.lastName,""),e.R7$(2),e.JRh(t.email)}}function UO(n,o){1&n&&(e.j41(0,"th",41),e.EFF(1,"Phone"),e.k0s())}function zO(n,o){if(1&n&&(e.j41(0,"td",37),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.R7$(1),e.JRh(t.phoneNumber)}}function VO(n,o){1&n&&(e.j41(0,"th",36),e.EFF(1,"Total Orders"),e.k0s())}function YO(n,o){if(1&n&&(e.j41(0,"td",37),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.R7$(1),e.JRh(t.totalOrders)}}function XO(n,o){1&n&&(e.j41(0,"th",36),e.EFF(1,"Total Spent"),e.k0s())}function HO(n,o){if(1&n&&(e.j41(0,"td",37),e.EFF(1),e.nI1(2,"currency"),e.k0s()),2&n){const t=o.$implicit;e.R7$(1),e.JRh(e.ii3(2,1,t.totalSpent,"INR","symbol","1.0-0"))}}function WO(n,o){1&n&&(e.j41(0,"th",41),e.EFF(1,"Avg Order"),e.k0s())}function qO(n,o){if(1&n&&(e.j41(0,"td",37),e.EFF(1),e.nI1(2,"currency"),e.k0s()),2&n){const t=o.$implicit;e.R7$(1),e.JRh(e.ii3(2,1,t.averageOrderValue,"INR","symbol","1.0-0"))}}function ZO(n,o){1&n&&(e.j41(0,"th",36),e.EFF(1,"Last Order"),e.k0s())}function QO(n,o){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.nI1(2,"date"),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.JRh(e.i5U(2,1,t.lastOrderDate,"shortDate"))}}function JO(n,o){1&n&&(e.j41(0,"span",44),e.EFF(1,"No orders"),e.k0s())}function KO(n,o){if(1&n&&(e.j41(0,"td",37),e.DNE(1,QO,3,4,"span",42),e.DNE(2,JO,2,0,"span",43),e.k0s()),2&n){const t=o.$implicit;e.R7$(1),e.Y8G("ngIf",t.lastOrderDate),e.R7$(1),e.Y8G("ngIf",!t.lastOrderDate)}}function ey(n,o){1&n&&(e.j41(0,"th",41),e.EFF(1,"Status"),e.k0s())}function ty(n,o){if(1&n&&(e.j41(0,"td",37)(1,"span",45),e.EFF(2),e.nI1(3,"titlecase"),e.k0s()()),2&n){const t=o.$implicit;e.R7$(1),e.HbH("status-"+t.status),e.R7$(1),e.SpI(" ",e.bMT(3,3,t.status)," ")}}function ny(n,o){1&n&&(e.j41(0,"th",41),e.EFF(1,"Actions"),e.k0s())}function ry(n,o){if(1&n){const t=e.RV6();e.j41(0,"td",37)(1,"button",46)(2,"mat-icon"),e.EFF(3,"more_vert"),e.k0s()(),e.j41(4,"mat-menu",null,47)(6,"button",48),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.viewCustomerDetails(a))}),e.j41(7,"mat-icon"),e.EFF(8,"visibility"),e.k0s(),e.EFF(9," View Details "),e.k0s(),e.j41(10,"button",48),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.viewCustomerOrders(a))}),e.j41(11,"mat-icon"),e.EFF(12,"receipt_long"),e.k0s(),e.EFF(13," View Orders "),e.k0s()()()}if(2&n){const t=e.sdS(5);e.R7$(1),e.Y8G("matMenuTriggerFor",t)}}function iy(n,o){1&n&&e.nrm(0,"tr",49)}function oy(n,o){1&n&&e.nrm(0,"tr",50)}const ay=function(){return[10,25,50]};function sy(n,o){if(1&n&&(e.j41(0,"mat-card",18)(1,"mat-card-header")(2,"mat-card-title"),e.EFF(3,"Customer List"),e.k0s()(),e.j41(4,"mat-card-content")(5,"div",19)(6,"table",20),e.qex(7,21),e.DNE(8,$O,2,0,"th",22),e.DNE(9,GO,6,3,"td",23),e.bVm(),e.qex(10,24),e.DNE(11,UO,2,0,"th",25),e.DNE(12,zO,2,1,"td",23),e.bVm(),e.qex(13,26),e.DNE(14,VO,2,0,"th",22),e.DNE(15,YO,2,1,"td",23),e.bVm(),e.qex(16,27),e.DNE(17,XO,2,0,"th",22),e.DNE(18,HO,3,6,"td",23),e.bVm(),e.qex(19,28),e.DNE(20,WO,2,0,"th",25),e.DNE(21,qO,3,6,"td",23),e.bVm(),e.qex(22,29),e.DNE(23,ZO,2,0,"th",22),e.DNE(24,KO,3,2,"td",23),e.bVm(),e.qex(25,30),e.DNE(26,ey,2,0,"th",25),e.DNE(27,ty,4,5,"td",23),e.bVm(),e.qex(28,31),e.DNE(29,ny,2,0,"th",25),e.DNE(30,ry,14,1,"td",23),e.bVm(),e.DNE(31,iy,1,0,"tr",32),e.DNE(32,oy,1,0,"tr",33),e.k0s(),e.nrm(33,"mat-paginator",34,35),e.k0s()()()),2&n){const t=e.XpG();e.R7$(6),e.Y8G("dataSource",t.dataSource),e.R7$(25),e.Y8G("matHeaderRowDef",t.displayedColumns),e.R7$(1),e.Y8G("matRowDefColumns",t.displayedColumns),e.R7$(1),e.Y8G("pageSizeOptions",e.lJ4(5,ay))("pageSize",10)}}let qd=(()=>{class n{constructor(t,r,i){this.snackBar=t,this.customerService=r,this.authService=i,this.dataSource=new _e.I6,this.displayedColumns=["name","phone","orders","spent","avgOrder","lastOrder","status","actions"],this.loading=!1,this.customers=[{id:1,firstName:"Rajesh",lastName:"Kumar",email:"rajesh.kumar@email.com",phoneNumber:"+91 9876543213",totalOrders:15,totalSpent:4500,lastOrderDate:new Date("2024-01-10"),status:"active",loyaltyPoints:450,averageOrderValue:300,joinDate:new Date("2023-06-15")},{id:2,firstName:"Priya",lastName:"Sharma",email:"priya.sharma@email.com",phoneNumber:"+91 9876543214",totalOrders:8,totalSpent:2400,lastOrderDate:new Date("2024-01-05"),status:"active",loyaltyPoints:240,averageOrderValue:300,joinDate:new Date("2023-08-20")}],this.dataSource.data=[]}ngOnInit(){this.loadCustomers()}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}loadCustomers(){this.loading=!0;const t=this.authService.getCurrentUser();if(!t||!t.shopId)return this.snackBar.open("Shop information not found","Close",{duration:3e3}),this.loading=!1,void(this.dataSource.data=this.customers);this.customerService.getShopCustomers(t.shopId).pipe((0,qr.j)(()=>this.loading=!1)).subscribe({next:r=>{this.customers=r.map(i=>({id:i.id,firstName:i.firstName,lastName:i.lastName,email:i.email,phoneNumber:i.phoneNumber,totalOrders:i.totalOrders||0,totalSpent:i.totalSpent||0,lastOrderDate:i.lastOrderDate?new Date(i.lastOrderDate):null,status:i.status||"active",loyaltyPoints:i.loyaltyPoints||0,averageOrderValue:i.averageOrderValue||0,joinDate:new Date(i.createdAt)})),this.dataSource.data=this.customers},error:r=>{console.error("Error loading customers:",r),this.snackBar.open("Failed to load customers. Showing sample data.","Close",{duration:3e3}),this.dataSource.data=this.customers}})}getTotalCustomers(){return this.customers.length}getActiveCustomers(){return this.customers.filter(t=>"active"===t.status).length}getAverageOrderValue(){const t=this.customers.reduce((r,i)=>r+i.averageOrderValue,0);return this.customers.length>0?t/this.customers.length:0}getLoyalCustomers(){return this.customers.filter(t=>t.totalOrders>=10).length}viewCustomerDetails(t){this.snackBar.open(`Viewing details for ${t.firstName} ${t.lastName}`,"Close",{duration:2e3})}viewCustomerOrders(t){this.snackBar.open(`Viewing orders for ${t.firstName} ${t.lastName}`,"Close",{duration:2e3})}exportCustomers(){const t={customers:this.customers,exportedAt:(new Date).toISOString(),totalCustomers:this.getTotalCustomers(),activeCustomers:this.getActiveCustomers()},r=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),i=window.URL.createObjectURL(r),a=document.createElement("a");a.href=i,a.download=`customers-export-${(new Date).toISOString().split("T")[0]}.json`,a.click(),window.URL.revokeObjectURL(i),this.snackBar.open("Customer data exported successfully","Close",{duration:2e3})}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(Ce.UG),e.rXU(BO.m),e.rXU(Gt.u))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-customer-management"]],viewQuery:function(r,i){if(1&r&&(e.GBs(lt.iy,5),e.GBs($t.B4,5)),2&r){let a;e.mGM(a=e.lsd())&&(i.paginator=a.first),e.mGM(a=e.lsd())&&(i.sort=a.first)}},decls:60,vars:11,consts:[[1,"customer-management-container"],[1,"page-header"],[1,"header-content"],[1,"page-title"],[1,"page-subtitle"],[1,"header-actions"],["mat-stroked-button","",3,"click"],[1,"stats-cards"],[1,"stat-card"],[1,"stat-content"],[1,"stat-icon","total"],[1,"stat-details"],[1,"stat-icon","active"],[1,"stat-icon","revenue"],[1,"stat-icon","loyal"],["class","loading-container",4,"ngIf"],["class","customers-table-card",4,"ngIf"],[1,"loading-container"],[1,"customers-table-card"],[1,"table-container"],["mat-table","","matSort","",1,"customers-table",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","phone"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","orders"],["matColumnDef","spent"],["matColumnDef","avgOrder"],["matColumnDef","lastOrder"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions","pageSize"],["paginator",""],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"customer-info"],[1,"customer-name"],[1,"customer-email"],["mat-header-cell",""],[4,"ngIf"],["class","no-orders",4,"ngIf"],[1,"no-orders"],[1,"status-badge"],["mat-icon-button","",3,"matMenuTriggerFor"],["actionMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(r,i){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),e.EFF(4,"Customer Management"),e.k0s(),e.j41(5,"p",4),e.EFF(6,"View and manage your shop's customers"),e.k0s()(),e.j41(7,"div",5)(8,"button",6),e.bIt("click",function(){return i.exportCustomers()}),e.j41(9,"mat-icon"),e.EFF(10,"download"),e.k0s(),e.EFF(11," Export Data "),e.k0s()()(),e.j41(12,"div",7)(13,"mat-card",8)(14,"mat-card-content")(15,"div",9)(16,"div",10)(17,"mat-icon"),e.EFF(18,"people"),e.k0s()(),e.j41(19,"div",11)(20,"h3"),e.EFF(21),e.k0s(),e.j41(22,"p"),e.EFF(23,"Total Customers"),e.k0s()()()()(),e.j41(24,"mat-card",8)(25,"mat-card-content")(26,"div",9)(27,"div",12)(28,"mat-icon"),e.EFF(29,"person_check"),e.k0s()(),e.j41(30,"div",11)(31,"h3"),e.EFF(32),e.k0s(),e.j41(33,"p"),e.EFF(34,"Active Customers"),e.k0s()()()()(),e.j41(35,"mat-card",8)(36,"mat-card-content")(37,"div",9)(38,"div",13)(39,"mat-icon"),e.EFF(40,"monetization_on"),e.k0s()(),e.j41(41,"div",11)(42,"h3"),e.EFF(43),e.nI1(44,"currency"),e.k0s(),e.j41(45,"p"),e.EFF(46,"Avg Order Value"),e.k0s()()()()(),e.j41(47,"mat-card",8)(48,"mat-card-content")(49,"div",9)(50,"div",14)(51,"mat-icon"),e.EFF(52,"loyalty"),e.k0s()(),e.j41(53,"div",11)(54,"h3"),e.EFF(55),e.k0s(),e.j41(56,"p"),e.EFF(57,"Loyal Customers"),e.k0s()()()()()(),e.DNE(58,LO,4,0,"div",15),e.DNE(59,sy,35,6,"mat-card",16),e.k0s()),2&r&&(e.R7$(21),e.JRh(i.getTotalCustomers()),e.R7$(11),e.JRh(i.getActiveCustomers()),e.R7$(11),e.JRh(e.ii3(44,6,i.getAverageOrderValue(),"INR","symbol","1.0-0")),e.R7$(12),e.JRh(i.getLoyalCustomers()),e.R7$(3),e.Y8G("ngIf",i.loading),e.R7$(1),e.Y8G("ngIf",!i.loading))},dependencies:[D.bT,j.RN,j.m2,j.MM,j.dh,B.$z,B.iY,H.An,X.LG,ae.kk,ae.fb,ae.Cp,_e.Zl,_e.tL,_e.ji,_e.cC,_e.YV,_e.iL,_e.KS,_e.$R,_e.YZ,_e.NB,lt.iy,$t.B4,$t.aE,D.PV,D.oe,D.vh],styles:[".customer-management-container[_ngcontent-%COMP%]{padding:24px;background-color:#f5f5f5;min-height:calc(100vh - 64px)}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.page-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:600;margin:0 0 4px;color:#1f2937}.page-subtitle[_ngcontent-%COMP%]{color:#6b7280;margin:0}.header-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.stats-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px;margin-bottom:24px}.stat-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #0000001a}.stat-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.stat-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff}.stat-icon.total[_ngcontent-%COMP%]{background:#3b82f6}.stat-icon.active[_ngcontent-%COMP%]{background:#10b981}.stat-icon.revenue[_ngcontent-%COMP%]{background:#f59e0b}.stat-icon.loyal[_ngcontent-%COMP%]{background:#8b5cf6}.stat-details[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;margin:0 0 4px;color:#1f2937}.stat-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6b7280;margin:0;font-size:.9rem}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:200px}.customers-table-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #0000001a}.table-container[_ngcontent-%COMP%]{width:100%;overflow-x:auto}.customers-table[_ngcontent-%COMP%]{width:100%}.customer-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.customer-name[_ngcontent-%COMP%]{font-weight:500;color:#1f2937}.customer-email[_ngcontent-%COMP%]{font-size:.8rem;color:#6b7280}.no-orders[_ngcontent-%COMP%]{color:#9ca3af;font-style:italic}.status-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:.8rem;font-weight:500;text-transform:uppercase}.status-badge.status-active[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.status-badge.status-inactive[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}@media (max-width: 768px){.customer-management-container[_ngcontent-%COMP%]{padding:16px}.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}.stats-cards[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})}}return n})();var cy=E(7897);function ly(n,o){1&n&&(e.j41(0,"div",13),e.nrm(1,"mat-spinner"),e.j41(2,"p"),e.EFF(3,"Loading shop settings..."),e.k0s()())}function dy(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Shop name is required "),e.k0s())}function uy(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Contact number is required "),e.k0s())}function gy(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1," Please enter a valid email "),e.k0s())}function py(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",66)(1,"div",67)(2,"h4"),e.EFF(3),e.nI1(4,"titlecase"),e.k0s(),e.j41(5,"mat-slide-toggle",68),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.onDayToggle(s,i))}),e.EFF(6),e.k0s()(),e.j41(7,"div",69)(8,"mat-form-field",21)(9,"mat-label"),e.EFF(10,"Open Time"),e.k0s(),e.nrm(11,"input",70),e.k0s(),e.j41(12,"mat-form-field",21)(13,"mat-label"),e.EFF(14,"Close Time"),e.k0s(),e.nrm(15,"input",70),e.k0s()()()}if(2&n){const t=o.$implicit,r=e.XpG(2);e.R7$(3),e.JRh(e.bMT(4,9,t)),e.R7$(2),e.Y8G("formControlName",t+"_closed"),e.R7$(1),e.SpI(" ",r.getToggleText(t)," "),e.R7$(1),e.AVh("disabled",r.isDayClosed(t)),e.R7$(4),e.Y8G("formControlName",t+"_open")("disabled",r.isDayClosed(t)),e.R7$(4),e.Y8G("formControlName",t+"_close")("disabled",r.isDayClosed(t))}}function fy(n,o){if(1&n){const t=e.RV6();e.j41(0,"mat-card",14)(1,"mat-tab-group")(2,"mat-tab",15)(3,"div",16)(4,"form",17)(5,"div",18)(6,"h3",19),e.EFF(7,"Basic Information"),e.k0s(),e.j41(8,"div",20)(9,"mat-form-field",21)(10,"mat-label"),e.EFF(11,"Shop Name"),e.k0s(),e.nrm(12,"input",22),e.DNE(13,dy,2,0,"mat-error",23),e.k0s(),e.j41(14,"mat-form-field",21)(15,"mat-label"),e.EFF(16,"Contact Number"),e.k0s(),e.nrm(17,"input",24),e.DNE(18,uy,2,0,"mat-error",23),e.k0s(),e.j41(19,"mat-form-field",25)(20,"mat-label"),e.EFF(21,"Email"),e.k0s(),e.nrm(22,"input",26),e.DNE(23,gy,2,0,"mat-error",23),e.k0s(),e.j41(24,"mat-form-field",25)(25,"mat-label"),e.EFF(26,"Description"),e.k0s(),e.nrm(27,"textarea",27),e.k0s()()(),e.j41(28,"div",18)(29,"h3",19),e.EFF(30,"Address Information"),e.k0s(),e.j41(31,"div",20)(32,"mat-form-field",25)(33,"mat-label"),e.EFF(34,"Address"),e.k0s(),e.nrm(35,"textarea",28),e.k0s(),e.j41(36,"mat-form-field",21)(37,"mat-label"),e.EFF(38,"City"),e.k0s(),e.nrm(39,"input",29),e.k0s(),e.j41(40,"mat-form-field",21)(41,"mat-label"),e.EFF(42,"State"),e.k0s(),e.nrm(43,"input",30),e.k0s(),e.j41(44,"mat-form-field",21)(45,"mat-label"),e.EFF(46,"Pincode"),e.k0s(),e.nrm(47,"input",31),e.k0s()()(),e.j41(48,"div",32)(49,"button",7),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.saveShopInfo())}),e.j41(50,"mat-icon"),e.EFF(51,"save"),e.k0s(),e.EFF(52," Save Shop Information "),e.k0s()()()()(),e.j41(53,"mat-tab",33)(54,"div",16)(55,"form",17)(56,"div",18)(57,"h3",19),e.EFF(58,"Operating Hours"),e.k0s(),e.j41(59,"div",34),e.DNE(60,py,16,11,"div",35),e.k0s()(),e.j41(61,"div",32)(62,"button",36),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.saveBusinessHours())}),e.j41(63,"mat-icon"),e.EFF(64,"schedule"),e.k0s(),e.EFF(65," Save Business Hours "),e.k0s()()()()(),e.j41(66,"mat-tab",37)(67,"div",16)(68,"form",17)(69,"div",18)(70,"h3",19),e.EFF(71,"Notification Preferences"),e.k0s(),e.j41(72,"div",38)(73,"div",39)(74,"div",40)(75,"h4"),e.EFF(76,"Email Notifications"),e.k0s(),e.j41(77,"p"),e.EFF(78,"Receive notifications via email"),e.k0s()(),e.nrm(79,"mat-slide-toggle",41),e.k0s(),e.j41(80,"div",39)(81,"div",40)(82,"h4"),e.EFF(83,"SMS Notifications"),e.k0s(),e.j41(84,"p"),e.EFF(85,"Receive notifications via SMS"),e.k0s()(),e.nrm(86,"mat-slide-toggle",42),e.k0s(),e.j41(87,"div",39)(88,"div",40)(89,"h4"),e.EFF(90,"Order Alerts"),e.k0s(),e.j41(91,"p"),e.EFF(92,"Get notified about new orders"),e.k0s()(),e.nrm(93,"mat-slide-toggle",43),e.k0s(),e.j41(94,"div",39)(95,"div",40)(96,"h4"),e.EFF(97,"Low Stock Alerts"),e.k0s(),e.j41(98,"p"),e.EFF(99,"Get alerted when inventory is running low"),e.k0s()(),e.nrm(100,"mat-slide-toggle",44),e.k0s(),e.j41(101,"div",39)(102,"div",40)(103,"h4"),e.EFF(104,"Customer Messages"),e.k0s(),e.j41(105,"p"),e.EFF(106,"Receive notifications for customer inquiries"),e.k0s()(),e.nrm(107,"mat-slide-toggle",45),e.k0s()()(),e.j41(108,"div",32)(109,"button",36),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.saveNotificationSettings())}),e.j41(110,"mat-icon"),e.EFF(111,"notifications"),e.k0s(),e.EFF(112," Save Notification Settings "),e.k0s()()()()(),e.j41(113,"mat-tab",46)(114,"div",16)(115,"form",17)(116,"div",18)(117,"h3",19),e.EFF(118,"Business Information"),e.k0s(),e.j41(119,"div",20)(120,"mat-form-field",21)(121,"mat-label"),e.EFF(122,"GST Number"),e.k0s(),e.nrm(123,"input",47),e.k0s(),e.j41(124,"mat-form-field",21)(125,"mat-label"),e.EFF(126,"PAN Number"),e.k0s(),e.nrm(127,"input",48),e.k0s()()(),e.j41(128,"div",18)(129,"h3",19),e.EFF(130,"Order Settings"),e.k0s(),e.j41(131,"div",20)(132,"mat-form-field",21)(133,"mat-label"),e.EFF(134,"Minimum Order Amount (\u20b9)"),e.k0s(),e.nrm(135,"input",49),e.k0s(),e.j41(136,"mat-form-field",21)(137,"mat-label"),e.EFF(138,"Delivery Radius (km)"),e.k0s(),e.nrm(139,"input",50),e.k0s(),e.j41(140,"mat-form-field",21)(141,"mat-label"),e.EFF(142,"Delivery Fee (\u20b9)"),e.k0s(),e.nrm(143,"input",51),e.k0s(),e.j41(144,"mat-form-field",21)(145,"mat-label"),e.EFF(146,"Free Delivery Above (\u20b9)"),e.k0s(),e.nrm(147,"input",52),e.k0s()()(),e.j41(148,"div",32)(149,"button",36),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.saveBusinessSettings())}),e.j41(150,"mat-icon"),e.EFF(151,"business"),e.k0s(),e.EFF(152," Save Business Settings "),e.k0s()()()()(),e.j41(153,"mat-tab",53)(154,"div",16)(155,"form",17)(156,"div",18)(157,"h3",19),e.EFF(158,"Payment & Services"),e.k0s(),e.j41(159,"div",54)(160,"div",55)(161,"div",56)(162,"h4"),e.EFF(163,"Payment Gateway"),e.k0s(),e.j41(164,"p"),e.EFF(165,"Choose your preferred payment provider"),e.k0s()(),e.j41(166,"mat-form-field",21)(167,"mat-label"),e.EFF(168,"Payment Gateway"),e.k0s(),e.j41(169,"mat-select",57)(170,"mat-option",58),e.EFF(171,"Razorpay"),e.k0s(),e.j41(172,"mat-option",59),e.EFF(173,"Paytm"),e.k0s(),e.j41(174,"mat-option",60),e.EFF(175,"PhonePe"),e.k0s(),e.j41(176,"mat-option",61),e.EFF(177,"UPI"),e.k0s()()()(),e.j41(178,"div",55)(179,"div",56)(180,"h4"),e.EFF(181,"Inventory Sync"),e.k0s(),e.j41(182,"p"),e.EFF(183,"Automatically sync inventory across platforms"),e.k0s()(),e.nrm(184,"mat-slide-toggle",62),e.k0s(),e.j41(185,"div",55)(186,"div",56)(187,"h4"),e.EFF(188,"Auto Stock Update"),e.k0s(),e.j41(189,"p"),e.EFF(190,"Automatically update stock levels after orders"),e.k0s()(),e.nrm(191,"mat-slide-toggle",63),e.k0s(),e.j41(192,"div",55)(193,"div",56)(194,"h4"),e.EFF(195,"Email Service"),e.k0s(),e.j41(196,"p"),e.EFF(197,"Enable automated email notifications"),e.k0s()(),e.nrm(198,"mat-slide-toggle",64),e.k0s(),e.j41(199,"div",55)(200,"div",56)(201,"h4"),e.EFF(202,"SMS Service"),e.k0s(),e.j41(203,"p"),e.EFF(204,"Enable SMS notifications for customers"),e.k0s()(),e.nrm(205,"mat-slide-toggle",65),e.k0s()()(),e.j41(206,"div",32)(207,"button",36),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.saveIntegrationSettings())}),e.j41(208,"mat-icon"),e.EFF(209,"settings_applications"),e.k0s(),e.EFF(210," Save Integration Settings "),e.k0s()()()()()()()}if(2&n){const t=e.XpG();let r,i,a;e.R7$(4),e.Y8G("formGroup",t.shopInfoForm),e.R7$(9),e.Y8G("ngIf",null==(r=t.shopInfoForm.get("shopName"))?null:r.hasError("required")),e.R7$(5),e.Y8G("ngIf",null==(i=t.shopInfoForm.get("contactNumber"))?null:i.hasError("required")),e.R7$(5),e.Y8G("ngIf",null==(a=t.shopInfoForm.get("email"))?null:a.hasError("email")),e.R7$(26),e.Y8G("disabled",t.shopInfoForm.invalid),e.R7$(6),e.Y8G("formGroup",t.businessHoursForm),e.R7$(5),e.Y8G("ngForOf",t.weekDays),e.R7$(8),e.Y8G("formGroup",t.notificationsForm),e.R7$(47),e.Y8G("formGroup",t.businessForm),e.R7$(40),e.Y8G("formGroup",t.integrationsForm)}}let my=(()=>{class n{constructor(t,r,i,a,s,l){this.fb=t,this.snackBar=r,this.dialog=i,this.shopService=a,this.authService=s,this.settingsService=l,this.loading=!1,this.settingsLoaded=!1,this.weekDays=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],this.initializeForms()}ngOnInit(){this.loadShopSettings()}initializeForms(){this.shopInfoForm=this.fb.group({shopName:["",b.k0.required],description:[""],contactNumber:["",b.k0.required],email:["",[b.k0.email]],address:[""],city:[""],state:[""],pincode:[""]}),this.businessHoursForm=this.fb.group({}),this.weekDays.forEach(t=>{this.businessHoursForm.addControl(`${t}_open`,this.fb.control("09:00")),this.businessHoursForm.addControl(`${t}_close`,this.fb.control("18:00")),this.businessHoursForm.addControl(`${t}_closed`,this.fb.control(!1))}),this.notificationsForm=this.fb.group({emailNotifications:[!0],smsNotifications:[!1],orderAlerts:[!0],lowStockAlerts:[!0],customerMessages:[!0]}),this.businessForm=this.fb.group({gstNumber:[""],panNumber:[""],minimumOrderAmount:[0,[b.k0.min(0)]],deliveryRadius:[10,[b.k0.min(1),b.k0.max(50)]],deliveryFee:[30,[b.k0.min(0)]],freeDeliveryAbove:[500,[b.k0.min(0)]]}),this.integrationsForm=this.fb.group({paymentGateway:["razorpay"],inventorySync:[!1],autoStockUpdate:[!0],emailService:[!0],smsService:[!1]})}loadShopSettings(){this.loading=!0,this.shopService.getMyShop().pipe((0,qr.j)(()=>{this.loading=!1,this.settingsLoaded=!0})).subscribe({next:t=>{t?(console.log("Shop data received:",t),this.shopInfoForm.patchValue({shopName:t.name||"",description:t.description||"",contactNumber:t.ownerPhone||t.phone||"",email:t.ownerEmail||t.email||"",address:t.addressLine1||t.address||"",city:t.city||"",state:t.state||"",pincode:t.postalCode||t.pincode||""}),t.businessType&&this.businessForm.patchValue({gstNumber:t.gstNumber||"",panNumber:t.panNumber||"",minimumOrderAmount:t.minOrderAmount||0,deliveryRadius:t.deliveryRadius||10,deliveryFee:t.deliveryFee||30,freeDeliveryAbove:t.freeDeliveryAbove||500})):this.snackBar.open("No shop found for this account","Close",{duration:3e3})},error:t=>{console.error("Error loading shop settings:",t),this.snackBar.open("Failed to load shop settings","Close",{duration:3e3})}})}saveShopInfo(){this.shopInfoForm.valid&&(this.loading=!0,setTimeout(()=>{this.loading=!1,this.snackBar.open("Shop information saved successfully","Close",{duration:3e3})},1e3))}saveBusinessHours(){this.loading=!0,setTimeout(()=>{this.loading=!1,this.snackBar.open("Business hours saved successfully","Close",{duration:3e3})},1e3)}saveNotificationSettings(){this.loading=!0,setTimeout(()=>{this.loading=!1,this.snackBar.open("Notification settings saved successfully","Close",{duration:3e3})},1e3)}saveBusinessSettings(){this.businessForm.valid&&(this.loading=!0,setTimeout(()=>{this.loading=!1,this.snackBar.open("Business settings saved successfully","Close",{duration:3e3})},1e3))}saveIntegrationSettings(){this.loading=!0,setTimeout(()=>{this.loading=!1,this.snackBar.open("Integration settings saved successfully","Close",{duration:3e3})},1e3)}saveAllSettings(){this.shopInfoForm.valid&&this.businessForm.valid?(this.loading=!0,setTimeout(()=>{this.loading=!1,this.snackBar.open("All settings saved successfully","Close",{duration:3e3})},1500)):this.snackBar.open("Please check all forms for errors","Close",{duration:3e3})}onDayToggle(t,r){r.checked?(this.businessHoursForm.get(`${t}_open`)?.disable(),this.businessHoursForm.get(`${t}_close`)?.disable()):(this.businessHoursForm.get(`${t}_open`)?.enable(),this.businessHoursForm.get(`${t}_close`)?.enable())}isDayClosed(t){return!0===this.businessHoursForm.get(`${t}_closed`)?.value}getToggleText(t){return this.isDayClosed(t)?"Closed":"Open"}testEmailSettings(){this.snackBar.open("Sending test email...","Close",{duration:2e3}),setTimeout(()=>{this.snackBar.open("Test email sent successfully!","Close",{duration:3e3})},2e3)}testSmsSettings(){this.snackBar.open("Sending test SMS...","Close",{duration:2e3}),setTimeout(()=>{this.snackBar.open("Test SMS sent successfully!","Close",{duration:3e3})},2e3)}viewShopProfile(){this.snackBar.open("Opening shop profile...","Close",{duration:2e3})}backupSettings(){const t={shopInfo:this.shopInfoForm.value,businessHours:this.businessHoursForm.value,notifications:this.notificationsForm.value,business:this.businessForm.value,integrations:this.integrationsForm.value,exportedAt:(new Date).toISOString()},r=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),i=window.URL.createObjectURL(r),a=document.createElement("a");a.href=i,a.download=`shop-settings-backup-${(new Date).toISOString().split("T")[0]}.json`,a.click(),window.URL.revokeObjectURL(i),this.snackBar.open("Settings backup downloaded successfully","Close",{duration:3e3})}exportSettings(){this.backupSettings()}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(b.ok),e.rXU(Ce.UG),e.rXU(Pe.bZ),e.rXU(Jt.s),e.rXU(Gt.u),e.rXU(cy.h))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-shop-settings"]],decls:40,vars:3,consts:[[1,"shop-settings-container"],[1,"page-header"],[1,"header-content"],[1,"page-title"],[1,"page-subtitle"],[1,"header-actions"],["mat-stroked-button","",3,"click"],["mat-raised-button","","color","primary",3,"disabled","click"],["class","loading-container",4,"ngIf"],["class","settings-card",4,"ngIf"],[1,"quick-actions-card"],[1,"quick-actions-grid"],["mat-stroked-button","",1,"action-btn",3,"click"],[1,"loading-container"],[1,"settings-card"],["label","Shop Information"],[1,"tab-content"],[1,"settings-form",3,"formGroup"],[1,"form-section"],[1,"section-title"],[1,"form-grid"],["appearance","outline"],["matInput","","formControlName","shopName","placeholder","Enter shop name"],[4,"ngIf"],["matInput","","formControlName","contactNumber","placeholder","+91 9876543210"],["appearance","outline",1,"full-width"],["matInput","","type","email","formControlName","email","placeholder","shop@example.com"],["matInput","","formControlName","description","rows","3","placeholder","Describe your shop..."],["matInput","","formControlName","address","rows","2","placeholder","Enter complete address"],["matInput","","formControlName","city","placeholder","Enter city"],["matInput","","formControlName","state","placeholder","Enter state"],["matInput","","formControlName","pincode","placeholder","Enter pincode"],[1,"form-actions"],["label","Business Hours"],[1,"business-hours-grid"],["class","day-schedule",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",3,"click"],["label","Notifications"],[1,"notification-options"],[1,"notification-item"],[1,"notification-info"],["formControlName","emailNotifications"],["formControlName","smsNotifications"],["formControlName","orderAlerts"],["formControlName","lowStockAlerts"],["formControlName","customerMessages"],["label","Business Settings"],["matInput","","formControlName","gstNumber","placeholder","Enter GST number"],["matInput","","formControlName","panNumber","placeholder","Enter PAN number"],["matInput","","type","number","formControlName","minimumOrderAmount","placeholder","0","min","0"],["matInput","","type","number","formControlName","deliveryRadius","placeholder","10","min","1","max","50"],["matInput","","type","number","formControlName","deliveryFee","placeholder","30","min","0"],["matInput","","type","number","formControlName","freeDeliveryAbove","placeholder","500","min","0"],["label","Integrations"],[1,"integration-options"],[1,"integration-item"],[1,"integration-info"],["formControlName","paymentGateway"],["value","razorpay"],["value","paytm"],["value","phonepe"],["value","upi"],["formControlName","inventorySync"],["formControlName","autoStockUpdate"],["formControlName","emailService"],["formControlName","smsService"],[1,"day-schedule"],[1,"day-header"],[3,"formControlName","change"],[1,"time-inputs"],["matInput","","type","time",3,"formControlName","disabled"]],template:function(r,i){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),e.EFF(4,"Shop Settings"),e.k0s(),e.j41(5,"p",4),e.EFF(6,"Manage your shop preferences and configurations"),e.k0s()(),e.j41(7,"div",5)(8,"button",6),e.bIt("click",function(){return i.exportSettings()}),e.j41(9,"mat-icon"),e.EFF(10,"download"),e.k0s(),e.EFF(11," Export Settings "),e.k0s(),e.j41(12,"button",7),e.bIt("click",function(){return i.saveAllSettings()}),e.j41(13,"mat-icon"),e.EFF(14,"save"),e.k0s(),e.EFF(15," Save Changes "),e.k0s()()(),e.DNE(16,ly,4,0,"div",8),e.DNE(17,fy,211,10,"mat-card",9),e.j41(18,"mat-card",10)(19,"mat-card-header")(20,"mat-card-title"),e.EFF(21,"Quick Actions"),e.k0s()(),e.j41(22,"mat-card-content")(23,"div",11)(24,"button",12),e.bIt("click",function(){return i.testEmailSettings()}),e.j41(25,"mat-icon"),e.EFF(26,"email"),e.k0s(),e.EFF(27," Test Email "),e.k0s(),e.j41(28,"button",12),e.bIt("click",function(){return i.testSmsSettings()}),e.j41(29,"mat-icon"),e.EFF(30,"sms"),e.k0s(),e.EFF(31," Test SMS "),e.k0s(),e.j41(32,"button",12),e.bIt("click",function(){return i.viewShopProfile()}),e.j41(33,"mat-icon"),e.EFF(34,"store"),e.k0s(),e.EFF(35," View Shop Profile "),e.k0s(),e.j41(36,"button",12),e.bIt("click",function(){return i.backupSettings()}),e.j41(37,"mat-icon"),e.EFF(38,"backup"),e.k0s(),e.EFF(39," Backup Settings "),e.k0s()()()()()),2&r&&(e.R7$(12),e.Y8G("disabled",i.loading),e.R7$(4),e.Y8G("ngIf",i.loading&&!i.settingsLoaded),e.R7$(1),e.Y8G("ngIf",!i.loading||i.settingsLoaded))},dependencies:[D.Sq,D.bT,b.qT,b.me,b.Q0,b.BC,b.cb,b.VZ,b.zX,b.j4,b.JD,j.RN,j.m2,j.MM,j.dh,B.$z,H.An,X.LG,ge.rl,ge.nJ,ge.TL,Ee.fg,ze.VO,Bt.wT,Ue.mq,Ue.T8,Ae.sG,D.PV],styles:[".shop-settings-container[_ngcontent-%COMP%]{padding:24px;background-color:#f5f5f5;min-height:calc(100vh - 64px)}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.page-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:600;margin:0 0 4px;color:#1f2937}.page-subtitle[_ngcontent-%COMP%]{color:#6b7280;margin:0}.header-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:200px}.settings-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #0000001a;margin-bottom:24px}.tab-content[_ngcontent-%COMP%]{padding:24px}.settings-form[_ngcontent-%COMP%]{max-width:800px}.form-section[_ngcontent-%COMP%]{margin-bottom:32px}.section-title[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:600;margin:0 0 16px;color:#1f2937;border-bottom:2px solid #e5e7eb;padding-bottom:8px}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px}.full-width[_ngcontent-%COMP%]{grid-column:1/-1}.business-hours-grid[_ngcontent-%COMP%]{display:grid;gap:16px}.day-schedule[_ngcontent-%COMP%]{padding:16px;border:1px solid #e5e7eb;border-radius:8px;background:#fafafa}.day-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.day-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-weight:500;color:#1f2937}.time-inputs[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px}.time-inputs.disabled[_ngcontent-%COMP%]{opacity:.5;pointer-events:none}.notification-options[_ngcontent-%COMP%], .integration-options[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.notification-item[_ngcontent-%COMP%], .integration-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px;border:1px solid #e5e7eb;border-radius:8px;background:#fafafa}.notification-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .integration-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 4px;font-weight:500;color:#1f2937}.notification-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .integration-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.9rem;color:#6b7280}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;margin-top:24px;padding-top:16px;border-top:1px solid #e5e7eb}.quick-actions-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #0000001a}.quick-actions-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:12px}.action-btn[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:8px;padding:16px;height:auto}.action-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}@media (max-width: 768px){.shop-settings-container[_ngcontent-%COMP%]{padding:16px}.page-header[_ngcontent-%COMP%]{flex-direction:column;gap:16px;text-align:center}.form-grid[_ngcontent-%COMP%], .time-inputs[_ngcontent-%COMP%]{grid-template-columns:1fr}.notification-item[_ngcontent-%COMP%], .integration-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.quick-actions-grid[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}"]})}}return n})();var hy=E(5567);function _y(n,o){if(1&n&&(e.j41(0,"span",11),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.SpI("",t.getUnreadCount()," unread")}}function xy(n,o){1&n&&(e.j41(0,"div",12),e.nrm(1,"mat-spinner"),e.j41(2,"p"),e.EFF(3,"Loading notifications..."),e.k0s()())}function Cy(n,o){if(1&n&&(e.j41(0,"div",28)(1,"strong"),e.EFF(2),e.k0s(),e.j41(3,"small"),e.EFF(4),e.k0s()()),2&n){const t=e.XpG().$implicit;e.R7$(2),e.SpI("\u20b9",t.orderData.totalAmount,""),e.R7$(2),e.SpI("(",t.orderData.orderItems.length||0," items)")}}function vy(n,o){if(1&n&&(e.j41(0,"div",29)(1,"span",30),e.EFF(2),e.k0s()()),2&n){const t=e.XpG().$implicit,r=e.XpG(2);e.R7$(1),e.HbH("status-"+r.getOrderStatus(t)),e.R7$(1),e.SpI(" ",r.getStatusLabel(r.getOrderStatus(t))," ")}}function Py(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",31)(1,"button",32),e.bIt("click",function(i){e.eBV(t);const a=e.XpG().$implicit;return e.XpG(2).handleAction(a),e.Njj(i.stopPropagation())}),e.EFF(2),e.k0s(),e.j41(3,"button",33),e.bIt("click",function(i){e.eBV(t);const a=e.XpG().$implicit;return e.XpG(2).rejectOrder(a),e.Njj(i.stopPropagation())}),e.EFF(4," Reject "),e.k0s()()}if(2&n){const t=e.XpG().$implicit;e.R7$(1),e.Y8G("disabled","processing"===t.status),e.R7$(1),e.SpI(" ","processing"===t.status?"Processing...":"Accept"," "),e.R7$(1),e.Y8G("disabled","processing"===t.status)}}function by(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",16),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.markAsRead(a))}),e.j41(1,"div",17)(2,"mat-icon"),e.EFF(3),e.k0s()(),e.j41(4,"div",18)(5,"div",19),e.EFF(6),e.k0s(),e.j41(7,"div",20),e.EFF(8),e.k0s()(),e.DNE(9,Cy,5,2,"div",21),e.j41(10,"div",22)(11,"div",23),e.EFF(12),e.k0s(),e.DNE(13,vy,3,3,"div",24),e.k0s(),e.j41(14,"div",25)(15,"span",26),e.EFF(16),e.k0s()(),e.DNE(17,Py,5,3,"div",27),e.k0s()}if(2&n){const t=o.$implicit,r=e.XpG(2);e.AVh("unread","unread"===t.status)("urgent","urgent"===t.priority),e.R7$(2),e.HbH("type-"+t.type),e.R7$(1),e.JRh(r.getTypeIcon(t.type)),e.R7$(3),e.JRh(t.title),e.R7$(2),e.JRh(t.message),e.R7$(1),e.Y8G("ngIf",t.orderData),e.R7$(3),e.SpI(" ",r.formatNotificationTime(t.createdAt)," "),e.R7$(1),e.Y8G("ngIf",t.orderData),e.R7$(2),e.HbH("priority-"+t.priority),e.R7$(1),e.SpI(" ",t.priority," "),e.R7$(1),e.Y8G("ngIf",t.actionRequired)}}function ky(n,o){if(1&n&&(e.j41(0,"div",34)(1,"mat-icon"),e.EFF(2,"notifications_none"),e.k0s(),e.j41(3,"h3"),e.EFF(4,"No notifications found"),e.k0s(),e.j41(5,"p"),e.EFF(6),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(6),e.JRh(t.getEmptyStateMessage())}}function Oy(n,o){if(1&n&&(e.j41(0,"div",13),e.DNE(1,by,18,16,"div",14),e.DNE(2,ky,7,1,"div",15),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.getFilteredNotifications()),e.R7$(1),e.Y8G("ngIf",0===t.getFilteredNotifications().length)}}function yy(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",35)(1,"button",5),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.loadMoreNotifications())}),e.EFF(2," Load More "),e.k0s()()}}let My=(()=>{class n{constructor(t,r,i,a,s,l,u,p){this.snackBar=t,this.dialog=r,this.router=i,this.notificationService=a,this.authService=s,this.orderService=l,this.shopOwnerOrderService=u,this.firebaseService=p,this.loading=!1,this.hasMoreNotifications=!0,this.selectedType="",this.selectedPriority="",this.selectedStatus="",this.showOnlyUnread=!1,this.showOnlyActionRequired=!1,this.notifications=[],this.destroy$=new _n.B}ngOnInit(){this.loadNotifications(),this.firebaseService.onMessageReceived().pipe((0,ot.Q)(this.destroy$)).subscribe(t=>{t&&(console.log("New Firebase notification received:",t),this.loadNotifications(),t.notification&&this.firebaseService.showNotification(t.notification.title||"New Notification",t.notification.body||"You have a new order notification"))}),(0,_r.Y)(3e4).pipe((0,ot.Q)(this.destroy$)).subscribe(()=>{this.loadNotifications()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadNotifications(){if(this.loading=!0,!this.authService.getCurrentUser())return this.snackBar.open("User not found","Close",{duration:3e3}),void(this.loading=!1);this.loadOrderNotifications().pipe((0,qr.j)(()=>this.loading=!1)).subscribe({next:r=>{console.log("Loaded order notifications:",r),this.notifications=r},error:r=>{console.error("Error loading order notifications:",r),this.snackBar.open("Failed to load notifications","Close",{duration:3e3}),this.notifications=[]}})}loadOrderNotifications(){const t=localStorage.getItem("current_shop_id");return t?this.orderService.getOrdersByShop(t,0,50).pipe((0,vt.n)(r=>{const a=r.data.content.map(s=>{let l="",u="",p="order",f="medium",h=!1;switch(s.status){case"PENDING":l="\u{1f195} New Order Received",u=`New order ${s.orderNumber} from ${s.customerName} - \u20b9${s.totalAmount}`,p="order",f="high",h=!0;break;case"ACCEPTED":l="\u2705 Order Accepted",u=`Order ${s.orderNumber} has been accepted and is being prepared`,p="success",f="medium";break;case"PREPARING":l="\u{1f468}\u200d\u{1f373} Order Being Prepared",u=`Order ${s.orderNumber} is currently being prepared`,p="info",f="medium";break;case"READY_FOR_PICKUP":l="\u{1f4e6} Order Ready for Pickup",u=`Order ${s.orderNumber} is ready and waiting for pickup`,p="info",f="medium";break;case"OUT_FOR_DELIVERY":l="\u{1f69a} Order Out for Delivery",u=`Order ${s.orderNumber} is out for delivery to ${s.customerName}`,p="info",f="low";break;case"DELIVERED":l="\u2714\ufe0f Order Delivered",u=`Order ${s.orderNumber} has been successfully delivered - \u20b9${s.totalAmount}`,p="success",f="low";break;case"CANCELLED":l="\u274c Order Cancelled",u=`Order ${s.orderNumber} has been cancelled by ${s.cancelledBy||"customer"}`,p="warning",f="high";break;case"REJECTED":l="\u{1f6ab} Order Rejected",u=`Order ${s.orderNumber} was rejected`,p="error",f="medium";break;case"RETURNED":l="\u21a9\ufe0f Order Returned",u=`Order ${s.orderNumber} has been returned by customer`,p="warning",f="high";break;case"REFUNDED":l="\u{1f4b0} Order Refunded",u=`Order ${s.orderNumber} has been refunded - \u20b9${s.totalAmount}`,p="info",f="medium";break;case"SELF_PICKUP_COLLECTED":l="\u{1f6cd}\ufe0f Self Pickup Collected",u=`Order ${s.orderNumber} has been collected by customer - \u20b9${s.totalAmount}`,p="success",f="low";break;case"RETURNING_TO_SHOP":l="\u{1f504} Order Returning to Shop",u=`Order ${s.orderNumber} is being returned to shop`,p="warning",f="high";break;case"RETURNED_TO_SHOP":l="\u{1f4e5} Order Returned to Shop",u=`Order ${s.orderNumber} has been returned to shop`,p="warning",f="medium";break;default:l="Order Update",u=`Order ${s.orderNumber} status: ${this.formatStatus(s.status)}`,p="info",f="low"}const _=this.parseUTCDate(s.createdAt),C=new Date;return C.setDate(C.getDate()-1),{id:s.id,title:l,message:u,type:p,priority:f,status:"PENDING"===s.status||_>C?"unread":"read",createdAt:this.parseUTCDate(s.createdAt),actionRequired:h,actionUrl:`/orders/${s.id}`,relatedEntity:{type:"order",id:s.id,name:s.orderNumber},orderData:s}});return a.sort((s,l)=>l.createdAt.getTime()-s.createdAt.getTime()),(0,He.of)(a)}),(0,wt.W)(()=>(0,He.of)([]))):(console.error("No shop ID found in localStorage"),(0,He.of)([]))}refreshNotifications(){this.loadNotifications(),this.snackBar.open("Notifications refreshed","Close",{duration:2e3})}loadMoreNotifications(){this.hasMoreNotifications=!1,this.snackBar.open("No more notifications to load","Close",{duration:2e3})}getFilteredNotifications(){return this.notifications.filter(t=>(!this.selectedType||t.type===this.selectedType)&&(!this.selectedPriority||t.priority===this.selectedPriority)&&(!this.selectedStatus||t.status===this.selectedStatus)&&(!this.showOnlyUnread||"unread"===t.status)&&(!this.showOnlyActionRequired||t.actionRequired))}applyFilters(){}toggleUnreadOnly(){this.showOnlyUnread=!this.showOnlyUnread}toggleActionRequiredOnly(){this.showOnlyActionRequired=!this.showOnlyActionRequired}getUnreadCount(){return this.notifications.filter(t=>"unread"===t.status).length}getUrgentCount(){return this.notifications.filter(t=>"urgent"===t.priority).length}getActionRequiredCount(){return this.notifications.filter(t=>t.actionRequired).length}getTodayCount(){const t=new Date;return t.setHours(0,0,0,0),this.notifications.filter(r=>r.createdAt>=t).length}getTypeIcon(t){return{order:"shopping_bag",customer:"person",inventory:"inventory",system:"settings",info:"info",success:"check_circle",warning:"warning",error:"error"}[t]||"notifications"}getEmptyStateMessage(){return this.showOnlyUnread?"No unread notifications":this.showOnlyActionRequired?"No notifications requiring action":this.selectedType?`No ${this.selectedType} notifications`:"You're all caught up!"}markAsRead(t){"unread"===t.status&&(t.status="read",t.readAt=new Date),"order"===t.relatedEntity?.type&&this.router.navigate(["/shop-owner/orders-management"])}markAsUnread(t){t.status="unread",t.readAt=void 0,this.snackBar.open("Notification marked as unread","Close",{duration:2e3})}markAllAsRead(){this.notifications.forEach(t=>{"unread"===t.status&&(t.status="read",t.readAt=new Date)}),this.snackBar.open("All notifications marked as read","Close",{duration:3e3})}archiveNotification(t){t.status="archived",this.snackBar.open("Notification archived","Close",{duration:2e3})}deleteNotification(t){const r=this.notifications.indexOf(t);r>-1&&(this.notifications.splice(r,1),this.snackBar.open("Notification deleted","Close",{duration:2e3}))}handleAction(t){"order"===t.type&&t.relatedEntity?this.acceptOrder(t):t.actionUrl?this.router.navigate([t.actionUrl]):this.snackBar.open("Action completed","Close",{duration:2e3}),"unread"===t.status&&(t.status="read",t.readAt=new Date)}acceptOrder(t){if(!t.relatedEntity||"processing"===t.status)return;const r=t.relatedEntity.id;t.status="processing",this.shopOwnerOrderService.acceptOrder(r,"30 minutes","Order accepted and will be prepared shortly").pipe((0,qr.j)(()=>{setTimeout(()=>{"processing"===t.status&&(t.status="read")},1e3)})).subscribe({next:i=>{console.log("Order accepted successfully:",i),this.snackBar.open(`Order ${t.relatedEntity.name} accepted successfully!`,"Close",{duration:5e3}),t.actionRequired=!1,t.status="read",t.title="Order Accepted",t.message=`Order ${t.relatedEntity.name} has been accepted and is being prepared.`,t.type="success",setTimeout(()=>this.loadNotifications(),2e3)},error:i=>{console.error("Error accepting order:",i),t.status="unread",this.snackBar.open("Failed to accept order. Please try again.","Close",{duration:5e3})}})}rejectOrder(t){if(!t.relatedEntity||"processing"===t.status)return;const r=t.relatedEntity.id;t.status="processing",this.shopOwnerOrderService.rejectOrder(r,"Order rejected by shop owner").pipe((0,qr.j)(()=>{setTimeout(()=>{"processing"===t.status&&(t.status="read")},1e3)})).subscribe({next:a=>{console.log("Order rejected successfully:",a),this.snackBar.open(`Order ${t.relatedEntity.name} rejected.`,"Close",{duration:5e3}),t.actionRequired=!1,t.status="read",t.title="Order Rejected",t.message=`Order ${t.relatedEntity.name} has been rejected.`,t.type="warning",setTimeout(()=>this.loadNotifications(),2e3)},error:a=>{console.error("Error rejecting order:",a),t.status="unread",this.snackBar.open("Failed to reject order. Please try again.","Close",{duration:5e3})}})}getOrderStatus(t){return t.orderData&&t.orderData.status?t.orderData.status:t.message.includes("status: CONFIRMED")?"CONFIRMED":t.message.includes("status: ACCEPTED")?"ACCEPTED":t.message.includes("status: PREPARING")?"PREPARING":t.message.includes("status: READY_FOR_PICKUP")?"READY_FOR_PICKUP":t.message.includes("status: PENDING")?"PENDING":t.message.includes("status: SELF_PICKUP_COLLECTED")?"SELF_PICKUP_COLLECTED":t.message.includes("status: DELIVERED")?"DELIVERED":t.message.includes("status: CANCELLED")?"CANCELLED":t.message.includes("status: REJECTED")?"REJECTED":t.message.includes("status: RETURNING_TO_SHOP")?"RETURNING_TO_SHOP":t.message.includes("status: RETURNED_TO_SHOP")?"RETURNED_TO_SHOP":"UNKNOWN"}formatStatus(t){return t?t.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase()).toLowerCase().replace(/\b\w/g,r=>r.toUpperCase()):""}getStatusLabel(t){return{PENDING:"Pending",CONFIRMED:"Confirmed",ACCEPTED:"Accepted",PREPARING:"Preparing",READY_FOR_PICKUP:"Ready",OUT_FOR_DELIVERY:"Out for Delivery",DELIVERED:"Delivered",CANCELLED:"Cancelled",REJECTED:"Rejected",RETURNED:"Returned",REFUNDED:"Refunded",SELF_PICKUP_COLLECTED:"Collected",RETURNING_TO_SHOP:"Returning",RETURNED_TO_SHOP:"Returned to Shop",UNKNOWN:"Unknown"}[t]||this.formatStatus(t)}parseUTCDate(t){return t?t.endsWith("Z")||/[+-]\d{2}:\d{2}$/.test(t)||/[+-]\d{4}$/.test(t)?new Date(t):new Date(t+"Z"):new Date}formatNotificationTime(t){if(!t)return"";const r=new Date(t),i=new Date,a=i.getTime()-r.getTime(),s=Math.floor(a/6e4),l=Math.floor(a/36e5),u=Math.floor(a/864e5);let p=r.getHours();const h=p>=12?"PM":"AM";p=p%12||12;const _=`${p}:${r.getMinutes().toString().padStart(2,"0")} ${h}`;if(s<1)return"Just now";if(s<60)return`${s} min ago`;if(l<24&&r.getDate()===i.getDate())return`Today, ${_}`;if(1===u||l<48&&r.getDate()===i.getDate()-1)return`Yesterday, ${_}`;{const C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return`${r.getDate()} ${C[r.getMonth()]} ${r.getFullYear()}, ${_}`}}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(Ce.UG),e.rXU(Pe.bZ),e.rXU(Xe.Ix),e.rXU(hy.J),e.rXU(Gt.u),e.rXU(At.Q),e.rXU(Kp),e.rXU(Jp.f))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-notifications"]],viewQuery:function(r,i){if(1&r&&(e.GBs(lt.iy,5),e.GBs($t.B4,5)),2&r){let a;e.mGM(a=e.lsd())&&(i.paginator=a.first),e.mGM(a=e.lsd())&&(i.sort=a.first)}},decls:21,vars:7,consts:[[1,"notifications-page"],[1,"page-header"],[1,"header-left"],["class","unread-badge",4,"ngIf"],[1,"header-actions"],["mat-button","",3,"click"],["mat-button","",3,"disabled","click"],["mat-icon-button","",3,"click"],["class","loading-container",4,"ngIf"],["class","notifications-table",4,"ngIf"],["class","load-more",4,"ngIf"],[1,"unread-badge"],[1,"loading-container"],[1,"notifications-table"],["class","notification-row",3,"unread","urgent","click",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],[1,"notification-row",3,"click"],[1,"notification-icon"],[1,"notification-content"],[1,"notification-title"],[1,"notification-message"],["class","notification-amount",4,"ngIf"],[1,"notification-status-column"],[1,"notification-time"],["class","order-status",4,"ngIf"],[1,"notification-priority"],[1,"priority-badge"],["class","notification-actions",4,"ngIf"],[1,"notification-amount"],[1,"order-status"],[1,"status-badge"],[1,"notification-actions"],["mat-raised-button","","color","primary","size","small",3,"disabled","click"],["mat-stroked-button","","color","warn","size","small",3,"disabled","click"],[1,"empty-state"],[1,"load-more"]],template:function(r,i){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),e.EFF(4,"Notifications"),e.k0s(),e.DNE(5,_y,2,1,"span",3),e.k0s(),e.j41(6,"div",4)(7,"button",5),e.bIt("click",function(){return i.toggleUnreadOnly()}),e.j41(8,"mat-icon"),e.EFF(9,"filter_list"),e.k0s(),e.EFF(10," Unread Only "),e.k0s(),e.j41(11,"button",6),e.bIt("click",function(){return i.markAllAsRead()}),e.j41(12,"mat-icon"),e.EFF(13,"done_all"),e.k0s(),e.EFF(14," Mark All Read "),e.k0s(),e.j41(15,"button",7),e.bIt("click",function(){return i.refreshNotifications()}),e.j41(16,"mat-icon"),e.EFF(17,"refresh"),e.k0s()()()(),e.DNE(18,xy,4,0,"div",8),e.DNE(19,Oy,3,2,"div",9),e.DNE(20,yy,3,0,"div",10),e.k0s()),2&r&&(e.R7$(5),e.Y8G("ngIf",i.getUnreadCount()>0),e.R7$(2),e.AVh("active",i.showOnlyUnread),e.R7$(4),e.Y8G("disabled",0===i.getUnreadCount()),e.R7$(7),e.Y8G("ngIf",i.loading),e.R7$(1),e.Y8G("ngIf",!i.loading),e.R7$(1),e.Y8G("ngIf",i.hasMoreNotifications&&!i.loading))},dependencies:[D.Sq,D.bT,B.$z,B.iY,H.An,X.LG],styles:[".notifications-page[_ngcontent-%COMP%]{padding:24px;max-width:1200px;margin:0 auto;background:#f8f9fa;min-height:100vh}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;background:white;padding:20px 24px;border-radius:12px;box-shadow:0 1px 3px #0000001a}.header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:600;color:#1a1a1a}.unread-badge[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2;padding:4px 12px;border-radius:16px;font-size:.8rem;font-weight:500}.header-actions[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.header-actions[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{background:#1976d2;color:#fff}.notifications-table[_ngcontent-%COMP%]{background:white;border-radius:12px;overflow:hidden;box-shadow:0 1px 3px #0000001a}.notification-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:50px 3fr 140px 110px 80px 200px;gap:16px;align-items:center;padding:16px 20px;border-bottom:1px solid #f0f2f4;cursor:pointer;transition:all .15s ease}.notification-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.notification-row[_ngcontent-%COMP%]:hover{background:#f8f9fb;transform:translateY(-1px);box-shadow:0 2px 8px #00000014}.notification-row.unread[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f0f7ff 0%,#ffffff 6px);border-left:3px solid #2196f3}.notification-row.urgent[_ngcontent-%COMP%]{border-left:3px solid #ff5722}.notification-icon[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:8px;background:linear-gradient(135deg,#e3f2fd,#bbdefb);display:flex;align-items:center;justify-content:center}.notification-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;color:#1976d2}.notification-content[_ngcontent-%COMP%]{min-width:0}.notification-title[_ngcontent-%COMP%]{font-weight:500;font-size:.95rem;color:#1a1a1a;margin-bottom:2px;line-height:1.3}.notification-message[_ngcontent-%COMP%]{color:#6b7280;font-size:.85rem;line-height:1.3;opacity:.9}.notification-amount[_ngcontent-%COMP%]{text-align:right;font-weight:600;color:#059669;font-size:.9rem}.notification-amount[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{display:block;color:#9ca3af;font-weight:400;font-size:.75rem;margin-top:2px}.notification-status-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.notification-time[_ngcontent-%COMP%]{color:#9ca3af;font-size:.75rem;white-space:nowrap}.order-status[_ngcontent-%COMP%]{margin-top:2px}.status-badge[_ngcontent-%COMP%]{padding:2px 6px;border-radius:4px;font-size:.65rem;font-weight:600;text-transform:uppercase;letter-spacing:.3px}.status-badge.status-PENDING[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.status-badge.status-CONFIRMED[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status-badge.status-ACCEPTED[_ngcontent-%COMP%]{background:#d1ecf1;color:#0c5460}.status-badge.status-PREPARING[_ngcontent-%COMP%]{background:#e2e3e5;color:#383d41}.status-badge.status-READY[_ngcontent-%COMP%], .status-badge.status-READY_FOR_PICKUP[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status-badge.status-OUT_FOR_DELIVERY[_ngcontent-%COMP%]{background:#e0f2fe;color:#0369a1}.status-badge.status-DELIVERED[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.status-badge.status-SELF_PICKUP_COLLECTED[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.status-badge.status-CANCELLED[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.status-badge.status-REJECTED[_ngcontent-%COMP%]{background:#fce7f3;color:#9d174d}.status-badge.status-RETURNED[_ngcontent-%COMP%], .status-badge.status-RETURNED_TO_SHOP[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.status-badge.status-RETURNING_TO_SHOP[_ngcontent-%COMP%]{background:#fff7ed;color:#c2410c}.status-badge.status-REFUNDED[_ngcontent-%COMP%]{background:#ede9fe;color:#6d28d9}.status-badge.status-UNKNOWN[_ngcontent-%COMP%]{background:#f8f9fa;color:#6c757d}.notification-priority[_ngcontent-%COMP%]{text-align:center}.priority-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:6px;font-size:.7rem;font-weight:500;text-transform:uppercase;letter-spacing:.5px}.priority-badge.priority-urgent[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.priority-badge.priority-high[_ngcontent-%COMP%]{background:#fff3e0;color:#e65100}.priority-badge.priority-medium[_ngcontent-%COMP%]{background:#e3f2fd;color:#1565c0}.priority-badge.priority-low[_ngcontent-%COMP%]{background:#f3f4f6;color:#6b7280}.notification-actions[_ngcontent-%COMP%]{display:flex;gap:8px;justify-content:flex-end}.notification-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 14px;font-size:.8rem;border-radius:6px;font-weight:500;min-width:70px;height:32px}.notification-actions[_ngcontent-%COMP%]   button[color=primary][_ngcontent-%COMP%]{background:#2196f3;color:#fff;border:none}.notification-actions[_ngcontent-%COMP%]   button[color=warn][_ngcontent-%COMP%]{color:#f44336;border:1px solid #f44336;background:transparent}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#666}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:3rem;width:3rem;height:3rem;margin-bottom:10px;color:#ccc}.loading-container[_ngcontent-%COMP%]{text-align:center;padding:40px}.load-more[_ngcontent-%COMP%]{text-align:center;margin-top:20px}.type-order[_ngcontent-%COMP%]{color:#10b981}.type-customer[_ngcontent-%COMP%]{color:#3b82f6}.type-inventory[_ngcontent-%COMP%]{color:#f59e0b}.type-system[_ngcontent-%COMP%]{color:#6b7280}.type-info[_ngcontent-%COMP%]{color:#06b6d4}.type-success[_ngcontent-%COMP%]{color:#10b981}.type-warning[_ngcontent-%COMP%]{color:#f59e0b}.type-error[_ngcontent-%COMP%]{color:#ef4444}"]})}}return n})();function wy(n,o){1&n&&(e.j41(0,"th",37),e.EFF(1,"Product"),e.k0s())}function Fy(n,o){if(1&n&&(e.j41(0,"td",38)(1,"div",39),e.nrm(2,"img",40),e.j41(3,"div",41)(4,"p",42),e.EFF(5),e.k0s(),e.j41(6,"p",43),e.EFF(7),e.k0s()()()()),2&n){const t=o.$implicit;e.R7$(2),e.FS9("alt",t.name),e.Y8G("src",t.image||"/assets/images/default-product.png",e.B4B),e.R7$(3),e.JRh(t.name),e.R7$(2),e.JRh(t.category)}}function Ey(n,o){1&n&&(e.j41(0,"th",37),e.EFF(1,"Stock"),e.k0s())}function Sy(n,o){if(1&n){const t=e.RV6();e.j41(0,"td",38)(1,"div",44)(2,"span",45),e.EFF(3),e.k0s(),e.j41(4,"button",46),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.updateStock(a))}),e.j41(5,"mat-icon"),e.EFF(6,"edit"),e.k0s()()()()}if(2&n){const t=o.$implicit,r=e.XpG();e.R7$(2),e.Y8G("ngClass",r.getStockClass(t.stock)),e.R7$(1),e.Lme(" ",t.stock," ",t.unit," ")}}function Ty(n,o){1&n&&(e.j41(0,"th",37),e.EFF(1,"Price"),e.k0s())}function Iy(n,o){if(1&n){const t=e.RV6();e.j41(0,"td",38)(1,"div",47)(2,"span",48),e.EFF(3),e.k0s(),e.j41(4,"button",49),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.updatePrice(a))}),e.j41(5,"mat-icon"),e.EFF(6,"edit"),e.k0s()()()()}if(2&n){const t=o.$implicit;e.R7$(3),e.SpI("\u20b9",t.price,"")}}function Ry(n,o){1&n&&(e.j41(0,"th",37),e.EFF(1,"Status"),e.k0s())}function Ny(n,o){if(1&n){const t=e.RV6();e.j41(0,"td",38)(1,"mat-slide-toggle",50),e.bIt("change",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.toggleAvailability(a))}),e.EFF(2),e.k0s()()}if(2&n){const t=o.$implicit;e.R7$(1),e.Y8G("checked",t.isActive),e.R7$(1),e.SpI(" ",t.isActive?"Available":"Unavailable"," ")}}function Ay(n,o){1&n&&(e.j41(0,"th",37),e.EFF(1,"Actions"),e.k0s())}function Dy(n,o){if(1&n){const t=e.RV6();e.j41(0,"td",38)(1,"button",22)(2,"mat-icon"),e.EFF(3,"more_vert"),e.k0s()(),e.j41(4,"mat-menu",null,51)(6,"button",52),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.editProduct(a))}),e.j41(7,"mat-icon"),e.EFF(8,"edit"),e.k0s(),e.EFF(9," Edit Product "),e.k0s(),e.j41(10,"button",52),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.viewAnalytics(a))}),e.j41(11,"mat-icon"),e.EFF(12,"analytics"),e.k0s(),e.EFF(13," View Analytics "),e.k0s(),e.j41(14,"button",53),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.deleteProduct(a))}),e.j41(15,"mat-icon"),e.EFF(16,"delete"),e.k0s(),e.EFF(17," Delete "),e.k0s()()()}if(2&n){const t=e.sdS(5);e.R7$(1),e.Y8G("matMenuTriggerFor",t)}}function jy(n,o){1&n&&e.nrm(0,"tr",54)}function By(n,o){1&n&&e.nrm(0,"tr",55)}function Ly(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",56)(1,"mat-icon"),e.EFF(2,"inventory_2"),e.k0s(),e.j41(3,"h3"),e.EFF(4,"No products found"),e.k0s(),e.j41(5,"p"),e.EFF(6,"Start by adding your first product to your shop"),e.k0s(),e.j41(7,"button",10),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.addNewProduct())}),e.EFF(8," Add Product "),e.k0s()()}}let $y=(()=>{class n{constructor(t,r){this.productService=t,this.snackBar=r,this.displayedColumns=["name","stock","price","status","actions"],this.dataSource=new _e.I6([]),this.products=[],this.filteredProducts=[],this.loading=!1,this.syncing=!1,this.searchTerm="",this.searchQuery="",this.selectedCategory="all",this.stockFilter="all",this.totalProducts=0,this.availableProducts=0,this.lowStockProducts=0,this.outOfStockProducts=0,this.belowMarketCount=0,this.aboveMarketCount=0,this.lowStockCount=0,this.activeCount=0}ngOnInit(){this.loadProducts()}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}loadProducts(){this.loading=!0;const t=this.getShopId();this.productService.getShopProducts(t).subscribe({next:r=>{this.products=this.transformProducts(r),this.applyFilter(),this.calculateMetrics(),this.loading=!1},error:r=>{console.error("Error loading products:",r);const i=[{id:1,name:"Tomatoes",category:"Vegetables",unit:"kg",price:40,stock:25,marketAverage:45,isActive:!0,updatedAt:(new Date).toISOString()}];this.products=this.transformProducts(i),this.applyFilter(),this.calculateMetrics(),this.loading=!1}})}getShopId(){const t=localStorage.getItem("current_shop_id");if(t){const i=parseInt(t,10);if(!isNaN(i)&&i>0)return i}const r=localStorage.getItem("shop_management_user")||localStorage.getItem("currentUser");if(r)try{const i=JSON.parse(r);if(i.shopId&&i.shopId>0)return i.shopId}catch(i){console.error("Error parsing user data:",i)}return console.error("No valid shop ID found for current user!"),0}transformProducts(t){return(Array.isArray(t)?t:[t]).map(i=>({id:i.id,masterId:i.masterProductId||i.masterId||`PROD_${i.id}`,name:i.customName||i.name||"Product",category:i.category||"General",unit:i.unit||"piece",price:i.price||0,marketAverage:i.marketPrice||i.marketAverage||1.1*i.price,stock:i.stockQuantity||i.stock||0,bulkShopsCount:i.bulkShopsCount||0,totalBulkStock:i.totalBulkStock||0,isActive:!1!==i.isAvailable&&"ACTIVE"===i.status,lastUpdated:new Date(i.updatedAt||i.createdAt||Date.now())}))}applyFilter(){let t=[...this.products];if(this.searchTerm){const r=this.searchTerm.toLowerCase();t=t.filter(i=>i.name.toLowerCase().includes(r)||i.masterId.toLowerCase().includes(r)||i.category.toLowerCase().includes(r))}"all"!==this.selectedCategory&&(t=t.filter(r=>r.category.toLowerCase()===this.selectedCategory)),"in-stock"===this.stockFilter?t=t.filter(r=>r.stock>10):"low-stock"===this.stockFilter?t=t.filter(r=>r.stock>0&&r.stock<=10):"out-of-stock"===this.stockFilter&&(t=t.filter(r=>0===r.stock)),this.filteredProducts=t,this.dataSource.data=t}calculateMetrics(){this.totalProducts=this.products.length,this.availableProducts=this.products.filter(t=>t.isActive&&t.stock>0).length,this.lowStockProducts=this.products.filter(t=>t.stock<=10&&t.stock>0).length,this.outOfStockProducts=this.products.filter(t=>0===t.stock).length,this.belowMarketCount=this.products.filter(t=>t.price<t.marketAverage).length,this.aboveMarketCount=this.products.filter(t=>t.price>t.marketAverage).length,this.lowStockCount=this.products.filter(t=>t.stock<=10&&t.stock>0).length,this.activeCount=this.products.filter(t=>t.isActive).length}updatePrice(t){const r=prompt(`Enter new price for ${t.name}:`,t.price.toString());if(r&&!isNaN(Number(r))){const i=Number(r);t.price=i,this.productService.updatePrice(t.id,i).subscribe({next:()=>{this.snackBar.open("Price updated successfully","Close",{duration:2e3,panelClass:"success-snackbar"}),this.calculateMetrics()},error:a=>{console.error("Error updating price:",a),this.loadProducts(),this.snackBar.open("Failed to update price","Close",{duration:3e3})}})}}updateStock(t){const r=prompt(`Enter new stock quantity for ${t.name}:`,t.stock.toString());if(r&&!isNaN(Number(r))){const i=Number(r);t.stock=i,this.productService.updateStock({productId:t.id,newQuantity:i,reason:"Manual update",notes:"Updated from pricing screen"}).subscribe({next:()=>{this.snackBar.open("Stock updated successfully","Close",{duration:2e3,panelClass:"success-snackbar"}),this.calculateMetrics()},error:s=>{console.error("Error updating stock:",s),this.loadProducts(),this.snackBar.open("Failed to update stock","Close",{duration:3e3})}})}}toggleProductStatus(t){this.productService.toggleProductStatus(t.id).subscribe({next:()=>{this.snackBar.open(t.isActive?"Product activated":"Product deactivated","Close",{duration:2e3}),this.calculateMetrics()},error:r=>{console.error("Error toggling product status:",r),t.isActive=!t.isActive,this.snackBar.open("Failed to update product status","Close",{duration:3e3})}})}syncPrices(){this.syncing=!0,setTimeout(()=>{this.snackBar.open("Market prices synced successfully","Close",{duration:3e3,panelClass:"success-snackbar"}),this.loadProducts(),this.syncing=!1},2e3)}getProductIcon(t){return{dairy:"egg",vegetables:"eco",fruits:"apple",grains:"grain",bakery:"bakery_dining",beverages:"local_drink",meat:"kebab_dining",seafood:"set_meal",snacks:"cookie",frozen:"ac_unit"}[t.toLowerCase()]||"inventory"}getPriceComparison(t){const r=(t.price-t.marketAverage)/t.marketAverage*100;return Math.abs(r)<1?"At market":`${Math.abs(r).toFixed(0)}% ${r<0?"below":"above"}`}getStockIcon(t){return 0===t?"error":t<=10?"warning":"check_circle"}viewDetails(t){console.log("View details for:",t)}viewPriceHistory(t){console.log("View price history for:",t)}compareWithOthers(t){console.log("Compare prices for:",t)}addNewProduct(){console.log("Add new product")}getStockClass(t){return 0===t?"out-of-stock":t<=10?"low-stock":"in-stock"}toggleAvailability(t){console.log("Toggle availability for:",t)}editProduct(t){console.log("Edit product:",t)}viewAnalytics(t){console.log("View analytics for:",t)}deleteProduct(t){console.log("Delete product:",t)}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(Gr),e.rXU(Ce.UG))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-products-pricing"]],viewQuery:function(r,i){if(1&r&&(e.GBs(lt.iy,5),e.GBs($t.B4,5)),2&r){let a;e.mGM(a=e.lsd())&&(i.paginator=a.first),e.mGM(a=e.lsd())&&(i.sort=a.first)}},decls:107,vars:10,consts:[[1,"products-pricing-container"],[1,"header-section"],[1,"page-title"],[1,"subtitle"],[1,"action-bar"],[1,"search-section"],["appearance","outline",1,"search-field"],["matInput","","placeholder","Search by name, category...",3,"ngModel","ngModelChange"],["matSuffix",""],[1,"action-buttons"],["mat-raised-button","","color","primary",3,"click"],["mat-stroked-button",""],[1,"stats-grid"],[1,"stat-card"],[1,"stat-info"],[1,"stat-icon","products"],[1,"stat-details"],[1,"stat-icon","available"],[1,"stat-icon","low-stock"],[1,"stat-icon","out-of-stock"],[1,"products-table-card"],[1,"header-actions"],["mat-icon-button","",3,"matMenuTriggerFor"],["filterMenu","matMenu"],["mat-menu-item",""],[1,"table-container"],["mat-table","",1,"products-table",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","stock"],["matColumnDef","price"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","empty-state",4,"ngIf"],["mat-header-cell",""],["mat-cell",""],[1,"product-info"],[1,"product-image",3,"src","alt"],[1,"product-details"],[1,"product-name"],[1,"product-category"],[1,"stock-info"],[1,"stock-quantity",3,"ngClass"],["mat-mini-fab","",1,"update-stock-btn",3,"click"],[1,"price-info"],[1,"current-price"],["mat-mini-fab","",1,"update-price-btn",3,"click"],[3,"checked","change"],["actionMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"delete-action",3,"click"],["mat-header-row",""],["mat-row",""],[1,"empty-state"]],template:function(r,i){if(1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"h1",2),e.EFF(3,"Products & Pricing"),e.k0s(),e.j41(4,"p",3),e.EFF(5,"Manage your shop's inventory, pricing, and product availability"),e.k0s()(),e.j41(6,"div",4)(7,"div",5)(8,"mat-form-field",6)(9,"mat-label"),e.EFF(10,"Search products"),e.k0s(),e.j41(11,"input",7),e.bIt("ngModelChange",function(s){return i.searchQuery=s}),e.k0s(),e.j41(12,"mat-icon",8),e.EFF(13,"search"),e.k0s()()(),e.j41(14,"div",9)(15,"button",10),e.bIt("click",function(){return i.addNewProduct()}),e.j41(16,"mat-icon"),e.EFF(17,"add"),e.k0s(),e.EFF(18," Add Product "),e.k0s(),e.j41(19,"button",11)(20,"mat-icon"),e.EFF(21,"upload"),e.k0s(),e.EFF(22," Bulk Import "),e.k0s()()(),e.j41(23,"div",12)(24,"mat-card",13)(25,"mat-card-content")(26,"div",14)(27,"div",15)(28,"mat-icon"),e.EFF(29,"inventory_2"),e.k0s()(),e.j41(30,"div",16)(31,"h3"),e.EFF(32),e.k0s(),e.j41(33,"p"),e.EFF(34,"Total Products"),e.k0s()()()()(),e.j41(35,"mat-card",13)(36,"mat-card-content")(37,"div",14)(38,"div",17)(39,"mat-icon"),e.EFF(40,"check_circle"),e.k0s()(),e.j41(41,"div",16)(42,"h3"),e.EFF(43),e.k0s(),e.j41(44,"p"),e.EFF(45,"Available"),e.k0s()()()()(),e.j41(46,"mat-card",13)(47,"mat-card-content")(48,"div",14)(49,"div",18)(50,"mat-icon"),e.EFF(51,"warning"),e.k0s()(),e.j41(52,"div",16)(53,"h3"),e.EFF(54),e.k0s(),e.j41(55,"p"),e.EFF(56,"Low Stock"),e.k0s()()()()(),e.j41(57,"mat-card",13)(58,"mat-card-content")(59,"div",14)(60,"div",19)(61,"mat-icon"),e.EFF(62,"remove_circle"),e.k0s()(),e.j41(63,"div",16)(64,"h3"),e.EFF(65),e.k0s(),e.j41(66,"p"),e.EFF(67,"Out of Stock"),e.k0s()()()()()(),e.j41(68,"mat-card",20)(69,"mat-card-header")(70,"mat-card-title"),e.EFF(71,"Product Inventory"),e.k0s(),e.j41(72,"div",21)(73,"button",22)(74,"mat-icon"),e.EFF(75,"filter_list"),e.k0s()(),e.j41(76,"mat-menu",null,23)(78,"button",24),e.EFF(79,"All Products"),e.k0s(),e.j41(80,"button",24),e.EFF(81,"Available"),e.k0s(),e.j41(82,"button",24),e.EFF(83,"Low Stock"),e.k0s(),e.j41(84,"button",24),e.EFF(85,"Out of Stock"),e.k0s()()()(),e.j41(86,"mat-card-content")(87,"div",25)(88,"table",26),e.qex(89,27),e.DNE(90,wy,2,0,"th",28),e.DNE(91,Fy,8,4,"td",29),e.bVm(),e.qex(92,30),e.DNE(93,Ey,2,0,"th",28),e.DNE(94,Sy,7,3,"td",29),e.bVm(),e.qex(95,31),e.DNE(96,Ty,2,0,"th",28),e.DNE(97,Iy,7,1,"td",29),e.bVm(),e.qex(98,32),e.DNE(99,Ry,2,0,"th",28),e.DNE(100,Ny,3,2,"td",29),e.bVm(),e.qex(101,33),e.DNE(102,Ay,2,0,"th",28),e.DNE(103,Dy,18,1,"td",29),e.bVm(),e.DNE(104,jy,1,0,"tr",34),e.DNE(105,By,1,0,"tr",35),e.k0s(),e.DNE(106,Ly,9,0,"div",36),e.k0s()()()()),2&r){const a=e.sdS(77);e.R7$(11),e.Y8G("ngModel",i.searchQuery),e.R7$(21),e.JRh(i.totalProducts),e.R7$(11),e.JRh(i.availableProducts),e.R7$(11),e.JRh(i.lowStockProducts),e.R7$(11),e.JRh(i.outOfStockProducts),e.R7$(8),e.Y8G("matMenuTriggerFor",a),e.R7$(15),e.Y8G("dataSource",i.dataSource),e.R7$(16),e.Y8G("matHeaderRowDef",i.displayedColumns),e.R7$(1),e.Y8G("matRowDefColumns",i.displayedColumns),e.R7$(1),e.Y8G("ngIf",0===i.dataSource.data.length)}},dependencies:[D.YU,D.bT,b.me,b.BC,b.vS,j.RN,j.m2,j.MM,j.dh,B.$z,B.iY,B.$0,H.An,ae.kk,ae.fb,ae.Cp,ge.rl,ge.nJ,ge.yw,Ee.fg,_e.Zl,_e.tL,_e.ji,_e.cC,_e.YV,_e.iL,_e.KS,_e.$R,_e.YZ,_e.NB,Ae.sG]})}}return n})();function Gy(n,o){if(1&n&&(e.j41(0,"div",42)(1,"div",43)(2,"p",44),e.EFF(3),e.k0s(),e.j41(4,"p",45),e.EFF(5),e.k0s()(),e.j41(6,"div",46)(7,"mat-chip",47),e.EFF(8),e.k0s()(),e.j41(9,"div",48),e.EFF(10),e.k0s()()),2&n){const t=o.$implicit;e.R7$(3),e.SpI("#",t.orderNumber,""),e.R7$(2),e.JRh(t.customerName),e.R7$(2),e.Y8G("ngClass","status-"+t.status.toLowerCase()),e.R7$(1),e.SpI(" ",t.status," "),e.R7$(2),e.SpI("\u20b9",t.totalAmount,"")}}function Uy(n,o){1&n&&(e.j41(0,"div",49)(1,"mat-icon"),e.EFF(2,"inbox"),e.k0s(),e.j41(3,"p"),e.EFF(4,"No recent orders"),e.k0s()())}function zy(n,o){if(1&n&&(e.j41(0,"div",50)(1,"div",51)(2,"p",52),e.EFF(3),e.k0s(),e.j41(4,"p",53),e.EFF(5),e.k0s()(),e.j41(6,"button",54)(7,"mat-icon"),e.EFF(8,"add"),e.k0s()()()),2&n){const t=o.$implicit;e.R7$(3),e.JRh(t.customName),e.R7$(2),e.SpI("Stock: ",t.stockQuantity,"")}}function Vy(n,o){1&n&&(e.j41(0,"div",49)(1,"mat-icon"),e.EFF(2,"check_circle"),e.k0s(),e.j41(3,"p"),e.EFF(4,"All products well stocked"),e.k0s()())}let is=(()=>{class n{constructor(t,r,i,a){this.http=t,this.router=r,this.shopContext=i,this.snackBar=a,this.destroy$=new _n.B,this.apiUrl=Oe.c.apiUrl,this.shopId=null,this.loading=!1,this.startDate=null,this.endDate=null,this.stats={todayRevenue:0,totalOrders:0,pendingOrders:0,activeProducts:0,lowStockCount:0,completedOrders:0,monthlyRevenue:0,weeklyOrders:0,totalRevenue:0},this.recentOrders=[],this.lowStockProducts=[],this.salesChartData=[],this.revenueChartData=[]}ngOnInit(){this.shopContext.shop$.pipe((0,ot.Q)(this.destroy$)).subscribe(t=>{t&&(this.shopId=t.id,this.loadAllDashboardData())})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadAllDashboardData(){this.shopId&&(this.loading=!0,this.loadDashboardStats(),this.loadRecentOrders(),this.loadLowStockProducts(),this.loadChartData())}loadDashboardStats(){this.shopId&&this.http.get(`${this.apiUrl}/orders/shop/${this.shopId}?size=100`).pipe((0,ot.Q)(this.destroy$)).subscribe({next:t=>{this.calculateStats(t.content||t||[]),this.loadProductStats()},error:t=>{console.error("Error loading dashboard stats:",t),this.handleError("Failed to load dashboard statistics"),this.loading=!1}})}calculateStats(t){const r=new Date,i=r.toDateString(),a=new Date(r.setDate(r.getDate()-r.getDay())),s=new Date(r.getFullYear(),r.getMonth(),1);let l=t;this.startDate&&this.endDate&&(l=t.filter(P=>{const x=new Date(P.createdAt);return x>=this.startDate&&x<=this.endDate}));const u=t.filter(P=>new Date(P.createdAt).toDateString()===i),p=t.filter(P=>new Date(P.createdAt)>=a),f=t.filter(P=>new Date(P.createdAt)>=s),h=u.filter(P=>"DELIVERED"===P.status).reduce((P,x)=>P+(x.totalAmount||0),0),_=f.filter(P=>"DELIVERED"===P.status).reduce((P,x)=>P+(x.totalAmount||0),0),C=t.filter(P=>"DELIVERED"===P.status).reduce((P,x)=>P+(x.totalAmount||0),0);this.stats={todayRevenue:h,totalOrders:t.length,pendingOrders:t.filter(P=>"PENDING"===P.status).length,completedOrders:t.filter(P=>"DELIVERED"===P.status).length,monthlyRevenue:_,weeklyOrders:p.length,totalRevenue:C,activeProducts:0,lowStockCount:0}}loadProductStats(){console.warn("Product APIs are broken - using fallback data"),this.stats.activeProducts=5,this.stats.lowStockCount=2,this.loading=!1}loadRecentOrders(){this.shopId&&this.http.get(`${this.apiUrl}/orders/shop/${this.shopId}`,{params:{size:"10"}}).pipe((0,ot.Q)(this.destroy$)).subscribe({next:t=>{const i=(t.content||t||[]).sort((a,s)=>new Date(s.createdAt).getTime()-new Date(a.createdAt).getTime());this.recentOrders=i.slice(0,5).map(a=>({id:a.id,orderNumber:a.orderNumber,customerName:a.customerName||"N/A",status:a.status,totalAmount:a.totalAmount,createdAt:a.createdAt}))},error:t=>{console.error("Error loading recent orders:",t),this.recentOrders=[]}})}loadLowStockProducts(){console.warn("Product APIs broken - showing sample low stock products"),this.lowStockProducts=[{id:1,customName:"Coffee Beans Arabica",stockQuantity:5,isAvailable:!0,price:999},{id:2,customName:"Garden Soil Organic",stockQuantity:3,isAvailable:!0,price:199}]}loadChartData(){const t=Array.from({length:7},(r,i)=>{const a=new Date;return a.setDate(a.getDate()-(6-i)),a});this.http.get(`${this.apiUrl}/orders/shop/${this.shopId}`,{params:{size:"200"}}).pipe((0,ot.Q)(this.destroy$)).subscribe({next:r=>{this.generateChartData(r.content||r||[],t)},error:r=>{console.error("Error loading chart data:",r),this.salesChartData=t.map(i=>({name:i.toLocaleDateString("en-IN",{weekday:"short"}),value:0})),this.revenueChartData=t.map(i=>({name:i.toLocaleDateString("en-IN",{weekday:"short"}),value:0}))}})}generateChartData(t,r){this.salesChartData=r.map(i=>{const a=t.filter(s=>new Date(s.createdAt).toDateString()===i.toDateString());return{name:i.toLocaleDateString("en-IN",{weekday:"short"}),value:a.length}}),this.revenueChartData=r.map(i=>{const a=t.filter(s=>new Date(s.createdAt).toDateString()===i.toDateString()&&"DELIVERED"===s.status).reduce((s,l)=>s+(l.totalAmount||0),0);return{name:i.toLocaleDateString("en-IN",{weekday:"short"}),value:a}})}refreshData(){this.loadAllDashboardData(),this.snackBar.open("Dashboard refreshed","Close",{duration:2e3})}onDateChange(){this.startDate&&this.endDate&&this.loadAllDashboardData()}viewOrderDetails(t){window.open(`/shop-owner/orders-management?orderId=${t.id}`,"_blank")}updateProductStock(t){window.open("/shop-owner/products","_blank")}handleError(t){this.snackBar.open(t,"Close",{duration:5e3,panelClass:["error-snackbar"]})}formatCurrency(t){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(t)}formatDate(t){return new Date(t).toLocaleDateString("en-IN",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})}getStatusBadgeClass(t){switch(t){case"PENDING":return"badge-warning";case"CONFIRMED":case"OUT_FOR_DELIVERY":return"badge-info";case"PREPARING":return"badge-primary";case"READY_FOR_PICKUP":case"DELIVERED":return"badge-success";case"CANCELLED":return"badge-danger";default:return"badge-secondary"}}getGrowthPercentage(t,r){return 0===r?t>0?100:0:Math.round((t-r)/r*100)}goToOrders(){this.router.navigate(["/shop-owner/orders-management"])}goToProducts(){this.router.navigate(["/shop-owner/products"])}goToSettings(){this.router.navigate(["/shop-owner/settings"])}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(gt.Qq),e.rXU(Xe.Ix),e.rXU($r.h),e.rXU(Ce.UG))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-business-summary"]],decls:144,vars:15,consts:[[1,"business-summary-container"],[1,"header-section"],[1,"header-left"],[1,"page-title"],[1,"welcome-text"],[1,"header-right"],["appearance","outline",1,"date-filter"],[3,"rangePicker"],["matStartDate","","placeholder","From date",3,"ngModel","ngModelChange","dateChange"],["matEndDate","","placeholder","To date",3,"ngModel","ngModelChange","dateChange"],["matSuffix","",3,"for"],["picker",""],["mat-icon-button","","matTooltip","Refresh",3,"click"],[1,"stats-grid"],[1,"stat-card"],[1,"stat-icon","revenue"],[1,"stat-details"],[1,"stat-label"],[1,"stat-value"],[1,"stat-change","positive"],[1,"stat-icon","monthly"],[1,"stat-icon","total"],[1,"stat-change"],[1,"stat-icon","orders"],[1,"stat-icon","pending"],[1,"stat-icon","products"],[1,"content-grid"],[1,"recent-orders"],["mat-button","","color","primary","routerLink","/shop-owner/orders-management"],[1,"orders-list"],["class","order-item",4,"ngFor","ngForOf"],["class","no-data",4,"ngIf"],[1,"low-stock-alert"],["mat-button","","color","primary","routerLink","/shop-owner/products-pricing"],[1,"stock-list"],["class","stock-item",4,"ngFor","ngForOf"],[1,"quick-actions"],[1,"actions-grid"],["mat-raised-button","","color","primary","routerLink","/shop-owner/products-pricing"],["mat-raised-button","","color","accent","routerLink","/shop-owner/orders-management"],["mat-raised-button","","routerLink","/shop-owner/profile"],["mat-raised-button",""],[1,"order-item"],[1,"order-info"],[1,"order-id"],[1,"order-customer"],[1,"order-status"],[3,"ngClass"],[1,"order-amount"],[1,"no-data"],[1,"stock-item"],[1,"product-info"],[1,"product-name"],[1,"stock-level"],["mat-mini-fab","","color","accent"]],template:function(r,i){if(1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),e.EFF(4,"Business Summary"),e.k0s(),e.j41(5,"p",4),e.EFF(6,"Welcome back! Here's your shop performance overview"),e.k0s()(),e.j41(7,"div",5)(8,"mat-form-field",6)(9,"mat-label"),e.EFF(10,"Date Range"),e.k0s(),e.j41(11,"mat-date-range-input",7)(12,"input",8),e.bIt("ngModelChange",function(s){return i.startDate=s})("dateChange",function(){return i.onDateChange()}),e.k0s(),e.j41(13,"input",9),e.bIt("ngModelChange",function(s){return i.endDate=s})("dateChange",function(){return i.onDateChange()}),e.k0s()(),e.nrm(14,"mat-datepicker-toggle",10)(15,"mat-date-range-picker",null,11),e.k0s(),e.j41(17,"button",12),e.bIt("click",function(){return i.refreshData()}),e.j41(18,"mat-icon"),e.EFF(19,"refresh"),e.k0s()()()(),e.j41(20,"div",13)(21,"mat-card",14)(22,"mat-card-content")(23,"div",15)(24,"mat-icon"),e.EFF(25,"account_balance_wallet"),e.k0s()(),e.j41(26,"div",16)(27,"p",17),e.EFF(28,"Today's Revenue"),e.k0s(),e.j41(29,"h2",18),e.EFF(30),e.k0s(),e.j41(31,"p",19)(32,"mat-icon"),e.EFF(33,"trending_up"),e.k0s(),e.EFF(34," +12% from yesterday "),e.k0s()()()(),e.j41(35,"mat-card",14)(36,"mat-card-content")(37,"div",20)(38,"mat-icon"),e.EFF(39,"calendar_month"),e.k0s()(),e.j41(40,"div",16)(41,"p",17),e.EFF(42,"Monthly Revenue"),e.k0s(),e.j41(43,"h2",18),e.EFF(44),e.k0s(),e.j41(45,"p",19)(46,"mat-icon"),e.EFF(47,"trending_up"),e.k0s(),e.EFF(48," This month "),e.k0s()()()(),e.j41(49,"mat-card",14)(50,"mat-card-content")(51,"div",21)(52,"mat-icon"),e.EFF(53,"payments"),e.k0s()(),e.j41(54,"div",16)(55,"p",17),e.EFF(56,"Total Revenue"),e.k0s(),e.j41(57,"h2",18),e.EFF(58),e.k0s(),e.j41(59,"p",22)(60,"mat-icon"),e.EFF(61,"account_balance"),e.k0s(),e.EFF(62," All time "),e.k0s()()()(),e.j41(63,"mat-card",14)(64,"mat-card-content")(65,"div",23)(66,"mat-icon"),e.EFF(67,"shopping_cart"),e.k0s()(),e.j41(68,"div",16)(69,"p",17),e.EFF(70,"Total Orders"),e.k0s(),e.j41(71,"h2",18),e.EFF(72),e.k0s(),e.j41(73,"p",19)(74,"mat-icon"),e.EFF(75,"trending_up"),e.k0s(),e.EFF(76," +5 new today "),e.k0s()()()(),e.j41(77,"mat-card",14)(78,"mat-card-content")(79,"div",24)(80,"mat-icon"),e.EFF(81,"pending_actions"),e.k0s()(),e.j41(82,"div",16)(83,"p",17),e.EFF(84,"Pending Orders"),e.k0s(),e.j41(85,"h2",18),e.EFF(86),e.k0s(),e.j41(87,"p",22),e.EFF(88,"Requires action"),e.k0s()()()(),e.j41(89,"mat-card",14)(90,"mat-card-content")(91,"div",25)(92,"mat-icon"),e.EFF(93,"inventory_2"),e.k0s()(),e.j41(94,"div",16)(95,"p",17),e.EFF(96,"Active Products"),e.k0s(),e.j41(97,"h2",18),e.EFF(98),e.k0s(),e.j41(99,"p",22),e.EFF(100),e.k0s()()()()(),e.j41(101,"div",26)(102,"mat-card",27)(103,"mat-card-header")(104,"mat-card-title"),e.EFF(105,"Recent Orders"),e.k0s(),e.j41(106,"button",28),e.EFF(107,"View All"),e.k0s()(),e.j41(108,"mat-card-content")(109,"div",29),e.DNE(110,Gy,11,5,"div",30),e.DNE(111,Uy,5,0,"div",31),e.k0s()()(),e.j41(112,"mat-card",32)(113,"mat-card-header")(114,"mat-card-title"),e.EFF(115,"Low Stock Alert"),e.k0s(),e.j41(116,"button",33),e.EFF(117,"Manage"),e.k0s()(),e.j41(118,"mat-card-content")(119,"div",34),e.DNE(120,zy,9,2,"div",35),e.DNE(121,Vy,5,0,"div",31),e.k0s()()()(),e.j41(122,"mat-card",36)(123,"mat-card-header")(124,"mat-card-title"),e.EFF(125,"Quick Actions"),e.k0s()(),e.j41(126,"mat-card-content")(127,"div",37)(128,"button",38)(129,"mat-icon"),e.EFF(130,"inventory"),e.k0s(),e.EFF(131," Manage Products "),e.k0s(),e.j41(132,"button",39)(133,"mat-icon"),e.EFF(134,"receipt"),e.k0s(),e.EFF(135," View Orders "),e.k0s(),e.j41(136,"button",40)(137,"mat-icon"),e.EFF(138,"store"),e.k0s(),e.EFF(139," Shop Profile "),e.k0s(),e.j41(140,"button",41)(141,"mat-icon"),e.EFF(142,"analytics"),e.k0s(),e.EFF(143," View Reports "),e.k0s()()()()()),2&r){const a=e.sdS(16);e.R7$(11),e.Y8G("rangePicker",a),e.R7$(1),e.Y8G("ngModel",i.startDate),e.R7$(1),e.Y8G("ngModel",i.endDate),e.R7$(1),e.Y8G("for",a),e.R7$(16),e.SpI("\u20b9",i.stats.todayRevenue||0,""),e.R7$(14),e.SpI("\u20b9",i.stats.monthlyRevenue||0,""),e.R7$(14),e.SpI("\u20b9",i.stats.totalRevenue||0,""),e.R7$(14),e.JRh(i.stats.totalOrders||0),e.R7$(14),e.JRh(i.stats.pendingOrders||0),e.R7$(12),e.JRh(i.stats.activeProducts||0),e.R7$(2),e.SpI("",i.stats.lowStockCount||0," low in stock"),e.R7$(10),e.Y8G("ngForOf",i.recentOrders),e.R7$(1),e.Y8G("ngIf",!i.recentOrders||0===i.recentOrders.length),e.R7$(9),e.Y8G("ngForOf",i.lowStockProducts),e.R7$(1),e.Y8G("ngIf",!i.lowStockProducts||0===i.lowStockProducts.length)}},dependencies:[D.YU,D.Sq,D.bT,b.me,b.BC,b.vS,Xe.Wk,j.RN,j.m2,j.MM,j.dh,B.$z,B.iY,B.$0,H.An,Ve.Jl,ge.rl,ge.nJ,ge.yw,qe.oV,Et.bU,Et.el,Et.xR,Et.IG,Et.SG],styles:[".business-summary-container[_ngcontent-%COMP%]{padding:24px;max-width:1400px;margin:0 auto}.header-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:32px;gap:20px;flex-wrap:wrap}.header-section[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]{flex:1;min-width:250px}.header-section[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-size:28px;font-weight:600;margin:0 0 8px;color:#333}.header-section[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .welcome-text[_ngcontent-%COMP%]{color:#666;font-size:14px;margin:0}.header-section[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.header-section[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .date-filter[_ngcontent-%COMP%]{min-width:280px}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:32px}.stat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{display:flex;align-items:center;padding:20px!important}.stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:12px;display:flex;align-items:center;justify-content:center;margin-right:16px}.stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px;color:#fff}.stat-card[_ngcontent-%COMP%]   .stat-icon.revenue[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)}.stat-card[_ngcontent-%COMP%]   .stat-icon.monthly[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4facfe 0%,#00f2fe 100%)}.stat-card[_ngcontent-%COMP%]   .stat-icon.total[_ngcontent-%COMP%]{background:linear-gradient(135deg,#43e97b 0%,#38f9d7 100%)}.stat-card[_ngcontent-%COMP%]   .stat-icon.orders[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%)}.stat-card[_ngcontent-%COMP%]   .stat-icon.pending[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fa709a 0%,#fee140 100%)}.stat-card[_ngcontent-%COMP%]   .stat-icon.products[_ngcontent-%COMP%]{background:linear-gradient(135deg,#30cfd0 0%,#330867 100%)}.stat-card[_ngcontent-%COMP%]   .stat-details[_ngcontent-%COMP%]{flex:1}.stat-card[_ngcontent-%COMP%]   .stat-details[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:12px;color:#999;margin:0 0 4px;text-transform:uppercase;letter-spacing:.5px}.stat-card[_ngcontent-%COMP%]   .stat-details[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:28px;font-weight:600;margin:0 0 4px;color:#333}.stat-card[_ngcontent-%COMP%]   .stat-details[_ngcontent-%COMP%]   .stat-change[_ngcontent-%COMP%]{font-size:12px;color:#666;margin:0;display:flex;align-items:center;gap:4px}.stat-card[_ngcontent-%COMP%]   .stat-details[_ngcontent-%COMP%]   .stat-change[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.stat-card[_ngcontent-%COMP%]   .stat-details[_ngcontent-%COMP%]   .stat-change.positive[_ngcontent-%COMP%]{color:#4caf50}.stat-card[_ngcontent-%COMP%]   .stat-details[_ngcontent-%COMP%]   .stat-change.negative[_ngcontent-%COMP%]{color:#f44336}.content-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr;gap:20px;margin-bottom:20px}@media (max-width: 960px){.content-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.recent-orders[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%], .low-stock-alert[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.recent-orders[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%], .low-stock-alert[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:18px;font-weight:500}.orders-list[_ngcontent-%COMP%]   .order-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px;border-bottom:1px solid #f0f0f0}.orders-list[_ngcontent-%COMP%]   .order-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.orders-list[_ngcontent-%COMP%]   .order-item[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]{flex:1}.orders-list[_ngcontent-%COMP%]   .order-item[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   .order-id[_ngcontent-%COMP%]{font-weight:500;margin:0 0 4px;color:#333}.orders-list[_ngcontent-%COMP%]   .order-item[_ngcontent-%COMP%]   .order-info[_ngcontent-%COMP%]   .order-customer[_ngcontent-%COMP%]{font-size:12px;color:#666;margin:0}.orders-list[_ngcontent-%COMP%]   .order-item[_ngcontent-%COMP%]   .order-status[_ngcontent-%COMP%]{margin:0 16px}.orders-list[_ngcontent-%COMP%]   .order-item[_ngcontent-%COMP%]   .order-status[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]{font-size:11px;height:24px;line-height:24px}.orders-list[_ngcontent-%COMP%]   .order-item[_ngcontent-%COMP%]   .order-status[_ngcontent-%COMP%]   mat-chip.status-pending[_ngcontent-%COMP%]{background-color:#fff3cd;color:#856404}.orders-list[_ngcontent-%COMP%]   .order-item[_ngcontent-%COMP%]   .order-status[_ngcontent-%COMP%]   mat-chip.status-confirmed[_ngcontent-%COMP%]{background-color:#cce5ff;color:#004085}.orders-list[_ngcontent-%COMP%]   .order-item[_ngcontent-%COMP%]   .order-status[_ngcontent-%COMP%]   mat-chip.status-delivered[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724}.orders-list[_ngcontent-%COMP%]   .order-item[_ngcontent-%COMP%]   .order-amount[_ngcontent-%COMP%]{font-weight:600;color:#333}.stock-list[_ngcontent-%COMP%]   .stock-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px;border-bottom:1px solid #f0f0f0}.stock-list[_ngcontent-%COMP%]   .stock-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.stock-list[_ngcontent-%COMP%]   .stock-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]{flex:1}.stock-list[_ngcontent-%COMP%]   .stock-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-name[_ngcontent-%COMP%]{font-weight:500;margin:0 0 4px;color:#333}.stock-list[_ngcontent-%COMP%]   .stock-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .stock-level[_ngcontent-%COMP%]{font-size:12px;color:#f44336;margin:0}.no-data[_ngcontent-%COMP%]{text-align:center;padding:32px;color:#999}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:8px;opacity:.5}.no-data[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}.quick-actions[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{margin-bottom:16px}.quick-actions[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:18px;font-weight:500}.quick-actions[_ngcontent-%COMP%]   .actions-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px}.quick-actions[_ngcontent-%COMP%]   .actions-grid[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;justify-content:center}.quick-actions[_ngcontent-%COMP%]   .actions-grid[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}"]})}}return n})();function Yy(n,o){if(1&n&&(e.j41(0,"span",37)(1,"mat-icon"),e.EFF(2,"category"),e.k0s(),e.EFF(3),e.k0s()),2&n){const t=e.XpG();e.R7$(3),e.SpI(" ",null==t.data.product.category?null:t.data.product.category.name," ")}}function Xy(n,o){if(1&n&&(e.j41(0,"div",38)(1,"div",39)(2,"mat-icon"),e.EFF(3),e.k0s(),e.j41(4,"span"),e.EFF(5),e.nI1(6,"number"),e.nI1(7,"number"),e.k0s()()()),2&n){const t=e.XpG();e.R7$(1),e.AVh("positive",t.getProfit()>0)("negative",t.getProfit()<0),e.R7$(2),e.JRh(t.getProfit()>=0?"trending_up":"trending_down"),e.R7$(2),e.Lme("Profit: \u20b9",e.i5U(6,7,t.getProfit(),"1.0-0")," (",e.i5U(7,10,t.getProfitPercentage(),"1.0-0"),"%)")}}function Hy(n,o){1&n&&(e.j41(0,"mat-icon"),e.EFF(1,"add_circle"),e.k0s())}function Wy(n,o){1&n&&e.nrm(0,"mat-progress-spinner",40)}let qy=(()=>{class n{constructor(t,r,i,a,s,l){this.fb=t,this.dialogRef=r,this.data=i,this.snackBar=a,this.http=s,this.offlineStorage=l,this.isLoading=!1,this.apiUrl=Oe.c.apiUrl,this.assignmentForm=this.fb.group({price:[i.product.minPrice||i.product.maxPrice||100,[b.k0.required,b.k0.min(.01)]],originalPrice:[null,[b.k0.min(0)]],stockQuantity:[0,[b.k0.min(0)]],costPrice:[null,[b.k0.min(0)]],customName:[""],customDescription:[""],sku:[i.product.sku||"",[b.k0.required]],barcode1:[i.product.barcode||""],barcode2:[""],barcode3:[""],nameTamil:[i.product.nameTamil||""],tags:[i.product.tags||""],voiceSearchTags:[i.product.voiceSearchTags||""],isAvailable:[!0]})}ngOnInit(){this.data.product.minPrice&&this.assignmentForm.patchValue({price:this.data.product.minPrice})}getProfit(){return(this.assignmentForm.get("price")?.value||0)-(this.assignmentForm.get("costPrice")?.value||0)}getProfitPercentage(){const t=this.assignmentForm.get("price")?.value||0,r=this.assignmentForm.get("costPrice")?.value||0;return 0===r?0:(t-r)/r*100}assignProduct(){var t=this;if(this.assignmentForm.invalid)return void this.markFormGroupTouched();this.isLoading=!0;const r=this.assignmentForm.value,i={masterProductId:this.data.product.id,price:r.price,originalPrice:r.originalPrice||null,stockQuantity:r.stockQuantity||0,costPrice:r.costPrice||null,isAvailable:r.isAvailable,customName:r.customName||void 0,customDescription:r.customDescription||void 0,sku:r.sku||void 0,barcode1:r.barcode1||void 0,barcode2:r.barcode2||void 0,barcode3:r.barcode3||void 0,nameTamil:r.nameTamil||void 0,tags:r.tags||void 0,voiceSearchTags:r.voiceSearchTags||void 0};var a;console.log("Assigning product with data:",i),this.http.post(`${this.apiUrl}/shop-products/create`,i).subscribe({next:(a=(0,fe.A)(function*(s){localStorage.removeItem("pos_products_last_sync"),localStorage.setItem("pos_products_changed","true");try{const l=parseInt(localStorage.getItem("current_shop_id")||"0",10),u=t.assignmentForm.value,p={id:s.id,shopId:l,name:u.customName||t.data.product.name,nameTamil:u.nameTamil||t.data.product.nameTamil||"",price:u.price,originalPrice:u.originalPrice||u.price,costPrice:u.costPrice||0,stock:u.stockQuantity||0,trackInventory:!0,isAvailable:u.isAvailable,sku:u.sku||"",barcode:u.barcode1||"",barcode1:u.barcode1||"",barcode2:u.barcode2||"",barcode3:u.barcode3||"",category:t.data.product.category?.name||"",unit:t.data.product.baseUnit||"piece",imageUrl:t.data.product.primaryImageUrl||"",tags:u.tags?u.tags.split(",").map(f=>f.trim()):[]};yield t.offlineStorage.addProductToCache(p),console.log("Added assigned product to IndexedDB cache for immediate POS search:",p.name)}catch(l){console.warn("Failed to add product to IndexedDB cache:",l)}t.snackBar.open(`Successfully added "${t.data.product.name}" to your shop`,"Close",{duration:3e3,panelClass:"success-snackbar"}),t.dialogRef.close({success:!0,data:s})}),function(l){return a.apply(this,arguments)}),error:a=>{console.error("Error assigning product:",a),this.snackBar.open(`Error: ${a.error?.message||a.message||"Failed to add product"}`,"Close",{duration:4e3,panelClass:"error-snackbar"}),this.isLoading=!1}})}markFormGroupTouched(){Object.keys(this.assignmentForm.controls).forEach(t=>{this.assignmentForm.get(t)?.markAsTouched()})}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(b.ok),e.rXU(Pe.CP),e.rXU(Pe.Vh),e.rXU(Ce.UG),e.rXU(gt.Qq),e.rXU(at.m))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-product-assignment-dialog"]],decls:115,vars:14,consts:[[1,"assignment-dialog-container"],[1,"dialog-header"],["mat-dialog-close","",1,"close-btn"],[1,"dialog-content"],[1,"product-card"],[1,"product-image"],["onerror","this.src='/assets/images/product-placeholder.svg'",3,"src","alt"],[1,"product-details"],[1,"product-name"],["class","category-badge",4,"ngIf"],[1,"assignment-form",3,"formGroup"],[1,"form-section"],[1,"section-header"],[1,"section-content"],[1,"input-row"],[1,"input-group"],[1,"input-with-icon"],[1,"currency"],["type","number","formControlName","price","placeholder","0.00"],["type","number","formControlName","originalPrice","placeholder","Optional"],["type","number","formControlName","costPrice","placeholder","Optional"],[1,"input-icon"],["type","number","formControlName","stockQuantity","placeholder","0"],["class","profit-row",4,"ngIf"],["type","text","formControlName","sku","placeholder","Product SKU"],["type","text","formControlName","barcode1","placeholder","Optional"],[1,"input-group","full"],["type","text","formControlName","customName","placeholder","Override product name (optional)"],["type","text","formControlName","nameTamil","placeholder","\u0ba4\u0bae\u0bbf\u0bb4\u0bcd \u0baa\u0bc6\u0baf\u0bb0\u0bcd (optional)"],[1,"availability-section"],[1,"toggle-wrapper"],["formControlName","isAvailable","color","primary"],[1,"dialog-actions"],["mat-dialog-close","",1,"btn-cancel"],[1,"btn-submit",3,"disabled","click"],[4,"ngIf"],["diameter","18","mode","indeterminate",4,"ngIf"],[1,"category-badge"],[1,"profit-row"],[1,"profit-badge"],["diameter","18","mode","indeterminate"]],template:function(r,i){if(1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"h2")(3,"mat-icon"),e.EFF(4,"add_business"),e.k0s(),e.EFF(5," Add to Shop "),e.k0s(),e.j41(6,"button",2)(7,"mat-icon"),e.EFF(8,"close"),e.k0s()()(),e.j41(9,"div",3)(10,"div",4)(11,"div",5),e.nrm(12,"img",6),e.k0s(),e.j41(13,"div",7)(14,"h3",8),e.EFF(15),e.k0s(),e.DNE(16,Yy,4,1,"span",9),e.k0s()(),e.j41(17,"form",10)(18,"div",11)(19,"div",12)(20,"mat-icon"),e.EFF(21,"payments"),e.k0s(),e.j41(22,"span"),e.EFF(23,"Pricing"),e.k0s()(),e.j41(24,"div",13)(25,"div",14)(26,"div",15)(27,"label"),e.EFF(28,"Selling Price *"),e.k0s(),e.j41(29,"div",16)(30,"span",17),e.EFF(31,"\u20b9"),e.k0s(),e.nrm(32,"input",18),e.k0s()(),e.j41(33,"div",15)(34,"label"),e.EFF(35,"MRP"),e.k0s(),e.j41(36,"div",16)(37,"span",17),e.EFF(38,"\u20b9"),e.k0s(),e.nrm(39,"input",19),e.k0s()()(),e.j41(40,"div",14)(41,"div",15)(42,"label"),e.EFF(43,"Cost Price"),e.k0s(),e.j41(44,"div",16)(45,"span",17),e.EFF(46,"\u20b9"),e.k0s(),e.nrm(47,"input",20),e.k0s()(),e.j41(48,"div",15)(49,"label"),e.EFF(50,"Stock Qty"),e.k0s(),e.j41(51,"div",16)(52,"mat-icon",21),e.EFF(53,"inventory_2"),e.k0s(),e.nrm(54,"input",22),e.k0s()()(),e.DNE(55,Xy,8,13,"div",23),e.k0s()(),e.j41(56,"div",11)(57,"div",12)(58,"mat-icon"),e.EFF(59,"qr_code_scanner"),e.k0s(),e.j41(60,"span"),e.EFF(61,"Identification"),e.k0s()(),e.j41(62,"div",13)(63,"div",14)(64,"div",15)(65,"label"),e.EFF(66,"SKU *"),e.k0s(),e.j41(67,"div",16)(68,"mat-icon",21),e.EFF(69,"tag"),e.k0s(),e.nrm(70,"input",24),e.k0s()(),e.j41(71,"div",15)(72,"label"),e.EFF(73,"Barcode"),e.k0s(),e.j41(74,"div",16)(75,"mat-icon",21),e.EFF(76,"qr_code"),e.k0s(),e.nrm(77,"input",25),e.k0s()()()()(),e.j41(78,"div",11)(79,"div",12)(80,"mat-icon"),e.EFF(81,"edit_note"),e.k0s(),e.j41(82,"span"),e.EFF(83,"Custom Details"),e.k0s()(),e.j41(84,"div",13)(85,"div",26)(86,"label"),e.EFF(87,"Custom Name"),e.k0s(),e.j41(88,"div",16)(89,"mat-icon",21),e.EFF(90,"badge"),e.k0s(),e.nrm(91,"input",27),e.k0s()(),e.j41(92,"div",26)(93,"label"),e.EFF(94,"Tamil Name"),e.k0s(),e.j41(95,"div",16)(96,"mat-icon",21),e.EFF(97,"translate"),e.k0s(),e.nrm(98,"input",28),e.k0s()()()(),e.j41(99,"div",29)(100,"div",30)(101,"mat-icon"),e.EFF(102),e.k0s(),e.j41(103,"span"),e.EFF(104),e.k0s(),e.nrm(105,"mat-slide-toggle",31),e.k0s()()()(),e.j41(106,"div",32)(107,"button",33)(108,"mat-icon"),e.EFF(109,"close"),e.k0s(),e.EFF(110," Cancel "),e.k0s(),e.j41(111,"button",34),e.bIt("click",function(){return i.assignProduct()}),e.DNE(112,Hy,2,0,"mat-icon",35),e.DNE(113,Wy,1,0,"mat-progress-spinner",36),e.EFF(114),e.k0s()()()),2&r){let a,s,l,u;e.R7$(12),e.Y8G("src",i.data.product.primaryImageUrl||"/assets/images/product-placeholder.svg",e.B4B)("alt",i.data.product.name),e.R7$(3),e.JRh(i.data.product.name),e.R7$(1),e.Y8G("ngIf",null==i.data.product.category?null:i.data.product.category.name),e.R7$(1),e.Y8G("formGroup",i.assignmentForm),e.R7$(38),e.Y8G("ngIf",(null==(a=i.assignmentForm.get("price"))?null:a.value)&&(null==(a=i.assignmentForm.get("costPrice"))?null:a.value)),e.R7$(45),e.AVh("available",null==(s=i.assignmentForm.get("isAvailable"))?null:s.value),e.R7$(2),e.JRh(null!=(l=i.assignmentForm.get("isAvailable"))&&l.value?"visibility":"visibility_off"),e.R7$(2),e.JRh(null!=(u=i.assignmentForm.get("isAvailable"))&&u.value?"Available for sale":"Hidden from customers"),e.R7$(7),e.Y8G("disabled",i.assignmentForm.invalid||i.isLoading),e.R7$(1),e.Y8G("ngIf",!i.isLoading),e.R7$(1),e.Y8G("ngIf",i.isLoading),e.R7$(1),e.SpI(" ",i.isLoading?"Adding...":"Add to Shop"," ")}},dependencies:[D.bT,b.qT,b.me,b.Q0,b.BC,b.cb,b.j4,b.JD,H.An,X.LG,Pe.tx,Ae.sG,D.QX],styles:[".assignment-dialog-container[_ngcontent-%COMP%]{width:100%;max-width:95vw;background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 20px 60px #00000026}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;background:linear-gradient(135deg,#22c55e 0%,#16a34a 100%)}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin:0;color:#fff;font-size:17px;font-weight:700}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:22px;width:22px;height:22px}.dialog-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{color:#fff;background:rgba(255,255,255,.2);border-radius:50%;width:32px;height:32px;min-width:32px;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;padding:0;margin:0;line-height:1;outline:none;appearance:none;box-sizing:border-box}.dialog-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:hover{background:rgba(255,255,255,.3)}.dialog-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;line-height:18px;display:flex;align-items:center;justify-content:center}.dialog-content[_ngcontent-%COMP%]{padding:16px;max-height:65vh;overflow-y:auto;background:#f8fafc}.dialog-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:5px}.dialog-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.product-card[_ngcontent-%COMP%]{display:flex;gap:12px;background:#fff;padding:12px;border-radius:12px;margin-bottom:14px;border:1px solid #e2e8f0}.product-card[_ngcontent-%COMP%]   .product-image[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:10px;overflow:hidden;background:#f1f5f9;flex-shrink:0}.product-card[_ngcontent-%COMP%]   .product-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.product-card[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]{flex:1;min-width:0;display:flex;flex-direction:column;justify-content:center}.product-card[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .product-name[_ngcontent-%COMP%]{margin:0 0 6px;font-size:14px;font-weight:700;color:#1e293b;line-height:1.3;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.product-card[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .category-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;font-size:11px;font-weight:600;color:#16a34a;background:#dcfce7;padding:3px 8px;border-radius:4px;width:-moz-fit-content;width:fit-content}.product-card[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .category-badge[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:12px;width:12px;height:12px}.form-section[_ngcontent-%COMP%]{background:#fff;border-radius:10px;margin-bottom:12px;border:1px solid #e2e8f0;overflow:hidden}.form-section[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 14px;background:linear-gradient(135deg,#f8fafc 0%,#f1f5f9 100%);border-bottom:1px solid #e2e8f0;font-size:12px;font-weight:700;color:#475569;text-transform:uppercase;letter-spacing:.5px}.form-section[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;color:#22c55e}.form-section[_ngcontent-%COMP%]   .section-content[_ngcontent-%COMP%]{padding:12px 14px}.input-row[_ngcontent-%COMP%]{display:flex;gap:10px;margin-bottom:10px}.input-row[_ngcontent-%COMP%]:last-child{margin-bottom:0}.input-group[_ngcontent-%COMP%]{flex:1;min-width:0}.input-group.full[_ngcontent-%COMP%]{flex:none;width:100%}.input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:11px;font-weight:600;color:#64748b;margin-bottom:5px;text-transform:uppercase;letter-spacing:.3px}.input-group[_ngcontent-%COMP%]   .input-with-icon[_ngcontent-%COMP%]{display:flex;align-items:center;background:#f8fafc;border:1.5px solid #e2e8f0;border-radius:8px;overflow:hidden;transition:all .2s}.input-group[_ngcontent-%COMP%]   .input-with-icon[_ngcontent-%COMP%]:focus-within{border-color:#22c55e;background:#fff;box-shadow:0 0 0 3px #22c55e1a}.input-group[_ngcontent-%COMP%]   .input-with-icon[_ngcontent-%COMP%]   .currency[_ngcontent-%COMP%]{padding:0 10px;font-size:13px;font-weight:700;color:#22c55e;background:#f0fdf4;border-right:1.5px solid #e2e8f0;height:38px;display:flex;align-items:center}.input-group[_ngcontent-%COMP%]   .input-with-icon[_ngcontent-%COMP%]   .input-icon[_ngcontent-%COMP%]{padding:0 8px 0 10px;font-size:16px;width:16px;height:16px;color:#94a3b8}.input-group[_ngcontent-%COMP%]   .input-with-icon[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;border:none;background:transparent;padding:10px 12px 10px 0;font-size:13px;font-weight:500;color:#1e293b;outline:none;min-width:0}.input-group[_ngcontent-%COMP%]   .input-with-icon[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#94a3b8}.input-group[_ngcontent-%COMP%]   .input-with-icon[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-outer-spin-button, .input-group[_ngcontent-%COMP%]   .input-with-icon[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.input-group[_ngcontent-%COMP%]   .input-with-icon[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}.profit-row[_ngcontent-%COMP%]{margin-top:10px}.profit-row[_ngcontent-%COMP%]   .profit-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:8px 14px;border-radius:8px;font-size:12px;font-weight:700}.profit-row[_ngcontent-%COMP%]   .profit-badge[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.profit-row[_ngcontent-%COMP%]   .profit-badge.positive[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dcfce7 0%,#bbf7d0 100%);color:#16a34a}.profit-row[_ngcontent-%COMP%]   .profit-badge.negative[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fee2e2 0%,#fecaca 100%);color:#dc2626}.availability-section[_ngcontent-%COMP%]{margin-top:4px}.availability-section[_ngcontent-%COMP%]   .toggle-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:12px 14px;background:#fef2f2;border:1.5px solid #fecaca;border-radius:10px;transition:all .2s}.availability-section[_ngcontent-%COMP%]   .toggle-wrapper[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;color:#ef4444}.availability-section[_ngcontent-%COMP%]   .toggle-wrapper[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;font-size:13px;font-weight:600;color:#dc2626}.availability-section[_ngcontent-%COMP%]   .toggle-wrapper.available[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f0fdf4 0%,#dcfce7 100%);border-color:#86efac}.availability-section[_ngcontent-%COMP%]   .toggle-wrapper.available[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#22c55e}.availability-section[_ngcontent-%COMP%]   .toggle-wrapper.available[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#16a34a}.availability-section[_ngcontent-%COMP%]   .toggle-wrapper[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mdc-switch--selected .mdc-switch__track:after{background:#22c55e!important}.availability-section[_ngcontent-%COMP%]   .toggle-wrapper[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]     .mdc-switch--selected .mdc-switch__handle:after{background:#16a34a!important}.dialog-actions[_ngcontent-%COMP%]{display:flex;gap:10px;padding:14px 16px;background:#fff;border-top:1px solid #e2e8f0}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;gap:6px;padding:12px 16px;font-size:13px;font-weight:700;border-radius:10px;cursor:pointer;transition:all .2s;border:none}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-progress-spinner[_ngcontent-%COMP%]     circle{stroke:#fff}.dialog-actions[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]{background:#fff;border:2px solid #e2e8f0;color:#64748b}.dialog-actions[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]:hover{background:#f8fafc;border-color:#cbd5e1}.dialog-actions[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]{background:linear-gradient(135deg,#22c55e 0%,#16a34a 100%);color:#fff;box-shadow:0 4px 12px #22c55e4d}.dialog-actions[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 6px 16px #22c55e66;transform:translateY(-1px)}.dialog-actions[_ngcontent-%COMP%]   .btn-submit[_ngcontent-%COMP%]:disabled{background:#94a3b8;box-shadow:none;cursor:not-allowed}@media (max-width: 480px){.assignment-dialog-container[_ngcontent-%COMP%]{width:100%;border-radius:12px}.dialog-header[_ngcontent-%COMP%]{padding:14px 16px}.dialog-content[_ngcontent-%COMP%]{padding:12px}.product-card[_ngcontent-%COMP%]{padding:10px}.product-card[_ngcontent-%COMP%]   .product-image[_ngcontent-%COMP%]{width:56px;height:56px}.form-section[_ngcontent-%COMP%]   .section-content[_ngcontent-%COMP%]{padding:10px 12px}.input-row[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.dialog-actions[_ngcontent-%COMP%]{padding:12px}}"]})}}return n})();function Zy(n,o){if(1&n&&(e.j41(0,"mat-option",23),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.Y8G("value",t),e.R7$(1),e.JRh(t)}}function Qy(n,o){if(1&n&&(e.j41(0,"span",27),e.EFF(1),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.SpI("(",t.selectedProducts.length,")")}}function Jy(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",24)(1,"mat-checkbox",25),e.bIt("change",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.areAllProductsSelected()?i.clearSelection():i.selectAllProducts())}),e.EFF(2," Select All "),e.k0s(),e.DNE(3,Qy,2,1,"span",26),e.k0s()}if(2&n){const t=e.XpG();e.R7$(1),e.Y8G("checked",t.areAllProductsSelected()),e.R7$(2),e.Y8G("ngIf",t.selectedProducts.length>0)}}function Ky(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",28)(1,"div",29)(2,"button",30),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.clearSelection())}),e.j41(3,"mat-icon"),e.EFF(4,"clear"),e.k0s(),e.EFF(5," Clear "),e.k0s(),e.j41(6,"button",31),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.assignSelectedProducts())}),e.j41(7,"mat-icon"),e.EFF(8,"add_shopping_cart"),e.k0s(),e.EFF(9),e.k0s()()()}if(2&n){const t=e.XpG();e.R7$(6),e.Y8G("disabled",t.loading),e.R7$(3),e.SpI(" Add ",t.selectedProducts.length," to Shop ")}}function eM(n,o){1&n&&(e.j41(0,"div",32),e.nrm(1,"mat-progress-spinner",33),e.j41(2,"h3"),e.EFF(3,"Loading products..."),e.k0s()())}function tM(n,o){1&n&&(e.j41(0,"span",52)(1,"mat-icon"),e.EFF(2,"star"),e.k0s()())}function nM(n,o){1&n&&(e.j41(0,"span",53)(1,"mat-icon"),e.EFF(2,"public"),e.k0s()())}function rM(n,o){1&n&&(e.j41(0,"span",54)(1,"mat-icon"),e.EFF(2,"fiber_new"),e.k0s()())}function iM(n,o){if(1&n&&(e.j41(0,"div",55)(1,"mat-icon"),e.EFF(2,"category"),e.k0s(),e.EFF(3),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(3),e.SpI(" ",null==t.category?null:t.category.name," ")}}function oM(n,o){if(1&n&&(e.j41(0,"div",55)(1,"mat-icon"),e.EFF(2,"sell"),e.k0s(),e.EFF(3),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(3),e.SpI(" ",t.brand," ")}}function aM(n,o){if(1&n){const t=e.RV6();e.j41(0,"mat-card",36)(1,"div",37),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.toggleProductSelection(a))}),e.nrm(2,"img",38),e.j41(3,"div",39)(4,"mat-checkbox",40),e.bIt("click",function(i){return i.stopPropagation()})("change",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.toggleProductSelection(a))}),e.k0s()(),e.j41(5,"div",41),e.DNE(6,tM,3,0,"span",42),e.DNE(7,nM,3,0,"span",43),e.DNE(8,rM,3,0,"span",44),e.k0s(),e.j41(9,"div",45)(10,"button",46),e.bIt("click",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return i.stopPropagation(),e.Njj(l.openAssignmentDialog(s))}),e.j41(11,"mat-icon"),e.EFF(12,"add"),e.k0s()()()(),e.j41(13,"mat-card-content")(14,"div",47)(15,"h3",48),e.EFF(16),e.k0s()(),e.j41(17,"div",49),e.DNE(18,iM,4,1,"div",50),e.DNE(19,oM,4,1,"div",50),e.k0s()(),e.j41(20,"mat-card-actions")(21,"button",30),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.toggleProductSelection(a))}),e.j41(22,"mat-icon"),e.EFF(23),e.k0s(),e.EFF(24),e.k0s(),e.j41(25,"button",51),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.openAssignmentDialog(a))}),e.j41(26,"mat-icon"),e.EFF(27,"add"),e.k0s(),e.EFF(28," Add "),e.k0s()()()}if(2&n){const t=o.$implicit,r=e.XpG(2);e.AVh("selected",r.isProductSelected(t)),e.R7$(2),e.Y8G("src",t.primaryImageUrl||"/assets/images/product-placeholder.svg",e.B4B)("alt",t.name),e.R7$(2),e.Y8G("checked",r.isProductSelected(t)),e.R7$(2),e.Y8G("ngIf",t.isFeatured),e.R7$(1),e.Y8G("ngIf",t.isGlobal),e.R7$(1),e.Y8G("ngIf",t.isNew),e.R7$(8),e.JRh(t.name),e.R7$(2),e.Y8G("ngIf",null==t.category?null:t.category.name),e.R7$(1),e.Y8G("ngIf",t.brand),e.R7$(2),e.AVh("selected",r.isProductSelected(t)),e.R7$(2),e.JRh(r.isProductSelected(t)?"check":"add"),e.R7$(1),e.SpI(" ",r.isProductSelected(t)?"Selected":"Select"," ")}}function sM(n,o){if(1&n&&(e.j41(0,"div",34),e.DNE(1,aM,29,15,"mat-card",35),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.filteredProducts)("ngForTrackBy",t.trackByProductId)}}const cM=function(){return[12,24,48]};function lM(n,o){if(1&n){const t=e.RV6();e.j41(0,"mat-card",56)(1,"mat-paginator",57),e.bIt("page",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.onPageChange(i))}),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(1),e.Y8G("length",t.totalProducts)("pageSize",t.pageSize)("pageSizeOptions",e.lJ4(5,cM))("pageIndex",t.currentPage)("showFirstLastButtons",!0)}}function dM(n,o){if(1&n){const t=e.RV6();e.j41(0,"mat-card",58)(1,"div",59)(2,"mat-icon"),e.EFF(3,"inventory_2"),e.k0s()(),e.j41(4,"h2"),e.EFF(5,"No Products Found"),e.k0s(),e.j41(6,"p"),e.EFF(7,"Try adjusting your search or filters"),e.k0s(),e.j41(8,"div",60)(9,"button",51),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.clearFilters())}),e.j41(10,"mat-icon"),e.EFF(11,"refresh"),e.k0s(),e.EFF(12," Reset Filters "),e.k0s()()()}}let uM=(()=>{class n{constructor(t,r,i,a,s){this.http=t,this.snackBar=r,this.shopContext=i,this.dialog=a,this.productService=s,this.destroy$=new _n.B,this.searchSubject$=new _n.B,this.apiUrl=Oe.c.apiUrl,this.loading=!1,this.masterProducts=[],this.filteredProducts=[],this.currentPage=0,this.pageSize=12,this.totalPages=0,this.totalProducts=0,this.searchTerm="",this.selectedCategory="",this.sortBy="name",this.activeFilters=[],this.categories=[],this.selectedProducts=[],this.currentShopId=null}ngOnInit(){this.shopContext.shop$.pipe((0,ot.Q)(this.destroy$)).subscribe(t=>{this.currentShopId=t?t.id:57,this.loadMasterProducts()}),this.searchSubject$.pipe((0,xr.B)(300),(0,Ei.F)(),(0,ot.Q)(this.destroy$)).subscribe(t=>{this.searchTerm=t,this.loadMasterProducts()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadMasterProducts(){this.loading=!0,console.log("Loading available master products (excluding already assigned)..."),this.productService.getAvailableMasterProducts(this.currentPage,this.pageSize,this.searchTerm||void 0,void 0,void 0).pipe((0,ot.Q)(this.destroy$)).subscribe({next:t=>{this.masterProducts=(t.content||[]).map(i=>({id:i.id,name:i.name,description:i.description,sku:i.sku,barcode:i.barcode,category:i.category,brand:i.brand,baseUnit:i.baseUnit,baseWeight:i.baseWeight,specifications:i.specifications,status:i.status,isFeatured:i.isFeatured,isGlobal:i.isGlobal,isNew:i.isNew,rating:i.rating,primaryImageUrl:this.getProductImageUrl(i),shopCount:i.shopCount,minPrice:i.minPrice,maxPrice:i.maxPrice})),this.filteredProducts=[...this.masterProducts],this.totalProducts=t.totalElements||this.masterProducts.length,this.totalPages=Math.ceil(this.totalProducts/this.pageSize),this.categories=[...new Set(this.masterProducts.map(i=>i.category?.name).filter(Boolean))],this.loading=!1,console.log("Loaded available master products:",this.masterProducts.length)},error:t=>{console.error("Error loading available master products:",t),this.masterProducts=[{id:1,name:"Organic Basmati Rice",description:"Premium quality organic basmati rice",sku:"ORG-RICE-001",category:{id:1,name:"Grains"},brand:"Organic Valley",baseUnit:"kg",baseWeight:1,status:"ACTIVE",isFeatured:!0,isGlobal:!0,primaryImageUrl:"/assets/images/products/rice.jpg",shopCount:25,minPrice:80,maxPrice:120},{id:2,name:"Fresh Red Apples",description:"Crisp and sweet red apples",sku:"FRUIT-APP-001",category:{id:2,name:"Fruits"},brand:"Fresh Farm",baseUnit:"kg",baseWeight:1,status:"ACTIVE",isFeatured:!0,isGlobal:!0,primaryImageUrl:"/assets/images/products/apples.jpg",shopCount:42,minPrice:120,maxPrice:180},{id:3,name:"Whole Wheat Bread",description:"Freshly baked whole wheat bread",sku:"BAKERY-WWB-001",category:{id:3,name:"Bakery"},brand:"Daily Fresh",baseUnit:"piece",baseWeight:.5,status:"ACTIVE",isFeatured:!1,isGlobal:!0,primaryImageUrl:"/assets/images/products/bread.jpg",shopCount:18,minPrice:35,maxPrice:55}],this.filteredProducts=[...this.masterProducts],this.totalProducts=this.masterProducts.length,this.categories=[...new Set(this.masterProducts.map(r=>r.category?.name).filter(Boolean))],this.loading=!1,this.snackBar.open("Using sample data (API unavailable)","Close",{duration:3e3})}})}onSearchChange(){this.searchSubject$.next(this.searchTerm)}onCategoryChange(){this.currentPage=0,this.loadMasterProducts()}onCategorySelectChange(t){"__NEW__"===t?(this.selectedCategory="",this.dialog.open(so,{width:"420px",maxWidth:"95vw",data:{existingCategories:this.categories},disableClose:!1}).afterClosed().subscribe(i=>{if(i?.name){this.categories.includes(i.name)||(this.categories.push(i.name),this.categories.sort()),this.selectedCategory=i.name;try{localStorage.setItem("cached_product_category_names",JSON.stringify(this.categories))}catch{}}})):(this.selectedCategory=t,this.onCategoryChange())}onPageChange(t){this.currentPage=t.pageIndex,this.pageSize=t.pageSize,this.loadMasterProducts()}clearFilters(){this.searchTerm="",this.selectedCategory="",this.currentPage=0,this.loadMasterProducts()}toggleProductSelection(t){const r=this.selectedProducts.findIndex(i=>i.id===t.id);r>-1?this.selectedProducts.splice(r,1):this.selectedProducts.push(t)}isProductSelected(t){return this.selectedProducts.some(r=>r.id===t.id)}selectAllProducts(){this.selectedProducts=[...this.filteredProducts]}clearSelection(){this.selectedProducts=[]}areAllProductsSelected(){return this.filteredProducts.length>0&&this.selectedProducts.length===this.filteredProducts.length}assignSelectedProducts(){if(0===this.selectedProducts.length)return void this.snackBar.open("Please select products to assign","Close",{duration:2e3});this.loading=!0;let t=0,r=0;console.log("Assigning products to shop:",this.selectedProducts);const i=s=>this.http.post(`${this.apiUrl}/shop-products/create`,{masterProductId:s.id,price:s.minPrice||s.maxPrice||100,stockQuantity:0,isAvailable:!0,customName:s.name,customDescription:s.description});this.selectedProducts.map(s=>i(s).pipe((0,ot.Q)(this.destroy$)).subscribe({next:l=>{t++,console.log(`Successfully assigned product: ${s.name}`),t+r===this.selectedProducts.length&&this.handleAssignmentComplete(t,r)},error:l=>{r++,console.error(`Error assigning product ${s.name}:`,l),t+r===this.selectedProducts.length&&this.handleAssignmentComplete(t,r)}}))}handleAssignmentComplete(t,r){this.loading=!1,t>0?this.snackBar.open(`Successfully assigned ${t} products to your shop`+(r>0?` (${r} failed)`:""),"Close",{duration:4e3}):this.snackBar.open("Failed to assign products. Please try again.","Close",{duration:3e3}),this.clearSelection()}openAssignmentDialog(t){this.dialog.open(qy,{width:"480px",maxWidth:"95vw",data:{product:{id:t.id,name:t.name,nameTamil:t.nameTamil,description:t.description,sku:t.sku,barcode:t.barcode,category:t.category,brand:t.brand,baseUnit:t.baseUnit,primaryImageUrl:t.primaryImageUrl,minPrice:t.minPrice,maxPrice:t.maxPrice,voiceSearchTags:t.voiceSearchTags,tags:t.tags}},disableClose:!1,panelClass:"product-assignment-dialog-panel"}).afterClosed().subscribe(a=>{a?.success&&this.loadMasterProducts()})}onSortChange(){this.currentPage=0,this.loadMasterProducts()}filterByTag(t){const r=this.activeFilters.indexOf(t);r>-1?this.activeFilters.splice(r,1):this.activeFilters.push(t),this.currentPage=0,this.loadMasterProducts()}trackByProductId(t,r){return r.id}quickView(t){console.log("Quick view for:",t.name),this.snackBar.open("Quick view dialog will be implemented","Close",{duration:2e3})}loadProducts(){this.loadMasterProducts()}formatCurrency(t){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(t)}getProductImageUrl(t){return(0,Mr.V)(this.getImageUrlFromProduct(t))}getImageUrlFromProduct(t){if(t.images&&t.images.length>0){const r=t.images.find(i=>i.isPrimary);if(r?.imageUrl)return r.imageUrl;if(t.images[0]?.imageUrl)return t.images[0].imageUrl}if(t.primaryImageUrl)return t.primaryImageUrl}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(gt.Qq),e.rXU(Ce.UG),e.rXU($r.h),e.rXU(Pe.bZ),e.rXU(Gr))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-browse-products"]],decls:46,vars:13,consts:[[1,"browse-products-container"],[1,"filter-card"],[1,"filter-controls"],["appearance","outline",1,"search-field"],["matPrefix",""],["matInput","","placeholder","Search products...",3,"ngModel","ngModelChange"],["appearance","outline"],[3,"ngModel","ngModelChange","selectionChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["value","__NEW__",1,"add-new-category-option"],["value","name"],["value","name-desc"],["value","price-low"],["value","price-high"],[1,"filter-chips"],[3,"selected","click"],["class","select-all-control",4,"ngIf"],["class","modern-header",4,"ngIf"],["class","loading-state",4,"ngIf"],["class","modern-products-grid",4,"ngIf"],["class","pagination-card",4,"ngIf"],["class","empty-state-card",4,"ngIf"],[3,"value"],[1,"select-all-control"],[3,"checked","change"],["class","selection-count",4,"ngIf"],[1,"selection-count"],[1,"modern-header"],[1,"header-actions"],["mat-stroked-button","",3,"click"],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"loading-state"],["mode","indeterminate","diameter","36"],[1,"modern-products-grid"],["class","product-card",3,"selected",4,"ngFor","ngForOf","ngForTrackBy"],[1,"product-card"],[1,"product-image-container",3,"click"],["loading","lazy","onerror","this.src='/assets/images/product-placeholder.svg'",3,"src","alt"],[1,"selection-overlay"],[3,"checked","click","change"],[1,"product-badges"],["class","badge featured",4,"ngIf"],["class","badge global",4,"ngIf"],["class","badge new",4,"ngIf"],[1,"quick-actions"],["mat-mini-fab","",3,"click"],[1,"product-header"],[1,"product-name"],[1,"product-info-grid"],["class","info-item",4,"ngIf"],["mat-raised-button","","color","primary",3,"click"],[1,"badge","featured"],[1,"badge","global"],[1,"badge","new"],[1,"info-item"],[1,"pagination-card"],[3,"length","pageSize","pageSizeOptions","pageIndex","showFirstLastButtons","page"],[1,"empty-state-card"],[1,"empty-illustration"],[1,"empty-actions"]],template:function(r,i){1&r&&(e.j41(0,"div",0)(1,"mat-card",1)(2,"div",2)(3,"mat-form-field",3)(4,"mat-icon",4),e.EFF(5,"search"),e.k0s(),e.j41(6,"input",5),e.bIt("ngModelChange",function(s){return i.searchTerm=s})("ngModelChange",function(){return i.onSearchChange()}),e.k0s()(),e.j41(7,"mat-form-field",6)(8,"mat-select",7),e.bIt("ngModelChange",function(s){return i.selectedCategory=s})("selectionChange",function(s){return i.onCategorySelectChange(s.value)}),e.j41(9,"mat-option",8),e.EFF(10,"All Categories"),e.k0s(),e.DNE(11,Zy,2,2,"mat-option",9),e.j41(12,"mat-option",10)(13,"mat-icon"),e.EFF(14,"add"),e.k0s(),e.EFF(15," Add New Category "),e.k0s()()(),e.j41(16,"mat-form-field",6)(17,"mat-select",7),e.bIt("ngModelChange",function(s){return i.sortBy=s})("selectionChange",function(){return i.onSortChange()}),e.j41(18,"mat-option",11),e.EFF(19,"A-Z"),e.k0s(),e.j41(20,"mat-option",12),e.EFF(21,"Z-A"),e.k0s(),e.j41(22,"mat-option",13),e.EFF(23,"Price \u2191"),e.k0s(),e.j41(24,"mat-option",14),e.EFF(25,"Price \u2193"),e.k0s()()(),e.j41(26,"div",15)(27,"mat-chip-listbox")(28,"mat-chip-option",16),e.bIt("click",function(){return i.filterByTag("featured")}),e.j41(29,"mat-icon"),e.EFF(30,"star"),e.k0s(),e.EFF(31," Featured "),e.k0s(),e.j41(32,"mat-chip-option",16),e.bIt("click",function(){return i.filterByTag("global")}),e.j41(33,"mat-icon"),e.EFF(34,"public"),e.k0s(),e.EFF(35," Global "),e.k0s(),e.j41(36,"mat-chip-option",16),e.bIt("click",function(){return i.filterByTag("new")}),e.j41(37,"mat-icon"),e.EFF(38,"fiber_new"),e.k0s(),e.EFF(39," New "),e.k0s()()(),e.DNE(40,Jy,4,2,"div",17),e.k0s()(),e.DNE(41,Ky,10,2,"div",18),e.DNE(42,eM,4,0,"div",19),e.DNE(43,sM,2,2,"div",20),e.DNE(44,lM,2,6,"mat-card",21),e.DNE(45,dM,13,0,"mat-card",22),e.k0s()),2&r&&(e.R7$(6),e.Y8G("ngModel",i.searchTerm),e.R7$(2),e.Y8G("ngModel",i.selectedCategory),e.R7$(3),e.Y8G("ngForOf",i.categories),e.R7$(6),e.Y8G("ngModel",i.sortBy),e.R7$(11),e.Y8G("selected",i.activeFilters.includes("featured")),e.R7$(4),e.Y8G("selected",i.activeFilters.includes("global")),e.R7$(4),e.Y8G("selected",i.activeFilters.includes("new")),e.R7$(4),e.Y8G("ngIf",i.filteredProducts.length>0),e.R7$(1),e.Y8G("ngIf",i.selectedProducts.length>0),e.R7$(1),e.Y8G("ngIf",i.loading),e.R7$(1),e.Y8G("ngIf",!i.loading&&i.filteredProducts.length>0),e.R7$(1),e.Y8G("ngIf",!i.loading&&i.totalProducts>i.pageSize),e.R7$(1),e.Y8G("ngIf",!i.loading&&0===i.filteredProducts.length))},dependencies:[D.Sq,D.bT,b.me,b.BC,b.vS,j.RN,j.YY,j.m2,B.$z,B.$0,H.An,X.LG,Ve.uI,Ve.gq,ge.rl,ge.JW,Ee.fg,lt.iy,ze.VO,Bt.wT,it.So],styles:['.browse-products-container[_ngcontent-%COMP%]{padding:16px;background:#f1f5f9;min-height:calc(100vh - 64px)}.browse-products-container[_ngcontent-%COMP%]   .modern-header[_ngcontent-%COMP%]{display:none}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]{background:white;border-radius:12px;margin-bottom:16px;box-shadow:0 1px 3px #00000014;border:none;padding:0;overflow:hidden}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-header[_ngcontent-%COMP%]{display:none}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]{padding:16px;display:flex;flex-wrap:wrap;align-items:center;gap:12px}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]:before{content:"Product Catalog";font-size:1.125rem;font-weight:600;color:#1e293b;margin-right:auto;display:flex;align-items:center;gap:8px}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   .select-all-control[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:6px 12px;background:#f0fdf4;border-radius:6px;border:1px solid #bbf7d0;margin:0;order:10}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   .select-all-control[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]     .mdc-form-field{font-size:.8125rem;color:#16a34a}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   .select-all-control[_ngcontent-%COMP%]   .selection-count[_ngcontent-%COMP%]{font-size:.75rem;color:#16a34a;font-weight:600}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]{flex:0 0 220px;margin:0;order:1}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]     .mat-mdc-form-field-subscript-wrapper{display:none}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]     .mat-mdc-text-field-wrapper{height:40px;padding:0 12px;background:#f8fafc;border-radius:8px}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]     .mat-mdc-form-field-flex{height:40px}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]     .mdc-notched-outline{display:none}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]     input{font-size:.875rem}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]     input::placeholder{color:#94a3b8}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]     .mat-mdc-form-field-icon-prefix{color:#94a3b8;padding:0 8px 0 0}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]:not(.search-field){margin:0;flex:0 0 140px;order:2}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]:not(.search-field)     .mat-mdc-form-field-subscript-wrapper{display:none}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]:not(.search-field)     .mat-mdc-text-field-wrapper{height:40px;padding:0 12px;background:#f8fafc;border-radius:8px}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]:not(.search-field)     .mat-mdc-form-field-flex{height:40px}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]:not(.search-field)     .mdc-notched-outline{display:none}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]:not(.search-field)     .mat-mdc-select-value{font-size:.875rem}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]:not(.search-field)     .mat-mdc-form-field-icon-prefix{display:none}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   .filter-chips[_ngcontent-%COMP%]{margin:0;display:flex;align-items:center;order:3}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   .filter-chips[_ngcontent-%COMP%]   mat-chip-listbox[_ngcontent-%COMP%]{display:flex;gap:6px}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   .filter-chips[_ngcontent-%COMP%]   mat-chip-listbox[_ngcontent-%COMP%]   mat-chip-option[_ngcontent-%COMP%]{font-size:.75rem;height:32px;background:#f8fafc;border:1px solid #e2e8f0}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   .filter-chips[_ngcontent-%COMP%]   mat-chip-listbox[_ngcontent-%COMP%]   mat-chip-option[_ngcontent-%COMP%]:hover{background:#f0fdf4;border-color:#22c55e}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   .filter-chips[_ngcontent-%COMP%]   mat-chip-listbox[_ngcontent-%COMP%]   mat-chip-option.mat-mdc-chip-selected[_ngcontent-%COMP%]{background:#22c55e!important;border-color:#22c55e!important;color:#fff!important}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   .filter-chips[_ngcontent-%COMP%]   mat-chip-listbox[_ngcontent-%COMP%]   mat-chip-option[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px;margin-right:4px}.browse-products-container[_ngcontent-%COMP%]   .loading-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;background:white;border-radius:12px;box-shadow:0 1px 3px #00000014}.browse-products-container[_ngcontent-%COMP%]   .loading-state[_ngcontent-%COMP%]   mat-progress-spinner[_ngcontent-%COMP%]{margin:0 auto 16px}.browse-products-container[_ngcontent-%COMP%]   .loading-state[_ngcontent-%COMP%]   mat-progress-spinner[_ngcontent-%COMP%]     circle{stroke:#22c55e}.browse-products-container[_ngcontent-%COMP%]   .loading-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#64748b;font-size:.875rem;font-weight:500}.browse-products-container[_ngcontent-%COMP%]   .loading-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:none}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]{background:white;border-radius:12px;overflow:hidden;transition:all .2s ease;box-shadow:0 1px 3px #00000014;border:2px solid transparent}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]:hover{box-shadow:0 8px 24px #0000001f;transform:translateY(-2px)}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card.selected[_ngcontent-%COMP%]{border-color:#22c55e;box-shadow:0 4px 12px #22c55e33}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image-container[_ngcontent-%COMP%]{position:relative;height:160px;background:linear-gradient(135deg,#f8fafc 0%,#e2e8f0 100%);cursor:pointer;overflow:hidden}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain;padding:12px;transition:transform .3s ease}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image-container[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{transform:scale(1.05)}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image-container[_ngcontent-%COMP%]   .selection-overlay[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;background:white;border-radius:6px;padding:4px;box-shadow:0 2px 6px #00000026;z-index:2}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image-container[_ngcontent-%COMP%]   .product-badges[_ngcontent-%COMP%]{position:absolute;top:8px;left:8px;display:flex;gap:4px;z-index:2}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image-container[_ngcontent-%COMP%]   .product-badges[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:24px;height:24px;border-radius:6px;box-shadow:0 2px 6px #00000026}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image-container[_ngcontent-%COMP%]   .product-badges[_ngcontent-%COMP%]   .badge.featured[_ngcontent-%COMP%]{background:#fef3c7;color:#d97706}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image-container[_ngcontent-%COMP%]   .product-badges[_ngcontent-%COMP%]   .badge.new[_ngcontent-%COMP%]{background:#dcfce7;color:#16a34a}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image-container[_ngcontent-%COMP%]   .product-badges[_ngcontent-%COMP%]   .badge.global[_ngcontent-%COMP%]{background:#dbeafe;color:#2563eb}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image-container[_ngcontent-%COMP%]   .product-badges[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image-container[_ngcontent-%COMP%]   .quick-actions[_ngcontent-%COMP%]{position:absolute;bottom:8px;right:8px;opacity:0;transition:opacity .2s ease;z-index:2}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image-container[_ngcontent-%COMP%]   .quick-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:36px;height:36px;background:#22c55e!important;color:#fff!important;box-shadow:0 2px 8px #22c55e66}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image-container[_ngcontent-%COMP%]   .quick-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image-container[_ngcontent-%COMP%]   .quick-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#16a34a!important;transform:scale(1.1)}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image-container[_ngcontent-%COMP%]:hover   .quick-actions[_ngcontent-%COMP%]{opacity:1}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:12px 16px 8px}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .product-header[_ngcontent-%COMP%]{margin-bottom:8px}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .product-header[_ngcontent-%COMP%]   .product-name[_ngcontent-%COMP%]{margin:0;font-size:.9375rem;font-weight:600;color:#1e293b;line-height:1.4;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;min-height:2.6em}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .product-header[_ngcontent-%COMP%]   .product-rating[_ngcontent-%COMP%]{display:none}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .product-description[_ngcontent-%COMP%]{display:none}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .product-info-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:6px}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .product-info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;font-size:.75rem;color:#64748b;background:#f1f5f9;padding:4px 8px;border-radius:4px}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .product-info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:12px;width:12px;height:12px;color:#94a3b8}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .price-section[_ngcontent-%COMP%]{display:none}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]{padding:8px 12px 12px;display:flex;gap:8px;margin:0}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;border-radius:8px;font-weight:600;font-size:.8125rem;height:38px;text-transform:none}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;margin-right:4px}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   button.mat-stroked-button[_ngcontent-%COMP%]{border:1.5px solid #e2e8f0;color:#64748b}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   button.mat-stroked-button[_ngcontent-%COMP%]:hover{background:#f8fafc;border-color:#22c55e;color:#22c55e}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   button.mat-stroked-button.selected[_ngcontent-%COMP%]{background:#f0fdf4;border-color:#22c55e;color:#22c55e}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   button.mat-raised-button[_ngcontent-%COMP%]{background:#22c55e!important;color:#fff;box-shadow:0 2px 6px #22c55e4d}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   button.mat-raised-button[_ngcontent-%COMP%]:hover{background:#16a34a!important}.browse-products-container[_ngcontent-%COMP%]   .pagination-card[_ngcontent-%COMP%]{background:white;border-radius:12px;box-shadow:0 1px 3px #00000014;margin-top:16px;border:none}.browse-products-container[_ngcontent-%COMP%]   .pagination-card[_ngcontent-%COMP%]   mat-paginator[_ngcontent-%COMP%]{background:transparent}.browse-products-container[_ngcontent-%COMP%]   .empty-state-card[_ngcontent-%COMP%]{background:white;border-radius:12px;padding:48px 24px;text-align:center;box-shadow:0 1px 3px #00000014;border:none}.browse-products-container[_ngcontent-%COMP%]   .empty-state-card[_ngcontent-%COMP%]   .empty-illustration[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:56px;width:56px;height:56px;color:#cbd5e1}.browse-products-container[_ngcontent-%COMP%]   .empty-state-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:16px 0 8px;color:#1e293b;font-size:1.125rem;font-weight:600}.browse-products-container[_ngcontent-%COMP%]   .empty-state-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 20px;color:#64748b;font-size:.875rem}.browse-products-container[_ngcontent-%COMP%]   .empty-state-card[_ngcontent-%COMP%]   .empty-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:8px}.browse-products-container[_ngcontent-%COMP%]   .empty-state-card[_ngcontent-%COMP%]   .empty-actions[_ngcontent-%COMP%]   button.mat-raised-button[_ngcontent-%COMP%]{background:#22c55e;color:#fff}@media (max-width: 768px){.browse-products-container[_ngcontent-%COMP%]{padding:12px}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]{padding:12px;gap:8px}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]:before{display:none}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]{flex:1 1 100%;order:0}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]:not(.search-field){flex:1 1 calc(50% - 4px)}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   .filter-chips[_ngcontent-%COMP%]{width:100%;order:5}.browse-products-container[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-controls[_ngcontent-%COMP%]   .select-all-control[_ngcontent-%COMP%]{order:-1}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:10px}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image-container[_ngcontent-%COMP%]{height:120px}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:10px 12px 6px}.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]{padding:6px 10px 10px;flex-direction:column;gap:6px}}@media (max-width: 400px){.browse-products-container[_ngcontent-%COMP%]   .modern-products-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}']})}}return n})();function gM(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1,"Name is required"),e.k0s())}function pM(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",38),e.nrm(1,"img",39),e.j41(2,"button",40),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.removeImage())}),e.j41(3,"mat-icon"),e.EFF(4,"close"),e.k0s()()()}if(2&n){const t=e.XpG();e.R7$(1),e.Y8G("src",t.getBannerImageUrl(),e.B4B)}}function fM(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",41),e.bIt("click",function(){e.eBV(t),e.XpG();const i=e.sdS(38);return e.Njj(i.click())}),e.j41(1,"mat-icon"),e.EFF(2,"cloud_upload"),e.k0s(),e.j41(3,"span"),e.EFF(4,"Click to upload banner image"),e.k0s(),e.j41(5,"small"),e.EFF(6,"JPG, PNG, GIF, WebP (max 10MB)"),e.k0s()()}}function mM(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",42)(1,"button",43),e.bIt("click",function(){e.eBV(t),e.XpG();const i=e.sdS(38);return e.Njj(i.click())}),e.j41(2,"mat-icon"),e.EFF(3,"photo_library"),e.k0s(),e.EFF(4," Choose Image "),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(1),e.Y8G("disabled",t.isUploadingImage)}}function hM(n,o){1&n&&e.nrm(0,"mat-progress-bar",44)}function _M(n,o){if(1&n&&e.nrm(0,"img",56),2&n){const t=e.XpG().$implicit,r=e.XpG(2);e.Y8G("src",r.getProductImage(t),e.B4B)}}function xM(n,o){1&n&&(e.j41(0,"div",57)(1,"mat-icon"),e.EFF(2,"inventory_2"),e.k0s()())}function CM(n,o){if(1&n&&(e.j41(0,"span",58),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit,r=e.XpG(2);e.R7$(1),e.JRh(r.getProductNameTamil(t))}}function vM(n,o){if(1&n&&(e.j41(0,"small"),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit,r=e.XpG(2);e.R7$(1),e.SpI("/ ",r.getProductUnit(t),"")}}function PM(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",48),e.bIt("mousedown",function(i){const s=e.eBV(t).$implicit;return e.XpG(2).addProduct(s),e.Njj(i.preventDefault())}),e.DNE(1,_M,1,1,"img",49),e.DNE(2,xM,3,0,"div",50),e.j41(3,"div",51)(4,"span",52),e.EFF(5),e.k0s(),e.DNE(6,CM,2,1,"span",53),e.j41(7,"span",54),e.EFF(8),e.DNE(9,vM,2,1,"small",9),e.k0s()(),e.j41(10,"mat-icon",55),e.EFF(11,"add_circle"),e.k0s()()}if(2&n){const t=o.$implicit,r=e.XpG(2);e.R7$(1),e.Y8G("ngIf",r.getProductImage(t)),e.R7$(1),e.Y8G("ngIf",!r.getProductImage(t)),e.R7$(3),e.JRh(r.getProductName(t)),e.R7$(1),e.Y8G("ngIf",r.getProductNameTamil(t)),e.R7$(2),e.SpI("\u20b9",r.getProductPrice(t)," "),e.R7$(1),e.Y8G("ngIf",r.getProductUnit(t))}}function bM(n,o){if(1&n&&(e.j41(0,"div",59)(1,"small"),e.EFF(2),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(2),e.SpI("",t.filteredProducts.length-10," more products. Type to filter.")}}function kM(n,o){if(1&n&&(e.j41(0,"div",45),e.DNE(1,PM,12,6,"div",46),e.nI1(2,"slice"),e.DNE(3,bM,3,1,"div",47),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",e.brH(2,2,t.filteredProducts,0,10)),e.R7$(2),e.Y8G("ngIf",t.filteredProducts.length>10)}}function OM(n,o){if(1&n&&e.nrm(0,"img",75),2&n){const t=e.XpG().$implicit;let r;e.Y8G("appOfflineImg",null==(r=t.get("imageUrl"))?null:r.value)("fallback","assets/images/product-placeholder.svg")}}function yM(n,o){1&n&&(e.j41(0,"div",76)(1,"mat-icon"),e.EFF(2,"inventory_2"),e.k0s()())}function MM(n,o){if(1&n&&(e.j41(0,"span",77),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;let r;e.R7$(1),e.JRh(null==(r=t.get("productNameTamil"))?null:r.value)}}function wM(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",62),e.DNE(1,OM,1,2,"img",63),e.DNE(2,yM,3,0,"div",64),e.j41(3,"div",65)(4,"span",66),e.EFF(5),e.k0s(),e.DNE(6,MM,2,1,"span",67),e.j41(7,"span",68),e.EFF(8),e.k0s()(),e.j41(9,"div",69)(10,"button",70),e.bIt("click",function(){const a=e.eBV(t).index,s=e.XpG(2);return e.Njj(s.updateQuantity(a,-1))}),e.j41(11,"mat-icon"),e.EFF(12,"remove"),e.k0s()(),e.j41(13,"span",71),e.EFF(14),e.k0s(),e.j41(15,"button",72),e.bIt("click",function(){const a=e.eBV(t).index,s=e.XpG(2);return e.Njj(s.updateQuantity(a,1))}),e.j41(16,"mat-icon"),e.EFF(17,"add"),e.k0s()()(),e.j41(18,"span",73),e.EFF(19),e.k0s(),e.j41(20,"button",74),e.bIt("click",function(){const a=e.eBV(t).index,s=e.XpG(2);return e.Njj(s.removeProduct(a))}),e.j41(21,"mat-icon"),e.EFF(22,"delete"),e.k0s()()()}if(2&n){const t=o.$implicit;let i,a,s,l,u,p,f,h;e.Y8G("formGroupName",o.index),e.R7$(1),e.Y8G("ngIf",null==(i=t.get("imageUrl"))?null:i.value),e.R7$(1),e.Y8G("ngIf",!(null!=(a=t.get("imageUrl"))&&a.value)),e.R7$(3),e.JRh(null==(s=t.get("productName"))?null:s.value),e.R7$(1),e.Y8G("ngIf",null==(l=t.get("productNameTamil"))?null:l.value),e.R7$(2),e.Lme("\u20b9",null==(u=t.get("unitPrice"))?null:u.value," ",null==(u=t.get("unit"))?null:u.value,""),e.R7$(2),e.Y8G("disabled",(null==(p=t.get("quantity"))?null:p.value)<=1),e.R7$(4),e.JRh(null==(f=t.get("quantity"))?null:f.value),e.R7$(5),e.SpI("\u20b9",((null==(h=t.get("quantity"))?null:h.value)||0)*((null==(h=t.get("unitPrice"))?null:h.value)||0),"")}}function FM(n,o){if(1&n&&(e.j41(0,"div",60),e.DNE(1,wM,23,10,"div",61),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.itemsFormArray.controls)}}function EM(n,o){1&n&&(e.j41(0,"div",78)(1,"mat-icon"),e.EFF(2,"inventory"),e.k0s(),e.j41(3,"p"),e.EFF(4,"Search and add products above"),e.k0s()())}function SM(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1,"Price is required"),e.k0s())}function TM(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1,"Price must be at least \u20b91"),e.k0s())}function IM(n,o){if(1&n&&(e.j41(0,"div",85)(1,"div",86),e.EFF(2),e.k0s(),e.j41(3,"div",87),e.EFF(4),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(2),e.SpI("",t.getDiscountPercentage(),"% OFF"),e.R7$(2),e.SpI("Customer saves \u20b9",t.getSavings(),"")}}function RM(n,o){if(1&n&&(e.j41(0,"div",6)(1,"h3")(2,"mat-icon"),e.EFF(3,"payments"),e.k0s(),e.EFF(4," Pricing"),e.k0s(),e.j41(5,"div",79)(6,"div",80)(7,"span"),e.EFF(8),e.k0s(),e.j41(9,"span",81),e.EFF(10),e.k0s()(),e.j41(11,"mat-form-field",82)(12,"mat-label"),e.EFF(13,"Combo Price *"),e.k0s(),e.j41(14,"span",21),e.EFF(15,"\u20b9\xa0"),e.k0s(),e.nrm(16,"input",83),e.DNE(17,SM,2,0,"mat-error",9),e.DNE(18,TM,2,0,"mat-error",9),e.k0s(),e.DNE(19,IM,5,2,"div",84),e.k0s()()),2&n){const t=e.XpG();let r,i;e.R7$(8),e.SpI("Original Price (",t.itemsFormArray.length," items):"),e.R7$(2),e.SpI("\u20b9",t.calculateOriginalPrice(),""),e.R7$(7),e.Y8G("ngIf",null==(r=t.comboForm.get("comboPrice"))?null:r.hasError("required")),e.R7$(1),e.Y8G("ngIf",null==(i=t.comboForm.get("comboPrice"))?null:i.hasError("min")),e.R7$(1),e.Y8G("ngIf",t.getSavings()>0)}}function NM(n,o){1&n&&e.nrm(0,"mat-spinner",88)}function AM(n,o){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.JRh(t.isEditMode?"Update Combo":"Create Combo")}}const DM=function(){return{standalone:!0}};let c0=(()=>{class n{constructor(t,r,i,a,s){this.fb=t,this.http=r,this.snackBar=i,this.dialogRef=a,this.data=s,this.isEditMode=!1,this.isLoading=!1,this.isSaving=!1,this.isUploadingImage=!1,this.shopProducts=[],this.filteredProducts=[],this.searchQuery="",this.selectedImageFile=null,this.imagePreviewUrl=null,this.isEditMode="edit"===s.mode}ngOnInit(){this.initForm(),this.loadProducts(),this.isEditMode&&this.data.combo&&this.populateForm(this.data.combo)}initForm(){const t=new Date,r=new Date;r.setMonth(r.getMonth()+1),this.comboForm=this.fb.group({name:["",[b.k0.required,b.k0.maxLength(100)]],nameTamil:["",b.k0.maxLength(100)],description:["",b.k0.maxLength(500)],comboPrice:[0,[b.k0.required,b.k0.min(1)]],startDate:[t,b.k0.required],endDate:[r,b.k0.required],bannerImageUrl:[""],items:this.fb.array([],b.k0.minLength(2))})}get itemsFormArray(){return this.comboForm.get("items")}loadProducts(){this.data.shopId?(this.isLoading=!0,this.http.get(`${Oe.c.apiUrl}/shops/${this.data.shopId}/products?page=0&size=500`).subscribe({next:r=>{this.shopProducts=r.data?.content||r.content||r.data||r||[],this.filteredProducts=[],this.isLoading=!1},error:()=>{this.isLoading=!1,this.showSnackBar("Failed to load products","error")}})):this.showSnackBar("Shop ID not found. Please try again.","error")}showProducts(){(!this.isEditMode||this.searchQuery.trim())&&0===this.filteredProducts.length&&this.shopProducts.length>0&&(this.filteredProducts=[...this.shopProducts])}hideDropdown(){setTimeout(()=>{this.filteredProducts=[]},200)}toggleProductDropdown(){this.filteredProducts=this.filteredProducts.length>0?[]:[...this.shopProducts]}filterProducts(){const t=this.searchQuery.toLowerCase().trim();this.filteredProducts=t?this.shopProducts.filter(r=>{const i=this.getProductName(r).toLowerCase(),a=this.getProductNameTamil(r)?.toLowerCase()||"";return i.includes(t)||a.includes(t)}):[]}getProductName(t){return t.name||t.displayName||t.customName||t.productName||t.masterProduct?.name||"Unknown Product"}getProductNameTamil(t){return t.masterProduct?.nameTamil}getProductImage(t){const r=t.primaryImageUrl||t.imageUrl;if(!r)return;if(r.startsWith("http://")||r.startsWith("https://"))return r;const i=r.startsWith("/")?r:"/"+r;return`${Oe.c.imageBaseUrl}${i}`}getProductPrice(t){return t.sellingPrice||t.price||0}getProductUnit(t){return t.baseWeight&&t.baseUnit?`${t.baseWeight} ${t.baseUnit}`:t.weight&&t.unit?`${t.weight} ${t.unit}`:""}addProduct(t){if(this.itemsFormArray.controls.find(a=>a.get("shopProductId")?.value===t.id))return void this.showSnackBar("Product already added","error");const i=this.fb.group({shopProductId:[t.id,b.k0.required],productName:[this.getProductName(t)],productNameTamil:[this.getProductNameTamil(t)],quantity:[1,[b.k0.required,b.k0.min(1)]],unitPrice:[this.getProductPrice(t)],imageUrl:[this.getProductImage(t)],unit:[this.getProductUnit(t)]});this.itemsFormArray.push(i),this.calculateOriginalPrice(),this.searchQuery="",this.filteredProducts=[],this.showSnackBar(`${this.getProductName(t)} added`,"success")}removeProduct(t){this.itemsFormArray.removeAt(t),this.calculateOriginalPrice()}updateQuantity(t,r){const i=this.itemsFormArray.at(t).get("quantity");if(i){const a=Math.max(1,i.value+r);i.setValue(a),this.calculateOriginalPrice()}}calculateOriginalPrice(){let t=0;return this.itemsFormArray.controls.forEach(r=>{const i=r.get("quantity")?.value||0,a=r.get("unitPrice")?.value||0;t+=i*a}),t}getDiscountPercentage(){const t=this.calculateOriginalPrice(),r=this.comboForm.get("comboPrice")?.value||0;return 0===t||r>=t?0:Math.round((t-r)/t*100)}getSavings(){const t=this.calculateOriginalPrice(),r=this.comboForm.get("comboPrice")?.value||0;return Math.max(0,t-r)}populateForm(t){this.comboForm.patchValue({name:t.name,nameTamil:t.nameTamil,description:t.description,comboPrice:t.comboPrice,startDate:new Date(t.startDate),endDate:new Date(t.endDate),bannerImageUrl:t.bannerImageUrl}),t.items&&t.items.length>0&&t.items.forEach(r=>{const i=this.getFullImageUrl(r.imageUrl),a=this.fb.group({shopProductId:[r.shopProductId,b.k0.required],productName:[r.productName],productNameTamil:[r.productNameTamil],quantity:[r.quantity,[b.k0.required,b.k0.min(1)]],unitPrice:[r.unitPrice],imageUrl:[i],unit:[r.unit]});this.itemsFormArray.push(a)})}getFullImageUrl(t){if(!t)return;if(t.startsWith("http://")||t.startsWith("https://"))return t;const r=t.startsWith("/")?t:"/"+t;return`${Oe.c.imageBaseUrl}${r}`}onSubmit(){if(this.comboForm.invalid)return this.markFormGroupTouched(this.comboForm),void this.showSnackBar(this.itemsFormArray.length<2?"Please add at least 2 products":"Please fill all required fields","error");this.isSaving=!0;const t=this.comboForm.value,r={name:t.name,nameTamil:t.nameTamil||null,description:t.description||null,comboPrice:t.comboPrice,startDate:t.startDate.toISOString(),endDate:t.endDate.toISOString(),bannerImageUrl:t.bannerImageUrl||null,items:t.items.map(s=>({shopProductId:s.shopProductId,quantity:s.quantity}))},i=this.isEditMode?`${Oe.c.apiUrl}/shops/${this.data.shopId}/combos/${this.data.combo.id}`:`${Oe.c.apiUrl}/shops/${this.data.shopId}/combos`;(this.isEditMode?this.http.put(i,r):this.http.post(i,r)).subscribe({next:()=>{this.isSaving=!1,this.showSnackBar(this.isEditMode?"Combo updated successfully":"Combo created successfully","success"),this.dialogRef.close(!0)},error:s=>{this.isSaving=!1,this.showSnackBar(s.error?.message||"Failed to save combo","error")}})}markFormGroupTouched(t){Object.keys(t.controls).forEach(r=>{t.get(r)?.markAsTouched()})}onCancel(){this.dialogRef.close(!1)}showSnackBar(t,r){this.snackBar.open(t,"Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:"success"===r?"snackbar-success":"snackbar-error"})}onImageSelected(t){const r=t.target;if(r.files&&r.files.length>0){const i=r.files[0];if(!["image/jpeg","image/png","image/gif","image/webp"].includes(i.type))return void this.showSnackBar("Invalid file type. Please select an image (JPG, PNG, GIF, WebP)","error");if(i.size>10485760)return void this.showSnackBar("File too large. Maximum size is 10MB","error");this.selectedImageFile=i;const s=new FileReader;s.onload=l=>{this.imagePreviewUrl=l.target?.result},s.readAsDataURL(i),this.uploadImage()}}uploadImage(){if(!this.selectedImageFile)return;this.isUploadingImage=!0;const t=new FormData;t.append("file",this.selectedImageFile);const r=this.isEditMode&&this.data.combo?this.data.combo.id:null;let i=`${Oe.c.apiUrl}/shops/${this.data.shopId}/combos/upload-image`;r&&(i+=`?comboId=${r}`),this.http.post(i,t).subscribe({next:a=>{this.isUploadingImage=!1,a.imageUrl&&(this.comboForm.patchValue({bannerImageUrl:a.imageUrl}),this.showSnackBar("Image uploaded successfully","success"))},error:a=>{this.isUploadingImage=!1,this.showSnackBar(a.error?.message||"Failed to upload image","error")}})}removeImage(){this.selectedImageFile=null,this.imagePreviewUrl=null,this.comboForm.patchValue({bannerImageUrl:""})}getBannerImageUrl(){const t=this.comboForm.get("bannerImageUrl")?.value;return this.imagePreviewUrl?this.imagePreviewUrl:t&&this.getFullImageUrl(t)||null}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(b.ok),e.rXU(gt.Qq),e.rXU(Ce.UG),e.rXU(Pe.CP),e.rXU(Pe.Vh))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-combo-form"]],decls:86,vars:24,consts:[[1,"dialog-container"],[1,"dialog-header"],["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close",""],[1,"dialog-content"],[3,"formGroup"],[1,"form-section"],["appearance","outline",1,"full-width"],["matInput","","formControlName","name","placeholder","e.g., Pongal Special Pack"],[4,"ngIf"],["matInput","","formControlName","nameTamil","placeholder","e.g., \u0baa\u0bca\u0b99\u0bcd\u0b95\u0bb2\u0bcd \u0bb8\u0bcd\u0baa\u0bc6\u0bb7\u0bb2\u0bcd \u0baa\u0bc7\u0b95\u0bcd"],["matInput","","formControlName","description","rows","2","placeholder","Brief description..."],[1,"image-upload-container"],["class","image-preview",4,"ngIf"],["class","upload-area",3,"click",4,"ngIf"],["type","file","hidden","","accept","image/*",3,"change"],["imageInput",""],["class","upload-actions",4,"ngIf"],["mode","indeterminate",4,"ngIf"],[1,"product-search"],["matInput","","placeholder","Type to search...",3,"ngModel","ngModelOptions","ngModelChange","focus","blur"],["matPrefix",""],["mat-icon-button","","matSuffix","","type","button",3,"click"],["class","product-suggestions",4,"ngIf"],["class","selected-products","formArrayName","items",4,"ngIf"],["class","empty-products",4,"ngIf"],["class","form-section",4,"ngIf"],[1,"date-row"],["appearance","outline"],["matInput","","formControlName","startDate",3,"matDatepicker"],["matSuffix","",3,"for"],["startPicker",""],["matInput","","formControlName","endDate",3,"matDatepicker"],["endPicker",""],["align","end"],["mat-button","",3,"disabled","click"],["mat-raised-button","","color","primary",3,"disabled","click"],["diameter","20",4,"ngIf"],[1,"image-preview"],["alt","Combo banner",3,"src"],["mat-icon-button","","type","button",1,"remove-image-btn",3,"click"],[1,"upload-area",3,"click"],[1,"upload-actions"],["mat-stroked-button","","type","button",3,"disabled","click"],["mode","indeterminate"],[1,"product-suggestions"],["class","suggestion-item",3,"mousedown",4,"ngFor","ngForOf"],["class","more-products",4,"ngIf"],[1,"suggestion-item",3,"mousedown"],["class","product-thumb","alt","",3,"src",4,"ngIf"],["class","product-thumb-placeholder",4,"ngIf"],[1,"product-details"],[1,"name"],["class","name-tamil",4,"ngIf"],[1,"price"],[1,"add-icon"],["alt","",1,"product-thumb",3,"src"],[1,"product-thumb-placeholder"],[1,"name-tamil"],[1,"more-products"],["formArrayName","items",1,"selected-products"],["class","product-item",3,"formGroupName",4,"ngFor","ngForOf"],[1,"product-item",3,"formGroupName"],["class","item-thumb","alt","",3,"appOfflineImg","fallback",4,"ngIf"],["class","item-thumb-placeholder",4,"ngIf"],[1,"item-info"],[1,"item-name"],["class","item-name-tamil",4,"ngIf"],[1,"item-price"],[1,"quantity-control"],["mat-icon-button","",3,"disabled","click"],[1,"qty"],["mat-icon-button","",3,"click"],[1,"item-total"],["mat-icon-button","","color","warn",3,"click"],["alt","",1,"item-thumb",3,"appOfflineImg","fallback"],[1,"item-thumb-placeholder"],[1,"item-name-tamil"],[1,"empty-products"],[1,"pricing-summary"],[1,"price-row"],[1,"original"],["appearance","outline",1,"combo-price-field"],["matInput","","type","number","formControlName","comboPrice","min","1"],["class","savings-box",4,"ngIf"],[1,"savings-box"],[1,"discount-badge"],[1,"savings-text"],["diameter","20"]],template:function(r,i){if(1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"h2",2)(3,"mat-icon"),e.EFF(4),e.k0s(),e.EFF(5),e.k0s(),e.j41(6,"button",3)(7,"mat-icon"),e.EFF(8,"close"),e.k0s()()(),e.j41(9,"mat-dialog-content",4)(10,"form",5)(11,"div",6)(12,"h3")(13,"mat-icon"),e.EFF(14,"info"),e.k0s(),e.EFF(15," Basic Information"),e.k0s(),e.j41(16,"mat-form-field",7)(17,"mat-label"),e.EFF(18,"Combo Name *"),e.k0s(),e.nrm(19,"input",8),e.DNE(20,gM,2,0,"mat-error",9),e.k0s(),e.j41(21,"mat-form-field",7)(22,"mat-label"),e.EFF(23,"Name in Tamil"),e.k0s(),e.nrm(24,"input",10),e.k0s(),e.j41(25,"mat-form-field",7)(26,"mat-label"),e.EFF(27,"Description"),e.k0s(),e.nrm(28,"textarea",11),e.k0s()(),e.j41(29,"div",6)(30,"h3")(31,"mat-icon"),e.EFF(32,"image"),e.k0s(),e.EFF(33," Banner Image (Optional)"),e.k0s(),e.j41(34,"div",12),e.DNE(35,pM,5,1,"div",13),e.DNE(36,fM,7,0,"div",14),e.j41(37,"input",15,16),e.bIt("change",function(s){return i.onImageSelected(s)}),e.k0s(),e.DNE(39,mM,5,1,"div",17),e.DNE(40,hM,1,0,"mat-progress-bar",18),e.k0s()(),e.j41(41,"div",6)(42,"h3")(43,"mat-icon"),e.EFF(44,"inventory_2"),e.k0s(),e.EFF(45," Products (Min 2 required)"),e.k0s(),e.j41(46,"div",19)(47,"mat-form-field",7)(48,"mat-label"),e.EFF(49,"Search and add products"),e.k0s(),e.j41(50,"input",20),e.bIt("ngModelChange",function(s){return i.searchQuery=s})("ngModelChange",function(){return i.filterProducts()})("focus",function(){return i.showProducts()})("blur",function(){return i.hideDropdown()}),e.k0s(),e.j41(51,"mat-icon",21),e.EFF(52,"search"),e.k0s(),e.j41(53,"button",22),e.bIt("click",function(){return i.toggleProductDropdown()}),e.j41(54,"mat-icon"),e.EFF(55),e.k0s()()(),e.DNE(56,kM,4,6,"div",23),e.k0s(),e.DNE(57,FM,2,1,"div",24),e.DNE(58,EM,5,0,"div",25),e.k0s(),e.DNE(59,RM,20,5,"div",26),e.j41(60,"div",6)(61,"h3")(62,"mat-icon"),e.EFF(63,"event"),e.k0s(),e.EFF(64," Validity Period"),e.k0s(),e.j41(65,"div",27)(66,"mat-form-field",28)(67,"mat-label"),e.EFF(68,"Start Date *"),e.k0s(),e.nrm(69,"input",29)(70,"mat-datepicker-toggle",30)(71,"mat-datepicker",null,31),e.k0s(),e.j41(73,"mat-form-field",28)(74,"mat-label"),e.EFF(75,"End Date *"),e.k0s(),e.nrm(76,"input",32)(77,"mat-datepicker-toggle",30)(78,"mat-datepicker",null,33),e.k0s()()()()(),e.j41(80,"mat-dialog-actions",34)(81,"button",35),e.bIt("click",function(){return i.onCancel()}),e.EFF(82,"Cancel"),e.k0s(),e.j41(83,"button",36),e.bIt("click",function(){return i.onSubmit()}),e.DNE(84,NM,1,0,"mat-spinner",37),e.DNE(85,AM,2,1,"span",9),e.k0s()()()),2&r){const a=e.sdS(72),s=e.sdS(79);let l;e.R7$(4),e.JRh(i.isEditMode?"edit":"add_circle"),e.R7$(1),e.SpI(" ",i.isEditMode?"Edit Combo":"Create New Combo"," "),e.R7$(5),e.Y8G("formGroup",i.comboForm),e.R7$(10),e.Y8G("ngIf",null==(l=i.comboForm.get("name"))?null:l.hasError("required")),e.R7$(15),e.Y8G("ngIf",i.getBannerImageUrl()),e.R7$(1),e.Y8G("ngIf",!i.getBannerImageUrl()),e.R7$(3),e.Y8G("ngIf",!i.getBannerImageUrl()),e.R7$(1),e.Y8G("ngIf",i.isUploadingImage),e.R7$(10),e.Y8G("ngModel",i.searchQuery)("ngModelOptions",e.lJ4(23,DM)),e.R7$(5),e.JRh(i.filteredProducts.length>0?"expand_less":"expand_more"),e.R7$(1),e.Y8G("ngIf",i.filteredProducts.length>0),e.R7$(1),e.Y8G("ngIf",i.itemsFormArray.length>0),e.R7$(1),e.Y8G("ngIf",0===i.itemsFormArray.length),e.R7$(1),e.Y8G("ngIf",i.itemsFormArray.length>=2),e.R7$(10),e.Y8G("matDatepicker",a),e.R7$(1),e.Y8G("for",a),e.R7$(6),e.Y8G("matDatepicker",s),e.R7$(1),e.Y8G("for",s),e.R7$(4),e.Y8G("disabled",i.isSaving),e.R7$(2),e.Y8G("disabled",i.isSaving||i.itemsFormArray.length<2),e.R7$(1),e.Y8G("ngIf",i.isSaving),e.R7$(1),e.Y8G("ngIf",!i.isSaving)}},dependencies:[D.Sq,D.bT,b.qT,b.me,b.Q0,b.BC,b.cb,b.VZ,b.j4,b.JD,b.$R,b.v8,b.vS,fi,B.$z,B.iY,H.An,X.LG,ge.rl,ge.nJ,ge.TL,ge.JW,ge.yw,Ee.fg,Pe.tx,Pe.BI,Pe.Yi,Pe.E7,Et.Vh,Et.bZ,Et.bU,Ke.HM,D.P9],styles:[".dialog-container[_ngcontent-%COMP%]{max-height:90vh;display:flex;flex-direction:column}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 24px;border-bottom:1px solid #e0e0e0}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin:0;font-size:20px;color:#333}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#d32f2f}.dialog-content[_ngcontent-%COMP%]{padding:24px;overflow-y:auto}.form-section[_ngcontent-%COMP%]{background:#f8f9fa;border-radius:8px;padding:16px;margin-bottom:16px;border-left:4px solid #d32f2f}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:16px;color:#333;margin:0 0 16px}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#d32f2f;font-size:20px;width:20px;height:20px}.full-width[_ngcontent-%COMP%]{width:100%}.image-upload-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.image-preview[_ngcontent-%COMP%]{position:relative;width:100%;max-width:300px;border-radius:8px;overflow:hidden;box-shadow:0 2px 8px #0000001a}.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:180px;object-fit:cover;display:block}.remove-image-btn[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;background:rgba(0,0,0,.6)!important;color:#fff!important}.upload-area[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;border:2px dashed #ccc;border-radius:8px;cursor:pointer;transition:all .2s;background:#fafafa}.upload-area[_ngcontent-%COMP%]:hover{border-color:#d32f2f;background:#fff5f5}.upload-area[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#999;margin-bottom:12px}.upload-area[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;color:#666;margin-bottom:4px}.upload-area[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:12px;color:#999}.upload-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.upload-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.product-search[_ngcontent-%COMP%]{position:relative}.product-suggestions[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;background:white;border:1px solid #ddd;border-radius:8px;box-shadow:0 4px 12px #0000001a;z-index:100;max-height:250px;overflow-y:auto}.suggestion-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px;cursor:pointer;transition:background .2s}.suggestion-item[_ngcontent-%COMP%]:hover{background:#f5f5f5}.product-thumb[_ngcontent-%COMP%], .item-thumb[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:6px;object-fit:cover}.product-thumb-placeholder[_ngcontent-%COMP%], .item-thumb-placeholder[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:6px;background:#e0e0e0;display:flex;align-items:center;justify-content:center}.product-thumb-placeholder[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .item-thumb-placeholder[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;color:#999}.product-details[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column}.product-details[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:500;color:#333}.product-details[_ngcontent-%COMP%]   .name-tamil[_ngcontent-%COMP%]{font-size:12px;color:#666;font-style:italic}.product-details[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-size:13px;color:#666}.add-icon[_ngcontent-%COMP%]{color:#4caf50}.more-products[_ngcontent-%COMP%]{padding:8px 12px;text-align:center;color:#666;background:#f5f5f5;border-top:1px solid #eee}.selected-products[_ngcontent-%COMP%]{margin-top:16px}.product-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px;background:white;border-radius:8px;margin-bottom:8px;box-shadow:0 1px 3px #0000001a}.item-info[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column}.item-name[_ngcontent-%COMP%]{font-weight:500;color:#333}.item-name-tamil[_ngcontent-%COMP%]{font-size:11px;color:#666;font-style:italic}.item-price[_ngcontent-%COMP%]{font-size:12px;color:#666}.quantity-control[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;background:#f5f5f5;border-radius:20px;padding:2px}.quantity-control[_ngcontent-%COMP%]   .qty[_ngcontent-%COMP%]{min-width:30px;text-align:center;font-weight:600}.item-total[_ngcontent-%COMP%]{font-weight:600;color:#2e7d32;min-width:60px;text-align:right}.empty-products[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:30px;color:#999}.empty-products[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:40px;width:40px;height:40px;margin-bottom:8px}.pricing-summary[_ngcontent-%COMP%]{background:white;padding:16px;border-radius:8px}.price-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:12px;color:#666}.price-row[_ngcontent-%COMP%]   .original[_ngcontent-%COMP%]{text-decoration:line-through}.combo-price-field[_ngcontent-%COMP%]{width:200px;margin-bottom:12px}.savings-box[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px;background:#e8f5e9;border-radius:8px}.discount-badge[_ngcontent-%COMP%]{background:#d32f2f;color:#fff;padding:4px 12px;border-radius:16px;font-weight:600;font-size:14px}.savings-text[_ngcontent-%COMP%]{color:#2e7d32;font-weight:500}.date-row[_ngcontent-%COMP%]{display:flex;gap:16px}.date-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1}mat-dialog-actions[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid #e0e0e0;gap:12px}@media (max-width: 600px){.date-row[_ngcontent-%COMP%]{flex-direction:column;gap:0}.product-item[_ngcontent-%COMP%]{flex-wrap:wrap}}"]})}}return n})();function jM(n,o){if(1&n&&(e.j41(0,"span",13),e.EFF(1),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.SpI("Last synced: ",t.getTimeSinceSync(),"")}}function BM(n,o){if(1&n&&(e.j41(0,"div",10)(1,"mat-icon"),e.EFF(2,"cloud_off"),e.k0s(),e.j41(3,"span",11),e.EFF(4,"You're offline. Showing cached data. Create/Edit disabled."),e.k0s(),e.DNE(5,jM,2,1,"span",12),e.k0s()),2&n){const t=e.XpG();e.R7$(5),e.Y8G("ngIf",t.lastSyncTime)}}function LM(n,o){1&n&&(e.j41(0,"div",14),e.nrm(1,"mat-spinner",15),e.k0s())}function $M(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",16)(1,"mat-icon",17),e.EFF(2,"card_giftcard"),e.k0s(),e.j41(3,"h3"),e.EFF(4,"No Combos Yet"),e.k0s(),e.j41(5,"p"),e.EFF(6,"Create combo offers to attract more customers!"),e.k0s(),e.j41(7,"button",18),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.openCreateDialog())}),e.j41(8,"mat-icon"),e.EFF(9,"add"),e.k0s(),e.EFF(10," Create Your First Combo "),e.k0s()()}}function GM(n,o){1&n&&(e.j41(0,"th",32),e.EFF(1,"Combo Name"),e.k0s())}function UM(n,o){if(1&n&&e.nrm(0,"img",40),2&n){const t=e.XpG().$implicit;e.Y8G("appOfflineImg",t.bannerImageUrl)("fallback","assets/images/product-placeholder.svg")}}function zM(n,o){1&n&&(e.j41(0,"div",41)(1,"mat-icon"),e.EFF(2,"card_giftcard"),e.k0s()())}function VM(n,o){if(1&n&&(e.j41(0,"span",42),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.JRh(t.nameTamil)}}function YM(n,o){if(1&n&&(e.j41(0,"td",33)(1,"div",34),e.DNE(2,UM,1,2,"img",35),e.DNE(3,zM,3,0,"div",36),e.j41(4,"div",37)(5,"span",38),e.EFF(6),e.k0s(),e.DNE(7,VM,2,1,"span",39),e.k0s()()()),2&n){const t=o.$implicit;e.R7$(2),e.Y8G("ngIf",t.bannerImageUrl),e.R7$(1),e.Y8G("ngIf",!t.bannerImageUrl),e.R7$(3),e.JRh(t.name),e.R7$(1),e.Y8G("ngIf",t.nameTamil)}}function XM(n,o){1&n&&(e.j41(0,"th",32),e.EFF(1,"Items"),e.k0s())}function HM(n,o){if(1&n&&(e.j41(0,"td",33)(1,"span",43),e.EFF(2),e.k0s()()),2&n){const t=o.$implicit;e.R7$(2),e.SpI("",t.itemCount," items")}}function WM(n,o){1&n&&(e.j41(0,"th",32),e.EFF(1,"Price"),e.k0s())}function qM(n,o){if(1&n&&(e.j41(0,"td",33)(1,"div",44)(2,"span",45),e.EFF(3),e.k0s(),e.j41(4,"span",46),e.EFF(5),e.k0s()()()),2&n){const t=o.$implicit;e.R7$(3),e.SpI("\u20b9",t.comboPrice,""),e.R7$(2),e.SpI("\u20b9",t.originalPrice,"")}}function ZM(n,o){1&n&&(e.j41(0,"th",32),e.EFF(1,"Discount"),e.k0s())}function QM(n,o){if(1&n&&(e.j41(0,"td",33)(1,"span",47),e.EFF(2),e.nI1(3,"number"),e.k0s()()),2&n){const t=o.$implicit;e.R7$(2),e.SpI("",e.i5U(3,1,t.discountPercentage,"1.0-0"),"% OFF")}}function JM(n,o){1&n&&(e.j41(0,"th",32),e.EFF(1,"Validity"),e.k0s())}function KM(n,o){if(1&n&&(e.j41(0,"td",33)(1,"div",48)(2,"span"),e.EFF(3),e.nI1(4,"date"),e.nI1(5,"date"),e.k0s()()()),2&n){const t=o.$implicit;e.R7$(3),e.Lme("",e.i5U(4,2,t.startDate,"dd MMM")," - ",e.i5U(5,5,t.endDate,"dd MMM yyyy"),"")}}function ew(n,o){1&n&&(e.j41(0,"th",32),e.EFF(1,"Status"),e.k0s())}function tw(n,o){if(1&n&&(e.j41(0,"td",33)(1,"span",49),e.EFF(2),e.k0s()()),2&n){const t=o.$implicit,r=e.XpG(2);e.R7$(1),e.Y8G("ngClass",r.getStatusClass(t)),e.R7$(1),e.SpI(" ",r.getStatusText(t)," ")}}function nw(n,o){1&n&&(e.j41(0,"th",32),e.EFF(1,"Actions"),e.k0s())}function rw(n,o){if(1&n){const t=e.RV6();e.j41(0,"td",33)(1,"button",50)(2,"mat-icon"),e.EFF(3,"more_vert"),e.k0s()(),e.j41(4,"mat-menu",null,51)(6,"button",52),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.openEditDialog(a))}),e.j41(7,"mat-icon"),e.EFF(8,"edit"),e.k0s(),e.j41(9,"span"),e.EFF(10,"Edit"),e.k0s()(),e.j41(11,"button",52),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.toggleStatus(a))}),e.j41(12,"mat-icon"),e.EFF(13),e.k0s(),e.j41(14,"span"),e.EFF(15),e.k0s()(),e.nrm(16,"mat-divider"),e.j41(17,"button",53),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.deleteCombo(a))}),e.j41(18,"mat-icon",54),e.EFF(19,"delete"),e.k0s(),e.j41(20,"span"),e.EFF(21,"Delete"),e.k0s()()()()}if(2&n){const t=o.$implicit,r=e.sdS(5),i=e.XpG(2);e.R7$(1),e.Y8G("matMenuTriggerFor",r),e.R7$(12),e.JRh(i.isComboActive(t)?"toggle_off":"toggle_on"),e.R7$(2),e.JRh(i.isComboActive(t)?"Deactivate":"Activate")}}function iw(n,o){1&n&&e.nrm(0,"tr",55)}function ow(n,o){1&n&&e.nrm(0,"tr",56)}function aw(n,o){if(1&n&&(e.j41(0,"div",19)(1,"table",20),e.qex(2,21),e.DNE(3,GM,2,0,"th",22),e.DNE(4,YM,8,4,"td",23),e.bVm(),e.qex(5,24),e.DNE(6,XM,2,0,"th",22),e.DNE(7,HM,3,1,"td",23),e.bVm(),e.qex(8,25),e.DNE(9,WM,2,0,"th",22),e.DNE(10,qM,6,2,"td",23),e.bVm(),e.qex(11,26),e.DNE(12,ZM,2,0,"th",22),e.DNE(13,QM,4,4,"td",23),e.bVm(),e.qex(14,27),e.DNE(15,JM,2,0,"th",22),e.DNE(16,KM,6,8,"td",23),e.bVm(),e.qex(17,28),e.DNE(18,ew,2,0,"th",22),e.DNE(19,tw,3,2,"td",23),e.bVm(),e.qex(20,29),e.DNE(21,nw,2,0,"th",22),e.DNE(22,rw,22,3,"td",23),e.bVm(),e.DNE(23,iw,1,0,"tr",30),e.DNE(24,ow,1,0,"tr",31),e.k0s()()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("dataSource",t.combos),e.R7$(22),e.Y8G("matHeaderRowDef",t.displayedColumns),e.R7$(1),e.Y8G("matRowDefColumns",t.displayedColumns)}}let sw=(()=>{class n{constructor(t,r,i,a,s){this.http=t,this.authService=r,this.dialog=i,this.snackBar=a,this.offlineStorage=s,this.combos=[],this.isLoading=!1,this.shopId=null,this.displayedColumns=["name","items","price","discount","validity","status","actions"],this.isOffline=!1,this.lastSyncTime=null,this.handleOnline=()=>{console.log("Network online - refreshing combos"),this.isOffline=!1,this.snackBar.open("Back online! Refreshing combos...","Close",{duration:3e3}),this.loadCombos()},this.handleOffline=()=>{console.log("Network offline - using cached combos"),this.isOffline=!0,this.snackBar.open("You are offline. Showing cached combos.","Close",{duration:3e3})}}ngOnDestroy(){window.removeEventListener("online",this.handleOnline.bind(this)),window.removeEventListener("offline",this.handleOffline.bind(this))}getTimeSinceSync(){if(!this.lastSyncTime)return"Never synced";const r=(new Date).getTime()-this.lastSyncTime.getTime(),i=Math.floor(r/6e4);if(i<1)return"Just now";if(1===i)return"1 minute ago";if(i<60)return`${i} minutes ago`;const a=Math.floor(i/60);if(1===a)return"1 hour ago";if(a<24)return`${a} hours ago`;const s=Math.floor(a/24);return 1===s?"1 day ago":`${s} days ago`}ngOnInit(){this.isOffline=!navigator.onLine,window.addEventListener("online",this.handleOnline.bind(this)),window.addEventListener("offline",this.handleOffline.bind(this)),this.loadShopId()}loadShopId(){const t=this.authService.getCurrentUser();t?.shopId?(this.shopId=t.shopId,this.loadCombos()):this.http.get(`${Oe.c.apiUrl}/shops/my-shop`).subscribe({next:r=>{this.shopId=r.data?.id||r.id,this.loadCombos()},error:()=>{this.showSnackBar("Failed to load shop info","error")}})}loadCombos(){var r,t=this;if(this.shopId){if(this.isLoading=!0,!navigator.onLine)return void this.loadCombosFromCache();this.http.get(`${Oe.c.apiUrl}/shops/${this.shopId}/combos`).subscribe({next:(r=(0,fe.A)(function*(i){t.combos=i.data?.content||i.data||i.content||i||[],t.isLoading=!1,t.isOffline=!1;try{yield t.offlineStorage.saveCombosCache(t.combos,t.shopId),t.lastSyncTime=new Date,console.log("Combos cached successfully")}catch(a){console.warn("Error caching combos:",a)}}),function(a){return r.apply(this,arguments)}),error:function(){var r=(0,fe.A)(function*(){yield t.loadCombosFromCache()});return function(){return r.apply(this,arguments)}}()})}}loadCombosFromCache(){var t=this;return(0,fe.A)(function*(){if(t.shopId){console.log("Loading combos from cache..."),t.isOffline=!0;try{const r=yield t.offlineStorage.getCombosCache(t.shopId);t.lastSyncTime=yield t.offlineStorage.getCombosCacheSyncTime(t.shopId),r&&r.length>0?(console.log("Loaded",r.length,"combos from cache"),t.combos=r,t.showSnackBar(`Showing ${r.length} cached combos`,"success")):(console.log("No cached combos found"),t.combos=[],t.showSnackBar("No cached combos available. Connect to internet to load combos.","error"))}catch(r){console.error("Error loading combos from cache:",r),t.showSnackBar("Failed to load cached combos","error")}t.isLoading=!1}else t.isLoading=!1})()}openCreateDialog(){this.shopId?this.dialog.open(c0,{width:"800px",maxHeight:"90vh",data:{mode:"create",shopId:this.shopId}}).afterClosed().subscribe(r=>{r&&this.loadCombos()}):this.showSnackBar("Shop ID not loaded. Please refresh the page.","error")}openEditDialog(t){this.http.get(`${Oe.c.apiUrl}/shops/${this.shopId}/combos/${t.id}`).subscribe({next:r=>{this.dialog.open(c0,{width:"800px",maxHeight:"90vh",data:{mode:"edit",combo:r.data||r,shopId:this.shopId}}).afterClosed().subscribe(s=>{s&&this.loadCombos()})},error:()=>{this.showSnackBar("Failed to load combo details","error")}})}isComboActive(t){return t.isActive??t.active??!1}toggleStatus(t){if(!this.shopId)return;const r=this.isComboActive(t);this.http.patch(`${Oe.c.apiUrl}/shops/${this.shopId}/combos/${t.id}/toggle-status`,{}).subscribe({next:a=>{const s=a.data;t.isActive=s?.isActive??!r,t.active=t.isActive,this.showSnackBar("Combo "+(t.isActive?"activated":"deactivated"),"success")},error:()=>{this.showSnackBar("Failed to update combo status","error")}})}deleteCombo(t){this.shopId&&confirm(`Are you sure you want to delete "${t.name}"?`)&&this.http.delete(`${Oe.c.apiUrl}/shops/${this.shopId}/combos/${t.id}`).subscribe({next:()=>{this.combos=this.combos.filter(r=>r.id!==t.id),this.showSnackBar("Combo deleted successfully","success")},error:()=>{this.showSnackBar("Failed to delete combo","error")}})}isExpired(t){return new Date(t.endDate)<new Date}isUpcoming(t){return new Date(t.startDate)>new Date}getStatusClass(t){return this.isComboActive(t)?this.isExpired(t)?"status-expired":this.isUpcoming(t)?"status-upcoming":"status-active":"status-inactive"}getStatusText(t){return this.isComboActive(t)?this.isExpired(t)?"Expired":this.isUpcoming(t)?"Upcoming":"Active":"Inactive"}showSnackBar(t,r){this.snackBar.open(t,"Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:"success"===r?"snackbar-success":"snackbar-error"})}getImageUrl(t){return t?t.startsWith("http://")||t.startsWith("https://")?t:`${Oe.c.imageBaseUrl}${t.startsWith("/")?"":"/"}${t}`:""}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(gt.Qq),e.rXU(Gt.u),e.rXU(Pe.bZ),e.rXU(Ce.UG),e.rXU(at.m))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-combo-list"]],decls:18,vars:5,consts:[[1,"combo-container"],["class","offline-banner",4,"ngIf"],[1,"page-header"],[1,"header-left"],[1,"subtitle"],["mat-raised-button","","color","primary",3,"disabled","click"],[1,"combo-card"],["class","loading-spinner",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","combo-table",4,"ngIf"],[1,"offline-banner"],[1,"offline-text"],["class","sync-time",4,"ngIf"],[1,"sync-time"],[1,"loading-spinner"],["diameter","40"],[1,"empty-state"],[1,"empty-icon"],["mat-raised-button","","color","primary",3,"click"],[1,"combo-table"],["mat-table","",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","items"],["matColumnDef","price"],["matColumnDef","discount"],["matColumnDef","validity"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[1,"combo-name-cell"],["class","combo-thumb","alt","",3,"appOfflineImg","fallback",4,"ngIf"],["class","combo-thumb-placeholder",4,"ngIf"],[1,"combo-info"],[1,"name"],["class","tamil-name",4,"ngIf"],["alt","",1,"combo-thumb",3,"appOfflineImg","fallback"],[1,"combo-thumb-placeholder"],[1,"tamil-name"],[1,"item-count"],[1,"price-cell"],[1,"combo-price"],[1,"original-price"],[1,"discount-badge"],[1,"validity-cell"],[1,"status-badge",3,"ngClass"],["mat-icon-button","","matTooltip","Actions",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"delete-btn",3,"click"],["color","warn"],["mat-header-row",""],["mat-row",""]],template:function(r,i){1&r&&(e.j41(0,"div",0),e.DNE(1,BM,6,1,"div",1),e.j41(2,"div",2)(3,"div",3)(4,"h1")(5,"mat-icon"),e.EFF(6,"card_giftcard"),e.k0s(),e.EFF(7," Product Combos "),e.k0s(),e.j41(8,"p",4),e.EFF(9,"Create combo offers to boost sales"),e.k0s()(),e.j41(10,"button",5),e.bIt("click",function(){return i.openCreateDialog()}),e.j41(11,"mat-icon"),e.EFF(12,"add"),e.k0s(),e.EFF(13," Create Combo "),e.k0s()(),e.j41(14,"mat-card",6),e.DNE(15,LM,2,0,"div",7),e.DNE(16,$M,11,0,"div",8),e.DNE(17,aw,25,3,"div",9),e.k0s()()),2&r&&(e.R7$(1),e.Y8G("ngIf",i.isOffline),e.R7$(9),e.Y8G("disabled",i.isOffline),e.R7$(5),e.Y8G("ngIf",i.isLoading),e.R7$(1),e.Y8G("ngIf",!i.isLoading&&0===i.combos.length),e.R7$(1),e.Y8G("ngIf",!i.isLoading&&i.combos.length>0))},dependencies:[D.YU,D.bT,fi,j.RN,B.$z,B.iY,H.An,X.LG,me.q,ae.kk,ae.fb,ae.Cp,_e.Zl,_e.tL,_e.ji,_e.cC,_e.YV,_e.iL,_e.KS,_e.$R,_e.YZ,_e.NB,qe.oV,D.QX,D.vh],styles:[".offline-banner[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 20px;background:linear-gradient(135deg,#fff3e0 0%,#ffe0b2 100%);border:1px solid #ffb74d;border-radius:8px;margin-bottom:16px;color:#e65100;font-weight:500}.offline-banner[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px;color:#e65100}.offline-banner[_ngcontent-%COMP%]   .offline-text[_ngcontent-%COMP%]{flex:1}.offline-banner[_ngcontent-%COMP%]   .sync-time[_ngcontent-%COMP%]{font-size:13px;color:#f57c00;background:rgba(255,255,255,.6);padding:4px 12px;border-radius:12px}.combo-container[_ngcontent-%COMP%]{padding:24px}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:24px}.header-left[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;font-size:28px;font-weight:600;color:#333;margin:0}.header-left[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#d32f2f;font-size:32px;width:32px;height:32px}.subtitle[_ngcontent-%COMP%]{color:#666;margin:4px 0 0 44px}.combo-card[_ngcontent-%COMP%]{border-radius:12px;overflow:hidden}.loading-spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:60px}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:60px 20px;text-align:center}.empty-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#ccc;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;color:#333;margin:0 0 8px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;margin:0 0 20px}.combo-table[_ngcontent-%COMP%]{overflow-x:auto}table[_ngcontent-%COMP%]{width:100%}th.mat-header-cell[_ngcontent-%COMP%]{font-weight:600;color:#333;background:#f5f5f5}.combo-name-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.combo-thumb[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:8px;object-fit:cover}.combo-thumb-placeholder[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:8px;background:linear-gradient(135deg,#ff9800,#f44336);display:flex;align-items:center;justify-content:center}.combo-thumb-placeholder[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff}.combo-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.combo-info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:500;color:#333}.combo-info[_ngcontent-%COMP%]   .tamil-name[_ngcontent-%COMP%]{font-size:12px;color:#666}.item-count[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2;padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500}.price-cell[_ngcontent-%COMP%]{display:flex;flex-direction:column}.combo-price[_ngcontent-%COMP%]{font-weight:600;color:#2e7d32;font-size:16px}.original-price[_ngcontent-%COMP%]{font-size:12px;color:#999;text-decoration:line-through}.discount-badge[_ngcontent-%COMP%]{background:#ffebee;color:#d32f2f;padding:4px 10px;border-radius:12px;font-size:12px;font-weight:600}.validity-cell[_ngcontent-%COMP%]{font-size:13px;color:#666}.status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:12px;font-size:12px;font-weight:500}.status-active[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.status-inactive[_ngcontent-%COMP%]{background:#fafafa;color:#9e9e9e}.status-expired[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.status-upcoming[_ngcontent-%COMP%]{background:#e3f2fd;color:#1565c0}.delete-btn[_ngcontent-%COMP%]{color:#d32f2f}  .snackbar-success{background-color:#4caf50!important;color:#fff!important}  .snackbar-error{background-color:#f44336!important;color:#fff!important}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]{flex-direction:column;gap:16px}.combo-container[_ngcontent-%COMP%]{padding:16px}}"]})}}return n})();function cw(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1,"Title is required"),e.k0s())}function lw(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1,"Code is required"),e.k0s())}function dw(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1,"Invalid characters"),e.k0s())}function uw(n,o){if(1&n&&(e.j41(0,"mat-option",38),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.Y8G("value",t.value),e.R7$(1),e.SpI(" ",t.label," ")}}function gw(n,o){1&n&&(e.j41(0,"span",18),e.EFF(1,"\u20b9\xa0"),e.k0s())}function pw(n,o){1&n&&(e.j41(0,"span",44),e.EFF(1,"%"),e.k0s())}function fw(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1,"Required"),e.k0s())}function mw(n,o){1&n&&(e.j41(0,"mat-error"),e.EFF(1,"Must be at least 1"),e.k0s())}function hw(n,o){1&n&&(e.j41(0,"mat-form-field",21)(1,"mat-label"),e.EFF(2,"Max Discount"),e.k0s(),e.j41(3,"span",18),e.EFF(4,"\u20b9\xa0"),e.k0s(),e.nrm(5,"input",45),e.j41(6,"mat-hint"),e.EFF(7,"Optional cap"),e.k0s()())}function _w(n,o){if(1&n&&(e.j41(0,"div",39)(1,"mat-form-field",21)(2,"mat-label"),e.EFF(3,"Discount Value *"),e.k0s(),e.DNE(4,gw,2,0,"span",40),e.nrm(5,"input",41),e.DNE(6,pw,2,0,"span",42),e.DNE(7,fw,2,0,"mat-error",9),e.DNE(8,mw,2,0,"mat-error",9),e.k0s(),e.DNE(9,hw,8,0,"mat-form-field",43),e.k0s()),2&n){const t=e.XpG();let r,i,a,s,l;e.R7$(4),e.Y8G("ngIf","FIXED_AMOUNT"===(null==(r=t.promoForm.get("type"))?null:r.value)),e.R7$(2),e.Y8G("ngIf","PERCENTAGE"===(null==(i=t.promoForm.get("type"))?null:i.value)),e.R7$(1),e.Y8G("ngIf",null==(a=t.promoForm.get("discountValue"))?null:a.hasError("required")),e.R7$(1),e.Y8G("ngIf",null==(s=t.promoForm.get("discountValue"))?null:s.hasError("min")),e.R7$(1),e.Y8G("ngIf","PERCENTAGE"===(null==(l=t.promoForm.get("type"))?null:l.value))}}function xw(n,o){1&n&&(e.j41(0,"mat-icon"),e.EFF(1,"cloud_upload"),e.k0s())}function Cw(n,o){1&n&&e.nrm(0,"mat-spinner",51)}function vw(n,o){1&n&&(e.j41(0,"span"),e.EFF(1,"Click to upload banner image"),e.k0s())}function Pw(n,o){1&n&&(e.j41(0,"span"),e.EFF(1,"Uploading..."),e.k0s())}function bw(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",46)(1,"input",47,48),e.bIt("change",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.onFileSelected(i))}),e.k0s(),e.j41(3,"div",49),e.bIt("click",function(){e.eBV(t);const i=e.sdS(2);return e.Njj(i.click())}),e.DNE(4,xw,2,0,"mat-icon",9),e.DNE(5,Cw,1,0,"mat-spinner",50),e.DNE(6,vw,2,0,"span",9),e.DNE(7,Pw,2,0,"span",9),e.j41(8,"small"),e.EFF(9,"Recommended: 800x400px, Max 5MB"),e.k0s()()()}if(2&n){const t=e.XpG();e.R7$(4),e.Y8G("ngIf",!t.isUploading),e.R7$(1),e.Y8G("ngIf",t.isUploading),e.R7$(1),e.Y8G("ngIf",!t.isUploading),e.R7$(1),e.Y8G("ngIf",t.isUploading)}}function kw(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",52)(1,"img",53),e.bIt("error",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.onImageError(i))}),e.k0s(),e.j41(2,"button",54),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.removeImage())}),e.j41(3,"mat-icon"),e.EFF(4,"delete"),e.k0s()(),e.j41(5,"button",55),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.removeImage())}),e.j41(6,"mat-icon"),e.EFF(7,"delete"),e.k0s(),e.EFF(8," Remove Image "),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(1),e.Y8G("src",t.imagePreview,e.B4B)}}function Ow(n,o){1&n&&e.nrm(0,"mat-spinner",56)}function yw(n,o){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.JRh(t.isEditMode?"Update":"Create")}}let l0=(()=>{class n{constructor(t,r,i,a,s){this.fb=t,this.http=r,this.snackBar=i,this.dialogRef=a,this.data=s,this.isEditMode=!1,this.isSaving=!1,this.isUploading=!1,this.imagePreview=null,this.promoTypes=[{value:"PERCENTAGE",label:"Percentage Discount"},{value:"FIXED_AMOUNT",label:"Fixed Amount Off"},{value:"FREE_SHIPPING",label:"Free Delivery"}],this.isEditMode="edit"===s.mode}ngOnInit(){this.initForm(),this.isEditMode&&this.data.promo&&this.populateForm(this.data.promo)}initForm(){const t=new Date,r=new Date;r.setMonth(r.getMonth()+1),this.promoForm=this.fb.group({code:["",[b.k0.required,b.k0.minLength(4),b.k0.maxLength(20),b.k0.pattern(/^[A-Z0-9]+$/)]],title:["",[b.k0.required,b.k0.maxLength(100)]],description:["",b.k0.maxLength(500)],type:["PERCENTAGE",b.k0.required],discountValue:[10,[b.k0.required,b.k0.min(1)]],minimumOrderAmount:[0],maximumDiscountAmount:[null],startDate:[t,b.k0.required],endDate:[r,b.k0.required],usageLimit:[null],usageLimitPerCustomer:[1],firstTimeOnly:[!1],imageUrl:[""]}),this.isEditMode||this.promoForm.get("title")?.valueChanges.subscribe(i=>{if(i&&!this.promoForm.get("code")?.dirty){const a=i.toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,10);this.promoForm.patchValue({code:a},{emitEvent:!1})}})}populateForm(t){this.promoForm.patchValue({code:t.code,title:t.title,description:t.description,type:t.type,discountValue:t.discountValue,minimumOrderAmount:t.minimumOrderAmount||0,maximumDiscountAmount:t.maximumDiscountAmount,startDate:new Date(t.startDate),endDate:new Date(t.endDate),usageLimit:t.usageLimit,usageLimitPerCustomer:t.usageLimitPerCustomer||1,firstTimeOnly:t.firstTimeOnly,imageUrl:t.imageUrl}),t.imageUrl&&(this.imagePreview=this.getImageUrl(t.imageUrl))}getImageUrl(t){if(!t)return"";if(t.startsWith("http://")||t.startsWith("https://"))return t;let r=t.startsWith("/")?t:"/"+t;return r.startsWith("/uploads/")||(r="/uploads"+r),`${Oe.c.imageBaseUrl}${r}`}onFileSelected(t){const r=t.target.files[0];if(r){if(!r.type.startsWith("image/"))return void this.showSnackBar("Please select an image file","error");if(r.size>5242880)return void this.showSnackBar("Image must be less than 5MB","error");this.uploadImage(r)}}uploadImage(t){this.isUploading=!0;const r=new FormData;r.append("file",t),this.http.post(`${Oe.c.apiUrl}/uploads/promotion`,r).subscribe({next:i=>{const a=i.url||i.path||i.data?.url;this.promoForm.patchValue({imageUrl:a}),this.imagePreview=this.getImageUrl(a),this.isUploading=!1,this.showSnackBar("Image uploaded","success")},error:i=>{this.isUploading=!1,this.showSnackBar(i.error?.message||"Failed to upload image","error")}})}removeImage(){this.promoForm.patchValue({imageUrl:""}),this.imagePreview=null}onImageError(t){console.log("Image failed to load")}generateCode(){let r="";for(let i=0;i<8;i++)r+="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".charAt(Math.floor(36*Math.random()));this.promoForm.patchValue({code:r})}onSubmit(){if(this.promoForm.invalid)return this.markFormGroupTouched(this.promoForm),void this.showSnackBar("Please fill all required fields","error");this.isSaving=!0;const t=this.promoForm.value,r={code:t.code.toUpperCase(),title:t.title,description:t.description||null,type:t.type,discountValue:t.discountValue,minimumOrderAmount:t.minimumOrderAmount||0,maximumDiscountAmount:t.maximumDiscountAmount||null,startDate:t.startDate.toISOString(),endDate:t.endDate.toISOString(),usageLimit:t.usageLimit||null,usageLimitPerCustomer:t.usageLimitPerCustomer||1,firstTimeOnly:t.firstTimeOnly,imageUrl:t.imageUrl||null,status:"ACTIVE"},i=this.isEditMode?`${Oe.c.apiUrl}/shop-owner/promotions/${this.data.promo?.id}`:`${Oe.c.apiUrl}/shop-owner/promotions`;(this.isEditMode?this.http.put(i,r):this.http.post(i,r)).subscribe({next:()=>{this.isSaving=!1,this.showSnackBar(this.isEditMode?"Promo code updated!":"Promo code created!","success"),this.dialogRef.close(!0)},error:s=>{this.isSaving=!1,this.showSnackBar(s.error?.message||"Failed to save promo code","error")}})}markFormGroupTouched(t){Object.keys(t.controls).forEach(r=>{t.get(r)?.markAsTouched()})}onCancel(){this.dialogRef.close(!1)}showSnackBar(t,r){this.snackBar.open(t,"Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:"success"===r?"snackbar-success":"snackbar-error"})}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(b.ok),e.rXU(gt.Qq),e.rXU(Ce.UG),e.rXU(Pe.CP),e.rXU(Pe.Vh))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-shop-promo-form"]],decls:111,vars:18,consts:[[1,"dialog-container"],[1,"dialog-header"],["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close",""],[1,"dialog-content"],[3,"formGroup"],[1,"form-section"],["appearance","outline",1,"full-width"],["matInput","","formControlName","title","placeholder","e.g., Pongal Special Offer"],[4,"ngIf"],[1,"code-row"],["appearance","outline",1,"code-field"],["matInput","","formControlName","code","placeholder","e.g., PONGAL20",2,"text-transform","uppercase"],["mat-stroked-button","","type","button",1,"generate-btn",3,"click"],["matInput","","formControlName","description","rows","2","placeholder","Describe this offer..."],["formControlName","type"],[3,"value",4,"ngFor","ngForOf"],["class","value-row",4,"ngIf"],["matPrefix",""],["matInput","","type","number","formControlName","minimumOrderAmount","min","0"],[1,"date-row"],["appearance","outline"],["matInput","","formControlName","startDate",3,"matDatepicker"],["matSuffix","",3,"for"],["startPicker",""],["matInput","","formControlName","endDate",3,"matDatepicker"],["endPicker",""],[1,"limit-row"],["matInput","","type","number","formControlName","usageLimit","min","0"],["matInput","","type","number","formControlName","usageLimitPerCustomer","min","1"],[1,"checkbox-row"],["formControlName","firstTimeOnly"],["class","image-upload-area",4,"ngIf"],["class","image-preview",4,"ngIf"],["align","end"],["mat-button","",3,"disabled","click"],["mat-raised-button","","color","primary",3,"disabled","click"],["diameter","20",4,"ngIf"],[3,"value"],[1,"value-row"],["matPrefix","",4,"ngIf"],["matInput","","type","number","formControlName","discountValue","min","1"],["matSuffix","",4,"ngIf"],["appearance","outline",4,"ngIf"],["matSuffix",""],["matInput","","type","number","formControlName","maximumDiscountAmount","min","0"],[1,"image-upload-area"],["type","file","accept","image/*","hidden","",3,"change"],["fileInput",""],[1,"upload-placeholder",3,"click"],["diameter","30",4,"ngIf"],["diameter","30"],[1,"image-preview"],["alt","Promo banner preview",3,"src","error"],["mat-icon-button","","color","warn",1,"remove-image-btn",3,"click"],["mat-stroked-button","","color","warn",1,"remove-image-text-btn",3,"click"],["diameter","20"]],template:function(r,i){if(1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"h2",2)(3,"mat-icon"),e.EFF(4),e.k0s(),e.EFF(5),e.k0s(),e.j41(6,"button",3)(7,"mat-icon"),e.EFF(8,"close"),e.k0s()()(),e.j41(9,"mat-dialog-content",4)(10,"form",5)(11,"div",6)(12,"h3")(13,"mat-icon"),e.EFF(14,"info"),e.k0s(),e.EFF(15," Basic Information"),e.k0s(),e.j41(16,"mat-form-field",7)(17,"mat-label"),e.EFF(18,"Promo Title *"),e.k0s(),e.nrm(19,"input",8),e.DNE(20,cw,2,0,"mat-error",9),e.k0s(),e.j41(21,"div",10)(22,"mat-form-field",11)(23,"mat-label"),e.EFF(24,"Promo Code *"),e.k0s(),e.nrm(25,"input",12),e.j41(26,"mat-hint"),e.EFF(27,"Only uppercase letters and numbers"),e.k0s(),e.DNE(28,lw,2,0,"mat-error",9),e.DNE(29,dw,2,0,"mat-error",9),e.k0s(),e.j41(30,"button",13),e.bIt("click",function(){return i.generateCode()}),e.j41(31,"mat-icon"),e.EFF(32,"autorenew"),e.k0s(),e.EFF(33," Generate "),e.k0s()(),e.j41(34,"mat-form-field",7)(35,"mat-label"),e.EFF(36,"Description"),e.k0s(),e.nrm(37,"textarea",14),e.k0s()(),e.j41(38,"div",6)(39,"h3")(40,"mat-icon"),e.EFF(41,"percent"),e.k0s(),e.EFF(42," Discount Details"),e.k0s(),e.j41(43,"mat-form-field",7)(44,"mat-label"),e.EFF(45,"Discount Type *"),e.k0s(),e.j41(46,"mat-select",15),e.DNE(47,uw,2,2,"mat-option",16),e.k0s()(),e.DNE(48,_w,10,5,"div",17),e.j41(49,"mat-form-field",7)(50,"mat-label"),e.EFF(51,"Minimum Order Amount"),e.k0s(),e.j41(52,"span",18),e.EFF(53,"\u20b9\xa0"),e.k0s(),e.nrm(54,"input",19),e.j41(55,"mat-hint"),e.EFF(56,"Leave 0 for no minimum"),e.k0s()()(),e.j41(57,"div",6)(58,"h3")(59,"mat-icon"),e.EFF(60,"event"),e.k0s(),e.EFF(61," Validity Period"),e.k0s(),e.j41(62,"div",20)(63,"mat-form-field",21)(64,"mat-label"),e.EFF(65,"Start Date *"),e.k0s(),e.nrm(66,"input",22)(67,"mat-datepicker-toggle",23)(68,"mat-datepicker",null,24),e.k0s(),e.j41(70,"mat-form-field",21)(71,"mat-label"),e.EFF(72,"End Date *"),e.k0s(),e.nrm(73,"input",25)(74,"mat-datepicker-toggle",23)(75,"mat-datepicker",null,26),e.k0s()()(),e.j41(77,"div",6)(78,"h3")(79,"mat-icon"),e.EFF(80,"group"),e.k0s(),e.EFF(81," Usage Limits"),e.k0s(),e.j41(82,"div",27)(83,"mat-form-field",21)(84,"mat-label"),e.EFF(85,"Total Usage Limit"),e.k0s(),e.nrm(86,"input",28),e.j41(87,"mat-hint"),e.EFF(88,"Leave empty for unlimited"),e.k0s()(),e.j41(89,"mat-form-field",21)(90,"mat-label"),e.EFF(91,"Per Customer Limit"),e.k0s(),e.nrm(92,"input",29),e.k0s()(),e.j41(93,"div",30)(94,"mat-checkbox",31)(95,"mat-icon"),e.EFF(96,"person_add"),e.k0s(),e.EFF(97," First-time customers only "),e.k0s()()(),e.j41(98,"div",6)(99,"h3")(100,"mat-icon"),e.EFF(101,"image"),e.k0s(),e.EFF(102," Promo Banner (Optional)"),e.k0s(),e.DNE(103,bw,10,4,"div",32),e.DNE(104,kw,9,1,"div",33),e.k0s()()(),e.j41(105,"mat-dialog-actions",34)(106,"button",35),e.bIt("click",function(){return i.onCancel()}),e.EFF(107,"Cancel"),e.k0s(),e.j41(108,"button",36),e.bIt("click",function(){return i.onSubmit()}),e.DNE(109,Ow,1,0,"mat-spinner",37),e.DNE(110,yw,2,1,"span",9),e.k0s()()()),2&r){const a=e.sdS(69),s=e.sdS(76);let l,u,p,f;e.R7$(4),e.JRh(i.isEditMode?"edit":"add_circle"),e.R7$(1),e.SpI(" ",i.isEditMode?"Edit Promo Code":"Create Promo Code"," "),e.R7$(5),e.Y8G("formGroup",i.promoForm),e.R7$(10),e.Y8G("ngIf",null==(l=i.promoForm.get("title"))?null:l.hasError("required")),e.R7$(8),e.Y8G("ngIf",null==(u=i.promoForm.get("code"))?null:u.hasError("required")),e.R7$(1),e.Y8G("ngIf",null==(p=i.promoForm.get("code"))?null:p.hasError("pattern")),e.R7$(18),e.Y8G("ngForOf",i.promoTypes),e.R7$(1),e.Y8G("ngIf","FREE_SHIPPING"!==(null==(f=i.promoForm.get("type"))?null:f.value)),e.R7$(18),e.Y8G("matDatepicker",a),e.R7$(1),e.Y8G("for",a),e.R7$(6),e.Y8G("matDatepicker",s),e.R7$(1),e.Y8G("for",s),e.R7$(29),e.Y8G("ngIf",!i.imagePreview),e.R7$(1),e.Y8G("ngIf",i.imagePreview),e.R7$(2),e.Y8G("disabled",i.isSaving),e.R7$(2),e.Y8G("disabled",i.isSaving),e.R7$(1),e.Y8G("ngIf",i.isSaving),e.R7$(1),e.Y8G("ngIf",!i.isSaving)}},dependencies:[D.Sq,D.bT,b.qT,b.me,b.Q0,b.BC,b.cb,b.VZ,b.j4,b.JD,B.$z,B.iY,H.An,X.LG,ge.rl,ge.nJ,ge.MV,ge.TL,ge.JW,ge.yw,Ee.fg,ze.VO,Bt.wT,Pe.tx,Pe.BI,Pe.Yi,Pe.E7,Et.Vh,Et.bZ,Et.bU,it.So],styles:[".dialog-container[_ngcontent-%COMP%]{min-width:550px}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 24px;border-bottom:1px solid #e0e0e0;background:linear-gradient(135deg,#ff6b35 0%,#ff8c5a 100%);color:#fff;margin:-24px -24px 0}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;display:flex;align-items:center;gap:8px;font-size:1.25rem}.dialog-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#fff}.dialog-content[_ngcontent-%COMP%]{padding:24px;max-height:65vh;overflow-y:auto}.form-section[_ngcontent-%COMP%]{margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid #eee}.form-section[_ngcontent-%COMP%]:last-child{border-bottom:none;margin-bottom:0}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:1rem;color:#333;margin-bottom:16px}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#ff6b35;font-size:20px;width:20px;height:20px}.full-width[_ngcontent-%COMP%]{width:100%}.code-row[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:flex-start}.code-field[_ngcontent-%COMP%]{flex:1}.generate-btn[_ngcontent-%COMP%]{margin-top:4px;height:56px}.value-row[_ngcontent-%COMP%], .date-row[_ngcontent-%COMP%], .limit-row[_ngcontent-%COMP%]{display:flex;gap:16px}.value-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%], .date-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%], .limit-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1}.checkbox-row[_ngcontent-%COMP%]{margin-top:16px}.checkbox-row[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.checkbox-row[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#666}.image-upload-area[_ngcontent-%COMP%]{margin-top:8px}.upload-placeholder[_ngcontent-%COMP%]{border:2px dashed #ccc;border-radius:8px;padding:32px;text-align:center;cursor:pointer;transition:all .2s ease;display:flex;flex-direction:column;align-items:center;gap:8px;background:#fafafa}.upload-placeholder[_ngcontent-%COMP%]:hover{border-color:#ff6b35;background:#fff5f0}.upload-placeholder[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#999}.upload-placeholder[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#999}.image-preview[_ngcontent-%COMP%]{position:relative;border-radius:8px;overflow:hidden;margin-top:8px}.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-height:200px;object-fit:cover;display:block}.remove-image-btn[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;background:rgba(255,255,255,.9)}.remove-image-text-btn[_ngcontent-%COMP%]{display:block;margin-top:8px;width:100%}mat-dialog-actions[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid #e0e0e0;margin:0 -24px -24px}mat-dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:100px}mat-dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{display:inline-block;margin-right:8px}@media (max-width: 600px){.dialog-container[_ngcontent-%COMP%]{min-width:auto}.code-row[_ngcontent-%COMP%], .value-row[_ngcontent-%COMP%], .date-row[_ngcontent-%COMP%], .limit-row[_ngcontent-%COMP%]{flex-direction:column;gap:0}.generate-btn[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}}"]})}}return n})();function Mw(n,o){1&n&&(e.j41(0,"div",10),e.nrm(1,"mat-spinner",11),e.k0s())}function ww(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",12)(1,"mat-icon",13),e.EFF(2,"local_offer"),e.k0s(),e.j41(3,"h3"),e.EFF(4,"No Promo Codes Yet"),e.k0s(),e.j41(5,"p"),e.EFF(6,"Create your first promo code to attract more customers!"),e.k0s(),e.j41(7,"button",5),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.openCreateDialog())}),e.j41(8,"mat-icon"),e.EFF(9,"add"),e.k0s(),e.EFF(10," Create Your First Promo "),e.k0s()()}}function Fw(n,o){if(1&n&&(e.j41(0,"div",37),e.nrm(1,"img",38),e.k0s()),2&n){const t=e.XpG().$implicit,r=e.XpG(2);e.R7$(1),e.Y8G("src",r.getImageUrl(t.imageUrl),e.B4B)}}function Ew(n,o){1&n&&(e.j41(0,"div",39)(1,"mat-icon"),e.EFF(2,"local_offer"),e.k0s()())}function Sw(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",40),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG(2);return e.Njj(a.toggleStatus(i))}),e.j41(1,"mat-icon"),e.EFF(2),e.k0s()()}if(2&n){const t=e.XpG().$implicit;e.Y8G("matTooltip","ACTIVE"===t.status?"Deactivate":"Activate"),e.R7$(2),e.JRh("ACTIVE"===t.status?"pause":"play_arrow")}}function Tw(n,o){if(1&n&&(e.j41(0,"p",41),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.JRh(t.description)}}function Iw(n,o){if(1&n&&(e.j41(0,"div",33)(1,"mat-icon"),e.EFF(2,"people"),e.k0s(),e.j41(3,"span"),e.EFF(4),e.k0s()()),2&n){const t=e.XpG().$implicit;e.R7$(4),e.Lme("",t.usageCount||0,"/",t.usageLimit," used")}}function Rw(n,o){1&n&&(e.j41(0,"span",42)(1,"mat-icon"),e.EFF(2,"person_add"),e.k0s(),e.EFF(3," First-time only "),e.k0s())}function Nw(n,o){if(1&n&&(e.j41(0,"span",42),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.SpI(" Max: \u20b9",t.maximumDiscountAmount," ")}}function Aw(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",16),e.DNE(1,Fw,2,1,"div",17),e.DNE(2,Ew,3,0,"div",18),e.j41(3,"div",19)(4,"button",20),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.openEditDialog(a))}),e.j41(5,"mat-icon"),e.EFF(6,"edit"),e.k0s()(),e.DNE(7,Sw,3,2,"button",21),e.j41(8,"button",22),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.deletePromo(a))}),e.j41(9,"mat-icon"),e.EFF(10,"delete"),e.k0s()()(),e.j41(11,"div",23)(12,"div",24)(13,"span",25),e.EFF(14),e.k0s(),e.j41(15,"span",26),e.EFF(16),e.k0s()(),e.j41(17,"h3",27),e.EFF(18),e.k0s(),e.DNE(19,Tw,2,1,"p",28),e.j41(20,"div",29),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.copyCode(a.code))}),e.j41(21,"span",30),e.EFF(22),e.k0s(),e.j41(23,"mat-icon",31),e.EFF(24,"content_copy"),e.k0s()(),e.j41(25,"div",32)(26,"div",33)(27,"mat-icon"),e.EFF(28,"shopping_cart"),e.k0s(),e.j41(29,"span"),e.EFF(30),e.k0s()(),e.j41(31,"div",33)(32,"mat-icon"),e.EFF(33,"event"),e.k0s(),e.j41(34,"span"),e.EFF(35),e.nI1(36,"date"),e.nI1(37,"date"),e.k0s()(),e.DNE(38,Iw,5,2,"div",34),e.k0s(),e.j41(39,"div",35),e.DNE(40,Rw,4,0,"span",36),e.DNE(41,Nw,2,1,"span",36),e.k0s()()()}if(2&n){const t=o.$implicit,r=e.XpG(2);e.Y8G("ngClass",r.getStatusClass(t)),e.R7$(1),e.Y8G("ngIf",t.imageUrl),e.R7$(1),e.Y8G("ngIf",!t.imageUrl),e.R7$(5),e.Y8G("ngIf",!r.isExpired(t)),e.R7$(7),e.JRh(r.getDiscountText(t)),e.R7$(1),e.Y8G("ngClass",r.getStatusClass(t)),e.R7$(1),e.JRh(r.getStatusText(t)),e.R7$(2),e.JRh(t.title),e.R7$(1),e.Y8G("ngIf",t.description),e.R7$(3),e.JRh(t.code),e.R7$(8),e.JRh(r.getMinOrderText(t)),e.R7$(5),e.Lme("",e.i5U(36,16,t.startDate,"dd MMM")," - ",e.i5U(37,19,t.endDate,"dd MMM yyyy"),""),e.R7$(3),e.Y8G("ngIf",t.usageLimit),e.R7$(2),e.Y8G("ngIf",t.firstTimeOnly),e.R7$(1),e.Y8G("ngIf",t.maximumDiscountAmount)}}function Dw(n,o){if(1&n&&(e.j41(0,"div",14),e.DNE(1,Aw,42,22,"div",15),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.promoCodes)}}let jw=(()=>{class n{constructor(t,r,i,a){this.http=t,this.authService=r,this.snackBar=i,this.dialog=a,this.promoCodes=[],this.isLoading=!1,this.shopId=null}ngOnInit(){this.loadShopId()}loadShopId(){const t=this.authService.getCurrentUser();t?.shopId?(this.shopId=t.shopId,this.loadPromoCodes()):this.http.get(`${Oe.c.apiUrl}/shops/my-shop`).subscribe({next:r=>{this.shopId=r.data?.id||r.id,this.loadPromoCodes()},error:()=>{this.showSnackBar("Failed to load shop info","error")}})}loadPromoCodes(){this.isLoading=!0,this.http.get(`${Oe.c.apiUrl}/shop-owner/promotions`).subscribe({next:t=>{const r=t.data?.content||t.data||t.content||t||[];this.promoCodes=Array.isArray(r)?r:[],this.isLoading=!1},error:t=>{console.error("Error loading promo codes:",t),this.isLoading=!1,this.promoCodes=[]}})}openCreateDialog(){this.dialog.open(l0,{width:"600px",maxHeight:"90vh",data:{mode:"create",shopId:this.shopId}}).afterClosed().subscribe(r=>{r&&this.loadPromoCodes()})}openEditDialog(t){this.dialog.open(l0,{width:"600px",maxHeight:"90vh",data:{mode:"edit",promo:t,shopId:this.shopId}}).afterClosed().subscribe(i=>{i&&this.loadPromoCodes()})}toggleStatus(t){const r="ACTIVE"===t.status?"INACTIVE":"ACTIVE";this.http.patch(`${Oe.c.apiUrl}/shop-owner/promotions/${t.id}/status?status=${r}`,{}).subscribe({next:()=>{t.status=r,this.showSnackBar(`Promo code ${r.toLowerCase()}`,"success")},error:i=>{this.showSnackBar(i.error?.message||"Failed to update status","error")}})}deletePromo(t){confirm(`Are you sure you want to delete "${t.title}"?`)&&this.http.delete(`${Oe.c.apiUrl}/shop-owner/promotions/${t.id}`).subscribe({next:()=>{this.promoCodes=this.promoCodes.filter(r=>r.id!==t.id),this.showSnackBar("Promo code deleted","success")},error:r=>{this.showSnackBar(r.error?.message||"Failed to delete promo code","error")}})}getDiscountText(t){switch(t.type){case"PERCENTAGE":return`${t.discountValue}% OFF`;case"FIXED_AMOUNT":return`\u20b9${t.discountValue} OFF`;case"FREE_SHIPPING":return"FREE DELIVERY";default:return"SPECIAL OFFER"}}getMinOrderText(t){return t.minimumOrderAmount&&t.minimumOrderAmount>0?`Min: \u20b9${t.minimumOrderAmount}`:"No minimum"}isExpired(t){return new Date(t.endDate)<new Date}isUpcoming(t){return new Date(t.startDate)>new Date}getStatusClass(t){return"INACTIVE"===t.status?"status-inactive":this.isExpired(t)?"status-expired":this.isUpcoming(t)?"status-upcoming":"status-active"}getStatusText(t){return"INACTIVE"===t.status?"Inactive":this.isExpired(t)?"Expired":this.isUpcoming(t)?"Upcoming":"Active"}copyCode(t){navigator.clipboard.writeText(t).then(()=>{this.showSnackBar("Code copied!","success")})}getImageUrl(t){if(!t)return"";if(t.startsWith("http://")||t.startsWith("https://"))return t;const r=t.startsWith("/")?t:"/"+t;return`${Oe.c.imageBaseUrl}${r}`}showSnackBar(t,r){this.snackBar.open(t,"Close",{duration:3e3,horizontalPosition:"end",verticalPosition:"top",panelClass:"success"===r?"snackbar-success":"snackbar-error"})}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(gt.Qq),e.rXU(Gt.u),e.rXU(Ce.UG),e.rXU(Pe.bZ))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-shop-promo-list"]],decls:18,vars:3,consts:[[1,"promo-container"],[1,"page-header"],[1,"header-left"],[1,"subtitle"],[1,"header-actions"],["mat-raised-button","","color","primary",3,"click"],[1,"promo-card"],["class","loading-spinner",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","promo-grid",4,"ngIf"],[1,"loading-spinner"],["diameter","40"],[1,"empty-state"],[1,"empty-icon"],[1,"promo-grid"],["class","promo-item",3,"ngClass",4,"ngFor","ngForOf"],[1,"promo-item",3,"ngClass"],["class","promo-banner",4,"ngIf"],["class","promo-banner default-banner",4,"ngIf"],[1,"promo-actions"],["mat-icon-button","","matTooltip","Edit",3,"click"],["mat-icon-button","",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","matTooltip","Delete","color","warn",3,"click"],[1,"promo-content"],[1,"promo-header"],[1,"discount-badge"],[1,"status-badge",3,"ngClass"],[1,"promo-title"],["class","promo-description",4,"ngIf"],[1,"promo-code-box",3,"click"],[1,"code"],["matTooltip","Click to copy"],[1,"promo-details"],[1,"detail-item"],["class","detail-item",4,"ngIf"],[1,"promo-tags"],["class","tag",4,"ngIf"],[1,"promo-banner"],["alt","Promo banner",3,"src"],[1,"promo-banner","default-banner"],["mat-icon-button","",3,"matTooltip","click"],[1,"promo-description"],[1,"tag"]],template:function(r,i){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1")(4,"mat-icon"),e.EFF(5,"local_offer"),e.k0s(),e.EFF(6," Promo Codes "),e.k0s(),e.j41(7,"p",3),e.EFF(8,"Create and manage promotions for your shop"),e.k0s()(),e.j41(9,"div",4)(10,"button",5),e.bIt("click",function(){return i.openCreateDialog()}),e.j41(11,"mat-icon"),e.EFF(12,"add"),e.k0s(),e.EFF(13," Create Promo "),e.k0s()()(),e.j41(14,"mat-card",6),e.DNE(15,Mw,2,0,"div",7),e.DNE(16,ww,11,0,"div",8),e.DNE(17,Dw,2,1,"div",9),e.k0s()()),2&r&&(e.R7$(15),e.Y8G("ngIf",i.isLoading),e.R7$(1),e.Y8G("ngIf",!i.isLoading&&0===i.promoCodes.length),e.R7$(1),e.Y8G("ngIf",!i.isLoading&&i.promoCodes.length>0))},dependencies:[D.YU,D.Sq,D.bT,j.RN,B.$z,B.iY,H.An,X.LG,qe.oV,D.vh],styles:[".promo-container[_ngcontent-%COMP%]{padding:24px}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.header-left[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;font-size:28px;font-weight:600;color:#333;margin:0}.header-left[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#ff9800;font-size:32px;width:32px;height:32px}.subtitle[_ngcontent-%COMP%]{color:#666;margin:4px 0 0 44px}.promo-card[_ngcontent-%COMP%]{border-radius:12px;padding:24px}.loading-spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:60px}.info-banner[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;background:#e3f2fd;border-radius:8px;margin-bottom:24px;color:#1565c0}.info-banner[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{flex-shrink:0}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:60px 20px;text-align:center}.empty-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#ccc;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;color:#333;margin:0 0 8px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;margin:0}.promo-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:20px}.promo-item[_ngcontent-%COMP%]{background:white;border-radius:12px;overflow:hidden;box-shadow:0 2px 8px #00000014;transition:transform .2s,box-shadow .2s}.promo-item[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 16px #0000001f}.promo-item.status-expired[_ngcontent-%COMP%]{opacity:.7}.promo-item.status-inactive[_ngcontent-%COMP%]{opacity:.6}.promo-banner[_ngcontent-%COMP%]{height:100px;overflow:hidden}.promo-banner[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.promo-banner.default-banner[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ff9800,#f57c00);display:flex;align-items:center;justify-content:center}.promo-banner.default-banner[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#fff;opacity:.8}.promo-item[_ngcontent-%COMP%]{position:relative}.promo-actions[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;display:flex;gap:4px;opacity:0;transition:opacity .2s;z-index:10}.promo-item[_ngcontent-%COMP%]:hover   .promo-actions[_ngcontent-%COMP%]{opacity:1}.promo-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:rgba(255,255,255,.9);box-shadow:0 2px 4px #0003}.promo-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:white}.promo-content[_ngcontent-%COMP%]{padding:16px}.promo-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.discount-badge[_ngcontent-%COMP%]{background:#ffebee;color:#d32f2f;padding:4px 12px;border-radius:16px;font-weight:700;font-size:14px}.status-badge[_ngcontent-%COMP%]{padding:4px 10px;border-radius:12px;font-size:11px;font-weight:600;text-transform:uppercase}.status-badge.status-active[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.status-badge.status-inactive[_ngcontent-%COMP%]{background:#fafafa;color:#9e9e9e}.status-badge.status-expired[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.status-badge.status-upcoming[_ngcontent-%COMP%]{background:#e3f2fd;color:#1565c0}.promo-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#333;margin:0 0 8px}.promo-description[_ngcontent-%COMP%]{font-size:13px;color:#666;margin:0 0 12px;line-height:1.4}.promo-code-box[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:10px 14px;background:#f5f5f5;border:2px dashed #ccc;border-radius:8px;cursor:pointer;transition:all .2s;margin-bottom:12px}.promo-code-box[_ngcontent-%COMP%]:hover{border-color:#ff9800;background:#fff3e0}.promo-code-box[_ngcontent-%COMP%]   .code[_ngcontent-%COMP%]{font-family:monospace;font-size:18px;font-weight:700;color:#333;letter-spacing:2px}.promo-code-box[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#999;font-size:18px;width:18px;height:18px}.promo-code-box[_ngcontent-%COMP%]:hover   mat-icon[_ngcontent-%COMP%]{color:#ff9800}.promo-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;margin-bottom:12px}.detail-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:13px;color:#666}.detail-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;color:#999}.promo-tags[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.tag[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:11px;color:#666;background:#f0f0f0;padding:4px 8px;border-radius:12px}.tag[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px}  .snackbar-success{background-color:#4caf50!important;color:#fff!important}  .snackbar-error{background-color:#f44336!important;color:#fff!important}@media (max-width: 768px){.promo-container[_ngcontent-%COMP%]{padding:16px}.promo-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})}}return n})();var Bw=E(8314);const Lw=["searchInput"],$w=["barcodeInput"];function Gw(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",47),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.manualSync())}),e.j41(1,"mat-icon"),e.EFF(2,"sync"),e.k0s()()}if(2&n){const t=e.XpG();e.Y8G("disabled",!t.syncStatus.isOnline||t.syncStatus.isSyncing),e.R7$(1),e.AVh("spinning",t.syncStatus.isSyncing)}}function Uw(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",48),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return i.searchTerm="",e.Njj(i.onSearchChange())}),e.j41(1,"mat-icon"),e.EFF(2,"close"),e.k0s()()}}function zw(n,o){1&n&&(e.j41(0,"div",49)(1,"mat-icon"),e.EFF(2,"qr_code_scanner"),e.k0s(),e.j41(3,"h3"),e.EFF(4,"Scan or Search to Add Products"),e.k0s(),e.j41(5,"p"),e.EFF(6,"Search by name, SKU, or scan barcode to find products"),e.k0s()())}function Vw(n,o){if(1&n){const t=e.RV6();e.j41(0,"img",70),e.bIt("error",function(i){e.eBV(t);const a=e.XpG(3);return e.Njj(a.onImageError(i))}),e.k0s()}if(2&n){const t=e.XpG().$implicit;e.Y8G("appOfflineImg",t.imageBase64||t.image)("fallback","assets/images/product-placeholder.svg")("alt",t.name)}}function Yw(n,o){if(1&n&&(e.j41(0,"div",71),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit,r=e.XpG(2);e.R7$(1),e.JRh(r.getDisplayBarcode(t))}}function Xw(n,o){if(1&n&&(e.j41(0,"span",74),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.R7$(1),e.JRh(t)}}function Hw(n,o){if(1&n&&(e.j41(0,"div",72),e.DNE(1,Xw,2,1,"span",73),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.Y8G("ngForOf",t.tags.slice(0,1))}}function Ww(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",53)(1,"button",54),e.bIt("click",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.openQuickEdit(s,i))}),e.j41(2,"mat-icon"),e.EFF(3,"edit"),e.k0s()(),e.j41(4,"div",55)(5,"span"),e.EFF(6),e.k0s()(),e.j41(7,"div",56),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.addToCart(a))}),e.DNE(8,Vw,1,3,"img",57),e.k0s(),e.j41(9,"div",58)(10,"div",59),e.EFF(11),e.k0s(),e.DNE(12,Yw,2,1,"div",60),e.DNE(13,Hw,2,1,"div",61),e.k0s(),e.j41(14,"div",62)(15,"div",63)(16,"span",64),e.EFF(17,"\u20b9"),e.k0s(),e.j41(18,"input",65),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.updateCartItemPrice(s,i))})("click",function(i){return i.stopPropagation()}),e.k0s()(),e.j41(19,"div",66)(20,"button",67),e.bIt("click",function(i){const s=e.eBV(t).$implicit;return e.XpG(2).updateCartQuantityByProduct(s,-1),e.Njj(i.stopPropagation())}),e.j41(21,"mat-icon"),e.EFF(22,"remove"),e.k0s()(),e.j41(23,"input",68),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.setCartQuantityByProduct(s,i))})("click",function(i){return i.stopPropagation()}),e.k0s(),e.j41(24,"button",69),e.bIt("click",function(i){const s=e.eBV(t).$implicit;return e.XpG(2).updateCartQuantityByProduct(s,1),e.Njj(i.stopPropagation())}),e.j41(25,"mat-icon"),e.EFF(26,"add"),e.k0s()()()()()}if(2&n){const t=o.$implicit,r=e.XpG(2);e.R7$(6),e.JRh(r.getCartQuantity(t)),e.R7$(2),e.Y8G("ngIf",t.imageBase64||t.image),e.R7$(3),e.JRh(r.getProductName(t)),e.R7$(1),e.Y8G("ngIf",r.getDisplayBarcode(t)),e.R7$(1),e.Y8G("ngIf",t.tags&&t.tags.length>0),e.R7$(2),e.AVh("price-above-mrp",r.isPriceAboveMrp(t)),e.R7$(3),e.Y8G("value",r.getCartItemPrice(t))("title",r.isPriceAboveMrp(t)?"Price exceeds MRP (\u20b9"+r.getCartItemMrp(t)+")":""),e.R7$(5),e.Y8G("value",r.getCartQuantity(t))}}function qw(n,o){if(1&n&&(e.j41(0,"div",50)(1,"div",51)(2,"mat-icon"),e.EFF(3,"shopping_cart"),e.k0s(),e.j41(4,"span"),e.EFF(5),e.k0s()(),e.DNE(6,Ww,27,10,"div",52),e.k0s()),2&n){const t=e.XpG();e.R7$(5),e.SpI("Products in Cart (",t.cart.length,")"),e.R7$(1),e.Y8G("ngForOf",t.getCartProducts())}}function Zw(n,o){if(1&n&&(e.j41(0,"div",55)(1,"span"),e.EFF(2),e.k0s()()),2&n){const t=e.XpG().$implicit,r=e.XpG(2);e.R7$(2),e.JRh(r.getCartQuantity(t))}}function Qw(n,o){if(1&n){const t=e.RV6();e.j41(0,"img",70),e.bIt("error",function(i){e.eBV(t);const a=e.XpG(3);return e.Njj(a.onImageError(i))}),e.k0s()}if(2&n){const t=e.XpG().$implicit;e.Y8G("appOfflineImg",t.imageBase64||t.image)("fallback","assets/images/product-placeholder.svg")("alt",t.name)}}function Jw(n,o){if(1&n&&(e.j41(0,"div",71),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit,r=e.XpG(2);e.R7$(1),e.JRh(r.getDisplayBarcode(t))}}function Kw(n,o){if(1&n&&(e.j41(0,"span",74),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.R7$(1),e.JRh(t)}}function eF(n,o){if(1&n&&(e.j41(0,"div",72),e.DNE(1,Kw,2,1,"span",73),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.Y8G("ngForOf",t.tags.slice(0,1))}}function tF(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",77)(1,"button",54),e.bIt("click",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.openQuickEdit(s,i))}),e.j41(2,"mat-icon"),e.EFF(3,"edit"),e.k0s()(),e.DNE(4,Zw,3,1,"div",78),e.j41(5,"div",56),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.addToCart(a))}),e.DNE(6,Qw,1,3,"img",57),e.k0s(),e.j41(7,"div",58)(8,"div",59),e.EFF(9),e.k0s(),e.DNE(10,Jw,2,1,"div",60),e.DNE(11,eF,2,1,"div",61),e.k0s(),e.j41(12,"div",62)(13,"div",63)(14,"span",64),e.EFF(15,"\u20b9"),e.k0s(),e.j41(16,"input",79),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.setTempPrice(s,i))})("click",function(i){return i.stopPropagation()}),e.k0s()(),e.j41(17,"div",66)(18,"button",67),e.bIt("click",function(i){const s=e.eBV(t).$implicit;return e.XpG(2).decrementTempQty(s),e.Njj(i.stopPropagation())}),e.j41(19,"mat-icon"),e.EFF(20,"remove"),e.k0s()(),e.j41(21,"input",80),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.setTempQty(s,i))})("click",function(i){return i.stopPropagation()}),e.k0s(),e.j41(22,"button",69),e.bIt("click",function(i){const s=e.eBV(t).$implicit;return e.XpG(2).incrementTempQty(s),e.Njj(i.stopPropagation())}),e.j41(23,"mat-icon"),e.EFF(24,"add"),e.k0s()()(),e.j41(25,"button",81),e.bIt("click",function(i){const s=e.eBV(t).$implicit;return e.XpG(2).addToCartWithTempValues(s),e.Njj(i.stopPropagation())}),e.j41(26,"mat-icon"),e.EFF(27,"add_shopping_cart"),e.k0s()()()()}if(2&n){const t=o.$implicit,r=e.XpG(2);e.AVh("out-of-stock",t.trackInventory&&t.stock<=0)("in-cart",r.isInCart(t)),e.R7$(4),e.Y8G("ngIf",r.getCartQuantity(t)>0),e.R7$(2),e.Y8G("ngIf",t.imageBase64||t.image),e.R7$(3),e.JRh(r.getProductName(t)),e.R7$(1),e.Y8G("ngIf",r.getDisplayBarcode(t)),e.R7$(1),e.Y8G("ngIf",t.tags&&t.tags.length>0),e.R7$(5),e.Y8G("value",r.getTempPrice(t)),e.R7$(5),e.Y8G("value",r.getTempQty(t)),e.R7$(4),e.Y8G("disabled",0===r.getTempQty(t))}}function nF(n,o){if(1&n&&(e.j41(0,"div",82)(1,"mat-icon"),e.EFF(2,"search_off"),e.k0s(),e.j41(3,"p"),e.EFF(4),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(4),e.SpI('No products found for "',t.searchTerm,'"')}}function rF(n,o){if(1&n&&(e.j41(0,"div",50),e.DNE(1,tF,28,12,"div",75),e.DNE(2,nF,5,1,"div",76),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.filteredProducts)("ngForTrackBy",t.trackByProductId),e.R7$(1),e.Y8G("ngIf",0===t.filteredProducts.length)}}function iF(n,o){1&n&&(e.j41(0,"div",83),e.nrm(1,"mat-spinner",84),e.j41(2,"p"),e.EFF(3,"Loading products..."),e.k0s()())}function oF(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",94),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return i.searchTerm="",e.Njj(i.onSearchChange())}),e.j41(1,"mat-icon"),e.EFF(2,"close"),e.k0s()()}}function aF(n,o){if(1&n&&(e.j41(0,"div",55)(1,"span"),e.EFF(2),e.k0s()()),2&n){const t=e.XpG().$implicit,r=e.XpG(3);e.R7$(2),e.JRh(r.getCartQuantity(t))}}function sF(n,o){if(1&n){const t=e.RV6();e.j41(0,"img",70),e.bIt("error",function(i){e.eBV(t);const a=e.XpG(4);return e.Njj(a.onImageError(i))}),e.k0s()}if(2&n){const t=e.XpG().$implicit;e.Y8G("appOfflineImg",t.imageBase64||t.image)("fallback","assets/images/product-placeholder.svg")("alt",t.name)}}function cF(n,o){if(1&n&&(e.j41(0,"div",102),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.JRh(t.name)}}function lF(n,o){if(1&n&&(e.j41(0,"div",102),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.JRh(t.nameTamil)}}function dF(n,o){if(1&n&&(e.j41(0,"div",71),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit,r=e.XpG(3);e.R7$(1),e.JRh(r.getDisplayBarcode(t))}}function uF(n,o){if(1&n&&(e.j41(0,"div",103)(1,"span"),e.EFF(2),e.k0s()()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.AVh("low-stock",t.stock<=5),e.R7$(1),e.SpI("Stock: ",t.stock,"")}}function gF(n,o){if(1&n&&(e.j41(0,"span",74),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.R7$(1),e.JRh(t)}}function pF(n,o){if(1&n&&(e.j41(0,"div",72),e.DNE(1,gF,2,1,"span",73),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.Y8G("ngForOf",t.tags.slice(0,2))}}function fF(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",97),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(3);return e.Njj(s.addToCart(a))}),e.DNE(1,aF,3,1,"div",78),e.j41(2,"button",54),e.bIt("click",function(i){const s=e.eBV(t).$implicit,l=e.XpG(3);return e.Njj(l.openQuickEdit(s,i))}),e.j41(3,"mat-icon"),e.EFF(4,"edit"),e.k0s()(),e.j41(5,"div",98),e.DNE(6,sF,1,3,"img",57),e.k0s(),e.j41(7,"div",58)(8,"div",59),e.EFF(9),e.k0s(),e.DNE(10,cF,2,1,"div",99),e.DNE(11,lF,2,1,"div",99),e.DNE(12,dF,2,1,"div",60),e.j41(13,"div",100),e.EFF(14),e.k0s(),e.DNE(15,uF,3,3,"div",101),e.DNE(16,pF,2,1,"div",61),e.k0s()()}if(2&n){const t=o.$implicit,r=e.XpG(3);e.AVh("out-of-stock",t.trackInventory&&t.stock<=0)("in-cart",r.isInCart(t)),e.R7$(1),e.Y8G("ngIf",r.getCartQuantity(t)>0),e.R7$(5),e.Y8G("ngIf",t.imageBase64||t.image),e.R7$(3),e.JRh(r.getProductName(t)),e.R7$(1),e.Y8G("ngIf",r.showTamil&&t.name),e.R7$(1),e.Y8G("ngIf",!r.showTamil&&t.nameTamil),e.R7$(1),e.Y8G("ngIf",r.getDisplayBarcode(t)),e.R7$(2),e.SpI("\u20b9",t.price,""),e.R7$(1),e.Y8G("ngIf",t.trackInventory),e.R7$(1),e.Y8G("ngIf",t.tags&&t.tags.length>0)}}function mF(n,o){1&n&&(e.j41(0,"div",82)(1,"mat-icon"),e.EFF(2,"inventory_2"),e.k0s(),e.j41(3,"p"),e.EFF(4,"No products found"),e.k0s()())}function hF(n,o){if(1&n&&(e.j41(0,"div",95),e.DNE(1,fF,17,13,"div",96),e.DNE(2,mF,5,0,"div",76),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("ngForOf",t.filteredProducts)("ngForTrackBy",t.trackByProductId),e.R7$(1),e.Y8G("ngIf",0===t.filteredProducts.length)}}function _F(n,o){1&n&&(e.j41(0,"div",83),e.nrm(1,"mat-spinner",84),e.j41(2,"p"),e.EFF(3,"Loading products..."),e.k0s()())}function xF(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",85)(1,"div",86)(2,"div",87)(3,"div",88)(4,"mat-icon"),e.EFF(5,"search"),e.k0s(),e.j41(6,"input",89),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.searchTerm=i)})("input",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onSearchChange())}),e.k0s(),e.DNE(7,oF,3,0,"button",90),e.k0s(),e.j41(8,"div",91)(9,"mat-icon"),e.EFF(10,"qr_code_scanner"),e.k0s(),e.j41(11,"input",92),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.barcodeBuffer=i)})("keyup.enter",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onBarcodeSubmit())}),e.k0s()()()(),e.DNE(12,hF,3,3,"div",93),e.DNE(13,_F,4,0,"div",23),e.k0s()}if(2&n){const t=e.XpG();e.R7$(6),e.Y8G("ngModel",t.searchTerm),e.R7$(1),e.Y8G("ngIf",t.searchTerm),e.R7$(4),e.Y8G("ngModel",t.barcodeBuffer),e.R7$(1),e.Y8G("ngIf",!t.isLoading),e.R7$(1),e.Y8G("ngIf",t.isLoading)}}function CF(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",104),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.clearCart())}),e.j41(1,"mat-icon"),e.EFF(2,"delete_sweep"),e.k0s()()}}function vF(n,o){if(1&n&&(e.j41(0,"span",120),e.EFF(1),e.k0s()),2&n){const t=e.XpG(2).$implicit;e.R7$(1),e.SpI("\u20b9",t.mrp,"")}}function PF(n,o){if(1&n&&(e.j41(0,"span",121),e.EFF(1),e.k0s()),2&n){const t=e.XpG(2).$implicit;e.R7$(1),e.SpI("Save \u20b9",t.discount*t.quantity,"")}}function bF(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",106)(1,"div",107)(2,"div",108),e.EFF(3),e.k0s(),e.j41(4,"button",109),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.removeFromCart(i))}),e.j41(5,"mat-icon"),e.EFF(6,"close"),e.k0s()()(),e.j41(7,"div",110)(8,"div",111),e.DNE(9,vF,2,1,"span",112),e.j41(10,"span",113),e.EFF(11),e.k0s()(),e.j41(12,"div",114)(13,"button",115),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.updateQuantity(i,-1))}),e.j41(14,"mat-icon"),e.EFF(15,"remove"),e.k0s()(),e.j41(16,"input",116),e.bIt("change",function(i){e.eBV(t);const a=e.XpG().$implicit,s=e.XpG();return e.Njj(s.setCartItemQuantity(a,i))}),e.k0s(),e.j41(17,"button",115),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG();return e.Njj(a.updateQuantity(i,1))}),e.j41(18,"mat-icon"),e.EFF(19,"add"),e.k0s()()(),e.j41(20,"div",117)(21,"span",118),e.EFF(22),e.k0s(),e.DNE(23,PF,2,1,"span",119),e.k0s()()()}if(2&n){const t=e.XpG().$implicit,r=e.XpG();e.R7$(3),e.JRh(r.getProductName(t.product)),e.R7$(6),e.Y8G("ngIf",t.discount>0),e.R7$(2),e.SpI("\u20b9",t.unitPrice," x"),e.R7$(5),e.Y8G("value",t.quantity),e.R7$(6),e.SpI("\u20b9",t.total,""),e.R7$(1),e.Y8G("ngIf",t.discount>0)}}function kF(n,o){if(1&n&&(e.qex(0),e.DNE(1,bF,24,6,"div",105),e.bVm()),2&n){const t=o.$implicit;e.R7$(1),e.Y8G("ngIf",null==t?null:t.product)}}function OF(n,o){1&n&&(e.j41(0,"div",122)(1,"mat-icon"),e.EFF(2,"shopping_cart"),e.k0s(),e.j41(3,"p"),e.EFF(4,"Cart is empty"),e.k0s(),e.j41(5,"span"),e.EFF(6,"Add products to start billing"),e.k0s()())}function yF(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",123)(1,"input",124),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.customerName=i)}),e.k0s(),e.j41(2,"input",125),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.customerPhone=i)}),e.k0s(),e.j41(3,"input",126),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.orderNotes=i)}),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngModel",t.customerName),e.R7$(1),e.Y8G("ngModel",t.customerPhone),e.R7$(1),e.Y8G("ngModel",t.orderNotes)}}function MF(n,o){if(1&n&&(e.j41(0,"div",131)(1,"span"),e.EFF(2,"MRP Total"),e.k0s(),e.j41(3,"span",132),e.EFF(4),e.nI1(5,"number"),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(4),e.SpI("\u20b9",e.i5U(5,1,t.totalMrp,"1.0-0"),"")}}function wF(n,o){if(1&n&&(e.j41(0,"div",133)(1,"span"),e.EFF(2,"Discount"),e.k0s(),e.j41(3,"span",134),e.EFF(4),e.nI1(5,"number"),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(4),e.SpI("- \u20b9",e.i5U(5,1,t.totalDiscount,"1.0-0"),"")}}function FF(n,o){if(1&n&&(e.j41(0,"div",127),e.DNE(1,MF,6,4,"div",128),e.DNE(2,wF,6,4,"div",129),e.j41(3,"div",130)(4,"span"),e.EFF(5,"TOTAL"),e.k0s(),e.j41(6,"span"),e.EFF(7),e.nI1(8,"number"),e.k0s()()()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngIf",t.totalDiscount>0),e.R7$(1),e.Y8G("ngIf",t.totalDiscount>0),e.R7$(5),e.SpI("\u20b9",e.i5U(8,3,t.totalAmount,"1.0-0"),"")}}function EF(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",140),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.selectedPaymentMethod=a.value)}),e.EFF(1),e.k0s()}if(2&n){const t=o.$implicit,r=e.XpG(2);e.AVh("selected",r.selectedPaymentMethod===t.value),e.R7$(1),e.SpI(" ",t.label," ")}}function SF(n,o){if(1&n&&(e.j41(0,"div",141)(1,"div",142),e.nrm(2,"img",143),e.k0s(),e.j41(3,"div",144)(4,"span",145),e.EFF(5),e.k0s(),e.j41(6,"span",146),e.EFF(7),e.nI1(8,"number"),e.k0s()()()),2&n){const t=e.XpG(2);e.R7$(2),e.Y8G("src",t.getUpiQrCodeUrl(),e.B4B),e.R7$(3),e.JRh(t.shopUpiId),e.R7$(2),e.SpI("Pay \u20b9",e.i5U(8,3,t.totalAmount,"1.0-0"),"")}}function TF(n,o){if(1&n&&(e.j41(0,"div",135)(1,"div",136),e.EFF(2,"Payment Method"),e.k0s(),e.j41(3,"div",137),e.DNE(4,EF,2,3,"button",138),e.k0s(),e.DNE(5,SF,9,6,"div",139),e.k0s()),2&n){const t=e.XpG();e.R7$(4),e.Y8G("ngForOf",t.paymentMethods),e.R7$(1),e.Y8G("ngIf","UPI"===t.selectedPaymentMethod&&t.shopUpiId)}}function IF(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",147),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.startNewBill())}),e.j41(1,"mat-icon"),e.EFF(2,"add_shopping_cart"),e.k0s(),e.EFF(3," New Bill "),e.k0s()}}function RF(n,o){if(1&n&&(e.j41(0,"div",201),e.nrm(1,"img",202),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("appOfflineImg",t.editingProduct.imageBase64||t.editingProduct.image)("fallback","assets/images/product-placeholder.svg")("alt",t.editingProduct.name)}}function NF(n,o){if(1&n&&e.nrm(0,"img",203),2&n){const t=e.XpG(2);e.Y8G("src",t.editImagePreview,e.B4B)}}function AF(n,o){if(1&n&&e.nrm(0,"img",204),2&n){const t=e.XpG(2);e.Y8G("appOfflineImg",(null==t.editingProduct?null:t.editingProduct.imageBase64)||(null==t.editingProduct?null:t.editingProduct.image))("fallback","assets/images/product-placeholder.svg")}}function DF(n,o){1&n&&(e.j41(0,"div",205)(1,"mat-icon"),e.EFF(2,"image"),e.k0s(),e.j41(3,"span"),e.EFF(4,"No image"),e.k0s()())}function jF(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",206),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.removeEditImage())}),e.j41(1,"mat-icon"),e.EFF(2,"close"),e.k0s()()}}function BF(n,o){1&n&&e.nrm(0,"mat-spinner",207)}function LF(n,o){1&n&&(e.j41(0,"span"),e.EFF(1,"Save"),e.k0s())}function $F(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",148),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeQuickEdit())}),e.j41(1,"div",149),e.bIt("click",function(i){return i.stopPropagation()}),e.j41(2,"div",150)(3,"div",151),e.DNE(4,RF,2,3,"div",152),e.j41(5,"div",153)(6,"h3"),e.EFF(7),e.k0s(),e.j41(8,"span",154),e.EFF(9),e.k0s()()(),e.j41(10,"button",94),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeQuickEdit())}),e.j41(11,"mat-icon"),e.EFF(12,"close"),e.k0s()()(),e.j41(13,"div",155)(14,"div",156)(15,"div",157)(16,"label")(17,"mat-icon"),e.EFF(18,"translate"),e.k0s(),e.EFF(19," English Name "),e.k0s(),e.j41(20,"input",158),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.editName=i)}),e.k0s()(),e.j41(21,"div",157)(22,"label")(23,"mat-icon"),e.EFF(24,"language"),e.k0s(),e.EFF(25," Tamil Name (\u0ba4\u0bae\u0bbf\u0bb4\u0bcd) "),e.k0s(),e.j41(26,"input",159),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.editNameTamil=i)}),e.k0s()()(),e.j41(27,"div",160)(28,"div",161)(29,"label"),e.EFF(30,"Product Image"),e.k0s(),e.j41(31,"div",162),e.DNE(32,NF,1,1,"img",163),e.DNE(33,AF,1,2,"img",164),e.DNE(34,DF,5,0,"div",165),e.DNE(35,jF,3,0,"button",166),e.k0s()(),e.j41(36,"div",167)(37,"input",168,169),e.bIt("change",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.onEditImageSelect(i))}),e.k0s(),e.j41(39,"button",170),e.bIt("click",function(){e.eBV(t);const i=e.sdS(38);return e.Njj(i.click())}),e.j41(40,"mat-icon"),e.EFF(41,"add_photo_alternate"),e.k0s(),e.EFF(42),e.k0s(),e.j41(43,"span",171),e.EFF(44,"Max 5MB, JPG/PNG"),e.k0s()()(),e.j41(45,"div",172)(46,"div",173)(47,"div",174)(48,"mat-icon"),e.EFF(49,"sell"),e.k0s(),e.EFF(50," Pricing "),e.k0s(),e.j41(51,"div",175)(52,"div",176)(53,"label"),e.EFF(54,"Price"),e.k0s(),e.j41(55,"div",177)(56,"span",178),e.EFF(57,"\u20b9"),e.k0s(),e.j41(58,"input",179),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.editPrice=i)}),e.k0s()()(),e.j41(59,"div",176)(60,"label"),e.EFF(61,"MRP"),e.k0s(),e.j41(62,"div",177)(63,"span",178),e.EFF(64,"\u20b9"),e.k0s(),e.j41(65,"input",179),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.editMrp=i)}),e.k0s()()()()(),e.j41(66,"div",173)(67,"div",174)(68,"mat-icon"),e.EFF(69,"inventory_2"),e.k0s(),e.EFF(70," Stock & Label "),e.k0s(),e.j41(71,"div",175)(72,"div",176)(73,"label"),e.EFF(74,"Stock"),e.k0s(),e.j41(75,"input",180),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.editStock=i)}),e.k0s()(),e.j41(76,"div",176)(77,"label"),e.EFF(78,"Net Qty"),e.k0s(),e.j41(79,"input",181),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.labelNetQty=i)}),e.k0s()(),e.j41(80,"div",176)(81,"label"),e.EFF(82,"PKD"),e.k0s(),e.j41(83,"input",182),e.bIt("input",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.formatDateInput(i,"pkd"))}),e.k0s()(),e.j41(84,"div",176)(85,"label"),e.EFF(86,"EXP"),e.k0s(),e.j41(87,"input",182),e.bIt("input",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.formatDateInput(i,"exp"))}),e.k0s()()()()(),e.j41(88,"div",183)(89,"div",184)(90,"mat-icon"),e.EFF(91,"qr_code_scanner"),e.k0s(),e.j41(92,"span"),e.EFF(93,"SKU & Barcodes"),e.k0s()(),e.j41(94,"div",185)(95,"div",186)(96,"label"),e.EFF(97,"SKU ID"),e.k0s(),e.j41(98,"input",187),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.editSku=i)}),e.k0s()(),e.j41(99,"div",186)(100,"label"),e.EFF(101,"Barcode 1 (Primary)"),e.k0s(),e.j41(102,"input",188),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.editBarcode1=i)}),e.k0s()(),e.j41(103,"div",186)(104,"label"),e.EFF(105,"Barcode 2"),e.k0s(),e.j41(106,"input",189),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.editBarcode2=i)}),e.k0s()(),e.j41(107,"div",186)(108,"label"),e.EFF(109,"Barcode 3"),e.k0s(),e.j41(110,"input",190),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.editBarcode3=i)}),e.k0s()()()(),e.j41(111,"div",191)(112,"div",192)(113,"mat-icon"),e.EFF(114,"print"),e.k0s(),e.j41(115,"span"),e.EFF(116,"Print Labels"),e.k0s(),e.j41(117,"button",193),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.showLabelConfigDialog=!0)}),e.j41(118,"mat-icon"),e.EFF(119,"settings"),e.k0s()()(),e.j41(120,"div",194)(121,"input",195),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.labelQuantity=i)}),e.k0s(),e.j41(122,"button",196),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.printLabel())}),e.j41(123,"mat-icon"),e.EFF(124,"print"),e.k0s(),e.EFF(125," Print "),e.k0s()()()(),e.j41(126,"div",197)(127,"button",140),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeQuickEdit())}),e.EFF(128,"Cancel"),e.k0s(),e.j41(129,"button",198),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.saveQuickEdit())}),e.DNE(130,BF,1,0,"mat-spinner",199),e.DNE(131,LF,2,0,"span",200),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(4),e.Y8G("ngIf",t.editingProduct.imageBase64||t.editingProduct.image),e.R7$(3),e.JRh(t.editingProduct.name),e.R7$(2),e.JRh(t.editingProduct.sku||t.editingProduct.barcode1||"No SKU"),e.R7$(11),e.Y8G("ngModel",t.editName),e.R7$(6),e.Y8G("ngModel",t.editNameTamil),e.R7$(6),e.Y8G("ngIf",t.editImagePreview),e.R7$(1),e.Y8G("ngIf",!t.editImagePreview&&((null==t.editingProduct?null:t.editingProduct.imageBase64)||(null==t.editingProduct?null:t.editingProduct.image))),e.R7$(1),e.Y8G("ngIf",!(t.editImagePreview||null!=t.editingProduct&&t.editingProduct.imageBase64||null!=t.editingProduct&&t.editingProduct.image)),e.R7$(1),e.Y8G("ngIf",t.editImagePreview),e.R7$(7),e.SpI(" ",t.editImagePreview?"Change Image":"Upload Image"," "),e.R7$(16),e.Y8G("ngModel",t.editPrice),e.R7$(7),e.Y8G("ngModel",t.editMrp),e.R7$(10),e.Y8G("ngModel",t.editStock),e.R7$(4),e.Y8G("ngModel",t.labelNetQty),e.R7$(4),e.Y8G("ngModel",t.labelPackedDate),e.R7$(4),e.Y8G("ngModel",t.labelExpiryDate),e.R7$(11),e.Y8G("ngModel",t.editSku),e.R7$(4),e.Y8G("ngModel",t.editBarcode1),e.R7$(4),e.Y8G("ngModel",t.editBarcode2),e.R7$(4),e.Y8G("ngModel",t.editBarcode3),e.R7$(11),e.Y8G("ngModel",t.labelQuantity),e.R7$(8),e.Y8G("disabled",t.isSavingEdit),e.R7$(1),e.Y8G("ngIf",t.isSavingEdit),e.R7$(1),e.Y8G("ngIf",!t.isSavingEdit)}}function GF(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",148),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeQuickAdd())}),e.j41(1,"div",208),e.bIt("click",function(i){return i.stopPropagation()}),e.j41(2,"div",209)(3,"h3"),e.EFF(4,"Add Custom Product"),e.k0s(),e.j41(5,"button",94),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeQuickAdd())}),e.j41(6,"mat-icon"),e.EFF(7,"close"),e.k0s()()(),e.j41(8,"div",210)(9,"div",211)(10,"div",212)(11,"label"),e.EFF(12,"Product Name *"),e.k0s(),e.j41(13,"input",213),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.customProductName=i)}),e.k0s()(),e.j41(14,"div",212)(15,"label"),e.EFF(16,"Selling Price (\u20b9) *"),e.k0s(),e.j41(17,"input",214),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.customProductPrice=i)}),e.k0s()(),e.j41(18,"div",212)(19,"label"),e.EFF(20,"MRP (\u20b9)"),e.k0s(),e.j41(21,"input",215),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.customProductMrp=i)}),e.k0s()(),e.j41(22,"div",212)(23,"label"),e.EFF(24,"Quantity"),e.k0s(),e.j41(25,"input",216),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.customProductQty=i)}),e.k0s()()(),e.j41(26,"p",217)(27,"mat-icon"),e.EFF(28,"info"),e.k0s(),e.EFF(29," Custom products are for one-time billing only and won't be saved to inventory. "),e.k0s()(),e.j41(30,"div",218)(31,"button",140),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeQuickAdd())}),e.EFF(32,"Cancel"),e.k0s(),e.j41(33,"button",198),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.addCustomProduct())}),e.j41(34,"mat-icon"),e.EFF(35,"add_shopping_cart"),e.k0s(),e.EFF(36," Add to Cart "),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(13),e.Y8G("ngModel",t.customProductName),e.R7$(4),e.Y8G("ngModel",t.customProductPrice),e.R7$(4),e.Y8G("ngModel",t.customProductMrp),e.R7$(4),e.Y8G("ngModel",t.customProductQty),e.R7$(8),e.Y8G("disabled",!t.customProductName||!t.customProductPrice||t.customProductPrice<=0)}}function UF(n,o){1&n&&(e.j41(0,"span",234),e.EFF(1,"(Offline)"),e.k0s())}function zF(n,o){1&n&&(e.j41(0,"span"),e.EFF(1,"Product will be created in your shop inventory."),e.k0s())}function VF(n,o){1&n&&(e.j41(0,"span"),e.EFF(1,"Product will be saved locally and synced when online."),e.k0s())}function YF(n,o){1&n&&e.nrm(0,"mat-spinner",235)}function XF(n,o){1&n&&(e.j41(0,"mat-icon"),e.EFF(1,"save"),e.k0s())}function HF(n,o){1&n&&(e.j41(0,"span"),e.EFF(1,"Save Product"),e.k0s())}function WF(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",148),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeAddProductDialog())}),e.j41(1,"div",219),e.bIt("click",function(i){return i.stopPropagation()}),e.j41(2,"div",209)(3,"h3")(4,"mat-icon"),e.EFF(5,"add_box"),e.k0s(),e.EFF(6," Add New Product "),e.DNE(7,UF,2,0,"span",220),e.k0s(),e.j41(8,"button",94),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeAddProductDialog())}),e.j41(9,"mat-icon"),e.EFF(10,"close"),e.k0s()()(),e.j41(11,"div",210)(12,"div",211)(13,"div",221)(14,"div",212)(15,"label"),e.EFF(16,"Product Name (English) *"),e.k0s(),e.j41(17,"input",222),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.newProductName=i)}),e.k0s()(),e.j41(18,"div",212)(19,"label"),e.EFF(20,"Tamil Name (\u0ba4\u0bae\u0bbf\u0bb4\u0bcd \u0baa\u0bc6\u0baf\u0bb0\u0bcd)"),e.k0s(),e.j41(21,"input",223),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.newProductNameTamil=i)}),e.k0s()()(),e.j41(22,"div",224)(23,"div",212)(24,"label"),e.EFF(25,"Selling Price (\u20b9) *"),e.k0s(),e.j41(26,"input",225),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.newProductPrice=i)}),e.k0s()(),e.j41(27,"div",212)(28,"label"),e.EFF(29,"MRP (\u20b9)"),e.k0s(),e.j41(30,"input",215),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.newProductMrp=i)}),e.k0s()(),e.j41(31,"div",212)(32,"label"),e.EFF(33,"Stock Quantity"),e.k0s(),e.j41(34,"input",226),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.newProductStock=i)}),e.k0s()()(),e.j41(35,"div",224)(36,"div",212)(37,"label"),e.EFF(38,"Barcode 1"),e.k0s(),e.j41(39,"input",227),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.newProductBarcode1=i)}),e.k0s()(),e.j41(40,"div",212)(41,"label"),e.EFF(42,"Barcode 2"),e.k0s(),e.j41(43,"input",228),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.newProductBarcode2=i)}),e.k0s()(),e.j41(44,"div",212)(45,"label"),e.EFF(46,"Barcode 3"),e.k0s(),e.j41(47,"input",229),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.newProductBarcode3=i)}),e.k0s()()(),e.j41(48,"div",230)(49,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.newProductTrackInventory=i)}),e.EFF(50," Track Inventory "),e.k0s()()(),e.j41(51,"p",232)(52,"mat-icon"),e.EFF(53,"info"),e.k0s(),e.DNE(54,zF,2,0,"span",200),e.DNE(55,VF,2,0,"span",200),e.k0s()(),e.j41(56,"div",218)(57,"button",140),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeAddProductDialog())}),e.EFF(58,"Cancel"),e.k0s(),e.j41(59,"button",198),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.saveNewProduct())}),e.DNE(60,YF,1,0,"mat-spinner",233),e.DNE(61,XF,2,0,"mat-icon",200),e.DNE(62,HF,2,0,"span",200),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(7),e.Y8G("ngIf",!t.syncStatus.isOnline),e.R7$(10),e.Y8G("ngModel",t.newProductName),e.R7$(4),e.Y8G("ngModel",t.newProductNameTamil),e.R7$(5),e.Y8G("ngModel",t.newProductPrice),e.R7$(4),e.Y8G("ngModel",t.newProductMrp),e.R7$(4),e.Y8G("ngModel",t.newProductStock),e.R7$(5),e.Y8G("ngModel",t.newProductBarcode1),e.R7$(4),e.Y8G("ngModel",t.newProductBarcode2),e.R7$(4),e.Y8G("ngModel",t.newProductBarcode3),e.R7$(2),e.Y8G("ngModel",t.newProductTrackInventory),e.R7$(5),e.Y8G("ngIf",t.syncStatus.isOnline),e.R7$(1),e.Y8G("ngIf",!t.syncStatus.isOnline),e.R7$(4),e.Y8G("disabled",!t.newProductName||!t.newProductPrice||t.newProductPrice<=0||t.isSavingNewProduct),e.R7$(1),e.Y8G("ngIf",t.isSavingNewProduct),e.R7$(1),e.Y8G("ngIf",!t.isSavingNewProduct),e.R7$(1),e.Y8G("ngIf",!t.isSavingNewProduct)}}function qF(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",236),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.showLabelConfigDialog=!1)}),e.j41(1,"div",237),e.bIt("click",function(i){return i.stopPropagation()}),e.j41(2,"div",238)(3,"h3")(4,"mat-icon"),e.EFF(5,"tune"),e.k0s(),e.EFF(6," Label Settings "),e.k0s(),e.j41(7,"button",94),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.showLabelConfigDialog=!1)}),e.j41(8,"mat-icon"),e.EFF(9,"close"),e.k0s()()(),e.j41(10,"div",239)(11,"div",240)(12,"div",241),e.EFF(13,"Label Data"),e.k0s(),e.j41(14,"div",242)(15,"label"),e.EFF(16,"Net Qty"),e.k0s(),e.j41(17,"input",243),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.labelNetQty=i)}),e.k0s()(),e.j41(18,"div",244)(19,"div",242)(20,"label"),e.EFF(21,"PKD (Packed)"),e.k0s(),e.j41(22,"input",245),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.labelPackedDate=i)}),e.k0s()(),e.j41(23,"div",242)(24,"label"),e.EFF(25,"EXP (Expiry)"),e.k0s(),e.j41(26,"input",245),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.labelExpiryDate=i)}),e.k0s()()()(),e.j41(27,"div",240)(28,"div",241),e.EFF(29,"Show/Hide Elements"),e.k0s(),e.j41(30,"div",246)(31,"span"),e.EFF(32,"Shop Name"),e.k0s(),e.j41(33,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.labelConfig.showShopName=i)}),e.k0s()(),e.j41(34,"div",246)(35,"span"),e.EFF(36,"Tamil Name"),e.k0s(),e.j41(37,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.labelConfig.showTamilName=i)}),e.k0s()(),e.j41(38,"div",246)(39,"span"),e.EFF(40,"English Name"),e.k0s(),e.j41(41,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.labelConfig.showEnglishName=i)}),e.k0s()(),e.j41(42,"div",246)(43,"span"),e.EFF(44,"Net Quantity"),e.k0s(),e.j41(45,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.labelConfig.showNetQty=i)}),e.k0s()(),e.j41(46,"div",246)(47,"span"),e.EFF(48,"MRP"),e.k0s(),e.j41(49,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.labelConfig.showMrp=i)}),e.k0s()(),e.j41(50,"div",246)(51,"span"),e.EFF(52,"Packed Date (PKD)"),e.k0s(),e.j41(53,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.labelConfig.showPackedDate=i)}),e.k0s()(),e.j41(54,"div",246)(55,"span"),e.EFF(56,"Expiry Date (EXP)"),e.k0s(),e.j41(57,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.labelConfig.showExpiryDate=i)}),e.k0s()(),e.j41(58,"div",246)(59,"span"),e.EFF(60,"Barcode"),e.k0s(),e.j41(61,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.labelConfig.showBarcode=i)}),e.k0s()(),e.j41(62,"div",246)(63,"span"),e.EFF(64,"Barcode Number"),e.k0s(),e.j41(65,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.labelConfig.showBarcodeNumber=i)}),e.k0s()()()(),e.j41(66,"div",247)(67,"button",140),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.showLabelConfigDialog=!1)}),e.EFF(68,"Cancel"),e.k0s(),e.j41(69,"button",248),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.saveLabelConfig())}),e.j41(70,"mat-icon"),e.EFF(71,"save"),e.k0s(),e.EFF(72," Save Settings "),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(17),e.Y8G("ngModel",t.labelNetQty),e.R7$(5),e.Y8G("ngModel",t.labelPackedDate),e.R7$(4),e.Y8G("ngModel",t.labelExpiryDate),e.R7$(7),e.Y8G("ngModel",t.labelConfig.showShopName),e.R7$(4),e.Y8G("ngModel",t.labelConfig.showTamilName),e.R7$(4),e.Y8G("ngModel",t.labelConfig.showEnglishName),e.R7$(4),e.Y8G("ngModel",t.labelConfig.showNetQty),e.R7$(4),e.Y8G("ngModel",t.labelConfig.showMrp),e.R7$(4),e.Y8G("ngModel",t.labelConfig.showPackedDate),e.R7$(4),e.Y8G("ngModel",t.labelConfig.showExpiryDate),e.R7$(4),e.Y8G("ngModel",t.labelConfig.showBarcode),e.R7$(4),e.Y8G("ngModel",t.labelConfig.showBarcodeNumber)}}function ZF(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",293)(1,"mat-slide-toggle",294),e.bIt("ngModelChange",function(i){const s=e.eBV(t).$implicit;return e.Njj(s.enabled=i)}),e.k0s(),e.j41(2,"input",295),e.bIt("ngModelChange",function(i){const s=e.eBV(t).$implicit;return e.Njj(s.label=i)}),e.k0s(),e.j41(3,"input",296),e.bIt("ngModelChange",function(i){const s=e.eBV(t).$implicit;return e.Njj(s.value=i)}),e.k0s(),e.j41(4,"select",297),e.bIt("ngModelChange",function(i){const s=e.eBV(t).$implicit;return e.Njj(s.position=i)}),e.j41(5,"option",298),e.EFF(6,"Header"),e.k0s(),e.j41(7,"option",299),e.EFF(8,"Footer"),e.k0s()()()}if(2&n){const t=o.$implicit;e.R7$(1),e.Y8G("ngModel",t.enabled),e.R7$(1),e.Y8G("ngModel",t.label),e.R7$(1),e.Y8G("ngModel",t.value),e.R7$(1),e.Y8G("ngModel",t.position)}}function QF(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",300)(1,"mat-icon",301),e.EFF(2,"drag_indicator"),e.k0s(),e.j41(3,"span",302),e.EFF(4),e.k0s(),e.j41(5,"div",303)(6,"button",304),e.bIt("click",function(){const a=e.eBV(t).index,s=e.XpG(2);return e.Njj(s.moveSectionUp(a))}),e.j41(7,"mat-icon"),e.EFF(8,"arrow_upward"),e.k0s()(),e.j41(9,"button",304),e.bIt("click",function(){const a=e.eBV(t).index,s=e.XpG(2);return e.Njj(s.moveSectionDown(a))}),e.j41(10,"mat-icon"),e.EFF(11,"arrow_downward"),e.k0s()()()()}if(2&n){const t=o.$implicit,r=o.index,i=e.XpG(2);e.R7$(4),e.JRh(i.getSectionLabel(t)),e.R7$(2),e.Y8G("disabled",0===r),e.R7$(3),e.Y8G("disabled",r===i.billSettings.sectionOrder.length-1)}}function JF(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",249),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeBillSettingsDialog())}),e.j41(1,"div",250),e.bIt("click",function(i){return i.stopPropagation()}),e.j41(2,"div",251)(3,"h3")(4,"mat-icon"),e.EFF(5,"receipt_long"),e.k0s(),e.EFF(6," Bill Settings "),e.k0s(),e.j41(7,"button",94),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeBillSettingsDialog())}),e.j41(8,"mat-icon"),e.EFF(9,"close"),e.k0s()()(),e.j41(10,"div",252)(11,"div",253)(12,"div",241)(13,"mat-icon"),e.EFF(14,"store"),e.k0s(),e.EFF(15," Shop Header "),e.k0s(),e.j41(16,"div",254)(17,"label"),e.EFF(18,"Shop Name"),e.k0s(),e.j41(19,"input",255),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.shopName=i)}),e.k0s()(),e.j41(20,"div",254)(21,"label"),e.EFF(22,"Shop Address"),e.k0s(),e.j41(23,"input",256),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.shopAddress=i)}),e.k0s()(),e.j41(24,"div",254)(25,"label"),e.EFF(26,"Phone Number"),e.k0s(),e.j41(27,"input",257),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.shopPhone=i)}),e.k0s()(),e.j41(28,"div",254)(29,"label"),e.EFF(30,"GST Number"),e.k0s(),e.j41(31,"input",258),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.gstNumber=i)}),e.k0s()(),e.j41(32,"div",254)(33,"label"),e.EFF(34,"FSSAI License Number"),e.k0s(),e.j41(35,"input",259),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.fssaiNumber=i)}),e.k0s()(),e.j41(36,"div",254)(37,"label"),e.EFF(38,"FSSAI License Holder Name"),e.k0s(),e.j41(39,"input",260),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.fssaiName=i)}),e.k0s()()(),e.j41(40,"div",253)(41,"div",241)(42,"mat-icon"),e.EFF(43,"format_list_numbered"),e.k0s(),e.EFF(44," Bill Format "),e.k0s(),e.j41(45,"div",261)(46,"div",262)(47,"label"),e.EFF(48,"Date Format"),e.k0s(),e.j41(49,"select",263),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.dateFormat=i)}),e.j41(50,"option",264),e.EFF(51,"DD/MM/YYYY"),e.k0s(),e.j41(52,"option",265),e.EFF(53,"MM/DD/YYYY"),e.k0s(),e.j41(54,"option",266),e.EFF(55,"YYYY-MM-DD"),e.k0s()()(),e.j41(56,"div",262)(57,"label"),e.EFF(58,"Bill Number Prefix"),e.k0s(),e.j41(59,"input",267),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.billNumberPrefix=i)}),e.k0s()()(),e.j41(60,"div",261)(61,"div",262)(62,"label"),e.EFF(63,"Paper Width"),e.k0s(),e.j41(64,"select",263),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.paperWidth=i)}),e.j41(65,"option",268),e.EFF(66,"58mm (Thermal)"),e.k0s(),e.j41(67,"option",269),e.EFF(68,"80mm (Thermal)"),e.k0s(),e.j41(69,"option",270),e.EFF(70,"A4 (Full Page)"),e.k0s()()(),e.j41(71,"div",262)(72,"label"),e.EFF(73,"Separator Style"),e.k0s(),e.j41(74,"select",263),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.separatorStyle=i)}),e.j41(75,"option",271),e.EFF(76,"Solid Line \u2500\u2500\u2500"),e.k0s(),e.j41(77,"option",272),e.EFF(78,"Dashed Line - - -"),e.k0s(),e.j41(79,"option",273),e.EFF(80,"Dotted Line \xb7\xb7\xb7"),e.k0s(),e.j41(81,"option",274),e.EFF(82,"No Separator"),e.k0s()()()()(),e.j41(83,"div",253)(84,"div",241)(85,"mat-icon"),e.EFF(86,"format_size"),e.k0s(),e.EFF(87," Font Sizes "),e.k0s(),e.j41(88,"div",275)(89,"div",276)(90,"label"),e.EFF(91,"Header"),e.k0s(),e.j41(92,"div",277)(93,"input",278),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.headerFontSize=i)}),e.k0s(),e.j41(94,"span",279),e.EFF(95),e.k0s()()(),e.j41(96,"div",276)(97,"label"),e.EFF(98,"Body"),e.k0s(),e.j41(99,"div",277)(100,"input",280),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.bodyFontSize=i)}),e.k0s(),e.j41(101,"span",279),e.EFF(102),e.k0s()()(),e.j41(103,"div",276)(104,"label"),e.EFF(105,"Footer"),e.k0s(),e.j41(106,"div",277)(107,"input",281),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.footerFontSize=i)}),e.k0s(),e.j41(108,"span",279),e.EFF(109),e.k0s()()()()(),e.j41(110,"div",253)(111,"div",241)(112,"mat-icon"),e.EFF(113,"visibility"),e.k0s(),e.EFF(114," Header Elements "),e.k0s(),e.j41(115,"div",282)(116,"div",283)(117,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showShopName=i)}),e.k0s(),e.j41(118,"span"),e.EFF(119,"Shop Name"),e.k0s()(),e.j41(120,"div",283)(121,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showShopAddress=i)}),e.k0s(),e.j41(122,"span"),e.EFF(123,"Shop Address"),e.k0s()(),e.j41(124,"div",283)(125,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showShopPhone=i)}),e.k0s(),e.j41(126,"span"),e.EFF(127,"Phone Number"),e.k0s()(),e.j41(128,"div",283)(129,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showGstNumber=i)}),e.k0s(),e.j41(130,"span"),e.EFF(131,"GST Number"),e.k0s()(),e.j41(132,"div",283)(133,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showFssaiInfo=i)}),e.k0s(),e.j41(134,"span"),e.EFF(135,"FSSAI Info"),e.k0s()(),e.j41(136,"div",283)(137,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showDateTime=i)}),e.k0s(),e.j41(138,"span"),e.EFF(139,"Date/Time"),e.k0s()(),e.j41(140,"div",283)(141,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showBillNumber=i)}),e.k0s(),e.j41(142,"span"),e.EFF(143,"Bill Number"),e.k0s()(),e.j41(144,"div",283)(145,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showCustomerDetails=i)}),e.k0s(),e.j41(146,"span"),e.EFF(147,"Customer Details"),e.k0s()()()(),e.j41(148,"div",253)(149,"div",241)(150,"mat-icon"),e.EFF(151,"inventory_2"),e.k0s(),e.EFF(152," Item Details "),e.k0s(),e.j41(153,"div",282)(154,"div",283)(155,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showItemSku=i)}),e.k0s(),e.j41(156,"span"),e.EFF(157,"SKU/Code"),e.k0s()(),e.j41(158,"div",283)(159,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showItemBarcode=i)}),e.k0s(),e.j41(160,"span"),e.EFF(161,"Barcode"),e.k0s()(),e.j41(162,"div",283)(163,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showItemMrp=i)}),e.k0s(),e.j41(164,"span"),e.EFF(165,"MRP Price"),e.k0s()(),e.j41(166,"div",283)(167,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showItemDiscount=i)}),e.k0s(),e.j41(168,"span"),e.EFF(169,"Item Discount"),e.k0s()(),e.j41(170,"div",283)(171,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showItemTax=i)}),e.k0s(),e.j41(172,"span"),e.EFF(173,"Item Tax"),e.k0s()()()(),e.j41(174,"div",253)(175,"div",241)(176,"mat-icon"),e.EFF(177,"summarize"),e.k0s(),e.EFF(178," Summary & Footer "),e.k0s(),e.j41(179,"div",282)(180,"div",283)(181,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showSubtotal=i)}),e.k0s(),e.j41(182,"span"),e.EFF(183,"Subtotal"),e.k0s()(),e.j41(184,"div",283)(185,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showTotalSavings=i)}),e.k0s(),e.j41(186,"span"),e.EFF(187,"Total Savings"),e.k0s()(),e.j41(188,"div",283)(189,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showTaxBreakdown=i)}),e.k0s(),e.j41(190,"span"),e.EFF(191,"Tax Breakdown"),e.k0s()(),e.j41(192,"div",283)(193,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showPaymentMethod=i)}),e.k0s(),e.j41(194,"span"),e.EFF(195,"Payment Method"),e.k0s()(),e.j41(196,"div",283)(197,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showThankYouMessage=i)}),e.k0s(),e.j41(198,"span"),e.EFF(199,"Thank You Message"),e.k0s()()()(),e.j41(200,"div",253)(201,"div",241)(202,"mat-icon"),e.EFF(203,"language"),e.k0s(),e.EFF(204," Receipt Language "),e.k0s(),e.j41(205,"div",282)(206,"div",283)(207,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showEnglish=i)}),e.k0s(),e.j41(208,"span"),e.EFF(209,"English"),e.k0s()(),e.j41(210,"div",283)(211,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showTamil=i)}),e.k0s(),e.j41(212,"span"),e.EFF(213,"Tamil (\u0ba4\u0bae\u0bbf\u0bb4\u0bcd)"),e.k0s()()()(),e.j41(214,"div",253)(215,"div",241)(216,"mat-icon"),e.EFF(217,"qr_code_2"),e.k0s(),e.EFF(218," UPI Payment "),e.k0s(),e.j41(219,"div",254)(220,"label"),e.EFF(221,"UPI ID"),e.k0s(),e.j41(222,"input",284),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.upiId=i)}),e.k0s()(),e.j41(223,"div",282)(224,"div",283)(225,"mat-slide-toggle",231),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.showUpiQrCode=i)}),e.k0s(),e.j41(226,"span"),e.EFF(227,"Show UPI QR Code on Receipt"),e.k0s()()()(),e.j41(228,"div",253)(229,"div",241)(230,"mat-icon"),e.EFF(231,"add_circle"),e.k0s(),e.EFF(232," Custom Fields "),e.k0s(),e.j41(233,"p",285),e.EFF(234,"Add your own custom labels to the receipt (e.g., License No, Reg. No, etc.)"),e.k0s(),e.j41(235,"div",286),e.DNE(236,ZF,9,4,"div",287),e.k0s()(),e.j41(237,"div",253)(238,"div",241)(239,"mat-icon"),e.EFF(240,"reorder"),e.k0s(),e.EFF(241," Receipt Section Order "),e.k0s(),e.j41(242,"p",285),e.EFF(243,"Drag to reorder sections on the receipt"),e.k0s(),e.j41(244,"div",288),e.DNE(245,QF,12,3,"div",289),e.k0s()(),e.j41(246,"div",253)(247,"div",241)(248,"mat-icon"),e.EFF(249,"message"),e.k0s(),e.EFF(250," Footer Message "),e.k0s(),e.j41(251,"div",254)(252,"label"),e.EFF(253,"Thank You Message"),e.k0s(),e.j41(254,"input",290),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.thankYouMessage=i)}),e.k0s()(),e.j41(255,"div",254)(256,"label"),e.EFF(257,"Additional Footer Note"),e.k0s(),e.j41(258,"input",291),e.bIt("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.billSettings.footerNote=i)}),e.k0s()()()(),e.j41(259,"div",292)(260,"button",140),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.closeBillSettingsDialog())}),e.EFF(261,"Cancel"),e.k0s(),e.j41(262,"button",248),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.saveBillSettings())}),e.j41(263,"mat-icon"),e.EFF(264,"save"),e.k0s(),e.EFF(265," Save Settings "),e.k0s()()()()}if(2&n){const t=e.XpG();e.R7$(19),e.Y8G("ngModel",t.billSettings.shopName),e.R7$(4),e.Y8G("ngModel",t.billSettings.shopAddress),e.R7$(4),e.Y8G("ngModel",t.billSettings.shopPhone),e.R7$(4),e.Y8G("ngModel",t.billSettings.gstNumber),e.R7$(4),e.Y8G("ngModel",t.billSettings.fssaiNumber),e.R7$(4),e.Y8G("ngModel",t.billSettings.fssaiName),e.R7$(10),e.Y8G("ngModel",t.billSettings.dateFormat),e.R7$(10),e.Y8G("ngModel",t.billSettings.billNumberPrefix),e.R7$(5),e.Y8G("ngModel",t.billSettings.paperWidth),e.R7$(10),e.Y8G("ngModel",t.billSettings.separatorStyle),e.R7$(19),e.Y8G("ngModel",t.billSettings.headerFontSize),e.R7$(2),e.SpI("",t.billSettings.headerFontSize,"px"),e.R7$(5),e.Y8G("ngModel",t.billSettings.bodyFontSize),e.R7$(2),e.SpI("",t.billSettings.bodyFontSize,"px"),e.R7$(5),e.Y8G("ngModel",t.billSettings.footerFontSize),e.R7$(2),e.SpI("",t.billSettings.footerFontSize,"px"),e.R7$(8),e.Y8G("ngModel",t.billSettings.showShopName),e.R7$(4),e.Y8G("ngModel",t.billSettings.showShopAddress),e.R7$(4),e.Y8G("ngModel",t.billSettings.showShopPhone),e.R7$(4),e.Y8G("ngModel",t.billSettings.showGstNumber),e.R7$(4),e.Y8G("ngModel",t.billSettings.showFssaiInfo),e.R7$(4),e.Y8G("ngModel",t.billSettings.showDateTime),e.R7$(4),e.Y8G("ngModel",t.billSettings.showBillNumber),e.R7$(4),e.Y8G("ngModel",t.billSettings.showCustomerDetails),e.R7$(10),e.Y8G("ngModel",t.billSettings.showItemSku),e.R7$(4),e.Y8G("ngModel",t.billSettings.showItemBarcode),e.R7$(4),e.Y8G("ngModel",t.billSettings.showItemMrp),e.R7$(4),e.Y8G("ngModel",t.billSettings.showItemDiscount),e.R7$(4),e.Y8G("ngModel",t.billSettings.showItemTax),e.R7$(10),e.Y8G("ngModel",t.billSettings.showSubtotal),e.R7$(4),e.Y8G("ngModel",t.billSettings.showTotalSavings),e.R7$(4),e.Y8G("ngModel",t.billSettings.showTaxBreakdown),e.R7$(4),e.Y8G("ngModel",t.billSettings.showPaymentMethod),e.R7$(4),e.Y8G("ngModel",t.billSettings.showThankYouMessage),e.R7$(10),e.Y8G("ngModel",t.billSettings.showEnglish),e.R7$(4),e.Y8G("ngModel",t.billSettings.showTamil),e.R7$(11),e.Y8G("ngModel",t.billSettings.upiId),e.R7$(3),e.Y8G("ngModel",t.billSettings.showUpiQrCode),e.R7$(11),e.Y8G("ngForOf",t.billSettings.customFields),e.R7$(9),e.Y8G("ngForOf",t.billSettings.sectionOrder),e.R7$(9),e.Y8G("ngModel",t.billSettings.thankYouMessage),e.R7$(4),e.Y8G("ngModel",t.billSettings.footerNote)}}let KF=(()=>{class n{constructor(t,r,i,a,s,l){this.http=t,this.offlineStorage=r,this.syncService=i,this.authService=a,this.swal=s,this.shopContext=l,this.destroy$=new _n.B,this.searchSubject=new _n.B,this.shopId=0,this.shopName="",this.shopUpiId="",this.products=[],this.filteredProducts=[],this.searchTerm="",this.barcodeBuffer="",this.posMode="browse",this.activeTab="quick",this.tempPrices=new Map,this.tempQtys=new Map,this.lastScannedBarcode="",this.lastScanTime=0,this.barcodeKeyHandler=null,this.lastBeepTime=0,this.cart=[],this.subtotal=0,this.taxAmount=0,this.totalAmount=0,this.taxRate=0,this.totalMrp=0,this.totalDiscount=0,this.selectedPaymentMethod="CASH_ON_DELIVERY",this.paymentMethods=[{value:"CASH_ON_DELIVERY",label:"Cash",icon:"payments"},{value:"UPI",label:"UPI",icon:"qr_code_2"},{value:"CARD",label:"Card",icon:"credit_card"}],this.customerName="",this.customerPhone="",this.orderNotes="",this.syncStatus={isOnline:!0,pendingOrders:0,pendingEdits:0,pendingProductCreations:0,lastProductSync:null,isSyncing:!1},this.CACHE_VALIDITY_MS=3e5,this.POS_CACHE_TIMESTAMP_KEY="pos_products_last_sync",this.isLoading=!0,this.showCustomerForm=!1,this.showTamil=!1,this.showEnglishOnReceipt=!0,this.showTamilOnReceipt=!0,this.showBillSettingsDialog=!1,this.billSettings={shopName:"",shopPhone:"",shopAddress:"",gstNumber:"",fssaiNumber:"",fssaiName:"",dateFormat:"DD/MM/YYYY",billNumberPrefix:"",showBillNumber:!0,paperWidth:"80mm",headerFontSize:16,bodyFontSize:12,footerFontSize:10,showShopName:!0,showShopPhone:!0,showShopAddress:!1,showGstNumber:!1,showFssaiInfo:!1,showDateTime:!0,showCustomerDetails:!0,showThankYouMessage:!0,showItemSku:!1,showItemBarcode:!1,showItemMrp:!0,showItemDiscount:!0,showItemTax:!1,showSubtotal:!0,showTotalSavings:!0,showTaxBreakdown:!1,showPaymentMethod:!0,showEnglish:!0,showTamil:!0,thankYouMessage:"Thank you for your order!",footerNote:"",separatorStyle:"dashed",upiId:"",showUpiQrCode:!1,customFields:[{label:"",value:"",enabled:!1,position:"header"},{label:"",value:"",enabled:!1,position:"header"},{label:"",value:"",enabled:!1,position:"footer"},{label:"",value:"",enabled:!1,position:"footer"}],sectionOrder:["header","billInfo","items","summary","payment","qrCode","footer"]},this.editingProduct=null,this.editPrice=0,this.editMrp=0,this.editStock=0,this.editBarcode="",this.editSku="",this.editBarcode1="",this.editBarcode2="",this.editBarcode3="",this.editName="",this.editNameTamil="",this.editImageFile=null,this.editImagePreview="",this.isSavingEdit=!1,this.labelQuantity=1,this.showLabelConfigDialog=!1,this.labelConfig={showShopName:!0,showTamilName:!0,showEnglishName:!0,showNetQty:!0,showMrp:!0,showPackedDate:!0,showExpiryDate:!0,showBarcode:!0,showBarcodeNumber:!0},this.labelPackedDate="",this.labelExpiryDate="",this.labelNetQty="",this.showQuickAddDialog=!1,this.customProductName="",this.customProductPrice=0,this.customProductMrp=0,this.customProductQty=1,this.customProductIdCounter=-1,this.showAddProductDialog=!1,this.newProductName="",this.newProductNameTamil="",this.newProductPrice=0,this.newProductMrp=0,this.newProductCostPrice=0,this.newProductStock=0,this.newProductBarcode1="",this.newProductBarcode2="",this.newProductBarcode3="",this.newProductTrackInventory=!0,this.isSavingNewProduct=!1,this.apiUrl=Oe.c.apiUrl}ngOnInit(){this.loadShopInfo(),this.loadLanguagePreference(),this.loadLabelConfig(),this.loadReceiptLanguageSettings(),this.loadBillSettings(),this.initSyncStatus(),this.initSearch(),this.initBarcodeScanner(),this.loadProducts(),this.checkForProductChanges()}checkForProductChanges(){"true"===localStorage.getItem("pos_products_changed")&&(console.log("POS: Products were changed, reloading from IndexedDB..."),localStorage.removeItem("pos_products_changed"),this.loadProducts())}ngAfterViewInit(){setTimeout(()=>{this.searchInput?.nativeElement&&this.searchInput.nativeElement.focus()},300)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.barcodeKeyHandler&&(document.removeEventListener("keypress",this.barcodeKeyHandler),this.barcodeKeyHandler=null)}loadShopInfo(){this.shopContext.shop$.pipe((0,ot.Q)(this.destroy$)).subscribe(r=>{r&&(this.shopId=r.id,this.shopName=r.name||r.businessName||"My Shop",this.shopUpiId=r.upiId||"",localStorage.setItem("shop_name",this.shopName),this.shopUpiId&&localStorage.setItem("shop_upi_id",this.shopUpiId),console.log("POS Billing - Shop loaded:",this.shopId,this.shopName))});const t=this.shopContext.getCurrentShop();if(t)this.shopId=t.id,this.shopName=t.name||t.businessName||"My Shop",this.shopUpiId=t.upiId||"",localStorage.setItem("shop_name",this.shopName),this.shopUpiId&&localStorage.setItem("shop_upi_id",this.shopUpiId);else{const r=localStorage.getItem("current_shop_id");r&&(this.shopId=parseInt(r,10));const i=localStorage.getItem("shop_name");i&&(this.shopName=i);const a=localStorage.getItem("shop_upi_id");a&&(this.shopUpiId=a)}console.log("POS Billing - shopId:",this.shopId,"shopName:",this.shopName)}loadLanguagePreference(){const t=localStorage.getItem("pos_language");this.showTamil="tamil"===t}loadLabelConfig(){const t=localStorage.getItem("pos_label_config");if(t)try{this.labelConfig={...this.labelConfig,...JSON.parse(t)}}catch(r){console.warn("Failed to parse saved label config:",r)}}saveLabelConfig(){localStorage.setItem("pos_label_config",JSON.stringify(this.labelConfig))}loadReceiptLanguageSettings(){const t=localStorage.getItem("pos_receipt_language");if(t)try{const r=JSON.parse(t);this.showEnglishOnReceipt=!1!==r.english,this.showTamilOnReceipt=!1!==r.tamil}catch(r){console.warn("Failed to parse saved receipt language settings:",r)}}toggleEnglishOnReceipt(){this.showEnglishOnReceipt&&!this.showTamilOnReceipt||(this.showEnglishOnReceipt=!this.showEnglishOnReceipt,this.saveReceiptLanguageSettings())}toggleTamilOnReceipt(){this.showTamilOnReceipt&&!this.showEnglishOnReceipt||(this.showTamilOnReceipt=!this.showTamilOnReceipt,this.saveReceiptLanguageSettings())}saveReceiptLanguageSettings(){localStorage.setItem("pos_receipt_language",JSON.stringify({english:this.showEnglishOnReceipt,tamil:this.showTamilOnReceipt})),this.showLabelConfigDialog=!1,this.swal.success("Saved","Label settings saved")}loadBillSettings(){const t=localStorage.getItem("pos_bill_settings");if(t)try{const r=JSON.parse(t);this.billSettings={...this.billSettings,...r},this.showEnglishOnReceipt=this.billSettings.showEnglish,this.showTamilOnReceipt=this.billSettings.showTamil}catch(r){console.warn("Failed to parse saved bill settings:",r)}}openBillSettingsDialog(){this.billSettings.shopName||(this.billSettings.shopName=this.shopName||"");const t=this.shopContext.getCurrentShop();t&&(this.billSettings.shopName||(this.billSettings.shopName=t.name||t.businessName||""),!this.billSettings.shopPhone&&t.phone&&(this.billSettings.shopPhone=t.phone||"")),this.showBillSettingsDialog=!0}closeBillSettingsDialog(){this.showBillSettingsDialog=!1,this.loadBillSettings()}saveBillSettings(){this.showEnglishOnReceipt=this.billSettings.showEnglish,this.showTamilOnReceipt=this.billSettings.showTamil,localStorage.setItem("pos_bill_settings",JSON.stringify(this.billSettings)),this.showBillSettingsDialog=!1,this.swal.success("Saved","Bill settings saved")}toggleLanguage(){this.showTamil=!this.showTamil,localStorage.setItem("pos_language",this.showTamil?"tamil":"english")}getProductName(t){return t?this.showTamil&&t.nameTamil?t.nameTamil:t.name||t.customName||"Loading...":"Unknown Product"}getDisplayBarcode(t){return t.barcode1?t.barcode1:t.barcode?t.barcode:t.sku&&!t.sku.startsWith("CUSTOM-")?t.sku:""}onImageError(t){const r=t.target;r&&(r.style.display="none")}trackByProductId(t,r){return r.id}getImageUrl(t){return(0,Mr.V)(t||"")}initSyncStatus(){this.syncService.getSyncStatus().pipe((0,ot.Q)(this.destroy$)).subscribe(t=>{this.syncStatus=t})}initSearch(){this.searchSubject.pipe((0,ot.Q)(this.destroy$),(0,xr.B)(300)).subscribe(t=>{this.filterProducts(t)})}initBarcodeScanner(){let t=0,r="";this.barcodeKeyHandler=i=>{const a=i.target;if("INPUT"===a.tagName||"TEXTAREA"===a.tagName)return;const s=Date.now();if(s-t<30?r+=i.key:r=i.key,t=s,"Enter"===i.key&&r.length>5){i.preventDefault();const l=r.slice(0,-1);this.handleBarcodeScan(l),r=""}},document.addEventListener("keypress",this.barcodeKeyHandler)}loadProducts(){var t=this;return(0,fe.A)(function*(){t.isLoading=!0,console.log("Loading products for POS...");try{const r=t.offlineStorage.getProducts(),i=new Promise((s,l)=>setTimeout(()=>l(new Error("Cache timeout")),3e3));let a=yield Promise.race([r,i]);t.shopId&&(a=a.filter(s=>!s.shopId||s.shopId===t.shopId));try{const s=yield t.offlineStorage.getPendingProductCreations(),l=t.shopId?s.filter(u=>u.shopId===t.shopId):s;if(l.length>0){console.log(`Found ${l.length} pending offline products for shop ${t.shopId}`);const u=l.filter(p=>{const f=(p.name||p.customName||"").toLowerCase(),h=(p.barcode1||"").toLowerCase(),_=p.tempProductId;return!a.some(C=>{const P=_&&C.id===_,x=h&&C.barcode1&&C.barcode1.toLowerCase()===h,k=C.name.toLowerCase()===f;return P||x||k})});u.length>0&&(a=[...u.map(f=>({id:f.tempProductId||t.offlineStorage.generateTempProductId(),shopId:f.shopId,name:f.name||f.customName||"New Product",nameTamil:f.nameTamil,price:f.price,originalPrice:f.originalPrice,costPrice:f.costPrice,stock:f.stockQuantity,trackInventory:f.trackInventory,isAvailable:!0,sku:f.sku||"",barcode:f.barcode1,barcode1:f.barcode1,barcode2:f.barcode2,barcode3:f.barcode3,category:f.categoryName,unit:f.unit,masterProductId:f.masterProductId})),...a],console.log(`Added ${u.length} new offline products (skipped ${l.length-u.length} already in cache)`))}}catch(s){console.warn("Failed to load pending offline products:",s)}if(a.length>0){if(t.products=a.filter(s=>!1!==s.isAvailable&&"INACTIVE"!==s.status),t.filteredProducts=t.sortProductsWithCartFirst(t.products),console.log(`Loaded ${t.products.length} active products from cache (filtered from ${a.length} total)`),(!t.shopId||0===t.shopId)&&a.length>0){const s=a.find(l=>l.shopId);s&&s.shopId&&(t.shopId=s.shopId,localStorage.setItem("current_shop_id",String(t.shopId)),console.log("POS: Extracted shopId from cached products:",t.shopId))}if(t.isLoading=!1,t.products.length>0&&t.cacheProductImagesToIndexedDB(t.products),navigator.onLine){const s=localStorage.getItem(t.POS_CACHE_TIMESTAMP_KEY),l=s?parseInt(s,10):0,u=Date.now()-l;if(0===t.products.length)return console.log("POS: No active products in cache, loading from server..."),void t.loadProductsFromServer();u>t.CACHE_VALIDITY_MS?(console.log(`POS cache is stale (age: ${Math.round(u/1e3)}s), syncing from server...`),t.syncProductsInBackground()):console.log(`POS using cached data (age: ${Math.round(u/1e3)}s, max: ${t.CACHE_VALIDITY_MS/1e3}s)`)}return}}catch(r){console.warn("Failed to load from cache, loading from server:",r)}t.loadProductsFromServer()})()}loadProductsFromServer(){var r,t=this;this.http.get(`${this.apiUrl}/shop-products/my-products?page=0&size=100000`).pipe((0,ot.Q)(this.destroy$)).subscribe({next:(r=(0,fe.A)(function*(i){let a=[];if(i?.data?.content?a=i.data.content:i?.data&&Array.isArray(i.data)&&(a=i.data),a.length>0&&(!t.shopId||0===t.shopId)){const l=a[0];l.shopId&&(t.shopId=l.shopId,localStorage.setItem("current_shop_id",String(t.shopId)),console.log("POS: Extracted shopId from products:",t.shopId))}const s=a.map(l=>t.mapProduct(l));t.products=s.filter(l=>!1!==l.isAvailable&&"INACTIVE"!==l.status),t.filteredProducts=t.sortProductsWithCartFirst(t.products),t.isLoading=!1,console.log(`Loaded ${t.products.length} active products (filtered from ${s.length} total)`),yield t.offlineStorage.saveProducts(s,t.shopId),localStorage.setItem(t.POS_CACHE_TIMESTAMP_KEY,Date.now().toString()),console.log(`Loaded and cached ${t.products.length} products`),t.cacheProductImages().then(()=>{console.log("Background image caching complete")}).catch(l=>console.warn("Image caching error:",l))}),function(a){return r.apply(this,arguments)}),error:r=>{console.error("Failed to load products:",r),this.swal.error("Error","Failed to load products"),this.isLoading=!1}})}cacheProductImages(){var t=this;return(0,fe.A)(function*(){const r=t.products.map(function(){var a=(0,fe.A)(function*(s,l){if(s.image&&!s.imageBase64)try{const u=t.getImageUrl(s.image),p=yield t.fetchImageAsBase64(u);p&&(t.products[l].imageBase64=p)}catch{console.warn(`Failed to cache image for product ${s.id}`)}});return function(s,l){return a.apply(this,arguments)}}());for(let a=0;a<r.length;a+=10)yield Promise.all(r.slice(a,a+10))})()}fetchImageAsBase64(t){return new Promise(r=>{const i=new Image;i.crossOrigin="Anonymous",i.onload=()=>{try{const a=document.createElement("canvas");a.width=i.width,a.height=i.height;const s=a.getContext("2d");if(s){s.drawImage(i,0,0);const l=a.toDataURL("image/jpeg",.6);r(l)}else r(null)}catch{r(null)}},i.onerror=()=>r(null),setTimeout(()=>r(null),5e3),i.src=t})}syncProductsInBackground(){var r,t=this;this.http.get(`${this.apiUrl}/shop-products/my-products?page=0&size=100000`).pipe((0,ot.Q)(this.destroy$)).subscribe({next:(r=(0,fe.A)(function*(i){let a=[];i?.data?.content?a=i.data.content:i?.data&&Array.isArray(i.data)&&(a=i.data);const s=a.map(u=>t.mapProduct(u)),l=s.filter(u=>!1!==u.isAvailable&&"INACTIVE"!==u.status);yield t.offlineStorage.saveProducts(s,t.shopId),localStorage.setItem(t.POS_CACHE_TIMESTAMP_KEY,Date.now().toString()),l.length!==t.products.length&&(t.products=l,t.filteredProducts=t.sortProductsWithCartFirst(t.products)),console.log(`Background sync complete: ${l.length} active products (${s.length} total)`)}),function(a){return r.apply(this,arguments)}),error:r=>{console.warn("Background sync failed:",r)}})}cacheProductImagesToIndexedDB(t){var r=this;if(!navigator.onLine)return;const i=t.filter(u=>u.image||u.imageUrl).map(u=>(0,Mr.V)(u.image||u.imageUrl||"")).filter(u=>u&&u.length>0);if(0===i.length)return;console.log(`Caching ${i.length} product images to IndexedDB...`);let s=0;const l=function(){var u=(0,fe.A)(function*(p){const f=i.slice(p,p+10);0!==f.length?(yield Promise.all(f.map(function(){var h=(0,fe.A)(function*(_){try{if(yield r.offlineStorage.isImageCached(_))s++;else{const P=yield fetch(_,{mode:"cors",credentials:"omit"});if(P.ok){const x=yield P.blob();yield r.offlineStorage.cacheImage(_,x),s++}}}catch{}});return function(_){return h.apply(this,arguments)}}())),setTimeout(()=>l(p+10),100)):console.log(`Image caching complete: ${s}/${i.length} cached`)});return function(f){return u.apply(this,arguments)}}();l(0)}mapProduct(t){return{id:t.id,shopId:t.shopId,name:t.displayName||t.customName||t.name||"Unknown",nameTamil:t.nameTamil||t.displayNameTamil||"",price:t.price||0,originalPrice:t.originalPrice||t.mrp||t.price||0,stock:t.stockQuantity||0,trackInventory:t.trackInventory??!0,isAvailable:!1!==t.isAvailable&&"INACTIVE"!==t.status,sku:t.sku||t.masterProduct?.sku||"",barcode:t.barcode||t.masterProduct?.barcode||"",barcode1:t.barcode1||"",barcode2:t.barcode2||"",barcode3:t.barcode3||"",image:t.primaryImageUrl||"",categoryId:t.categoryId||t.masterProduct?.category?.id,categoryName:t.categoryName||t.masterProduct?.category?.name||"",tags:t.tags||t.masterProduct?.tags||[]}}onSearchChange(){this.searchSubject.next(this.searchTerm)}addFirstSearchResult(){this.filteredProducts.length>0&&(this.addToCart(this.filteredProducts[0]),this.searchTerm="",this.onSearchChange())}onQuickSearchEnter(){if(!this.searchTerm.trim())return;const t=this.products.find(r=>r.barcode===this.searchTerm||r.barcode1===this.searchTerm||r.barcode2===this.searchTerm||r.barcode3===this.searchTerm||r.sku===this.searchTerm);t&&(this.addToCart(t),this.playBeep(!0),this.searchTerm="",this.filterProducts(""))}getTempPrice(t){if(this.tempPrices.has(t.id))return this.tempPrices.get(t.id);const r=this.cart.find(i=>i.product.id===t.id);return r?r.unitPrice:t.price}setTempPrice(t,r){const a=parseFloat(r.target.value)||0;this.tempPrices.set(t.id,a)}getTempQty(t){if(this.tempQtys.has(t.id))return this.tempQtys.get(t.id);const r=this.getCartQuantity(t);return r>0?r:1}incrementTempQty(t){const r=this.getTempQty(t);this.tempQtys.set(t.id,r+1)}decrementTempQty(t){const r=this.getTempQty(t);r>0&&this.tempQtys.set(t.id,r-1)}addToCartWithTempValues(t){const r=this.getTempPrice(t),i=this.getTempQty(t);if(i<=0)return;const a={...t,price:r};for(let s=0;s<i;s++)this.addToCart(a);this.tempQtys.set(t.id,1)}filterProducts(t){if(!t||t.length<2)return void(this.filteredProducts="scanner"===this.posMode?[]:this.sortProductsWithCartFirst(this.products));const r=t.toLowerCase();if(t.length>=5&&/^\d+$/.test(t)){const a=this.products.find(s=>s.barcode===t||s.barcode1===t||s.barcode2===t||s.barcode3===t);if(a)return void(this.filteredProducts=[a])}const i=[];for(const a of this.products){if(i.length>=50)break;(a.name.toLowerCase().includes(r)||a.nameTamil&&a.nameTamil.toLowerCase().includes(r)||a.sku&&a.sku.toLowerCase().includes(r)||a.barcode&&a.barcode.includes(t)||a.barcode1&&a.barcode1.includes(t)||a.barcode2&&a.barcode2.includes(t)||a.barcode3&&a.barcode3.includes(t))&&i.push(a)}this.filteredProducts=this.sortProductsWithCartFirst(i)}onPosModeChange(){this.filterProducts(this.searchTerm)}handleBarcodeScan(t){const r=Date.now();if(t===this.lastScannedBarcode&&r-this.lastScanTime<500)return void console.log("Ignoring duplicate barcode scan:",t);this.lastScannedBarcode=t,this.lastScanTime=r,console.log("Barcode scanned:",t);const i=this.products.find(a=>a.barcode===t||a.barcode1===t||a.barcode2===t||a.barcode3===t||a.sku===t);i?"quick"===this.activeTab?(this.searchTerm=t,this.filterProducts(t),this.playBeep(!0)):(this.addToCart(i),this.playBeep(!0)):(this.swal.error("Not Found",`Product with barcode "${t}" not found`,2e3),this.playBeep(!1))}onBarcodeSubmit(){const t=this.barcodeBuffer.trim();if(!t)return;const r=this.products.find(i=>i.barcode===t||i.barcode1===t||i.barcode2===t||i.barcode3===t||i.sku===t);r?(this.addToCart(r),this.playBeep(!0)):(this.swal.error("Not Found",`Product with barcode "${t}" not found`,2e3),this.playBeep(!1)),this.barcodeBuffer=""}addToCart(t){if(t.trackInventory&&t.stock<=0)return void this.swal.error("Out of Stock",`${t.name} is out of stock`);const r=this.cart.find(s=>s.product.id===t.id),i=t.originalPrice||t.price,a=i-t.price;if(r){if(t.trackInventory&&r.quantity>=t.stock)return void this.swal.warning("Stock Limit",`Only ${t.stock} available`);r.quantity++,r.unitPrice!==t.price&&(r.unitPrice=t.price,r.mrp=i,r.discount=a),r.total=r.quantity*r.unitPrice}else this.cart.unshift({product:t,quantity:1,unitPrice:t.price,mrp:i,total:t.price,discount:a});this.calculateTotals(),"quick"===this.activeTab?(this.searchTerm="",this.filteredProducts=[]):(this.searchTerm="",this.filteredProducts=this.sortProductsWithCartFirst(this.products))}isInCart(t){return this.cart.some(r=>r.product.id===t.id)}getCartQuantity(t){const r=this.cart.find(i=>i.product.id===t.id);return r?r.quantity:0}getCartProducts(){return this.cart.map(t=>t.product)}getCartItemPrice(t){const r=this.cart.find(i=>i.product.id===t.id);return r?r.unitPrice:t.price}getCartItemMrp(t){const r=this.cart.find(i=>i.product.id===t.id);return r?r.mrp:t.originalPrice||t.price}isPriceAboveMrp(t){const r=this.cart.find(i=>i.product.id===t.id);return!!r&&r.unitPrice>r.mrp}updateCartQuantityByProduct(t,r){const i=this.cart.find(a=>a.product.id===t.id);i&&this.updateQuantity(i,r)}setCartQuantityByProduct(t,r){const i=r.target,a=parseInt(i.value,10),s=this.cart.find(l=>l.product.id===t.id);if(s&&a>0){if(s.product.trackInventory&&a>s.product.stock)return this.swal.warning("Stock Limit",`Only ${s.product.stock} available`),void(i.value=String(s.quantity));s.quantity=a,s.total=s.quantity*s.unitPrice,this.calculateTotals()}else s&&a<=0&&this.removeFromCart(s)}setCartItemQuantity(t,r){const i=r.target,a=parseInt(i.value,10);if(a>0){if(t.product.trackInventory&&a>t.product.stock)return this.swal.warning("Stock Limit",`Only ${t.product.stock} available`),void(i.value=String(t.quantity));t.quantity=a,t.total=t.quantity*t.unitPrice,this.calculateTotals()}else a<=0&&this.removeFromCart(t)}setTempQty(t,r){const a=parseInt(r.target.value,10);!isNaN(a)&&a>=0&&this.tempQtys.set(t.id,a)}updateCartItemPrice(t,r){const a=parseFloat(r.target.value)||0,s=this.cart.find(l=>l.product.id===t.id);s&&a>=0&&(s.unitPrice=a,s.total=s.unitPrice*s.quantity,s.discount=s.mrp-s.unitPrice,s.discount<0&&(s.discount=0),this.calculateTotals())}sortProductsWithCartFirst(t){const r=new Set(this.cart.map(i=>i.product.id));return 0===r.size?t:[...t].sort((i,a)=>{const s=r.has(i.id),l=r.has(a.id);return s&&!l?-1:!s&&l?1:0})}updateQuantity(t,r){const i=t.quantity+r;i<=0?this.removeFromCart(t):t.product.trackInventory&&i>t.product.stock?this.swal.warning("Stock Limit",`Only ${t.product.stock} available`):(t.quantity=i,t.total=t.quantity*t.unitPrice,this.calculateTotals())}removeFromCart(t){const r=this.cart.indexOf(t);r>-1&&(this.cart.splice(r,1),this.calculateTotals(),"quick"!==this.activeTab&&(this.filteredProducts=this.sortProductsWithCartFirst(this.products)))}removeProductFromCart(t){const r=this.cart.find(i=>i.product.id===t.id);r&&this.removeFromCart(r)}clearCart(){0!==this.cart.length&&this.swal.confirm("Clear Cart","Remove all items from cart?","Yes, Clear","Cancel").then(t=>{t.isConfirmed&&this.resetCart()})}startNewBill(){0!==this.cart.length&&this.swal.confirm("Start New Bill","Clear current cart and start a new bill?","Yes, New Bill","Cancel").then(t=>{t.isConfirmed&&(this.resetCart(),this.swal.toast("Ready for new bill","success"))})}resetCart(){this.cart=[],this.calculateTotals(),this.customerName="",this.customerPhone="",this.orderNotes="",this.filteredProducts="quick"!==this.activeTab?this.sortProductsWithCartFirst(this.products):[]}calculateTotals(){this.subtotal=this.cart.reduce((t,r)=>t+r.total,0),this.totalMrp=this.cart.reduce((t,r)=>t+r.mrp*r.quantity,0),this.totalDiscount=this.totalMrp-this.subtotal,this.totalDiscount<0&&(this.totalDiscount=0),this.taxAmount=this.subtotal*this.taxRate,this.totalAmount=this.subtotal+this.taxAmount}generateBill(){var t=this;return(0,fe.A)(function*(){if(0!==t.cart.length){if(!t.shopId||0===t.shopId){console.log("POS: shopId not set, attempting to retrieve...");const r=t.shopContext.getCurrentShop();if(r)t.shopId=r.id,console.log("POS: Got shopId from shop context:",t.shopId);else{const i=localStorage.getItem("current_shop_id");i&&(t.shopId=parseInt(i,10),console.log("POS: Got shopId from localStorage:",t.shopId))}if((!t.shopId||0===t.shopId)&&t.products.length>0){const i=t.products.find(a=>a.shopId);i&&i.shopId&&(t.shopId=i.shopId,localStorage.setItem("current_shop_id",String(t.shopId)),console.log("POS: Got shopId from products:",t.shopId))}if(!t.shopId||0===t.shopId)return console.error("POS: Failed to get shopId from any source"),void t.swal.error("Error","Shop not loaded. Please refresh the page.")}console.log("Creating POS order for shopId:",t.shopId),t.swal.loading("Creating bill...");try{const r=yield t.resolveCartProductIds();if(r.filter(l=>l.shopProductId<0).length>0&&navigator.onLine){console.log("Found unsynced products in cart, attempting sync..."),yield t.syncService.syncPendingProductCreations();const l=yield t.resolveCartProductIds(),u=l.filter(p=>p.shopProductId<0);u.length>0&&console.warn("Some products still have temp IDs after sync:",u),r.length=0,r.push(...l)}const a={items:r,paymentMethod:t.selectedPaymentMethod,customerName:t.customerName||void 0,customerPhone:t.customerPhone||void 0,notes:t.orderNotes||void 0,subtotal:t.subtotal,taxAmount:t.taxAmount,totalAmount:t.totalAmount},s=yield t.syncService.createPosOrder(a,t.shopId,t.shopName);if(t.swal.close(),s.success){const l=s.offline?" (Saved offline)":"";t.swal.toast(`Bill Created - \u20b9${t.totalAmount.toFixed(0)}${l}`,"success"),t.printReceipt(s.order),yield t.updateLocalStockAfterBill()}}catch(r){t.swal.close(),console.error("Failed to create bill:",r),t.swal.error("Error","Failed to create bill")}}else t.swal.warning("Empty Cart","Please add items to generate bill")})()}printReceipt(t){var r=this;return(0,fe.A)(function*(){const i=r.getPaperConfig(r.billSettings.paperWidth||"80mm"),a=window.open("","_blank",`width=${i.windowWidth},height=600`);if(!a)return;a.document.write('<html><body style="display:flex;justify-content:center;align-items:center;height:100vh;font-family:sans-serif;"><p>Generating receipt...</p></body></html>');const s=yield r.generateReceiptHtml(t);a.document.open(),a.document.write(s),a.document.close(),setTimeout(()=>{a.onafterprint=()=>a.close(),a.print()},500)})()}getPaperConfig(t){switch(t){case"58mm":return{pageSize:"58mm auto",bodyWidth:"180px",maxWidth:"180px",windowWidth:300};case"80mm":default:return{pageSize:"80mm auto",bodyWidth:"260px",maxWidth:"260px",windowWidth:350};case"A4":return{pageSize:"A4",bodyWidth:"100%",maxWidth:"600px",windowWidth:700}}}getSeparatorStyle(t){switch(t){case"solid":return"border-top: 1px solid #000; margin: 6px 0;";case"dashed":default:return"border-top: 1px dashed #000; margin: 6px 0;";case"dotted":return"border-top: 1px dotted #000; margin: 6px 0;";case"none":return"margin: 6px 0;"}}generateReceiptHtml(t){var r=this;return(0,fe.A)(function*(){const i=r.billSettings,a=i.bodyFontSize||12,s=i.headerFontSize||16,l=i.footerFontSize||10,u=r.getPaperConfig(i.paperWidth||"80mm");let p="";if(i.showUpiQrCode&&i.upiId){const ee="58mm"===i.paperWidth?100:140;p=yield r.generateUpiQrCode(ee,r.totalAmount)}const f=r.cart.map(ee=>{const A=ee.product.name||"",Q=ee.product.nameTamil||"",q=ee.unitPrice||0,le=ee.mrp||q,de=ee.discount>0;let Z="";Z=i.showEnglish&&i.showTamil&&Q?`${A}<br><span style="font-size: ${Math.max(a-3,8)}px; color: #333;">${Q}</span>`:i.showEnglish?A:i.showTamil&&Q?Q:A;const Fe=de?`<span style="text-decoration: line-through; color: #666; font-size: ${Math.max(a-1,8)}px;">${le}</span><br>${q}`:`${q}`;return`\n      <tr>\n        <td style="font-size: ${a}px; padding: 2px 0; font-weight: 600; word-wrap: break-word; max-width: 60px;">${Z}</td>\n        <td style="font-size: ${a}px; text-align: right; padding: 2px 0; font-weight: 600; white-space: nowrap;">${Fe}</td>\n        <td style="font-size: ${a}px; text-align: center; padding: 2px 0; font-weight: 700; white-space: nowrap;">${ee.quantity}</td>\n        <td style="font-size: ${a}px; text-align: right; padding: 2px 0; font-weight: 700; white-space: nowrap;">${ee.total.toFixed(0)}</td>\n      </tr>\n    `}).join(""),_=localStorage.getItem("shop_name"),C=i.shopName&&i.shopName.trim()||t.shopName&&t.shopName.trim()||_&&_.trim()||(r.shopName&&"My Shop"!==r.shopName?r.shopName:null)||"Shop",P=i.shopPhone||"",x=r.customerName||"",k=r.customerPhone||"",F=new Date;let S="";switch(i.dateFormat){case"MM/DD/YYYY":S=`${String(F.getMonth()+1).padStart(2,"0")}/${String(F.getDate()).padStart(2,"0")}/${F.getFullYear()}`;break;case"YYYY-MM-DD":S=`${F.getFullYear()}-${String(F.getMonth()+1).padStart(2,"0")}-${String(F.getDate()).padStart(2,"0")}`;break;default:S=`${String(F.getDate()).padStart(2,"0")}/${String(F.getMonth()+1).padStart(2,"0")}/${F.getFullYear()}`}const w=F.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),W=i.billNumberPrefix?`${i.billNumberPrefix}${t.orderNumber||t.offlineOrderId}`:`#${t.orderNumber||t.offlineOrderId}`;console.log("Receipt - shopName sources:",{billSettings:i.shopName,orderShopName:t.shopName,localStorage:_,thisShopName:r.shopName,resolved:C});const K=r.getSeparatorStyle(i.separatorStyle||"dashed");return`\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <meta charset="UTF-8">\n        <title>Receipt - ${t.orderNumber||t.offlineOrderId}</title>\n        <style>\n          @page {\n            size: ${u.pageSize};\n            margin: 1mm;\n          }\n          @media print {\n            body {\n              -webkit-print-color-adjust: exact;\n              print-color-adjust: exact;\n            }\n            .no-print { display: none !important; }\n          }\n          body {\n            font-family: 'Noto Sans Tamil', 'Latha', 'Tamil Sangam MN', Arial, sans-serif;\n            font-size: ${a}px;\n            width: ${u.bodyWidth};\n            max-width: ${u.maxWidth};\n            margin: 0 auto;\n            padding: 8px;\n            line-height: 1.3;\n          }\n          .center { text-align: center; }\n          .divider {\n            ${K}\n          }\n          .divider-solid {\n            border-top: 1px solid #000;\n            margin: 6px 0;\n          }\n          table { width: 100%; border-collapse: collapse; }\n          .shop-name {\n            font-family: 'Noto Sans Tamil', 'Latha', 'Tamil Sangam MN', Arial, sans-serif;\n            font-size: ${s}px;\n            font-weight: 700;\n            margin-bottom: 3px;\n          }\n          .shop-phone {\n            font-size: ${Math.max(s-4,10)}px;\n            color: #333;\n            margin-bottom: 2px;\n          }\n          .fssai-info {\n            font-size: ${Math.max(l,8)}px;\n            color: #555;\n            margin-bottom: 2px;\n          }\n          .order-number {\n            font-size: ${Math.max(a,12)}px;\n            font-weight: 700;\n            background: #000;\n            color: #fff;\n            padding: 4px 8px;\n            display: inline-block;\n            border-radius: 3px;\n            margin: 4px 0;\n          }\n          .customer-name {\n            font-size: ${a}px;\n            font-weight: 700;\n          }\n          .customer-phone {\n            font-size: ${Math.max(a-2,10)}px;\n            color: #333;\n          }\n          .item-header th {\n            font-size: ${Math.max(a-2,10)}px;\n            padding: 4px 0;\n            border-bottom: 1px solid #000;\n            text-transform: uppercase;\n            font-weight: 700;\n          }\n          .payment-badge {\n            font-size: ${Math.max(a-2,10)}px;\n            font-weight: 700;\n            padding: 4px 8px;\n            background: #f0f0f0;\n            border-radius: 3px;\n            display: inline-block;\n            margin: 4px 0;\n          }\n          .footer-text {\n            font-size: ${l}px;\n            color: #666;\n            margin-top: 6px;\n          }\n          .offline-badge {\n            background: #ff9800;\n            color: white;\n            padding: 2px 6px;\n            font-size: ${Math.max(l,9)}px;\n            border-radius: 3px;\n          }\n          .flex-row {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n          }\n        </style>\n      </head>\n      <body>\n        ${i.showShopName?`<div class="center shop-name">${C}</div>`:""}\n        ${i.showShopAddress&&i.shopAddress?`<div class="center" style="font-size: ${Math.max(l,9)}px; color: #555;">${i.shopAddress}</div>`:""}\n        ${i.showShopPhone&&P?`<div class="center shop-phone">\u{1f4de} ${P}</div>`:""}\n        ${i.showGstNumber&&i.gstNumber?`<div class="center" style="font-size: ${Math.max(l,9)}px;">GST: ${i.gstNumber}</div>`:""}\n        ${i.showFssaiInfo&&i.fssaiNumber?`\n          <div class="center fssai-info">\n            FSSAI: ${i.fssaiNumber}\n            ${i.fssaiName?`<br>${i.fssaiName}`:""}\n          </div>\n        `:""}\n        ${r.getCustomFieldsHtml("header",Math.max(l,9))}\n        <div class="center" style="font-size: ${Math.max(l,9)}px; color: #666;">Order Receipt</div>\n        <div class="divider"></div>\n\n        ${i.showBillNumber?`\n        <div class="center">\n          <div class="order-number">${W}</div>\n        </div>\n        `:""}\n        ${i.showDateTime?`\n        <div style="font-size: ${Math.max(l,9)}px; text-align: center; margin-bottom: 4px;">\n          ${S} | ${w}\n        </div>\n        `:""}\n        <div class="divider"></div>\n\n        ${i.showCustomerDetails&&(x||k)?`\n        <div style="margin-bottom: 4px;">\n          ${x?`<div class="customer-name">${x}</div>`:""}\n          ${k?`<div class="customer-phone">${k}</div>`:""}\n        </div>\n        <div class="divider"></div>\n        `:""}\n\n        <table>\n          <thead>\n            <tr class="item-header">\n              <th style="text-align: left;">ITEM</th>\n              <th style="text-align: right;">RATE</th>\n              <th style="text-align: center;">QTY</th>\n              <th style="text-align: right;">AMT</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${f}\n          </tbody>\n        </table>\n        <div class="divider-solid"></div>\n\n        <div class="flex-row" style="font-size: ${a}px; padding: 4px 0;">\n          <span style="font-weight: 600;">Items: ${r.cart.length} (Qty: ${r.cart.reduce((ee,A)=>ee+A.quantity,0)})</span>\n          <span style="font-weight: 700;">\u20b9${r.totalAmount.toFixed(0)}</span>\n        </div>\n\n        ${r.totalDiscount>0?`\n        <div class="flex-row" style="font-size: ${a}px; padding: 2px 0;">\n          <span style="font-weight: 600; color: #888;">MRP Total</span>\n          <span style="text-decoration: line-through; color: #888;">\u20b9${r.totalMrp.toFixed(0)}</span>\n        </div>\n        <div class="flex-row" style="font-size: ${a}px; padding: 2px 0; color: #4caf50;">\n          <span style="font-weight: 600;">You Save</span>\n          <span style="font-weight: 700;">\u20b9${r.totalDiscount.toFixed(0)}</span>\n        </div>\n        `:""}\n\n        <div class="flex-row" style="border-top: 1px solid #000; padding-top: 6px; margin-top: 4px;">\n          <span style="font-size: ${s}px; font-weight: 700;">TOTAL</span>\n          <span style="font-size: ${s+2}px; font-weight: 700;">\u20b9${r.totalAmount.toFixed(0)}</span>\n        </div>\n\n        ${i.showPaymentMethod?`\n        <div class="divider"></div>\n        <div class="center">\n          <span class="payment-badge">\n            ${"CASH_ON_DELIVERY"===r.selectedPaymentMethod?"\u{1f4b5} CASH":"UPI"===r.selectedPaymentMethod?"\u{1f4f1} UPI":"\u{1f4b3} CARD"}\n          </span>\n        </div>\n        `:""}\n\n        ${i.showUpiQrCode&&i.upiId&&p?`\n        <div class="divider"></div>\n        <div class="center" style="padding: 8px 0;">\n          <div style="font-size: ${l}px; margin-bottom: 4px; font-weight: 600;">Scan to Pay</div>\n          <img src="${p}"\n               alt="UPI QR Code"\n               style="width: ${"58mm"===i.paperWidth?"100px":"140px"}; height: ${"58mm"===i.paperWidth?"100px":"140px"}; margin: 4px 0;">\n          <div style="font-size: ${Math.max(l-1,7)}px; color: #666;">${i.upiId}</div>\n        </div>\n        `:""}\n\n        <div class="divider"></div>\n\n        ${r.getCustomFieldsHtml("footer",l)}\n\n        ${i.footerNote?`\n        <div class="center" style="font-size: ${l}px; color: #888; margin: 4px 0;">\n          ${i.footerNote}\n        </div>\n        `:""}\n\n        ${i.showThankYouMessage?`\n        <div class="center footer-text">\n          ${i.thankYouMessage||"Thank you for your order!"}<br>\n          Printed: ${(new Date).toLocaleString("en-IN")}\n        </div>\n        `:""}\n\n        \x3c!-- Print Button (hidden during print) --\x3e\n        <div class="no-print" style="margin-top: 15px; text-align: center;">\n          <button onclick="window.onafterprint=function(){window.close()};window.print()" style="\n            background: #4CAF50;\n            color: white;\n            border: none;\n            padding: 12px 30px;\n            font-size: 16px;\n            font-weight: bold;\n            border-radius: 5px;\n            cursor: pointer;\n            margin-right: 10px;\n          ">\u{1f5a8}\ufe0f PRINT</button>\n          <button onclick="window.close()" style="\n            background: #666;\n            color: white;\n            border: none;\n            padding: 12px 20px;\n            font-size: 14px;\n            border-radius: 5px;\n            cursor: pointer;\n          ">Close</button>\n        </div>\n      </body>\n      </html>\n    `})()}getPaymentLabel(t){const r=this.paymentMethods.find(i=>i.value===t);return r?r.label:t}getSectionLabel(t){return{header:"Shop Header",billInfo:"Bill Info (Date, Number)",items:"Item List",summary:"Summary (Total, Savings)",payment:"Payment Method",qrCode:"UPI QR Code",footer:"Footer & Thank You"}[t]||t}moveSectionUp(t){if(t>0){const r=this.billSettings.sectionOrder[t];this.billSettings.sectionOrder[t]=this.billSettings.sectionOrder[t-1],this.billSettings.sectionOrder[t-1]=r}}moveSectionDown(t){if(t<this.billSettings.sectionOrder.length-1){const r=this.billSettings.sectionOrder[t];this.billSettings.sectionOrder[t]=this.billSettings.sectionOrder[t+1],this.billSettings.sectionOrder[t+1]=r}}addCustomField(){this.billSettings.customFields.length<6&&this.billSettings.customFields.push({label:"",value:"",enabled:!1,position:"footer"})}removeCustomField(t){this.billSettings.customFields.splice(t,1)}getCustomFieldsHtml(t,r){const i=this.billSettings.customFields.filter(a=>a.enabled&&a.label&&a.value&&a.position===t);return 0===i.length?"":i.map(a=>`\n      <div style="font-size: ${r}px; text-align: center; margin: 2px 0;">\n        <span style="color: #666;">${a.label}:</span> <span style="font-weight: 500;">${a.value}</span>\n      </div>\n    `).join("")}generateUpiQrCode(){var t=this;return(0,fe.A)(function*(r=150,i){const a=t.billSettings.upiId||t.shopUpiId;if(!a)return"";const u=`upi://pay?pa=${a}&pn=${(t.billSettings.shopName||t.shopName||"Shop").replace(/[^a-zA-Z0-9 ]/g,"")}&am=${i??t.totalAmount}&cu=INR`;try{return yield Bw.dY(u,{width:r,margin:1,color:{dark:"#000000",light:"#ffffff"}})}catch(p){return console.error("Error generating QR code:",p),""}}).apply(this,arguments)}getUpiQrCodeUrl(t=150,r){const i=this.billSettings.upiId||this.shopUpiId;if(!i)return"";const a=(this.billSettings.shopName||this.shopName||"Shop").replace(/[^a-zA-Z0-9 ]/g,"");return`https://chart.googleapis.com/chart?cht=qr&chs=${t}x${t}&chl=${encodeURIComponent(`upi://pay?pa=${i}&pn=${a}&am=${r??this.totalAmount}&cu=INR`)}&choe=UTF-8`}manualSync(){var t=this;return(0,fe.A)(function*(){if(t.syncStatus.isOnline){t.swal.loading("Syncing pending data...");try{const r=yield t.syncService.syncPendingOrders();console.log("Order sync result:",r);const i=yield t.syncService.syncPendingEdits();console.log("Edit sync result:",i);const a=yield t.syncService.syncPendingProductCreations();console.log("Product creation sync result:",a),yield t.loadProducts(),t.swal.close();const s=r.synced+i.synced+a.synced,l=r.failed+i.failed+a.failed;if(s>0||l>0)if(l>0)t.swal.warning("Sync Partial",`Synced: ${s}, Failed: ${l}`);else{let u="";r.synced>0&&(u+=`${r.synced} order(s)`),i.synced>0&&(u&&(u+=", "),u+=`${i.synced} product edit(s)`),a.synced>0&&(u&&(u+=", "),u+=`${a.synced} product(s) created`),t.swal.success("Synced",`${u} synced successfully`)}else t.swal.success("Synced","No pending data to sync. Products updated.")}catch(r){t.swal.close(),console.error("Sync error:",r),t.swal.error("Sync Failed",r.message||"Failed to sync data")}}else t.swal.warning("Offline","Cannot sync while offline")})()}playBeep(t){}toggleCustomerForm(){this.showCustomerForm=!this.showCustomerForm}openQuickEdit(t,r){r.stopPropagation(),this.editingProduct=t,this.editPrice=t.price,this.editMrp=t.originalPrice||t.price,this.editStock=t.stock,this.editSku=t.sku||"",this.editBarcode=t.barcode||"",this.editBarcode1=t.barcode1||"",this.editBarcode2=t.barcode2||"",this.editBarcode3=t.barcode3||"",this.editName=t.name||"",this.editNameTamil=t.nameTamil||"",this.editImageFile=null,this.editImagePreview="",this.labelNetQty=t.netQty||"",this.labelPackedDate=t.packedDate||"",this.labelExpiryDate=t.expiryDate||"",this.labelQuantity=1}formatDateInput(t,r){const i=t.target;let a=i.value.replace(/[^0-9]/g,"");a.length>4&&(a=a.substring(0,4)),a.length>=2&&(a=a.substring(0,2)+"/"+a.substring(2)),"pkd"===r?this.labelPackedDate=a:this.labelExpiryDate=a,i.value=a}closeQuickEdit(){this.editingProduct=null,this.editPrice=0,this.editMrp=0,this.editStock=0,this.editBarcode="",this.editSku="",this.editBarcode1="",this.editBarcode2="",this.editBarcode3="",this.editName="",this.editNameTamil="",this.editImageFile=null,this.editImagePreview="",this.labelQuantity=1,this.searchTerm="",this.filteredProducts=this.sortProductsWithCartFirst(this.products),setTimeout(()=>{this.searchInput?.nativeElement&&this.searchInput.nativeElement.focus()},100)}onEditImageSelect(t){const r=t.target;if(r.files&&r.files[0]){const i=r.files[0];if(!i.type.startsWith("image/"))return void this.swal.error("Invalid File","Please select an image file");if(i.size>5242880)return void this.swal.error("File Too Large","Image must be less than 5MB");this.editImageFile=i;const a=new FileReader;a.onload=s=>{this.editImagePreview=s.target?.result},a.readAsDataURL(i)}}removeEditImage(){this.editImageFile=null,this.editImagePreview=""}generateCode128DataUrl(t){const r=["11011001100","11001101100","11001100110","10010011000","10010001100","10001001100","10011001000","10011000100","10001100100","11001001000","11001000100","11000100100","10110011100","10011011100","10011001110","10111001100","10011101100","10011100110","11001110010","11001011100","11001001110","11011100100","11001110100","11101101110","11101001100","11100101100","11100100110","11101100100","11100110100","11100110010","11011011000","11011000110","11000110110","10100011000","10001011000","10001000110","10110001000","10001101000","10001100010","11010001000","11000101000","11000100010","10110111000","10110001110","10001101110","10111011000","10111000110","10001110110","11101110110","11010001110","11000101110","11011101000","11011100010","11011101110","11101011000","11101000110","11100010110","11101101000","11101100010","11100011010","11101111010","11001000010","11110001010","10100110000","10100001100","10010110000","10010000110","10000101100","10000100110","10110010000","10110000100","10011010000","10011000010","10000110100","10000110010","11000010010","11001010000","11110111010","11000010100","10001111010","10100111100","10010111100","10010011110","10111100100","10011110100","10011110010","11110100100","11110010100","11110010010","11011011110","11011110110","11110110110","10101111000","10100011110","10001011110","10111101000","10111100010","11110101000","11110100010","10111011110","10111101110","11101011110","11110101110","11010000100","11010010000","11010011100"];let a=r[104],s=104;for(let F=0;F<t.length;F++){const S=t.charCodeAt(F)-32;S>=0&&S<95&&(a+=r[S],s+=(F+1)*S)}a+=r[s%103],a+="1100011101011";const C=6*a.length+120,P=document.createElement("canvas");P.width=C,P.height=300;const x=P.getContext("2d");if(!x)return"";x.fillStyle="#FFFFFF",x.fillRect(0,0,C,300),x.fillStyle="#000000";let k=0;for(;k<a.length;)if("1"===a[k]){const F=60+6*k;let S=0;for(;k<a.length&&"1"===a[k];)S+=6,k++;x.fillRect(F,0,S,300)}else k++;return P.toDataURL("image/png")}printLabel(){if(!this.editingProduct)return;const t=this.editingProduct,r=this.editBarcode1||this.editBarcode||t.sku||"",i=this.labelQuantity||1;if(!r)return void this.swal.warning("No Barcode","Please add a barcode to print labels");const a=this.generateLabelsHtml(t,r,i),s=window.open("","_blank","width=400,height=600");s?(s.document.write(a),s.document.close(),setTimeout(()=>{s.onafterprint=()=>s.close(),s.print()},300)):this.swal.error("Error","Please allow popups to print labels")}generateLabelsHtml(t,r,i){let a="";for(let s=0;s<i;s++)a+=this.generateSingleLabelHtml(t,r);return`\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <meta charset="UTF-8">\n        <title>Label - ${t.name}</title>\n        <style>\n          @page {\n            size: 50mm 25mm;\n            margin: 0;\n            padding: 0;\n          }\n          @media print {\n            html, body {\n              margin: 0 !important;\n              padding: 0 !important;\n              width: 50mm !important;\n              -webkit-print-color-adjust: exact;\n              print-color-adjust: exact;\n            }\n            .print-instructions { display: none !important; }\n            .label {\n              page-break-after: always;\n              page-break-inside: avoid;\n              border: none !important;\n            }\n            .label:last-child { page-break-after: auto; }\n          }\n          * { margin: 0; padding: 0; box-sizing: border-box; }\n          body {\n            font-family: 'Noto Sans Tamil', 'Segoe UI', Arial, sans-serif;\n            width: 50mm;\n          }\n          .print-instructions {\n            width: 320px;\n            margin: 10px auto;\n            padding: 12px 16px;\n            background: #fffbeb;\n            border: 1px solid #f59e0b;\n            border-radius: 8px;\n            font-family: Arial, sans-serif;\n            font-size: 12px;\n            color: #92400e;\n            line-height: 1.6;\n          }\n          .print-instructions strong { color: #78350f; }\n          .print-instructions ul { margin: 4px 0 0 16px; }\n          .label {\n            width: 50mm;\n            height: 25mm;\n            padding: 1mm 2mm;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: space-between;\n            border: 1px dashed #ccc;\n            background: white;\n            overflow: hidden;\n          }\n          .label-top {\n            width: 100%;\n            text-align: center;\n          }\n          .shop-name {\n            font-size: 6pt;\n            font-weight: 800;\n            color: #000;\n            text-transform: uppercase;\n            letter-spacing: 0.3px;\n            line-height: 1.2;\n            margin-bottom: 0.3mm;\n          }\n          .tamil-name {\n            font-size: 5pt;\n            font-weight: 600;\n            color: #000;\n            font-family: 'Noto Sans Tamil', 'Latha', 'Tamil Sangam MN', Arial, sans-serif;\n            line-height: 1.2;\n            margin-bottom: 0.3mm;\n          }\n          .english-name {\n            font-size: 5pt;\n            font-weight: 600;\n            color: #000;\n            line-height: 1.2;\n            margin-bottom: 0.3mm;\n          }\n          .info-row {\n            display: flex;\n            justify-content: space-between;\n            width: 100%;\n            font-size: 5pt;\n            font-weight: 700;\n            color: #000;\n            margin-top: 0.3mm;\n            padding: 0 1mm;\n          }\n          .info-item {\n            white-space: nowrap;\n          }\n          .info-item.info-left {\n            text-align: left;\n          }\n          .info-item.info-right {\n            text-align: right;\n          }\n          .date-row {\n            display: flex;\n            justify-content: space-between;\n            width: 100%;\n            font-size: 4.5pt;\n            font-weight: 600;\n            color: #333;\n            margin-top: 0.3mm;\n            padding: 0 1mm;\n          }\n          .date-item {\n            white-space: nowrap;\n          }\n          .date-item.date-left {\n            text-align: left;\n          }\n          .date-item.date-right {\n            text-align: right;\n          }\n          .label-bottom {\n            width: 100%;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            margin-top: 0.5mm;\n          }\n          .barcode {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n          }\n          .barcode img {\n            height: 8mm;\n            width: auto;\n            image-rendering: pixelated;\n            image-rendering: -moz-crisp-edges;\n            image-rendering: crisp-edges;\n          }\n          .barcode-text {\n            font-size: 5pt;\n            font-family: 'Courier New', monospace;\n            font-weight: 700;\n            letter-spacing: 1px;\n            color: #000;\n            text-align: center;\n            margin-top: 0.3mm;\n          }\n        </style>\n      </head>\n      <body>\n        <div class="print-instructions">\n          <strong>Printer Settings (Important):</strong>\n          <ul>\n            <li>Paper size: <strong>50 x 25 mm</strong> (or custom)</li>\n            <li>Margins: <strong>None</strong></li>\n            <li>Scale: <strong>100%</strong> (not "Fit to page")</li>\n          </ul>\n        </div>\n        ${a}\n      </body>\n      </html>\n    `}generateSingleLabelHtml(t,r){const i=this.labelConfig;let l='<div class="label">';l+='<div class="label-top">',i.showShopName&&this.shopName&&(l+=`<div class="shop-name">${this.shopName}</div>`),i.showTamilName&&t.nameTamil&&(l+=`<div class="tamil-name">${t.nameTamil}</div>`),i.showEnglishName&&t.name&&(l+=`<div class="english-name">${t.name}</div>`);const u=i.showNetQty&&this.labelNetQty,p=i.showMrp;(u||p)&&(l+='<div class="info-row">',l+=`<span class="info-item info-left">${u?"NET QTY: "+this.labelNetQty:""}</span>`,l+=`<span class="info-item info-right">${p?"MRP: \u20b9"+(this.editMrp||t.originalPrice||this.editPrice||t.price||0):""}</span>`,l+="</div>");const f=i.showPackedDate&&this.labelPackedDate,h=i.showExpiryDate&&this.labelExpiryDate;return(f||h)&&(l+='<div class="date-row">',l+=`<span class="date-item date-left">${f?"PKD: "+this.labelPackedDate:""}</span>`,l+=`<span class="date-item date-right">${h?"EXP: "+this.labelExpiryDate:""}</span>`,l+="</div>"),l+="</div>",l+='<div class="label-bottom">',i.showBarcode&&(l+=`<div class="barcode"><img src="${this.generateCode128DataUrl(r)}" alt="${r}"></div>`),i.showBarcodeNumber&&(l+=`<div class="barcode-text">${r}</div>`),l+="</div>",l+="</div>",l}saveQuickEdit(){var t=this;return(0,fe.A)(function*(){if(!t.editingProduct)return;if(t.editPrice<=0)return void t.swal.error("Invalid Price","Price must be greater than 0");if(t.editMrp<t.editPrice)return void t.swal.error("Invalid MRP","MRP cannot be less than selling price");if(t.editStock<0)return void t.swal.error("Invalid Stock","Stock cannot be negative");const r=t.editBarcode1?.trim()||"",i=t.editBarcode2?.trim()||"",a=t.editBarcode3?.trim()||"";if(r&&i&&r.toLowerCase()===i.toLowerCase())return void t.swal.error("Duplicate Barcode","Barcode 1 and Barcode 2 cannot be the same.");if(r&&a&&r.toLowerCase()===a.toLowerCase())return void t.swal.error("Duplicate Barcode","Barcode 1 and Barcode 3 cannot be the same.");if(i&&a&&i.toLowerCase()===a.toLowerCase())return void t.swal.error("Duplicate Barcode","Barcode 2 and Barcode 3 cannot be the same.");const s=[t.editingProduct?.barcode1?.toLowerCase(),t.editingProduct?.barcode2?.toLowerCase(),t.editingProduct?.barcode3?.toLowerCase(),t.editingProduct?.barcode?.toLowerCase(),t.editingProduct?.sku?.toLowerCase()].filter(h=>h),l=[{value:r,label:"Barcode 1"},{value:i,label:"Barcode 2"},{value:a,label:"Barcode 3"}].filter(h=>h.value&&""!==h.value.trim());for(const h of l){const _=h.value.trim().toLowerCase();if(s.includes(_))continue;const C=t.products.find(P=>P.id!==t.editingProduct.id&&![P.barcode1,P.barcode2,P.barcode3,P.barcode,P.sku].filter(F=>F).map(F=>F.toLowerCase()).some(F=>s.includes(F))&&(P.sku&&P.sku.toLowerCase()===_||P.barcode&&P.barcode.toLowerCase()===_||P.barcode1&&P.barcode1.toLowerCase()===_||P.barcode2&&P.barcode2.toLowerCase()===_||P.barcode3&&P.barcode3.toLowerCase()===_));if(C)return void t.swal.error("Duplicate Barcode",`${h.label} "${h.value}" already exists for product "${C.name}". Please use a unique barcode.`)}t.isSavingEdit=!0;const u=t.editingProduct.id,p={price:t.editPrice,originalPrice:t.editMrp,stockQuantity:t.editStock,sku:t.editSku,barcode1:t.editBarcode1,barcode2:t.editBarcode2,barcode3:t.editBarcode3,customName:t.editName,nameTamil:t.editNameTamil,netQty:t.labelNetQty,packedDate:t.labelPackedDate,expiryDate:t.labelExpiryDate},f={price:t.editingProduct.price,originalPrice:t.editingProduct.originalPrice,stockQuantity:t.editingProduct.stock,barcode:t.editingProduct.barcode,barcode1:t.editingProduct.barcode1,barcode2:t.editingProduct.barcode2,barcode3:t.editingProduct.barcode3,name:t.editingProduct.name,nameTamil:t.editingProduct.nameTamil,netQty:t.editingProduct.netQty,packedDate:t.editingProduct.packedDate,expiryDate:t.editingProduct.expiryDate};try{if(navigator.onLine&&!(u<0))try{let ee;if(t.editImageFile){const A=new FormData;A.append("price",t.editPrice.toString()),A.append("originalPrice",t.editMrp.toString()),A.append("stockQuantity",t.editStock.toString()),t.editBarcode1&&A.append("barcode1",t.editBarcode1),t.editBarcode2&&A.append("barcode2",t.editBarcode2),t.editBarcode3&&A.append("barcode3",t.editBarcode3),t.editName&&A.append("customName",t.editName),t.editNameTamil&&A.append("nameTamil",t.editNameTamil),t.labelNetQty&&A.append("netQty",t.labelNetQty),t.labelPackedDate&&A.append("packedDate",t.labelPackedDate),t.labelExpiryDate&&A.append("expiryDate",t.labelExpiryDate),A.append("image",t.editImageFile),ee=yield t.http.patch(`${t.apiUrl}/shop-products/${u}/quick-update`,A).toPromise()}else ee=yield t.http.patch(`${t.apiUrl}/shop-products/${u}/quick-update`,p).toPromise();return ee?.statusCode&&"0000"!==ee.statusCode?(t.isSavingEdit=!1,void t.swal.error("Validation Error",ee.message||"Failed to update product")):(t.editImagePreview&&(p.imageBase64=t.editImagePreview),yield t.updateLocalProductData(u,p),yield t.offlineStorage.updateLocalProduct(u,{price:p.price,originalPrice:p.originalPrice,stock:p.stockQuantity,sku:p.sku,barcode:p.barcode,barcode1:p.barcode1,barcode2:p.barcode2,barcode3:p.barcode3,name:p.customName,nameTamil:p.nameTamil,imageBase64:p.imageBase64,netQty:p.netQty,packedDate:p.packedDate,expiryDate:p.expiryDate}).catch(A=>console.warn("Failed to update cache:",A)),localStorage.setItem(t.POS_CACHE_TIMESTAMP_KEY,Date.now().toString()),t.swal.success("Updated","Product updated successfully"),void t.closeQuickEdit())}catch(ee){if(console.log("API Error caught:",ee),ee?.status&&0!==ee.status)return t.isSavingEdit=!1,void t.swal.error("Error",ee?.error?.message||ee?.message||"Failed to update product");console.warn("Network error, saving offline:",ee)}const _=t.editingProduct?.barcode1?.toLowerCase()||"",C=t.editingProduct?.barcode2?.toLowerCase()||"",P=t.editingProduct?.barcode3?.toLowerCase()||"",x=(t.editBarcode1||"").toLowerCase(),k=(t.editBarcode2||"").toLowerCase(),F=(t.editBarcode3||"").toLowerCase(),S=x!==_,w=k!==C,W=F!==P;if(S||w||W){const ee=yield t.offlineStorage.validateBarcodes(S?t.editBarcode1:null,w?t.editBarcode2:null,W?t.editBarcode3:null,u);if(ee)return t.isSavingEdit=!1,void t.swal.error("Duplicate Barcode",ee)}const K={editId:t.offlineStorage.generateOfflineEditId(),productId:u,shopId:t.shopId,changes:{price:t.editPrice,originalPrice:t.editMrp,stockQuantity:t.editStock,sku:t.editSku,barcode:t.editBarcode,barcode1:t.editBarcode1,barcode2:t.editBarcode2,barcode3:t.editBarcode3,customName:t.editName,nameTamil:t.editNameTamil,netQty:t.labelNetQty,packedDate:t.labelPackedDate,expiryDate:t.labelExpiryDate},previousValues:f,createdAt:(new Date).toISOString(),synced:!1};yield t.offlineStorage.saveOfflineEdit(K),t.editImagePreview&&(p.imageBase64=t.editImagePreview),yield t.updateLocalProductData(u,p),yield t.offlineStorage.updateLocalProduct(u,{price:t.editPrice,originalPrice:t.editMrp,stock:t.editStock,sku:t.editSku,barcode:t.editBarcode,barcode1:t.editBarcode1,barcode2:t.editBarcode2,barcode3:t.editBarcode3,name:t.editName,nameTamil:t.editNameTamil,imageBase64:t.editImagePreview||void 0,netQty:t.labelNetQty,packedDate:t.labelPackedDate,expiryDate:t.labelExpiryDate}),u<0&&(yield t.offlineStorage.applyEditToProductCreation(u,{price:t.editPrice,originalPrice:t.editMrp,stockQuantity:t.editStock,sku:t.editSku,barcode1:t.editBarcode1,barcode2:t.editBarcode2,barcode3:t.editBarcode3,customName:t.editName,nameTamil:t.editNameTamil})),t.swal.success("Saved Offline","Changes saved locally. Will sync when online."),t.closeQuickEdit()}catch(h){console.error("Failed to save product edit:",h),t.swal.error("Error",h.message||"Failed to save product edit")}finally{t.isSavingEdit=!1}})()}updateLocalProductData(t,r){var i=this;return(0,fe.A)(function*(){const a=i.products.findIndex(u=>u.id===t);-1!==a&&(i.products[a].price=r.price,i.products[a].originalPrice=r.originalPrice,i.products[a].stock=r.stockQuantity,void 0!==r.sku&&(i.products[a].sku=r.sku),i.products[a].barcode=r.barcode,i.products[a].barcode1=r.barcode1,i.products[a].barcode2=r.barcode2,i.products[a].barcode3=r.barcode3,r.customName&&(i.products[a].name=r.customName),void 0!==r.nameTamil&&(i.products[a].nameTamil=r.nameTamil),r.imageBase64&&(i.products[a].imageBase64=r.imageBase64),void 0!==r.netQty&&(i.products[a].netQty=r.netQty),void 0!==r.packedDate&&(i.products[a].packedDate=r.packedDate),void 0!==r.expiryDate&&(i.products[a].expiryDate=r.expiryDate));const s=i.filteredProducts.findIndex(u=>u.id===t);-1!==s&&(i.filteredProducts[s].price=r.price,i.filteredProducts[s].originalPrice=r.originalPrice,i.filteredProducts[s].stock=r.stockQuantity,void 0!==r.sku&&(i.filteredProducts[s].sku=r.sku),i.filteredProducts[s].barcode=r.barcode,i.filteredProducts[s].barcode1=r.barcode1,i.filteredProducts[s].barcode2=r.barcode2,i.filteredProducts[s].barcode3=r.barcode3,r.customName&&(i.filteredProducts[s].name=r.customName),void 0!==r.nameTamil&&(i.filteredProducts[s].nameTamil=r.nameTamil),r.imageBase64&&(i.filteredProducts[s].imageBase64=r.imageBase64),void 0!==r.netQty&&(i.filteredProducts[s].netQty=r.netQty),void 0!==r.packedDate&&(i.filteredProducts[s].packedDate=r.packedDate),void 0!==r.expiryDate&&(i.filteredProducts[s].expiryDate=r.expiryDate));const l=i.cart.find(u=>u.product.id===t);l&&(l.product.price=r.price,l.product.originalPrice=r.originalPrice,l.product.stock=r.stockQuantity,r.customName&&(l.product.name=r.customName),void 0!==r.nameTamil&&(l.product.nameTamil=r.nameTamil),r.imageBase64&&(l.product.imageBase64=r.imageBase64),l.unitPrice=r.price,l.mrp=r.originalPrice,l.discount=r.originalPrice-r.price,l.total=l.quantity*r.price,i.calculateTotals()),navigator.onLine&&(yield i.offlineStorage.saveProducts(i.products,i.shopId))})()}resolveCartProductIds(){var t=this;return(0,fe.A)(function*(){const r=yield t.offlineStorage.getProducts();return t.cart.map(i=>{let a=i.product.id;if(a<0){const s=i.product.barcode1||i.product.barcode||"";if(s){const l=r.find(u=>u.id>0&&(u.barcode1===s||u.barcode===s));l&&(console.log(`Resolved temp ID ${a} to ${l.id} via barcode ${s}`),a=l.id)}if(a<0){const l=i.product.name.toLowerCase(),u=r.find(p=>p.id>0&&p.name.toLowerCase()===l);u&&(console.log(`Resolved temp ID ${a} to ${u.id} via name ${l}`),a=u.id)}}return{shopProductId:a,quantity:i.quantity,unitPrice:i.unitPrice,productName:i.product.name}})})()}updateLocalStockAfterBill(){var t=this;return(0,fe.A)(function*(){for(const r of t.cart){const i=r.product.id,a=r.quantity,s=t.products.findIndex(u=>u.id===i);-1!==s&&t.products[s].trackInventory&&(t.products[s].stock=Math.max(0,(t.products[s].stock||0)-a));const l=t.filteredProducts.findIndex(u=>u.id===i);-1!==l&&t.filteredProducts[l].trackInventory&&(t.filteredProducts[l].stock=Math.max(0,(t.filteredProducts[l].stock||0)-a))}yield t.offlineStorage.saveProducts(t.products,t.shopId)})()}openQuickAdd(){this.showQuickAddDialog=!0,this.customProductName="",this.customProductPrice=0,this.customProductMrp=0,this.customProductQty=1}closeQuickAdd(){this.showQuickAddDialog=!1,this.customProductName="",this.customProductPrice=0,this.customProductMrp=0,this.customProductQty=1}addCustomProduct(){if(!this.customProductName||this.customProductPrice<=0)return void this.swal.error("Invalid Input","Please enter product name and price");const t=this.customProductMrp||this.customProductPrice,r=this.customProductQty||1,i={id:this.customProductIdCounter--,shopId:this.shopId,name:this.customProductName,nameTamil:"",price:this.customProductPrice,originalPrice:t,stock:9999,trackInventory:!1,sku:"CUSTOM",barcode:"",image:"",categoryId:void 0,categoryName:"Custom"};this.cart.unshift({product:i,quantity:r,unitPrice:this.customProductPrice,mrp:t,total:this.customProductPrice*r,discount:t-this.customProductPrice}),this.calculateTotals(),this.closeQuickAdd(),this.swal.success("Added",`${this.customProductName} added to cart`)}openAddProductDialog(){this.showAddProductDialog=!0,this.newProductName="",this.newProductNameTamil="",this.newProductPrice=0,this.newProductMrp=0,this.newProductCostPrice=0,this.newProductStock=0,this.newProductBarcode1="",this.newProductBarcode2="",this.newProductBarcode3="",this.newProductTrackInventory=!0}closeAddProductDialog(){this.showAddProductDialog=!1,this.newProductName="",this.newProductNameTamil="",this.newProductPrice=0,this.newProductMrp=0,this.newProductCostPrice=0,this.newProductStock=0,this.newProductBarcode1="",this.newProductBarcode2="",this.newProductBarcode3="",this.newProductTrackInventory=!0,this.isSavingNewProduct=!1}saveNewProduct(){var t=this;return(0,fe.A)(function*(){if(!t.newProductName||""===t.newProductName.trim())return void t.swal.error("Required","Product name is required");if(t.newProductPrice<=0)return void t.swal.error("Invalid Price","Price must be greater than 0");const r=t.newProductBarcode1?.trim()||"",i=t.newProductBarcode2?.trim()||"",a=t.newProductBarcode3?.trim()||"";if(r&&i&&r.toLowerCase()===i.toLowerCase())return void t.swal.error("Duplicate Barcode","Barcode 1 and Barcode 2 cannot be the same.");if(r&&a&&r.toLowerCase()===a.toLowerCase())return void t.swal.error("Duplicate Barcode","Barcode 1 and Barcode 3 cannot be the same.");if(i&&a&&i.toLowerCase()===a.toLowerCase())return void t.swal.error("Duplicate Barcode","Barcode 2 and Barcode 3 cannot be the same.");const s=[{value:r,label:"Barcode 1"},{value:i,label:"Barcode 2"},{value:a,label:"Barcode 3"}].filter(l=>""!==l.value);for(const l of s){const u=t.products.find(p=>p.barcode1&&p.barcode1.toLowerCase()===l.value.toLowerCase()||p.barcode2&&p.barcode2.toLowerCase()===l.value.toLowerCase()||p.barcode3&&p.barcode3.toLowerCase()===l.value.toLowerCase());if(u)return void t.swal.error("Duplicate Barcode",`${l.label} "${l.value}" already exists for "${u.name}"`)}t.isSavingNewProduct=!0;try{const f=`${t.newProductName.trim().substring(0,3).toUpperCase()}${Date.now().toString().slice(-6)}`,h={shopId:t.shopId,name:t.newProductName.trim(),nameTamil:t.newProductNameTamil?.trim()||"",price:t.newProductPrice,originalPrice:t.newProductMrp||t.newProductPrice,costPrice:t.newProductCostPrice||0,stockQuantity:t.newProductStock||0,trackInventory:t.newProductTrackInventory,barcode1:t.newProductBarcode1?.trim()||"",barcode2:t.newProductBarcode2?.trim()||"",barcode3:t.newProductBarcode3?.trim()||"",customName:t.newProductName.trim(),sku:f},_=yield t.syncService.createProductOffline(h);if(_.success){const C={id:_.tempProductId,shopId:t.shopId,name:t.newProductName.trim(),nameTamil:t.newProductNameTamil?.trim(),price:t.newProductPrice,originalPrice:t.newProductMrp||t.newProductPrice,stock:t.newProductStock||0,trackInventory:t.newProductTrackInventory,sku:f,barcode:t.newProductBarcode1?.trim()||"",barcode1:t.newProductBarcode1?.trim()||"",barcode2:t.newProductBarcode2?.trim(),barcode3:t.newProductBarcode3?.trim(),image:"",categoryId:void 0,categoryName:""};t.products.push(C),t.filteredProducts=t.sortProductsWithCartFirst(t.products),t.closeAddProductDialog(),navigator.onLine?(t.swal.success("Product Added","Product has been added and will sync shortly."),t.syncService.syncPendingProductCreations().then(()=>{console.log("Product creation synced after online create")}).catch(P=>console.warn("Auto-sync after creation failed:",P))):t.swal.success("Saved Offline",_.message)}else t.swal.error("Error",_.message)}catch(l){console.error("Failed to save new product:",l),t.swal.error("Error",l.message||"Failed to save product")}finally{t.isSavingNewProduct=!1}})()}getTotalPendingCount(){return this.syncStatus.pendingOrders+(this.syncStatus.pendingEdits||0)+(this.syncStatus.pendingProductCreations||0)}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(gt.Qq),e.rXU(at.m),e.rXU(t0),e.rXU(Gt.u),e.rXU(Wd),e.rXU($r.h))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-pos-billing"]],viewQuery:function(r,i){if(1&r&&(e.GBs(Lw,5),e.GBs($w,5)),2&r){let a;e.mGM(a=e.lsd())&&(i.searchInput=a.first),e.mGM(a=e.lsd())&&(i.barcodeInput=a.first)}},decls:83,vars:39,consts:[[1,"pos-billing-container"],[1,"pos-content"],[1,"products-panel"],[1,"pos-tabs-row"],[1,"pos-tabs"],[1,"tab-btn","active"],["title","Start a new bill",1,"new-bill-top-btn",3,"click"],[1,"pos-controls"],[1,"language-toggle"],[1,"lang-label"],["color","primary",3,"checked","change"],[1,"sync-status"],[1,"sync-label"],["mat-icon-button","","class","sync-btn",3,"disabled","click",4,"ngIf"],[1,"tab-content",3,"hidden"],[1,"quick-search-bar"],[1,"search-icon"],["type","text","placeholder","Search or scan barcode...","autofocus","",1,"quick-search-input",3,"ngModel","ngModelChange","input","keyup.enter"],["searchInput",""],[1,"barcode-icon"],["mat-icon-button","","class","clear-btn",3,"click",4,"ngIf"],["class","quick-bill-empty",4,"ngIf"],["class","products-grid quick-bill-grid",4,"ngIf"],["class","loading-state",4,"ngIf"],["class","tab-content",4,"ngIf"],[1,"cart-panel"],[1,"cart-header"],["mat-icon-button","","color","warn","title","Clear Cart",3,"click",4,"ngIf"],[1,"cart-items"],[4,"ngFor","ngForOf"],["class","empty-cart",4,"ngIf"],[1,"cart-footer"],[1,"customer-section"],["mat-button","",1,"customer-toggle",3,"click"],["class","customer-form",4,"ngIf"],["class","totals-section",4,"ngIf"],["class","payment-section",4,"ngIf"],[1,"generate-bill-row"],["mat-raised-button","","color","primary",1,"generate-btn",3,"disabled","click"],["mat-stroked-button","","color","accent","class","new-bill-btn","matTooltip","Clear cart and start new bill",3,"click",4,"ngIf"],["mat-icon-button","","matTooltip","Bill Settings",1,"receipt-settings-btn",3,"click"],[1,"fab-container"],["title","Add New Product (Offline)",1,"quick-add-fab","add-product-fab",3,"click"],["title","Quick Add (One-time)",1,"quick-add-fab",3,"click"],["class","quick-edit-overlay",3,"click",4,"ngIf"],["class","label-config-overlay",3,"click",4,"ngIf"],["class","bill-settings-overlay",3,"click",4,"ngIf"],["mat-icon-button","",1,"sync-btn",3,"disabled","click"],["mat-icon-button","",1,"clear-btn",3,"click"],[1,"quick-bill-empty"],[1,"products-grid","quick-bill-grid"],[1,"section-header"],["class","product-card billing-card in-cart",4,"ngFor","ngForOf"],[1,"product-card","billing-card","in-cart"],["title","Edit Price/Stock",1,"quick-edit-btn",3,"click"],[1,"cart-badge"],[1,"product-image",3,"click"],[3,"appOfflineImg","fallback","alt","error",4,"ngIf"],[1,"product-info"],[1,"product-name"],["class","product-sku",4,"ngIf"],["class","product-tags",4,"ngIf"],[1,"billing-controls"],[1,"price-edit"],[1,"price-label"],["type","number","min","0","step","0.01",1,"price-input",3,"value","title","change","click"],[1,"qty-controls"],[1,"qty-btn","minus",3,"click"],["type","number","min","1","step","1",1,"qty-value","qty-input",3,"value","change","click"],[1,"qty-btn","plus",3,"click"],[3,"appOfflineImg","fallback","alt","error"],[1,"product-sku"],[1,"product-tags"],["class","tag",4,"ngFor","ngForOf"],[1,"tag"],["class","product-card billing-card",3,"out-of-stock","in-cart",4,"ngFor","ngForOf","ngForTrackBy"],["class","empty-products",4,"ngIf"],[1,"product-card","billing-card"],["class","cart-badge",4,"ngIf"],["type","number","min","0","step","0.01",1,"price-input",3,"value","change","click"],["type","number","min","0","step","1",1,"qty-value","qty-input",3,"value","change","click"],[1,"add-btn",3,"disabled","click"],[1,"empty-products"],[1,"loading-state"],["diameter","40"],[1,"tab-content"],[1,"search-section"],[1,"search-row"],[1,"search-box"],["type","text","placeholder","Search products by name, SKU, or barcode...",1,"search-input",3,"ngModel","ngModelChange","input"],["mat-icon-button","",3,"click",4,"ngIf"],[1,"barcode-box"],["type","text","placeholder","Scan barcode...",1,"barcode-input",3,"ngModel","ngModelChange","keyup.enter"],["class","products-grid",4,"ngIf"],["mat-icon-button","",3,"click"],[1,"products-grid"],["class","product-card",3,"out-of-stock","in-cart","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"product-card",3,"click"],[1,"product-image"],["class","product-name-secondary",4,"ngIf"],[1,"product-price"],["class","product-stock",4,"ngIf"],[1,"product-name-secondary"],[1,"product-stock"],["mat-icon-button","","color","warn","title","Clear Cart",3,"click"],["class","cart-item",4,"ngIf"],[1,"cart-item"],[1,"item-row-top"],[1,"item-name"],["mat-icon-button","","color","warn",1,"remove-btn",3,"click"],[1,"item-row-bottom"],[1,"item-price-section"],["class","item-mrp",4,"ngIf"],[1,"item-price"],[1,"item-quantity"],["mat-mini-fab","","color","basic",3,"click"],["type","number","min","1","step","1",1,"qty","qty-input",3,"value","change"],[1,"item-total-section"],[1,"item-total"],["class","item-discount",4,"ngIf"],[1,"item-mrp"],[1,"item-discount"],[1,"empty-cart"],[1,"customer-form"],["type","text","placeholder","Customer Name",1,"customer-input",3,"ngModel","ngModelChange"],["type","tel","placeholder","Phone Number",1,"customer-input",3,"ngModel","ngModelChange"],["type","text","placeholder","Notes",1,"customer-input",3,"ngModel","ngModelChange"],[1,"totals-section"],["class","total-row mrp-total",4,"ngIf"],["class","total-row discount-total",4,"ngIf"],[1,"total-row","grand-total"],[1,"total-row","mrp-total"],[1,"mrp-value"],[1,"total-row","discount-total"],[1,"discount-value"],[1,"payment-section"],[1,"payment-label"],[1,"payment-options"],["mat-stroked-button","",3,"selected","click",4,"ngFor","ngForOf"],["class","upi-qr-section",4,"ngIf"],["mat-stroked-button","",3,"click"],[1,"upi-qr-section"],[1,"qr-code-container"],["alt","UPI QR Code",1,"qr-code-img",3,"src"],[1,"upi-info"],[1,"upi-id"],[1,"upi-amount"],["mat-stroked-button","","color","accent","matTooltip","Clear cart and start new bill",1,"new-bill-btn",3,"click"],[1,"quick-edit-overlay",3,"click"],[1,"quick-edit-dialog","compact-dialog",3,"click"],[1,"dialog-header","compact-header"],[1,"header-product-info"],["class","header-image",4,"ngIf"],[1,"header-text"],[1,"sku-badge"],[1,"dialog-content","compact-content"],[1,"names-section"],[1,"name-field"],["type","text","placeholder","Product name in English",1,"name-input",3,"ngModel","ngModelChange"],["type","text","placeholder","\u0baa\u0bca\u0bb0\u0bc1\u0bb3\u0bbf\u0ba9\u0bcd \u0baa\u0bc6\u0baf\u0bb0\u0bcd",1,"name-input","tamil-input",3,"ngModel","ngModelChange"],[1,"image-section"],[1,"current-image"],[1,"image-preview-container"],["alt","New image preview","class","preview-img",3,"src",4,"ngIf"],["alt","Current image","class","preview-img",3,"appOfflineImg","fallback",4,"ngIf"],["class","no-image",4,"ngIf"],["class","remove-image-btn","title","Remove new image",3,"click",4,"ngIf"],[1,"image-upload"],["type","file","accept","image/*",2,"display","none",3,"change"],["imageInput",""],[1,"upload-btn",3,"click"],[1,"upload-hint"],[1,"two-column-grid"],[1,"edit-card"],[1,"card-title"],[1,"card-fields"],[1,"inline-field"],[1,"input-with-prefix"],[1,"prefix"],["type","number","min","0","step","0.01",3,"ngModel","ngModelChange"],["type","number","min","0","step","1",1,"stock-input",3,"ngModel","ngModelChange"],["type","text","placeholder","250g",1,"label-input",3,"ngModel","ngModelChange"],["type","text","placeholder","MM/YY","maxlength","5",1,"label-input",3,"ngModel","input"],[1,"barcode-section"],[1,"barcode-header"],[1,"barcode-grid"],[1,"barcode-field"],["type","text","placeholder","SKU identifier","autocomplete","off",1,"barcode-input-field",3,"ngModel","ngModelChange"],["type","text","placeholder","Primary barcode","autocomplete","off",1,"barcode-input-field",3,"ngModel","ngModelChange"],["type","text","placeholder","Secondary barcode","autocomplete","off",1,"barcode-input-field",3,"ngModel","ngModelChange"],["type","text","placeholder","Tertiary barcode","autocomplete","off",1,"barcode-input-field",3,"ngModel","ngModelChange"],[1,"print-label-inline"],[1,"print-left"],["title","Label Settings",1,"label-config-btn",3,"click"],[1,"print-right"],["type","number","min","1","max","100",1,"qty-input",3,"ngModel","ngModelChange"],[1,"print-btn",3,"click"],[1,"dialog-actions","compact-actions"],["mat-raised-button","","color","primary",3,"disabled","click"],["diameter","16",4,"ngIf"],[4,"ngIf"],[1,"header-image"],[3,"appOfflineImg","fallback","alt"],["alt","New image preview",1,"preview-img",3,"src"],["alt","Current image",1,"preview-img",3,"appOfflineImg","fallback"],[1,"no-image"],["title","Remove new image",1,"remove-image-btn",3,"click"],["diameter","16"],[1,"quick-edit-dialog","quick-add-dialog",3,"click"],[1,"dialog-header"],[1,"dialog-content"],[1,"edit-fields"],[1,"field-group"],["type","text","placeholder","Enter product name",1,"edit-input",3,"ngModel","ngModelChange"],["type","number","min","0","step","0.01","placeholder","0",1,"edit-input",3,"ngModel","ngModelChange"],["type","number","min","0","step","0.01","placeholder","Same as price",1,"edit-input",3,"ngModel","ngModelChange"],["type","number","min","1","step","1","placeholder","1",1,"edit-input",3,"ngModel","ngModelChange"],[1,"custom-product-note"],[1,"dialog-actions"],[1,"quick-edit-dialog","add-product-dialog",3,"click"],["class","offline-badge",4,"ngIf"],[1,"field-row","two-cols"],["type","text","placeholder","Enter product name","required","",1,"edit-input",3,"ngModel","ngModelChange"],["type","text","placeholder","\u0baa\u0bca\u0bb0\u0bc1\u0bb3\u0bbf\u0ba9\u0bcd \u0baa\u0bc6\u0baf\u0bb0\u0bcd",1,"edit-input","tamil-input",3,"ngModel","ngModelChange"],[1,"field-row","three-cols"],["type","number","min","0","step","0.01","placeholder","0","required","",1,"edit-input",3,"ngModel","ngModelChange"],["type","number","min","0","step","1","placeholder","0",1,"edit-input",3,"ngModel","ngModelChange"],["type","text","placeholder","Primary barcode",1,"edit-input",3,"ngModel","ngModelChange"],["type","text","placeholder","Secondary barcode",1,"edit-input",3,"ngModel","ngModelChange"],["type","text","placeholder","Tertiary barcode",1,"edit-input",3,"ngModel","ngModelChange"],[1,"field-group","toggle-group"],["color","primary",3,"ngModel","ngModelChange"],[1,"product-note"],["diameter","18",4,"ngIf"],[1,"offline-badge"],["diameter","18"],[1,"label-config-overlay",3,"click"],[1,"label-config-dialog",3,"click"],[1,"config-header"],[1,"config-content"],[1,"config-section"],[1,"section-title"],[1,"config-field"],["type","text","placeholder","e.g. 250g, 1kg",3,"ngModel","ngModelChange"],[1,"config-field-row"],["type","text","placeholder","MM/YY",3,"ngModel","ngModelChange"],[1,"config-item"],[1,"config-actions"],["mat-raised-button","","color","primary",3,"click"],[1,"bill-settings-overlay",3,"click"],[1,"bill-settings-dialog",3,"click"],[1,"bill-settings-header"],[1,"bill-settings-content"],[1,"settings-section"],[1,"settings-field"],["type","text","placeholder","Enter shop name",3,"ngModel","ngModelChange"],["type","text","placeholder","Enter shop address",3,"ngModel","ngModelChange"],["type","tel","placeholder","e.g. 9876543210",3,"ngModel","ngModelChange"],["type","text","placeholder","e.g. 33XXXXX1234X1ZX",3,"ngModel","ngModelChange"],["type","text","placeholder","14 digit FSSAI number",3,"ngModel","ngModelChange"],["type","text","placeholder","License holder name",3,"ngModel","ngModelChange"],[1,"settings-row"],[1,"settings-field","half"],[3,"ngModel","ngModelChange"],["value","DD/MM/YYYY"],["value","MM/DD/YYYY"],["value","YYYY-MM-DD"],["type","text","placeholder","e.g. INV-",3,"ngModel","ngModelChange"],["value","58mm"],["value","80mm"],["value","A4"],["value","solid"],["value","dashed"],["value","dotted"],["value","none"],[1,"font-size-row"],[1,"font-size-item"],[1,"slider-container"],["type","range","min","12","max","24","step","1",3,"ngModel","ngModelChange"],[1,"font-size-value"],["type","range","min","8","max","16","step","1",3,"ngModel","ngModelChange"],["type","range","min","6","max","14","step","1",3,"ngModel","ngModelChange"],[1,"toggle-grid"],[1,"toggle-item"],["type","text","placeholder","e.g. shopname@ybl or 9876543210@paytm",3,"ngModel","ngModelChange"],[1,"section-hint"],[1,"custom-fields-list"],["class","custom-field-row",4,"ngFor","ngForOf"],[1,"section-order-list"],["class","section-order-item",4,"ngFor","ngForOf"],["type","text","placeholder","Thank you for shopping with us!",3,"ngModel","ngModelChange"],["type","text","placeholder","e.g. No exchange after 7 days",3,"ngModel","ngModelChange"],[1,"bill-settings-actions"],[1,"custom-field-row"],["color","primary",1,"field-toggle",3,"ngModel","ngModelChange"],["type","text","placeholder","Label (e.g., License No)",1,"field-label-input",3,"ngModel","ngModelChange"],["type","text","placeholder","Value (e.g., LIC-12345)",1,"field-value-input",3,"ngModel","ngModelChange"],[1,"field-position-select",3,"ngModel","ngModelChange"],["value","header"],["value","footer"],[1,"section-order-item"],[1,"drag-handle"],[1,"section-label"],[1,"order-buttons"],["mat-icon-button","",1,"order-btn",3,"disabled","click"]],template:function(r,i){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5)(6,"mat-icon"),e.EFF(7,"bolt"),e.k0s(),e.j41(8,"span"),e.EFF(9,"Quick Bill"),e.k0s()(),e.j41(10,"button",6),e.bIt("click",function(){return i.startNewBill()}),e.j41(11,"mat-icon"),e.EFF(12,"add_circle"),e.k0s(),e.j41(13,"span"),e.EFF(14,"New Bill"),e.k0s()()(),e.j41(15,"div",7)(16,"div",8)(17,"span",9),e.EFF(18,"EN"),e.k0s(),e.j41(19,"mat-slide-toggle",10),e.bIt("change",function(){return i.toggleLanguage()}),e.k0s(),e.j41(20,"span",9),e.EFF(21,"\u0ba4\u0bae\u0bbf\u0bb4\u0bcd"),e.k0s()(),e.j41(22,"div",11)(23,"mat-icon"),e.EFF(24),e.k0s(),e.j41(25,"span",12),e.EFF(26),e.k0s()(),e.DNE(27,Gw,3,3,"button",13),e.k0s()(),e.j41(28,"div",14)(29,"div",15)(30,"mat-icon",16),e.EFF(31,"search"),e.k0s(),e.j41(32,"input",17,18),e.bIt("ngModelChange",function(s){return i.searchTerm=s})("input",function(){return i.onSearchChange()})("keyup.enter",function(){return i.onQuickSearchEnter()}),e.k0s(),e.j41(34,"mat-icon",19),e.EFF(35,"qr_code_scanner"),e.k0s(),e.DNE(36,Uw,3,0,"button",20),e.k0s(),e.DNE(37,zw,7,0,"div",21),e.DNE(38,qw,7,2,"div",22),e.DNE(39,rF,3,3,"div",22),e.DNE(40,iF,4,0,"div",23),e.k0s(),e.DNE(41,xF,14,5,"div",24),e.k0s(),e.j41(42,"div",25)(43,"div",26)(44,"h2")(45,"mat-icon"),e.EFF(46,"shopping_cart"),e.k0s(),e.EFF(47),e.k0s(),e.DNE(48,CF,3,0,"button",27),e.k0s(),e.j41(49,"div",28),e.DNE(50,kF,2,1,"ng-container",29),e.DNE(51,OF,7,0,"div",30),e.k0s(),e.j41(52,"div",31)(53,"div",32)(54,"button",33),e.bIt("click",function(){return i.toggleCustomerForm()}),e.j41(55,"mat-icon"),e.EFF(56),e.k0s(),e.EFF(57," Customer Details (Optional) "),e.k0s(),e.DNE(58,yF,4,3,"div",34),e.k0s(),e.DNE(59,FF,9,6,"div",35),e.DNE(60,TF,6,2,"div",36),e.j41(61,"div",37)(62,"button",38),e.bIt("click",function(){return i.generateBill()}),e.j41(63,"mat-icon"),e.EFF(64,"receipt_long"),e.k0s(),e.EFF(65),e.nI1(66,"number"),e.k0s(),e.DNE(67,IF,4,0,"button",39),e.j41(68,"button",40),e.bIt("click",function(){return i.openBillSettingsDialog()}),e.j41(69,"mat-icon"),e.EFF(70,"settings"),e.k0s()()()()()(),e.j41(71,"div",41)(72,"button",42),e.bIt("click",function(){return i.openAddProductDialog()}),e.j41(73,"mat-icon"),e.EFF(74,"add_box"),e.k0s()(),e.j41(75,"button",43),e.bIt("click",function(){return i.openQuickAdd()}),e.j41(76,"mat-icon"),e.EFF(77,"add"),e.k0s()()(),e.DNE(78,$F,132,24,"div",44),e.DNE(79,GF,37,5,"div",44),e.DNE(80,WF,63,16,"div",44),e.DNE(81,qF,73,12,"div",45),e.DNE(82,JF,266,42,"div",46),e.k0s()),2&r&&(e.R7$(17),e.AVh("active",!i.showTamil),e.R7$(2),e.Y8G("checked",i.showTamil),e.R7$(1),e.AVh("active",i.showTamil),e.R7$(2),e.AVh("offline",!i.syncStatus.isOnline)("online",i.syncStatus.isOnline),e.R7$(2),e.JRh(i.syncStatus.isOnline?"cloud_done":"cloud_off"),e.R7$(2),e.JRh(i.syncStatus.isOnline?"Online":"Offline"),e.R7$(1),e.Y8G("ngIf",i.syncStatus.isOnline),e.R7$(1),e.Y8G("hidden","quick"!==i.activeTab),e.R7$(4),e.Y8G("ngModel",i.searchTerm),e.R7$(4),e.Y8G("ngIf",i.searchTerm),e.R7$(1),e.Y8G("ngIf",!i.searchTerm&&0===i.cart.length&&!i.isLoading),e.R7$(1),e.Y8G("ngIf",!i.searchTerm&&i.cart.length>0&&!i.isLoading),e.R7$(1),e.Y8G("ngIf",i.searchTerm&&!i.isLoading),e.R7$(1),e.Y8G("ngIf",i.isLoading),e.R7$(1),e.Y8G("ngIf",!1),e.R7$(6),e.SpI(" Cart (",i.cart.length,") "),e.R7$(1),e.Y8G("ngIf",i.cart.length>0),e.R7$(2),e.Y8G("ngForOf",i.cart),e.R7$(1),e.Y8G("ngIf",0===i.cart.length),e.R7$(5),e.JRh(i.showCustomerForm?"expand_less":"expand_more"),e.R7$(2),e.Y8G("ngIf",i.showCustomerForm),e.R7$(1),e.Y8G("ngIf",i.cart.length>0),e.R7$(1),e.Y8G("ngIf",i.cart.length>0),e.R7$(2),e.Y8G("disabled",0===i.cart.length),e.R7$(3),e.SpI(" Print Bill - \u20b9",e.i5U(66,36,i.totalAmount,"1.0-0")," "),e.R7$(2),e.Y8G("ngIf",i.cart.length>0),e.R7$(11),e.Y8G("ngIf",i.editingProduct),e.R7$(1),e.Y8G("ngIf",i.showQuickAddDialog),e.R7$(1),e.Y8G("ngIf",i.showAddProductDialog),e.R7$(1),e.Y8G("ngIf",i.showLabelConfigDialog),e.R7$(1),e.Y8G("ngIf",i.showBillSettingsDialog))},dependencies:[D.Sq,D.bT,b.xH,b.y7,b.me,b.Q0,b.MR,b.wz,b.BC,b.YS,b.tU,b.VZ,b.zX,b.vS,fi,B.$z,B.iY,B.$0,H.An,X.LG,qe.oV,Ae.sG,D.QX],styles:[".pos-billing-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:calc(100vh - 75px);max-height:calc(100vh - 75px);background:#f5f6fa;overflow:hidden}.pos-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:6px 12px;background:white;border-bottom:1px solid #dfe6e9}.pos-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.pos-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:600;color:#2c3e50}.pos-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .shop-name[_ngcontent-%COMP%]{font-size:12px;color:#7f8c8d;padding-right:8px;border-right:1px solid #dfe6e9}.pos-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.pos-header[_ngcontent-%COMP%]   .cart-header-inline[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:6px 16px;background:linear-gradient(135deg,#3498db,#217dbb);border-radius:8px;color:#fff;font-weight:600;font-size:14px}.pos-header[_ngcontent-%COMP%]   .cart-header-inline[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.pos-header[_ngcontent-%COMP%]   .cart-header-inline[_ngcontent-%COMP%]   .clear-cart-btn[_ngcontent-%COMP%]{width:24px;height:24px;line-height:24px}.pos-header[_ngcontent-%COMP%]   .cart-header-inline[_ngcontent-%COMP%]   .clear-cart-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;color:#fffc}.pos-header[_ngcontent-%COMP%]   .language-toggle[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:6px 12px;border-radius:20px;background:white;border:1px solid #dfe6e9}.pos-header[_ngcontent-%COMP%]   .language-toggle[_ngcontent-%COMP%]   .lang-label[_ngcontent-%COMP%]{font-size:13px;font-weight:500;color:#7f8c8d}.pos-header[_ngcontent-%COMP%]   .language-toggle[_ngcontent-%COMP%]   .lang-label.active[_ngcontent-%COMP%]{color:#3498db;font-weight:600}.pos-header[_ngcontent-%COMP%]   .sync-status[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:6px 12px;border-radius:20px;background:#e8f5e9;color:#27ae60;font-size:13px;font-weight:500}.pos-header[_ngcontent-%COMP%]   .sync-status.offline[_ngcontent-%COMP%]{background:#ffebee;color:#e74c3c}.pos-header[_ngcontent-%COMP%]   .sync-status.syncing[_ngcontent-%COMP%]{background:#fff3e0;color:#f39c12}.pos-header[_ngcontent-%COMP%]   .sync-status[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.pos-header[_ngcontent-%COMP%]   .pending-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:6px 12px;border-radius:20px;background:#f39c12;color:#fff;font-size:12px;font-weight:600;cursor:pointer}.pos-header[_ngcontent-%COMP%]   .pending-badge[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.pos-content[_ngcontent-%COMP%]{display:flex;flex:1;overflow:hidden}.products-panel[_ngcontent-%COMP%]{flex:1 1 auto;min-width:0;display:flex;flex-direction:column;padding:8px 12px;overflow:hidden}.products-panel[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;margin-bottom:16px}.products-panel[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .pos-mode-toggle[_ngcontent-%COMP%]{display:flex;align-items:center}.products-panel[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .pos-mode-toggle[_ngcontent-%COMP%]   mat-radio-group[_ngcontent-%COMP%]{display:flex;gap:16px}.products-panel[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-row[_ngcontent-%COMP%]{display:flex;gap:12px}.products-panel[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%], .products-panel[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .barcode-box[_ngcontent-%COMP%]{display:flex;align-items:center;background:white;border:1px solid #dfe6e9;border-radius:8px;padding:8px 12px}.products-panel[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .products-panel[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .barcode-box[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#7f8c8d;margin-right:8px}.products-panel[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .products-panel[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .barcode-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;border:none;outline:none;font-size:14px;background:transparent}.products-panel[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]{flex:2}.products-panel[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .barcode-box[_ngcontent-%COMP%]{flex:1;max-width:200px}.products-panel[_ngcontent-%COMP%]   .pos-tabs-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:8px;margin-bottom:8px;padding:8px 12px;background:white;border-radius:10px;box-shadow:0 1px 3px #00000014}.products-panel[_ngcontent-%COMP%]   .pos-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.products-panel[_ngcontent-%COMP%]   .pos-controls[_ngcontent-%COMP%]   .language-toggle[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:11px}.products-panel[_ngcontent-%COMP%]   .pos-controls[_ngcontent-%COMP%]   .language-toggle[_ngcontent-%COMP%]   .lang-label[_ngcontent-%COMP%]{color:#7f8c8d}.products-panel[_ngcontent-%COMP%]   .pos-controls[_ngcontent-%COMP%]   .language-toggle[_ngcontent-%COMP%]   .lang-label.active[_ngcontent-%COMP%]{color:#3498db;font-weight:600}.products-panel[_ngcontent-%COMP%]   .pos-controls[_ngcontent-%COMP%]   .sync-status[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:4px 10px;border-radius:16px;font-size:11px;font-weight:600}.products-panel[_ngcontent-%COMP%]   .pos-controls[_ngcontent-%COMP%]   .sync-status[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.products-panel[_ngcontent-%COMP%]   .pos-controls[_ngcontent-%COMP%]   .sync-status.online[_ngcontent-%COMP%]{background:#e8f5e9;color:#27ae60}.products-panel[_ngcontent-%COMP%]   .pos-controls[_ngcontent-%COMP%]   .sync-status.offline[_ngcontent-%COMP%]{background:#ffebee;color:#e74c3c}.products-panel[_ngcontent-%COMP%]   .pos-controls[_ngcontent-%COMP%]   .sync-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px}.products-panel[_ngcontent-%COMP%]   .pos-controls[_ngcontent-%COMP%]   .sync-btn[_ngcontent-%COMP%]   mat-icon.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.products-panel[_ngcontent-%COMP%]   .pos-tabs[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.products-panel[_ngcontent-%COMP%]   .pos-tabs[_ngcontent-%COMP%]   .tab-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:4px;padding:8px 14px;border:1px solid #dfe6e9;background:white;border-radius:6px;font-size:12px;font-weight:500;color:#7f8c8d;cursor:pointer}.products-panel[_ngcontent-%COMP%]   .pos-tabs[_ngcontent-%COMP%]   .tab-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.products-panel[_ngcontent-%COMP%]   .pos-tabs[_ngcontent-%COMP%]   .tab-btn[_ngcontent-%COMP%]:hover{background:#f5f6fa}.products-panel[_ngcontent-%COMP%]   .pos-tabs[_ngcontent-%COMP%]   .tab-btn.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3498db,#2980b9);color:#fff;border-color:#3498db}.products-panel[_ngcontent-%COMP%]   .pos-tabs[_ngcontent-%COMP%]   .new-bill-top-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:5px;padding:7px 12px;border:1.5px dashed #27ae60;background:white;border-radius:6px;font-size:12px;font-weight:500;color:#27ae60;cursor:pointer;transition:all .2s}.products-panel[_ngcontent-%COMP%]   .pos-tabs[_ngcontent-%COMP%]   .new-bill-top-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.products-panel[_ngcontent-%COMP%]   .pos-tabs[_ngcontent-%COMP%]   .new-bill-top-btn[_ngcontent-%COMP%]:hover{background:rgba(39,174,96,.08);border-style:solid}.products-panel[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:hidden}.products-panel[_ngcontent-%COMP%]   .tab-content[hidden][_ngcontent-%COMP%]{display:none!important}.products-panel[_ngcontent-%COMP%]   .quick-search-bar[_ngcontent-%COMP%]{display:flex;align-items:center;background:white;border:2px solid #dfe6e9;border-radius:12px;padding:12px 16px;margin-bottom:16px}.products-panel[_ngcontent-%COMP%]   .quick-search-bar[_ngcontent-%COMP%]:focus-within{border-color:#3498db}.products-panel[_ngcontent-%COMP%]   .quick-search-bar[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{color:#3498db;font-size:24px;width:24px;height:24px;margin-right:12px}.products-panel[_ngcontent-%COMP%]   .quick-search-bar[_ngcontent-%COMP%]   .quick-search-input[_ngcontent-%COMP%]{flex:1;border:none;outline:none;font-size:16px;background:transparent}.products-panel[_ngcontent-%COMP%]   .quick-search-bar[_ngcontent-%COMP%]   .barcode-icon[_ngcontent-%COMP%]{color:#7f8c8d;font-size:20px;width:20px;height:20px;margin-left:8px;opacity:.5}.products-panel[_ngcontent-%COMP%]   .quick-search-bar[_ngcontent-%COMP%]   .clear-btn[_ngcontent-%COMP%]{margin-left:8px;width:28px;height:28px}.products-panel[_ngcontent-%COMP%]   .quick-search-bar[_ngcontent-%COMP%]   .clear-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.products-panel[_ngcontent-%COMP%]   .search-results-dropdown[_ngcontent-%COMP%]{background:white;border:1px solid #dfe6e9;border-radius:12px;box-shadow:0 8px 24px #0000001f;margin-bottom:16px;max-height:320px;overflow-y:auto}.products-panel[_ngcontent-%COMP%]   .search-results-dropdown[_ngcontent-%COMP%]   .search-result-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;cursor:pointer;border-bottom:1px solid #f5f6fa}.products-panel[_ngcontent-%COMP%]   .search-results-dropdown[_ngcontent-%COMP%]   .search-result-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.products-panel[_ngcontent-%COMP%]   .search-results-dropdown[_ngcontent-%COMP%]   .search-result-item[_ngcontent-%COMP%]:hover{background:#e3f2fd}.products-panel[_ngcontent-%COMP%]   .search-results-dropdown[_ngcontent-%COMP%]   .search-result-item[_ngcontent-%COMP%]   .result-image[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:8px;overflow:hidden;background:#f5f6fa;flex-shrink:0}.products-panel[_ngcontent-%COMP%]   .search-results-dropdown[_ngcontent-%COMP%]   .search-result-item[_ngcontent-%COMP%]   .result-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.products-panel[_ngcontent-%COMP%]   .search-results-dropdown[_ngcontent-%COMP%]   .search-result-item[_ngcontent-%COMP%]   .result-image[_ngcontent-%COMP%]   .result-initial[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:600;color:#7f8c8d}.products-panel[_ngcontent-%COMP%]   .search-results-dropdown[_ngcontent-%COMP%]   .search-result-item[_ngcontent-%COMP%]   .result-info[_ngcontent-%COMP%]{flex:1;min-width:0}.products-panel[_ngcontent-%COMP%]   .search-results-dropdown[_ngcontent-%COMP%]   .search-result-item[_ngcontent-%COMP%]   .result-info[_ngcontent-%COMP%]   .result-name[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#2c3e50;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.products-panel[_ngcontent-%COMP%]   .search-results-dropdown[_ngcontent-%COMP%]   .search-result-item[_ngcontent-%COMP%]   .result-info[_ngcontent-%COMP%]   .result-sku[_ngcontent-%COMP%]{font-size:12px;color:#7f8c8d}.products-panel[_ngcontent-%COMP%]   .search-results-dropdown[_ngcontent-%COMP%]   .search-result-item[_ngcontent-%COMP%]   .result-price[_ngcontent-%COMP%]{font-size:16px;font-weight:700;color:#3498db;padding:0 8px}.products-panel[_ngcontent-%COMP%]   .search-results-dropdown[_ngcontent-%COMP%]   .search-result-item[_ngcontent-%COMP%]   .result-stock[_ngcontent-%COMP%]{font-size:12px;color:#27ae60;min-width:70px;text-align:right}.products-panel[_ngcontent-%COMP%]   .search-results-dropdown[_ngcontent-%COMP%]   .search-result-item[_ngcontent-%COMP%]   .result-stock[_ngcontent-%COMP%]   .low-stock[_ngcontent-%COMP%]{color:#f39c12}.products-panel[_ngcontent-%COMP%]   .search-results-dropdown[_ngcontent-%COMP%]   .search-result-item[_ngcontent-%COMP%]   .add-icon[_ngcontent-%COMP%]{color:#7f8c8d;font-size:24px;width:24px;height:24px}.products-panel[_ngcontent-%COMP%]   .no-search-results[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px;padding:16px;background:#fff3e0;border-radius:8px;color:#f39c12;font-size:14px;margin-bottom:16px}.products-panel[_ngcontent-%COMP%]   .no-search-results[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;background:white;border-radius:12px;border:1px solid #dfe6e9;overflow:hidden}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:linear-gradient(135deg,#f8f9fa,#e9ecef);border-bottom:1px solid #dfe6e9}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:15px;font-weight:600;color:#2c3e50;display:flex;align-items:center;gap:8px}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#3498db;font-size:20px;width:20px;height:20px}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .selected-items-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:12px}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .selected-items-list[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px;background:#f5f6fa;border-radius:10px;margin-bottom:10px;border:1px solid #dfe6e9;position:relative}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .selected-items-list[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .selected-items-list[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   .item-image[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:8px;overflow:hidden;background:white;flex-shrink:0;border:1px solid #dfe6e9}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .selected-items-list[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   .item-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .selected-items-list[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   .item-image[_ngcontent-%COMP%]   .item-initial[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:600;color:#7f8c8d}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .selected-items-list[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   .item-details[_ngcontent-%COMP%]{flex:1;min-width:0}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .selected-items-list[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   .item-details[_ngcontent-%COMP%]   .item-name[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#2c3e50;margin-bottom:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .selected-items-list[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   .item-details[_ngcontent-%COMP%]   .item-price-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .selected-items-list[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   .item-details[_ngcontent-%COMP%]   .item-price-info[_ngcontent-%COMP%]   .item-mrp[_ngcontent-%COMP%]{font-size:12px;color:#7f8c8d;text-decoration:line-through}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .selected-items-list[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   .item-details[_ngcontent-%COMP%]   .item-price-info[_ngcontent-%COMP%]   .item-unit-price[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#3498db}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .selected-items-list[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   .item-quantity-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .selected-items-list[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   .item-quantity-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:32px;height:32px;min-width:32px;background:white;border:1px solid #dfe6e9}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .selected-items-list[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   .item-quantity-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#2c3e50}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .selected-items-list[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   .item-quantity-controls[_ngcontent-%COMP%]   .qty-display[_ngcontent-%COMP%]{font-size:16px;font-weight:700;color:#2c3e50;min-width:30px;text-align:center}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .selected-items-list[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   .item-total[_ngcontent-%COMP%]{text-align:right;min-width:80px}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .selected-items-list[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   .item-total[_ngcontent-%COMP%]   .total-amount[_ngcontent-%COMP%]{display:block;font-size:16px;font-weight:700;color:#2c3e50}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .selected-items-list[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   .item-total[_ngcontent-%COMP%]   .item-savings[_ngcontent-%COMP%]{display:block;font-size:11px;color:#27ae60;font-weight:500}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .selected-items-list[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   .remove-item-btn[_ngcontent-%COMP%]{position:absolute;top:4px;right:4px;width:24px;height:24px;min-width:24px;padding:0;background:rgba(231,76,60,.1);border-radius:50%}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .selected-items-list[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   .remove-item-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px;color:#e74c3c}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .empty-selected-items[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px;color:#7f8c8d;text-align:center}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .empty-selected-items[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;margin-bottom:16px;color:#3498db;opacity:.3}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .empty-selected-items[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;font-size:16px;font-weight:500;color:#2c3e50}.products-panel[_ngcontent-%COMP%]   .selected-items-section[_ngcontent-%COMP%]   .empty-selected-items[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px}.products-panel[_ngcontent-%COMP%]   .scanner-mode-hint[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px;color:#7f8c8d;text-align:center}.products-panel[_ngcontent-%COMP%]   .scanner-mode-hint[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;margin-bottom:16px;opacity:.5}.products-panel[_ngcontent-%COMP%]   .scanner-mode-hint[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px}.products-panel[_ngcontent-%COMP%]   .products-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:12px;overflow-y:auto;padding-right:8px}.products-panel[_ngcontent-%COMP%]   .products-grid[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.products-panel[_ngcontent-%COMP%]   .products-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#dfe6e9;border-radius:3px}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]{background:white;border:1px solid #dfe6e9;border-radius:6px;padding:8px;cursor:pointer;position:relative}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]:hover{border-color:#3498db}.products-panel[_ngcontent-%COMP%]   .product-card.out-of-stock[_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed}.products-panel[_ngcontent-%COMP%]   .product-card.in-cart[_ngcontent-%COMP%]{border:2px solid #27ae60;background:#e8f5e9}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .remove-from-cart-btn[_ngcontent-%COMP%]{position:absolute;top:-8px;left:-8px;background:#e74c3c;color:#fff;width:24px;height:24px;border-radius:50%;border:2px solid white;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:2}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .remove-from-cart-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .cart-badge[_ngcontent-%COMP%]{position:absolute;top:-8px;right:-8px;background:#27ae60;color:#fff;width:26px;height:26px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:700;z-index:1;border:2px solid white}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image[_ngcontent-%COMP%]{width:100%;height:80px;border-radius:6px;overflow:hidden;background:#f5f6fa;display:flex;align-items:center;justify-content:center;margin-bottom:8px}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-name[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#2c3e50;margin-bottom:4px;line-height:1.3;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;min-height:32px}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-name-secondary[_ngcontent-%COMP%]{font-size:10px;color:#7f8c8d;margin-bottom:2px}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-sku[_ngcontent-%COMP%]{font-size:10px;color:#7f8c8d;margin-bottom:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-price[_ngcontent-%COMP%]{font-size:16px;font-weight:700;color:#3498db}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-stock[_ngcontent-%COMP%]{font-size:11px;color:#27ae60;margin-top:4px}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-stock[_ngcontent-%COMP%]   .low-stock[_ngcontent-%COMP%]{color:#f39c12}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-tags[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:4px;margin-top:4px}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-tags[_ngcontent-%COMP%]   .tag[_ngcontent-%COMP%]{font-size:9px;padding:2px 6px;background:#e3f2fd;color:#1976d2;border-radius:10px}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:3px;margin-top:4px;padding-top:4px;border-top:1px dashed #dfe6e9}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .price-edit[_ngcontent-%COMP%]{display:flex;align-items:center;background:#f5f6fa;border:1px solid #dfe6e9;border-radius:4px;padding:2px 4px;min-width:50px}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .price-edit[_ngcontent-%COMP%]   .price-label[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#3498db;margin-right:1px}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .price-edit[_ngcontent-%COMP%]   .price-input[_ngcontent-%COMP%]{width:40px;border:none;background:transparent;font-size:12px;font-weight:600;outline:none;-moz-appearance:textfield}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .price-edit[_ngcontent-%COMP%]   .price-input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .price-edit[_ngcontent-%COMP%]   .price-display[_ngcontent-%COMP%]{font-size:12px;font-weight:600}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .price-edit.price-above-mrp[_ngcontent-%COMP%]{border:2px solid #e74c3c!important;background:rgba(231,76,60,.15)!important}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .price-edit.price-above-mrp[_ngcontent-%COMP%]   .price-label[_ngcontent-%COMP%], .products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .price-edit.price-above-mrp[_ngcontent-%COMP%]   .price-input[_ngcontent-%COMP%]{color:#e74c3c;font-weight:700}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .qty-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1px;background:#f5f6fa;border:1px solid #dfe6e9;border-radius:4px;padding:1px}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .qty-controls[_ngcontent-%COMP%]   .qty-btn[_ngcontent-%COMP%]{width:20px;height:20px;border:none;background:white;border-radius:3px;cursor:pointer;display:flex;align-items:center;justify-content:center}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .qty-controls[_ngcontent-%COMP%]   .qty-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px;color:#7f8c8d}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .qty-controls[_ngcontent-%COMP%]   .qty-btn[_ngcontent-%COMP%]:hover{background:#3498db}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .qty-controls[_ngcontent-%COMP%]   .qty-btn[_ngcontent-%COMP%]:hover   mat-icon[_ngcontent-%COMP%]{color:#fff}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .qty-controls[_ngcontent-%COMP%]   .qty-btn.minus[_ngcontent-%COMP%]:hover{background:#e74c3c}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .qty-controls[_ngcontent-%COMP%]   .qty-btn.plus[_ngcontent-%COMP%]:hover{background:#27ae60}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .qty-controls[_ngcontent-%COMP%]   .qty-value[_ngcontent-%COMP%]{font-size:12px;font-weight:600;min-width:16px;text-align:center}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .qty-controls[_ngcontent-%COMP%]   .qty-value.qty-input[_ngcontent-%COMP%]{width:32px;border:none;background:transparent;outline:none;padding:0;-moz-appearance:textfield}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .qty-controls[_ngcontent-%COMP%]   .qty-value.qty-input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .qty-controls[_ngcontent-%COMP%]   .qty-value.qty-input[_ngcontent-%COMP%]:focus{background:white;border-radius:3px}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .add-btn[_ngcontent-%COMP%]{width:24px;height:24px;min-width:24px;border:none;background:#27ae60;border-radius:4px;cursor:pointer;display:flex;align-items:center;justify-content:center}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .add-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px;color:#fff}.products-panel[_ngcontent-%COMP%]   .product-card[_ngcontent-%COMP%]   .billing-controls[_ngcontent-%COMP%]   .add-btn[_ngcontent-%COMP%]:disabled{background:#dfe6e9;cursor:not-allowed}.products-panel[_ngcontent-%COMP%]   .product-card.billing-card[_ngcontent-%COMP%]{cursor:default}.products-panel[_ngcontent-%COMP%]   .product-card.billing-card[_ngcontent-%COMP%]   .product-image[_ngcontent-%COMP%]{cursor:pointer}.products-panel[_ngcontent-%COMP%]   .quick-bill-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:8px}.products-panel[_ngcontent-%COMP%]   .quick-bill-grid[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{grid-column:1/-1;display:flex;align-items:center;gap:6px;padding:8px 12px;background:rgba(52,152,219,.1);border-radius:6px;margin-bottom:4px;color:#2c3e50;font-weight:500;font-size:13px}.products-panel[_ngcontent-%COMP%]   .quick-bill-grid[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#3498db}.products-panel[_ngcontent-%COMP%]   .quick-bill-empty[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;text-align:center}.products-panel[_ngcontent-%COMP%]   .quick-bill-empty[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:60px;width:60px;height:80px;color:#3498db;opacity:.3;margin-bottom:24px}.products-panel[_ngcontent-%COMP%]   .quick-bill-empty[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:20px;font-weight:600;color:#2c3e50}.products-panel[_ngcontent-%COMP%]   .quick-bill-empty[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#7f8c8d}.products-panel[_ngcontent-%COMP%]   .empty-products[_ngcontent-%COMP%], .products-panel[_ngcontent-%COMP%]   .loading-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px;color:#7f8c8d}.products-panel[_ngcontent-%COMP%]   .empty-products[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .products-panel[_ngcontent-%COMP%]   .loading-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:16px;opacity:.5}.products-panel[_ngcontent-%COMP%]   .empty-products[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .products-panel[_ngcontent-%COMP%]   .loading-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px}.cart-panel[_ngcontent-%COMP%]{width:380px;min-width:340px;flex-shrink:0;background:white;border-left:1px solid #dfe6e9;display:flex;flex-direction:column;overflow:hidden}.cart-panel.no-header[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]{padding-top:8px}.cart-panel[_ngcontent-%COMP%]   .cart-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid #dfe6e9}.cart-panel[_ngcontent-%COMP%]   .cart-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:600;color:#2c3e50;display:flex;align-items:center;gap:8px}.cart-panel[_ngcontent-%COMP%]   .cart-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#3498db}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:8px 12px}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]{background:#f5f6fa;border-radius:10px;padding:12px;margin-bottom:10px;border:1px solid #dfe6e9}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .item-row-top[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .item-row-top[_ngcontent-%COMP%]   .item-name[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#2c3e50;line-height:1.4;flex:1;padding-right:8px}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .item-row-top[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%]{width:28px;height:28px;min-width:28px;background:rgba(231,76,60,.1);border-radius:50%;padding:0;display:flex;align-items:center;justify-content:center}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .item-row-top[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;color:#e74c3c}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .item-row-bottom[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .item-row-bottom[_ngcontent-%COMP%]   .item-price-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:70px}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .item-row-bottom[_ngcontent-%COMP%]   .item-price-section[_ngcontent-%COMP%]   .item-mrp[_ngcontent-%COMP%]{font-size:11px;color:#999;text-decoration:line-through}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .item-row-bottom[_ngcontent-%COMP%]   .item-price-section[_ngcontent-%COMP%]   .item-price[_ngcontent-%COMP%], .cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .item-row-bottom[_ngcontent-%COMP%]   .item-price[_ngcontent-%COMP%]{font-size:13px;color:#7f8c8d}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .item-row-bottom[_ngcontent-%COMP%]   .item-quantity[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .item-row-bottom[_ngcontent-%COMP%]   .item-quantity[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:28px!important;height:28px!important;background:white;border:1px solid #dfe6e9}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .item-row-bottom[_ngcontent-%COMP%]   .item-quantity[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .item-row-bottom[_ngcontent-%COMP%]   .item-quantity[_ngcontent-%COMP%]   .qty[_ngcontent-%COMP%]{min-width:28px;text-align:center;font-weight:700;font-size:16px;color:#2c3e50}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .item-row-bottom[_ngcontent-%COMP%]   .item-quantity[_ngcontent-%COMP%]   .qty.qty-input[_ngcontent-%COMP%]{width:40px;border:1px solid #dfe6e9;border-radius:4px;background:white;outline:none;padding:2px 4px;-moz-appearance:textfield}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .item-row-bottom[_ngcontent-%COMP%]   .item-quantity[_ngcontent-%COMP%]   .qty.qty-input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .item-row-bottom[_ngcontent-%COMP%]   .item-quantity[_ngcontent-%COMP%]   .qty.qty-input[_ngcontent-%COMP%]:focus{border-color:#3498db}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .item-row-bottom[_ngcontent-%COMP%]   .item-total-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;min-width:80px}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .item-row-bottom[_ngcontent-%COMP%]   .item-total-section[_ngcontent-%COMP%]   .item-total[_ngcontent-%COMP%]{font-size:16px;font-weight:700;color:#3498db}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .item-row-bottom[_ngcontent-%COMP%]   .item-total-section[_ngcontent-%COMP%]   .item-discount[_ngcontent-%COMP%]{font-size:10px;color:#4caf50;font-weight:600}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .cart-item[_ngcontent-%COMP%]   .item-row-bottom[_ngcontent-%COMP%]   .item-total[_ngcontent-%COMP%]{font-size:16px;font-weight:700;color:#3498db;min-width:70px;text-align:right}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .empty-cart[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:150px;color:#7f8c8d}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .empty-cart[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;opacity:.3;margin-bottom:12px}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .empty-cart[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 4px;font-size:16px;font-weight:500}.cart-panel[_ngcontent-%COMP%]   .cart-items[_ngcontent-%COMP%]   .empty-cart[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px}.cart-panel[_ngcontent-%COMP%]   .cart-footer[_ngcontent-%COMP%]{flex-shrink:0;border-top:1px solid #dfe6e9;background:white;max-height:40%;overflow-y:auto}.cart-panel[_ngcontent-%COMP%]   .customer-section[_ngcontent-%COMP%]{border-top:1px solid #dfe6e9;padding:8px 12px}.cart-panel[_ngcontent-%COMP%]   .customer-section[_ngcontent-%COMP%]   .customer-toggle[_ngcontent-%COMP%]{width:100%;justify-content:flex-start;color:#7f8c8d}.cart-panel[_ngcontent-%COMP%]   .customer-section[_ngcontent-%COMP%]   .customer-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;margin-top:8px}.cart-panel[_ngcontent-%COMP%]   .customer-section[_ngcontent-%COMP%]   .customer-form[_ngcontent-%COMP%]   .customer-input[_ngcontent-%COMP%]{padding:10px 12px;border:1px solid #dfe6e9;border-radius:6px;font-size:14px;outline:none}.cart-panel[_ngcontent-%COMP%]   .customer-section[_ngcontent-%COMP%]   .customer-form[_ngcontent-%COMP%]   .customer-input[_ngcontent-%COMP%]:focus{border-color:#3498db}.cart-panel[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]{padding:8px 12px;border-top:1px solid #dfe6e9;background:#f5f6fa}.cart-panel[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:4px;font-size:13px;color:#7f8c8d}.cart-panel[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-row.mrp-total[_ngcontent-%COMP%]   .mrp-value[_ngcontent-%COMP%]{text-decoration:line-through;color:#999}.cart-panel[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-row.discount-total[_ngcontent-%COMP%]   .discount-value[_ngcontent-%COMP%]{color:#4caf50;font-weight:600}.cart-panel[_ngcontent-%COMP%]   .totals-section[_ngcontent-%COMP%]   .total-row.grand-total[_ngcontent-%COMP%]{margin-top:6px;padding-top:6px;border-top:2px solid #2c3e50;font-size:16px;font-weight:700;color:#2c3e50}.cart-panel[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]{padding:8px 12px;border-top:1px solid #dfe6e9}.cart-panel[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]   .payment-label[_ngcontent-%COMP%]{font-size:12px;color:#7f8c8d;margin-bottom:6px}.cart-panel[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]   .payment-options[_ngcontent-%COMP%]{display:flex;gap:6px}.cart-panel[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]   .payment-options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;padding:10px 8px;font-size:12px;border-radius:8px}.cart-panel[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]   .payment-options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px}.cart-panel[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]   .payment-options[_ngcontent-%COMP%]   button.selected[_ngcontent-%COMP%]{background:#3498db;color:#fff;border-color:#3498db}.cart-panel[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]   .upi-qr-section[_ngcontent-%COMP%]{margin-top:12px;padding:12px;background:#f8f9fa;border-radius:12px;border:1px solid #dee2e6;display:flex;flex-direction:column;align-items:center;gap:8px}.cart-panel[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]   .upi-qr-section[_ngcontent-%COMP%]   .qr-code-container[_ngcontent-%COMP%]{background:white;padding:8px;border-radius:8px}.cart-panel[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]   .upi-qr-section[_ngcontent-%COMP%]   .qr-code-container[_ngcontent-%COMP%]   .qr-code-img[_ngcontent-%COMP%]{width:150px;height:150px;display:block}.cart-panel[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]   .upi-qr-section[_ngcontent-%COMP%]   .upi-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:4px}.cart-panel[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]   .upi-qr-section[_ngcontent-%COMP%]   .upi-info[_ngcontent-%COMP%]   .upi-id[_ngcontent-%COMP%]{font-size:12px;color:#7f8c8d;font-family:monospace;background:white;padding:4px 8px;border-radius:4px}.cart-panel[_ngcontent-%COMP%]   .payment-section[_ngcontent-%COMP%]   .upi-qr-section[_ngcontent-%COMP%]   .upi-info[_ngcontent-%COMP%]   .upi-amount[_ngcontent-%COMP%]{font-size:16px;font-weight:700;color:#27ae60}.cart-panel[_ngcontent-%COMP%]   .generate-bill-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;margin:8px 12px 12px;flex-wrap:wrap}.cart-panel[_ngcontent-%COMP%]   .generate-bill-row[_ngcontent-%COMP%]   .generate-btn[_ngcontent-%COMP%]{flex:1;min-width:140px;margin:0;padding:12px;font-size:14px;font-weight:600;border-radius:8px}.cart-panel[_ngcontent-%COMP%]   .generate-bill-row[_ngcontent-%COMP%]   .generate-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:6px;font-size:18px}.cart-panel[_ngcontent-%COMP%]   .generate-bill-row[_ngcontent-%COMP%]   .new-bill-btn[_ngcontent-%COMP%]{padding:10px 12px;font-size:12px;font-weight:500;border-radius:8px;border-color:#ff9800;color:#ff9800}.cart-panel[_ngcontent-%COMP%]   .generate-bill-row[_ngcontent-%COMP%]   .new-bill-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:4px;font-size:16px}.cart-panel[_ngcontent-%COMP%]   .generate-bill-row[_ngcontent-%COMP%]   .new-bill-btn[_ngcontent-%COMP%]:hover{background:rgba(255,152,0,.1)}.cart-panel[_ngcontent-%COMP%]   .generate-bill-row[_ngcontent-%COMP%]   .receipt-settings-btn[_ngcontent-%COMP%]{width:40px;height:40px;background:#f0f0f0;border-radius:8px}.cart-panel[_ngcontent-%COMP%]   .generate-bill-row[_ngcontent-%COMP%]   .receipt-settings-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#7f8c8d}.cart-panel[_ngcontent-%COMP%]   .generate-btn[_ngcontent-%COMP%]{margin:8px 12px 12px;padding:12px;font-size:14px;font-weight:600;border-radius:8px}.cart-panel[_ngcontent-%COMP%]   .generate-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:6px;font-size:18px}@media (max-width: 1024px){.pos-content[_ngcontent-%COMP%]{flex-direction:column}.cart-panel[_ngcontent-%COMP%]{width:100%;max-height:50vh;border-left:none;border-top:1px solid #dfe6e9}.products-panel[_ngcontent-%COMP%]   .products-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(120px,1fr))}}@media (max-width: 600px){.pos-header[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.pos-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{width:100%;justify-content:space-between}.search-section[_ngcontent-%COMP%]{flex-direction:column}.search-section[_ngcontent-%COMP%]   .barcode-box[_ngcontent-%COMP%]{max-width:100%!important}}.quick-edit-btn[_ngcontent-%COMP%]{position:absolute;top:4px;left:4px;width:28px;height:28px;border-radius:50%;border:none;background:rgba(255,255,255,.95);color:#7f8c8d;cursor:pointer;display:flex;align-items:center;justify-content:center;z-index:2;opacity:0}.quick-edit-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.product-card[_ngcontent-%COMP%]:hover   .quick-edit-btn[_ngcontent-%COMP%]{opacity:1}.fab-container[_ngcontent-%COMP%]{position:fixed;bottom:24px;left:24px;display:flex;flex-direction:column;gap:12px;z-index:100}.quick-add-fab[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:50%;border:none;background:linear-gradient(135deg,#27ae60,#2ecc71);color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 12px #27ae6066}.quick-add-fab[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px}.quick-add-fab.add-product-fab[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3498db,#2980b9);box-shadow:0 4px 12px #3498db66}.quick-edit-overlay[_ngcontent-%COMP%], .label-config-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.quick-edit-dialog[_ngcontent-%COMP%]{background:white;border-radius:16px;width:90%;max-width:500px;max-height:90vh;box-shadow:0 10px 40px #0003;animation:_ngcontent-%COMP%_slideUp .3s ease;overflow-y:auto}.quick-edit-dialog.quick-add-dialog[_ngcontent-%COMP%]{max-width:360px}.quick-edit-dialog.add-product-dialog[_ngcontent-%COMP%]{max-width:480px}.quick-edit-dialog.add-product-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3498db,#2980b9)}.quick-edit-dialog.add-product-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.quick-edit-dialog.add-product-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:22px;width:22px;height:22px}.quick-edit-dialog.add-product-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   .offline-badge[_ngcontent-%COMP%]{font-size:12px;background:rgba(255,255,255,.2);padding:2px 8px;border-radius:12px;margin-left:8px}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;background:linear-gradient(135deg,#2c3e50,#34495e);color:#fff}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#fff}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]{padding:20px}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .product-preview[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px;padding-bottom:16px;border-bottom:1px solid #dfe6e9}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .product-preview[_ngcontent-%COMP%]   .preview-image[_ngcontent-%COMP%]{width:80px;height:80px;margin:0 auto 12px;border-radius:8px;overflow:hidden;background:#f5f6fa}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .product-preview[_ngcontent-%COMP%]   .preview-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .product-preview[_ngcontent-%COMP%]   .preview-name[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin-bottom:4px}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .product-preview[_ngcontent-%COMP%]   .preview-sku[_ngcontent-%COMP%]{font-size:12px;color:#7f8c8d}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .edit-fields[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .edit-fields[_ngcontent-%COMP%]   .field-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .edit-fields[_ngcontent-%COMP%]   .field-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:13px;font-weight:600;color:#7f8c8d}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .edit-fields[_ngcontent-%COMP%]   .field-group[_ngcontent-%COMP%]   .edit-input[_ngcontent-%COMP%]{padding:12px 14px;border:1px solid #dfe6e9;border-radius:8px;font-size:16px;outline:none}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .edit-fields[_ngcontent-%COMP%]   .field-group[_ngcontent-%COMP%]   .edit-input[_ngcontent-%COMP%]:focus{border-color:#3498db}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .edit-fields[_ngcontent-%COMP%]   .field-group.toggle-group[_ngcontent-%COMP%]{flex-direction:row;align-items:center;padding-top:8px}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .edit-fields[_ngcontent-%COMP%]   .field-row[_ngcontent-%COMP%]{display:flex;gap:12px}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .edit-fields[_ngcontent-%COMP%]   .field-row[_ngcontent-%COMP%]   .field-group[_ngcontent-%COMP%]{flex:1}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .edit-fields[_ngcontent-%COMP%]   .field-row.two-cols[_ngcontent-%COMP%]   .field-group[_ngcontent-%COMP%], .quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .edit-fields[_ngcontent-%COMP%]   .field-row.three-cols[_ngcontent-%COMP%]   .field-group[_ngcontent-%COMP%]{flex:1;min-width:0}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .edit-fields[_ngcontent-%COMP%]   .field-row.two-cols[_ngcontent-%COMP%]   .field-group[_ngcontent-%COMP%]   .edit-input[_ngcontent-%COMP%], .quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .edit-fields[_ngcontent-%COMP%]   .field-row.three-cols[_ngcontent-%COMP%]   .field-group[_ngcontent-%COMP%]   .edit-input[_ngcontent-%COMP%]{width:100%}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .edit-fields[_ngcontent-%COMP%]   .tamil-input[_ngcontent-%COMP%]{font-family:Noto Sans Tamil,Latha,Arial,sans-serif}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .product-note[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px;margin-top:16px;padding:12px;background:#e3f2fd;border-radius:8px;font-size:12px;color:#1976d2}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .product-note[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .custom-product-note[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px;margin-top:16px;padding:12px;background:#fff8e1;border-radius:8px;font-size:12px;color:#f57c00}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]   .custom-product-note[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.quick-edit-dialog[_ngcontent-%COMP%]   .label-print-section[_ngcontent-%COMP%]{margin:16px 20px;padding:16px;background:#e8f5e9;border-radius:12px;border:1px solid #c8e6c9}.quick-edit-dialog[_ngcontent-%COMP%]   .label-print-section[_ngcontent-%COMP%]   .label-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:12px;font-size:15px;font-weight:600;color:#2e7d32}.quick-edit-dialog[_ngcontent-%COMP%]   .label-print-section[_ngcontent-%COMP%]   .label-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.quick-edit-dialog[_ngcontent-%COMP%]   .label-print-section[_ngcontent-%COMP%]   .label-controls[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:16px;flex-wrap:wrap}.quick-edit-dialog[_ngcontent-%COMP%]   .label-print-section[_ngcontent-%COMP%]   .label-controls[_ngcontent-%COMP%]   .field-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:12px;font-weight:500;color:#7f8c8d;margin-bottom:4px}.quick-edit-dialog[_ngcontent-%COMP%]   .label-print-section[_ngcontent-%COMP%]   .label-controls[_ngcontent-%COMP%]   .field-group[_ngcontent-%COMP%]   .label-qty-input[_ngcontent-%COMP%]{width:80px;padding:10px 12px;font-size:16px;text-align:center}.quick-edit-dialog[_ngcontent-%COMP%]   .label-print-section[_ngcontent-%COMP%]   .label-controls[_ngcontent-%COMP%]   .print-label-btn[_ngcontent-%COMP%]{flex:1;min-width:140px;padding:10px 20px;font-weight:600;background:#43a047}.quick-edit-dialog[_ngcontent-%COMP%]   .label-print-section[_ngcontent-%COMP%]   .label-controls[_ngcontent-%COMP%]   .print-label-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:6px}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;padding:16px 20px;background:#f5f6fa;border-top:1px solid #dfe6e9}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:100px;padding:10px 20px}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:6px;font-size:18px}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{display:inline-block;margin-right:6px}@media (max-width: 600px){.quick-add-fab[_ngcontent-%COMP%]{bottom:16px;left:16px;width:48px;height:48px}.quick-add-fab[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.quick-edit-dialog[_ngcontent-%COMP%]{width:95%;margin:16px}.quick-edit-dialog[_ngcontent-%COMP%]   .dialog-content[_ngcontent-%COMP%]{padding:16px}}.compact-dialog[_ngcontent-%COMP%]{max-width:620px!important;width:95%;border-radius:16px;overflow:hidden;display:flex;flex-direction:column;max-height:94vh;box-shadow:0 20px 60px #0000004d}.compact-dialog[_ngcontent-%COMP%]   .compact-header[_ngcontent-%COMP%]{padding:14px 18px;background:linear-gradient(135deg,#667eea,#764ba2);display:flex;align-items:center;justify-content:space-between}.compact-dialog[_ngcontent-%COMP%]   .compact-header[_ngcontent-%COMP%]   .header-product-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;flex:1;min-width:0}.compact-dialog[_ngcontent-%COMP%]   .compact-header[_ngcontent-%COMP%]   .header-product-info[_ngcontent-%COMP%]   .header-image[_ngcontent-%COMP%]{width:44px;height:44px;border-radius:8px;overflow:hidden;background:rgba(255,255,255,.2)}.compact-dialog[_ngcontent-%COMP%]   .compact-header[_ngcontent-%COMP%]   .header-product-info[_ngcontent-%COMP%]   .header-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.compact-dialog[_ngcontent-%COMP%]   .compact-header[_ngcontent-%COMP%]   .header-product-info[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]{flex:1;min-width:0}.compact-dialog[_ngcontent-%COMP%]   .compact-header[_ngcontent-%COMP%]   .header-product-info[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:15px;font-weight:600;color:#fff;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.compact-dialog[_ngcontent-%COMP%]   .compact-header[_ngcontent-%COMP%]   .header-product-info[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]   .sku-badge[_ngcontent-%COMP%]{display:inline-block;font-size:10px;color:#ffffffe6;background:rgba(255,255,255,.2);padding:2px 8px;border-radius:10px;margin-top:4px}.compact-dialog[_ngcontent-%COMP%]   .compact-header[_ngcontent-%COMP%]   button.mat-icon-button[_ngcontent-%COMP%]{color:#fff;width:34px;height:34px;background:rgba(255,255,255,.2);border-radius:50%}.compact-dialog[_ngcontent-%COMP%]   .compact-content[_ngcontent-%COMP%]{padding:14px;background:#f5f6fa;flex:1;overflow-y:auto;min-height:0}.compact-dialog[_ngcontent-%COMP%]   .names-section[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px}.compact-dialog[_ngcontent-%COMP%]   .names-section[_ngcontent-%COMP%]   .name-field[_ngcontent-%COMP%]{background:white;border-radius:10px;padding:12px;box-shadow:0 1px 4px #00000014}.compact-dialog[_ngcontent-%COMP%]   .names-section[_ngcontent-%COMP%]   .name-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:10px;font-weight:700;color:#667eea;text-transform:uppercase;margin-bottom:8px}.compact-dialog[_ngcontent-%COMP%]   .names-section[_ngcontent-%COMP%]   .name-field[_ngcontent-%COMP%]   .name-input[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border:1.5px solid #e2e8f0;border-radius:8px;font-size:14px;font-weight:600;outline:none;background:#fafbfc;box-sizing:border-box}.compact-dialog[_ngcontent-%COMP%]   .names-section[_ngcontent-%COMP%]   .name-field[_ngcontent-%COMP%]   .name-input[_ngcontent-%COMP%]:focus{border-color:#667eea;background:white}.compact-dialog[_ngcontent-%COMP%]   .names-section[_ngcontent-%COMP%]   .name-field[_ngcontent-%COMP%]   .name-input.tamil-input[_ngcontent-%COMP%]{font-family:Noto Sans Tamil,Arial,sans-serif}.compact-dialog[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;background:white;border-radius:10px;padding:12px;margin-bottom:12px;box-shadow:0 1px 4px #00000014}.compact-dialog[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]   .current-image[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:10px;font-weight:700;color:#667eea;text-transform:uppercase;margin-bottom:8px}.compact-dialog[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]   .current-image[_ngcontent-%COMP%]   .image-preview-container[_ngcontent-%COMP%]{position:relative;width:80px;height:80px;border-radius:10px;overflow:hidden;background:#f0f2f5;border:2px solid #e2e8f0}.compact-dialog[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]   .current-image[_ngcontent-%COMP%]   .image-preview-container[_ngcontent-%COMP%]   .preview-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.compact-dialog[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]   .current-image[_ngcontent-%COMP%]   .image-preview-container[_ngcontent-%COMP%]   .no-image[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;color:#94a3b8}.compact-dialog[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]   .current-image[_ngcontent-%COMP%]   .image-preview-container[_ngcontent-%COMP%]   .no-image[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:28px;margin-bottom:4px}.compact-dialog[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]   .current-image[_ngcontent-%COMP%]   .image-preview-container[_ngcontent-%COMP%]   .no-image[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:10px}.compact-dialog[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]   .current-image[_ngcontent-%COMP%]   .image-preview-container[_ngcontent-%COMP%]   .remove-image-btn[_ngcontent-%COMP%]{position:absolute;top:4px;right:4px;width:22px;height:22px;border-radius:50%;border:none;background:rgba(244,67,54,.9);color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center}.compact-dialog[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]   .image-upload[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.compact-dialog[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]   .image-upload[_ngcontent-%COMP%]   .upload-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 16px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer}.compact-dialog[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]   .image-upload[_ngcontent-%COMP%]   .upload-hint[_ngcontent-%COMP%]{font-size:11px;color:#94a3b8}.compact-dialog[_ngcontent-%COMP%]   .two-column-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px}.compact-dialog[_ngcontent-%COMP%]   .edit-card[_ngcontent-%COMP%]{background:white;border-radius:10px;padding:12px;box-shadow:0 1px 4px #00000014}.compact-dialog[_ngcontent-%COMP%]   .edit-card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:10px;font-weight:700;color:#667eea;text-transform:uppercase;margin-bottom:10px;padding-bottom:8px;border-bottom:1px solid #eef0f5}.compact-dialog[_ngcontent-%COMP%]   .edit-card[_ngcontent-%COMP%]   .card-fields[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.compact-dialog[_ngcontent-%COMP%]   .edit-card[_ngcontent-%COMP%]   .inline-field[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:8px}.compact-dialog[_ngcontent-%COMP%]   .edit-card[_ngcontent-%COMP%]   .inline-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#64748b}.compact-dialog[_ngcontent-%COMP%]   .edit-card[_ngcontent-%COMP%]   .inline-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:70px;padding:7px 8px;border:1.5px solid #e2e8f0;border-radius:6px;font-size:13px;font-weight:700;text-align:right;outline:none;background:#fafbfc}.compact-dialog[_ngcontent-%COMP%]   .edit-card[_ngcontent-%COMP%]   .inline-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#667eea;background:white}.compact-dialog[_ngcontent-%COMP%]   .edit-card[_ngcontent-%COMP%]   .inline-field[_ngcontent-%COMP%]   .input-with-prefix[_ngcontent-%COMP%]{display:flex;align-items:center;border:1.5px solid #e2e8f0;border-radius:6px;background:#fafbfc;max-width:100px}.compact-dialog[_ngcontent-%COMP%]   .edit-card[_ngcontent-%COMP%]   .inline-field[_ngcontent-%COMP%]   .input-with-prefix[_ngcontent-%COMP%]   .prefix[_ngcontent-%COMP%]{padding:7px 8px;background:#eef0f5;color:#64748b;font-size:12px;font-weight:700;border-right:1.5px solid #e2e8f0}.compact-dialog[_ngcontent-%COMP%]   .edit-card[_ngcontent-%COMP%]   .inline-field[_ngcontent-%COMP%]   .input-with-prefix[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:55px;border:none;text-align:right;padding:7px 8px;background:transparent}.compact-dialog[_ngcontent-%COMP%]   .edit-card[_ngcontent-%COMP%]   .inline-field[_ngcontent-%COMP%]   .stock-input[_ngcontent-%COMP%]{width:65px;text-align:center}.compact-dialog[_ngcontent-%COMP%]   .edit-card[_ngcontent-%COMP%]   .inline-field[_ngcontent-%COMP%]   .label-input[_ngcontent-%COMP%]{width:70px;padding:7px 8px;border:1.5px solid #e2e8f0;border-radius:6px;font-size:12px;font-weight:600;text-align:center;outline:none;background:#fafbfc}.compact-dialog[_ngcontent-%COMP%]   .barcode-section[_ngcontent-%COMP%]{background:white;border-radius:10px;padding:12px;margin-bottom:12px;box-shadow:0 1px 4px #00000014}.compact-dialog[_ngcontent-%COMP%]   .barcode-section[_ngcontent-%COMP%]   .barcode-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:10px;font-weight:700;color:#667eea;text-transform:uppercase;margin-bottom:10px;padding-bottom:8px;border-bottom:1px solid #eef0f5}.compact-dialog[_ngcontent-%COMP%]   .barcode-section[_ngcontent-%COMP%]   .barcode-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.compact-dialog[_ngcontent-%COMP%]   .barcode-section[_ngcontent-%COMP%]   .barcode-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:9px;font-weight:700;color:#94a3b8;text-transform:uppercase;margin-bottom:4px}.compact-dialog[_ngcontent-%COMP%]   .barcode-section[_ngcontent-%COMP%]   .barcode-field[_ngcontent-%COMP%]   .barcode-input-field[_ngcontent-%COMP%]{width:100%;padding:8px 10px;border:1.5px solid #e2e8f0;border-radius:6px;font-size:12px;font-weight:600;font-family:monospace;outline:none;background:#fafbfc;box-sizing:border-box}.compact-dialog[_ngcontent-%COMP%]   .barcode-section[_ngcontent-%COMP%]   .barcode-field[_ngcontent-%COMP%]   .barcode-input-field[_ngcontent-%COMP%]:focus{border-color:#667eea;background:white}.compact-dialog[_ngcontent-%COMP%]   .barcode-section[_ngcontent-%COMP%]   .barcode-field[_ngcontent-%COMP%]:first-child   .barcode-input-field[_ngcontent-%COMP%]{border-color:#667eea;background:#f8f9ff}.compact-dialog[_ngcontent-%COMP%]   .print-label-inline[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;background:#e8f5e9;border-radius:8px;padding:10px 12px;border:1px solid #c8e6c9}.compact-dialog[_ngcontent-%COMP%]   .print-label-inline[_ngcontent-%COMP%]   .print-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#2e7d32;font-size:12px;font-weight:600}.compact-dialog[_ngcontent-%COMP%]   .print-label-inline[_ngcontent-%COMP%]   .print-left[_ngcontent-%COMP%]   .label-config-btn[_ngcontent-%COMP%]{width:24px;height:24px;border:none;border-radius:50%;background:rgba(46,125,50,.15);color:#2e7d32;cursor:pointer;margin-left:4px}.compact-dialog[_ngcontent-%COMP%]   .print-label-inline[_ngcontent-%COMP%]   .print-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.compact-dialog[_ngcontent-%COMP%]   .print-label-inline[_ngcontent-%COMP%]   .print-right[_ngcontent-%COMP%]   .qty-input[_ngcontent-%COMP%]{width:50px;padding:6px 8px;border:1.5px solid #a5d6a7;border-radius:6px;font-size:14px;font-weight:700;text-align:center;outline:none;background:white}.compact-dialog[_ngcontent-%COMP%]   .print-label-inline[_ngcontent-%COMP%]   .print-right[_ngcontent-%COMP%]   .print-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:6px 12px;background:#43a047;color:#fff;border:none;border-radius:6px;font-size:12px;font-weight:600;cursor:pointer}.compact-dialog[_ngcontent-%COMP%]   .compact-actions[_ngcontent-%COMP%]{padding:14px 18px;background:#fafbfc;display:flex;justify-content:flex-end;gap:12px;border-top:1px solid #e5e7eb}.compact-dialog[_ngcontent-%COMP%]   .compact-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:100px;padding:10px 24px;font-size:14px;font-weight:600;border-radius:8px;cursor:pointer}.compact-dialog[_ngcontent-%COMP%]   .compact-actions[_ngcontent-%COMP%]   button[mat-stroked-button][_ngcontent-%COMP%]{background:white;border:2px solid #e0e0e0;color:#555}.compact-dialog[_ngcontent-%COMP%]   .compact-actions[_ngcontent-%COMP%]   button[mat-raised-button][_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none}@media (max-width: 480px){.compact-dialog[_ngcontent-%COMP%]{max-width:95%!important}.compact-dialog[_ngcontent-%COMP%]   .names-section[_ngcontent-%COMP%]{grid-template-columns:1fr}.compact-dialog[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.compact-dialog[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]   .current-image[_ngcontent-%COMP%]{width:100%}.compact-dialog[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]   .current-image[_ngcontent-%COMP%]   .image-preview-container[_ngcontent-%COMP%]{width:100%;height:120px}.compact-dialog[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]   .image-upload[_ngcontent-%COMP%]{width:100%}.compact-dialog[_ngcontent-%COMP%]   .image-section[_ngcontent-%COMP%]   .image-upload[_ngcontent-%COMP%]   .upload-btn[_ngcontent-%COMP%]{width:100%;justify-content:center}.compact-dialog[_ngcontent-%COMP%]   .two-column-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.label-config-overlay[_ngcontent-%COMP%]{z-index:1100}.label-config-dialog[_ngcontent-%COMP%]{background:white;border-radius:16px;width:90%;max-width:400px;max-height:90vh;box-shadow:0 20px 60px #0000004d;overflow:hidden;display:flex;flex-direction:column}.label-config-dialog[_ngcontent-%COMP%]   .config-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:14px 20px;background:linear-gradient(135deg,#43a047,#2e7d32);color:#fff}.label-config-dialog[_ngcontent-%COMP%]   .config-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:17px;font-weight:600;display:flex;align-items:center;gap:10px}.label-config-dialog[_ngcontent-%COMP%]   .config-header[_ngcontent-%COMP%]   button.mat-icon-button[_ngcontent-%COMP%]{color:#fff;background:rgba(255,255,255,.15);border-radius:50%;width:32px;height:32px}.label-config-dialog[_ngcontent-%COMP%]   .config-content[_ngcontent-%COMP%]{padding:16px 20px;overflow-y:auto;flex:1}.label-config-dialog[_ngcontent-%COMP%]   .config-section[_ngcontent-%COMP%]{margin-bottom:20px}.label-config-dialog[_ngcontent-%COMP%]   .config-section[_ngcontent-%COMP%]:last-child{margin-bottom:0}.label-config-dialog[_ngcontent-%COMP%]   .config-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:11px;font-weight:700;color:#667eea;text-transform:uppercase;margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid #eef0f5}.label-config-dialog[_ngcontent-%COMP%]   .config-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:10px 0;border-bottom:1px solid #f0f0f0}.label-config-dialog[_ngcontent-%COMP%]   .config-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.label-config-dialog[_ngcontent-%COMP%]   .config-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;font-weight:500}.label-config-dialog[_ngcontent-%COMP%]   .config-field[_ngcontent-%COMP%]{margin-bottom:12px}.label-config-dialog[_ngcontent-%COMP%]   .config-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:11px;font-weight:600;color:#64748b;text-transform:uppercase;margin-bottom:6px}.label-config-dialog[_ngcontent-%COMP%]   .config-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border:1.5px solid #e2e8f0;border-radius:8px;font-size:14px;outline:none;background:#fafbfc}.label-config-dialog[_ngcontent-%COMP%]   .config-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#43a047;background:white}.label-config-dialog[_ngcontent-%COMP%]   .config-field-row[_ngcontent-%COMP%]{display:flex;gap:12px}.label-config-dialog[_ngcontent-%COMP%]   .config-field-row[_ngcontent-%COMP%]   .config-field[_ngcontent-%COMP%]{flex:1}.label-config-dialog[_ngcontent-%COMP%]   .config-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;padding:16px 20px;background:#f5f6fa;border-top:1px solid #e5e7eb}.label-config-dialog[_ngcontent-%COMP%]   .config-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:100px;padding:10px 20px;font-size:14px;font-weight:600;border-radius:8px}.label-config-dialog[_ngcontent-%COMP%]   .config-actions[_ngcontent-%COMP%]   button[mat-stroked-button][_ngcontent-%COMP%]{background:white;border:2px solid #e0e0e0;color:#555}.label-config-dialog[_ngcontent-%COMP%]   .config-actions[_ngcontent-%COMP%]   button[mat-raised-button][_ngcontent-%COMP%]{background:linear-gradient(135deg,#43a047,#2e7d32);color:#fff;border:none}@media (max-width: 480px){.label-config-dialog[_ngcontent-%COMP%]{max-width:95%}.label-config-dialog[_ngcontent-%COMP%]   .config-field-row[_ngcontent-%COMP%]{flex-direction:column}}.bill-settings-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1100}.bill-settings-dialog[_ngcontent-%COMP%]{background:#fff;border-radius:16px;width:95%;max-width:460px;max-height:85vh;box-shadow:0 20px 50px #0000004d;overflow:hidden;display:flex;flex-direction:column}.bill-settings-dialog[_ngcontent-%COMP%]   .bill-settings-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;background:linear-gradient(135deg,#3498db,#2980b9);color:#fff}.bill-settings-dialog[_ngcontent-%COMP%]   .bill-settings-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:17px;font-weight:600;display:flex;align-items:center;gap:10px}.bill-settings-dialog[_ngcontent-%COMP%]   .bill-settings-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:22px;width:22px;height:22px}.bill-settings-dialog[_ngcontent-%COMP%]   .bill-settings-header[_ngcontent-%COMP%]   button.mat-icon-button[_ngcontent-%COMP%]{color:#fff;background:rgba(255,255,255,.2);border-radius:50%;width:32px;height:32px}.bill-settings-dialog[_ngcontent-%COMP%]   .bill-settings-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:16px;background:#f8fafc}.bill-settings-dialog[_ngcontent-%COMP%]   .settings-section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:14px;margin-bottom:12px;box-shadow:0 1px 4px #0000000f;border:1px solid #e2e8f0}.bill-settings-dialog[_ngcontent-%COMP%]   .settings-section[_ngcontent-%COMP%]:last-child{margin-bottom:0}.bill-settings-dialog[_ngcontent-%COMP%]   .settings-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:11px;font-weight:700;color:#3498db;text-transform:uppercase;margin-bottom:12px;padding-bottom:10px;border-bottom:1px solid #e8f4fc}.bill-settings-dialog[_ngcontent-%COMP%]   .settings-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.bill-settings-dialog[_ngcontent-%COMP%]   .settings-field[_ngcontent-%COMP%]{margin-bottom:12px}.bill-settings-dialog[_ngcontent-%COMP%]   .settings-field[_ngcontent-%COMP%]:last-child{margin-bottom:0}.bill-settings-dialog[_ngcontent-%COMP%]   .settings-field.half[_ngcontent-%COMP%]{flex:1;min-width:0}.bill-settings-dialog[_ngcontent-%COMP%]   .settings-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:11px;font-weight:600;color:#64748b;margin-bottom:6px}.bill-settings-dialog[_ngcontent-%COMP%]   .settings-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .bill-settings-dialog[_ngcontent-%COMP%]   .settings-field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border:1.5px solid #e2e8f0;border-radius:8px;font-size:13px;outline:none;background:#fafbfc;box-sizing:border-box}.bill-settings-dialog[_ngcontent-%COMP%]   .settings-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .bill-settings-dialog[_ngcontent-%COMP%]   .settings-field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:#3498db;background:#fff}.bill-settings-dialog[_ngcontent-%COMP%]   .settings-field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{cursor:pointer;appearance:none;background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' viewBox='0 0 10 10'%3E%3Cpath fill='%2364748b' d='M5 7L0 2h10z'/%3E%3C/svg%3E\");background-repeat:no-repeat;background-position:right 12px center;padding-right:32px}.bill-settings-dialog[_ngcontent-%COMP%]   .settings-row[_ngcontent-%COMP%]{display:flex;gap:12px}.bill-settings-dialog[_ngcontent-%COMP%]   .font-size-row[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.bill-settings-dialog[_ngcontent-%COMP%]   .font-size-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;background:#f8fafc;padding:10px 12px;border-radius:8px;border:1px solid #e2e8f0}.bill-settings-dialog[_ngcontent-%COMP%]   .font-size-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#475569;min-width:50px;margin:0}.bill-settings-dialog[_ngcontent-%COMP%]   .font-size-item[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;gap:10px}.bill-settings-dialog[_ngcontent-%COMP%]   .font-size-item[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   input[type=range][_ngcontent-%COMP%]{flex:1;height:6px;border-radius:3px;background:#e2e8f0;outline:none;-webkit-appearance:none;cursor:pointer}.bill-settings-dialog[_ngcontent-%COMP%]   .font-size-item[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;width:18px;height:18px;border-radius:50%;background:#3498db;cursor:pointer;border:2px solid #fff}.bill-settings-dialog[_ngcontent-%COMP%]   .font-size-item[_ngcontent-%COMP%]   .slider-container[_ngcontent-%COMP%]   .font-size-value[_ngcontent-%COMP%]{font-size:12px;font-weight:700;color:#3498db;min-width:40px;text-align:center;background:#e8f4fc;padding:4px 8px;border-radius:6px}.bill-settings-dialog[_ngcontent-%COMP%]   .toggle-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}.bill-settings-dialog[_ngcontent-%COMP%]   .toggle-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:8px 10px;background:#f8fafc;border-radius:8px;border:1px solid #e2e8f0}.bill-settings-dialog[_ngcontent-%COMP%]   .toggle-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;font-weight:500;color:#475569}.bill-settings-dialog[_ngcontent-%COMP%]   .bill-settings-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;padding:14px 20px;background:#fff;border-top:1px solid #e5e7eb}.bill-settings-dialog[_ngcontent-%COMP%]   .bill-settings-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:100px;padding:10px 20px;font-size:13px;font-weight:600;border-radius:8px;cursor:pointer}.bill-settings-dialog[_ngcontent-%COMP%]   .bill-settings-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;margin-right:6px}.bill-settings-dialog[_ngcontent-%COMP%]   .bill-settings-actions[_ngcontent-%COMP%]   button[mat-stroked-button][_ngcontent-%COMP%]{background:#fff;border:1.5px solid #e2e8f0;color:#64748b}.bill-settings-dialog[_ngcontent-%COMP%]   .bill-settings-actions[_ngcontent-%COMP%]   button[mat-raised-button][_ngcontent-%COMP%]{background:linear-gradient(135deg,#3498db,#2980b9);color:#fff;border:none}@media (max-width: 480px){.bill-settings-dialog[_ngcontent-%COMP%]{max-width:98%}.bill-settings-dialog[_ngcontent-%COMP%]   .bill-settings-content[_ngcontent-%COMP%]{padding:12px}.bill-settings-dialog[_ngcontent-%COMP%]   .settings-row[_ngcontent-%COMP%]{flex-direction:column}.bill-settings-dialog[_ngcontent-%COMP%]   .settings-field.half[_ngcontent-%COMP%]{margin-bottom:12px}.bill-settings-dialog[_ngcontent-%COMP%]   .toggle-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.section-hint[_ngcontent-%COMP%]{font-size:11px;color:#64748b;margin:0 0 10px}.custom-fields-list[_ngcontent-%COMP%]   .custom-field-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:6px;background:#f8fafc;border-radius:6px;margin-bottom:6px}.custom-fields-list[_ngcontent-%COMP%]   .custom-field-row[_ngcontent-%COMP%]   .field-label-input[_ngcontent-%COMP%], .custom-fields-list[_ngcontent-%COMP%]   .custom-field-row[_ngcontent-%COMP%]   .field-value-input[_ngcontent-%COMP%]{flex:1;padding:6px 8px;border:1px solid #e2e8f0;border-radius:4px;font-size:11px}.custom-fields-list[_ngcontent-%COMP%]   .custom-field-row[_ngcontent-%COMP%]   .field-label-input[_ngcontent-%COMP%]{max-width:100px}.custom-fields-list[_ngcontent-%COMP%]   .custom-field-row[_ngcontent-%COMP%]   .field-position-select[_ngcontent-%COMP%]{padding:6px;border:1px solid #e2e8f0;border-radius:4px;font-size:10px}.section-order-list[_ngcontent-%COMP%]   .section-order-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px;background:#f8fafc;border-radius:6px;margin-bottom:4px}.section-order-list[_ngcontent-%COMP%]   .section-order-item[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{color:#94a3b8}.section-order-list[_ngcontent-%COMP%]   .section-order-item[_ngcontent-%COMP%]   .section-label[_ngcontent-%COMP%]{flex:1;font-size:12px;color:#475569}.section-order-list[_ngcontent-%COMP%]   .section-order-item[_ngcontent-%COMP%]   .order-buttons[_ngcontent-%COMP%]{display:flex;gap:2px}.section-order-list[_ngcontent-%COMP%]   .section-order-item[_ngcontent-%COMP%]   .order-buttons[_ngcontent-%COMP%]   .order-btn[_ngcontent-%COMP%]{width:26px;height:26px}.section-order-list[_ngcontent-%COMP%]   .section-order-item[_ngcontent-%COMP%]   .order-buttons[_ngcontent-%COMP%]   .order-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px}.section-order-list[_ngcontent-%COMP%]   .section-order-item[_ngcontent-%COMP%]   .order-buttons[_ngcontent-%COMP%]   .order-btn[_ngcontent-%COMP%]:disabled{opacity:.3}"]})}}return n})();var e3=E(6580);function t3(n,o){if(1&n&&(e.j41(0,"span",33),e.EFF(1),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.SpI("Last synced: ",t.getTimeSinceSync(),"")}}function n3(n,o){if(1&n&&(e.j41(0,"div",30)(1,"mat-icon"),e.EFF(2,"cloud_off"),e.k0s(),e.j41(3,"span",31),e.EFF(4,"You're offline. Changes will be saved locally and synced when online."),e.k0s(),e.DNE(5,t3,2,1,"span",32),e.k0s()),2&n){const t=e.XpG();e.R7$(5),e.Y8G("ngIf",t.lastSyncTime)}}function r3(n,o){if(1&n&&(e.j41(0,"mat-option",34),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.Y8G("value",t),e.R7$(1),e.SpI(" ",t," ")}}function i3(n,o){if(1&n&&(e.j41(0,"span",35),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.SpI(" (",t.modifiedProducts.size," pending) ")}}function o3(n,o){1&n&&e.nrm(0,"mat-spinner",36)}function a3(n,o){if(1&n&&(e.j41(0,"span",37),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.E5c(" Showing ",t.currentPageIndex*t.pageSize+1,"-",t.min((t.currentPageIndex+1)*t.pageSize,t.totalProducts)," of ",t.totalProducts," products ")}}function s3(n,o){1&n&&(e.j41(0,"span",37),e.EFF(1," No products found "),e.k0s())}function c3(n,o){if(1&n&&(e.j41(0,"span",38),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.SpI(" \u2022 ",t.modifiedProducts.size," modified (unsaved) ")}}function l3(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",39),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.discardChanges())}),e.j41(1,"mat-icon"),e.EFF(2,"undo"),e.k0s(),e.EFF(3," Discard All "),e.k0s()}}function d3(n,o){1&n&&(e.j41(0,"div",40),e.nrm(1,"mat-spinner",41),e.j41(2,"p"),e.EFF(3,"Loading products..."),e.k0s()())}function u3(n,o){1&n&&(e.j41(0,"mat-icon"),e.EFF(1,"more_vert"),e.k0s())}function g3(n,o){1&n&&e.nrm(0,"mat-spinner",88)}function p3(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",65),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,a=e.XpG(2);return e.Njj(a.removeImage(i))}),e.j41(1,"mat-icon",89),e.EFF(2,"delete"),e.k0s(),e.j41(3,"span"),e.EFF(4,"Remove Image"),e.k0s()()}}function f3(n,o){if(1&n&&(e.j41(0,"option",90),e.EFF(1),e.k0s()),2&n){const t=o.$implicit,r=e.XpG().$implicit;e.Y8G("value",t)("selected",r.category===t),e.R7$(1),e.SpI(" ",t," ")}}function m3(n,o){if(1&n){const t=e.RV6();e.j41(0,"tr")(1,"td",45),e.EFF(2),e.k0s(),e.j41(3,"td",46)(4,"div",59),e.nrm(5,"img",60),e.j41(6,"div",61),e.DNE(7,u3,2,0,"mat-icon",62),e.DNE(8,g3,1,0,"mat-spinner",63),e.k0s()(),e.j41(9,"mat-menu",null,64)(11,"button",65),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.sdS(18),l=e.XpG(2);return e.Njj(l.triggerImageUpload(a,s))}),e.j41(12,"mat-icon"),e.EFF(13,"add_photo_alternate"),e.k0s(),e.j41(14,"span"),e.EFF(15,"Change Image"),e.k0s()(),e.DNE(16,p3,5,0,"button",66),e.k0s(),e.j41(17,"input",67,68),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.onImageSelected(i,s))}),e.k0s()(),e.j41(19,"td",47)(20,"div",69)(21,"input",70),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.onProductNameChange(s,i.target.value))}),e.k0s(),e.j41(22,"a",71)(23,"mat-icon"),e.EFF(24,"image_search"),e.k0s()()()(),e.j41(25,"td",48)(26,"select",72),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.onCategoryDropdownChange(s,i.target))}),e.j41(27,"option",14),e.EFF(28,"-"),e.k0s(),e.DNE(29,f3,2,3,"option",73),e.j41(30,"option",74),e.EFF(31,"+ Add New Category"),e.k0s()()(),e.j41(32,"td",49)(33,"div",75)(34,"input",76),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.onTamilNameChange(s,i.target.value))}),e.k0s(),e.j41(35,"a",77)(36,"mat-icon"),e.EFF(37,"translate"),e.k0s()()()(),e.j41(38,"td",50)(39,"input",78),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.onSkuChange(s,i.target.value))}),e.k0s()(),e.j41(40,"td",51)(41,"input",79),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.onPriceChange(s,i.target.value))}),e.k0s()(),e.j41(42,"td",52)(43,"input",79),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.onMrpChange(s,i.target.value))}),e.k0s()(),e.j41(44,"td",53)(45,"input",80),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.onStockChange(s,i.target.value))}),e.k0s()(),e.j41(46,"td",54)(47,"input",81),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.onBarcode1Change(s,i.target.value))}),e.k0s()(),e.j41(48,"td",54)(49,"input",81),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.onBarcode2Change(s,i.target.value))}),e.k0s()(),e.j41(50,"td",54)(51,"input",81),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.onBarcode3Change(s,i.target.value))}),e.k0s()(),e.j41(52,"td",55)(53,"select",82),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.onStatusDropdownChange(s,i.target.value))}),e.j41(54,"option",83),e.EFF(55,"Active"),e.k0s(),e.j41(56,"option",84),e.EFF(57,"Inactive"),e.k0s()()(),e.j41(58,"td",56)(59,"div",85)(60,"input",86),e.bIt("change",function(i){const s=e.eBV(t).$implicit,l=e.XpG(2);return e.Njj(l.onTagsChange(s,i.target.value))}),e.k0s(),e.j41(61,"button",87),e.bIt("click",function(){const a=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.autoGenerateTags(a))}),e.j41(62,"mat-icon"),e.EFF(63,"auto_fix_high"),e.k0s()()()()()}if(2&n){const t=o.$implicit,r=o.index,i=e.sdS(10),a=e.XpG(2);e.AVh("modified-row",a.isModified(t)),e.R7$(2),e.JRh(a.getRowNumber(r)),e.R7$(2),e.AVh("uploading",a.isUploadingImage(t)),e.Y8G("matMenuTriggerFor",i),e.R7$(1),e.Y8G("appOfflineImg",t.imageUrl)("fallback","assets/images/product-placeholder.svg")("alt",t.customName),e.R7$(2),e.Y8G("ngIf",!a.isUploadingImage(t)),e.R7$(1),e.Y8G("ngIf",a.isUploadingImage(t)),e.R7$(8),e.Y8G("ngIf",t.imageUrl),e.R7$(5),e.AVh("modified",a.isCellModified(t,"customName"))("invalid",!(null!=t.customName&&t.customName.trim())),e.Y8G("value",t.customName),e.R7$(1),e.Y8G("href",a.getImageSearchUrl(t),e.B4B),e.R7$(4),e.AVh("modified",a.isCellModified(t,"category")),e.Y8G("value",t.category||""),e.R7$(3),e.Y8G("ngForOf",a.categories),e.R7$(5),e.AVh("modified",a.isCellModified(t,"nameTamil")),e.Y8G("value",t.nameTamil||""),e.R7$(1),e.Y8G("href",a.getTranslateUrl(t),e.B4B),e.R7$(4),e.AVh("modified",a.isCellModified(t,"sku"))("invalid",a.hasDuplicateError(t,"sku")),e.Y8G("title",a.getDuplicateErrorMessage(t,"sku"))("value",t.sku||""),e.R7$(2),e.AVh("modified",a.isCellModified(t,"price"))("invalid",!a.isValidPrice(t.price)),e.Y8G("value",t.price),e.R7$(2),e.AVh("modified",a.isCellModified(t,"mrp"))("invalid",void 0!==t.originalPrice&&!a.isValidPrice(t.originalPrice)),e.Y8G("value",t.originalPrice),e.R7$(2),e.AVh("modified",a.isCellModified(t,"stock"))("invalid",!a.isValidStock(t.stockQuantity)),e.Y8G("value",t.stockQuantity),e.R7$(2),e.AVh("modified",a.isCellModified(t,"barcode1"))("invalid",a.hasDuplicateError(t,"barcode1")),e.Y8G("title",a.getDuplicateErrorMessage(t,"barcode1"))("value",t.barcode1||""),e.R7$(2),e.AVh("modified",a.isCellModified(t,"barcode2"))("invalid",a.hasDuplicateError(t,"barcode2")),e.Y8G("title",a.getDuplicateErrorMessage(t,"barcode2"))("value",t.barcode2||""),e.R7$(2),e.AVh("modified",a.isCellModified(t,"barcode3"))("invalid",a.hasDuplicateError(t,"barcode3")),e.Y8G("title",a.getDuplicateErrorMessage(t,"barcode3"))("value",t.barcode3||""),e.R7$(2),e.AVh("modified",a.isCellModified(t,"status"))("status-active","ACTIVE"===t.status)("status-inactive","INACTIVE"===t.status),e.Y8G("value",t.status),e.R7$(7),e.AVh("modified",a.isCellModified(t,"tags")),e.Y8G("value",t.tags||"")}}function h3(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",42)(1,"div",43)(2,"table",44)(3,"thead")(4,"tr")(5,"th",45),e.EFF(6,"#"),e.k0s(),e.j41(7,"th",46),e.EFF(8,"IMG"),e.k0s(),e.j41(9,"th",47),e.EFF(10,"PRODUCT NAME"),e.k0s(),e.j41(11,"th",48),e.EFF(12,"CATEGORY"),e.k0s(),e.j41(13,"th",49),e.EFF(14,"TAMIL NAME"),e.k0s(),e.j41(15,"th",50),e.EFF(16,"SKU"),e.k0s(),e.j41(17,"th",51),e.EFF(18,"PRICE"),e.k0s(),e.j41(19,"th",52),e.EFF(20,"MRP"),e.k0s(),e.j41(21,"th",53),e.EFF(22,"STOCK"),e.k0s(),e.j41(23,"th",54),e.EFF(24,"BARCODE 1"),e.k0s(),e.j41(25,"th",54),e.EFF(26,"BARCODE 2"),e.k0s(),e.j41(27,"th",54),e.EFF(28,"BARCODE 3"),e.k0s(),e.j41(29,"th",55),e.EFF(30,"STATUS"),e.k0s(),e.j41(31,"th",56),e.EFF(32,"TAGS"),e.k0s()()(),e.j41(33,"tbody"),e.DNE(34,m3,64,75,"tr",57),e.k0s()()(),e.j41(35,"mat-paginator",58),e.bIt("page",function(i){e.eBV(t);const a=e.XpG();return e.Njj(a.onPageChange(i))}),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(34),e.Y8G("ngForOf",t.paginatedProducts),e.R7$(1),e.Y8G("length",t.totalProducts)("pageSize",t.pageSize)("pageSizeOptions",t.pageSizeOptions)("pageIndex",t.currentPageIndex)}}function _3(n,o){1&n&&(e.j41(0,"div",91)(1,"div",92)(2,"mat-icon"),e.EFF(3,"inventory_2"),e.k0s()(),e.j41(4,"h3"),e.EFF(5,"No products found"),e.k0s(),e.j41(6,"p"),e.EFF(7,"Try adjusting your search or filter criteria."),e.k0s()())}function x3(n,o){1&n&&(e.j41(0,"div",93)(1,"span",94),e.nrm(2,"span",95),e.EFF(3," Modified cell (yellow) "),e.k0s(),e.j41(4,"span",94),e.nrm(5,"span",96),e.EFF(6," Invalid value (red border) "),e.k0s()())}const C3=[{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"summary",component:is},{path:"profile",component:ro},{path:"products-pricing",component:$y},{path:"orders",redirectTo:"orders-management",pathMatch:"full"},{path:"orders-management",component:sk},{path:"delivery-management",component:Rk},{path:"dashboard",component:Bc},{path:"overview",component:sa},{path:"my-products",component:wl},{path:"my-products/add",component:a0},{path:"my-products/edit/:id",component:a0},{path:"my-products/bulk-upload",component:bO},{path:"my-products/categories",component:s0},{path:"browse-products",component:uM},{path:"combos",component:sw},{path:"promo-codes",component:jw},{path:"pos-billing",component:KF},{path:"bulk-edit",component:(()=>{class n{constructor(t,r,i,a,s){this.http=t,this.snackBar=r,this.offlineStorage=i,this.versionService=a,this.dialog=s,this.destroy$=new _n.B,this.searchSubject$=new _n.B,this.apiUrl=Oe.c.apiUrl,this.products=[],this.filteredProducts=[],this.categories=[],this.loading=!1,this.saving=!1,this.searchTerm="",this.selectedCategory="",this.selectedStatus="",this.totalProducts=0,this.pageSize=100,this.pageSizeOptions=[50,100,200,500],this.currentPageIndex=0,this.modifiedProducts=new Map,this.clientVersion="",this.isOffline=!1,this.lastSyncTime=null,this.handleOnline=()=>{console.log("Network online - syncing categories first, then products"),this.isOffline=!1,this.snackBar.open("Back online! Syncing changes...","Close",{duration:3e3}),Cr(this.http,this.apiUrl).then(()=>{this.loadProducts(!0)})},this.handleOffline=()=>{console.log("Network offline - using cached data"),this.isOffline=!0,this.snackBar.open("You are offline. Changes will be saved locally.","Close",{duration:3e3})},this.uploadingImageFor=null,this.tamilToEnglish={\u0b85:"a",\u0b86:"aa",\u0b87:"i",\u0b88:"ee",\u0b89:"u",\u0b8a:"oo",\u0b8e:"e",\u0b8f:"ae",\u0b90:"ai",\u0b92:"o",\u0b93:"oo",\u0b94:"au",\u0b95:"ka",\u0b95\u0bbe:"kaa",\u0b95\u0bbf:"ki",\u0b95\u0bc0:"kee",\u0b95\u0bc1:"ku",\u0b95\u0bc2:"koo",\u0b95\u0bc6:"ke",\u0b95\u0bc7:"kae",\u0b95\u0bc8:"kai",\u0b95\u0bca:"ko",\u0b95\u0bcb:"koo",\u0b95\u0bcc:"kau",\u0b95\u0bcd:"k",\u0b99:"nga",\u0b99\u0bbe:"ngaa",\u0b99\u0bbf:"ngi",\u0b99\u0bc0:"ngee",\u0b99\u0bc1:"ngu",\u0b99\u0bc2:"ngoo",\u0b99\u0bcd:"ng",\u0b9a:"sa",\u0b9a\u0bbe:"saa",\u0b9a\u0bbf:"si",\u0b9a\u0bc0:"see",\u0b9a\u0bc1:"su",\u0b9a\u0bc2:"soo",\u0b9a\u0bc6:"se",\u0b9a\u0bc7:"sae",\u0b9a\u0bc8:"sai",\u0b9a\u0bca:"so",\u0b9a\u0bcb:"soo",\u0b9a\u0bcc:"sau",\u0b9a\u0bcd:"s",\u0b9e:"nya",\u0b9e\u0bbe:"nyaa",\u0b9e\u0bbf:"nyi",\u0b9e\u0bc0:"nyee",\u0b9e\u0bc1:"nyu",\u0b9e\u0bc2:"nyoo",\u0b9e\u0bcd:"ny",\u0b9f:"da",\u0b9f\u0bbe:"daa",\u0b9f\u0bbf:"di",\u0b9f\u0bc0:"dee",\u0b9f\u0bc1:"du",\u0b9f\u0bc2:"doo",\u0b9f\u0bc6:"de",\u0b9f\u0bc7:"dae",\u0b9f\u0bc8:"dai",\u0b9f\u0bca:"do",\u0b9f\u0bcb:"doo",\u0b9f\u0bcc:"dau",\u0b9f\u0bcd:"d",\u0ba3:"na",\u0ba3\u0bbe:"naa",\u0ba3\u0bbf:"ni",\u0ba3\u0bc0:"nee",\u0ba3\u0bc1:"nu",\u0ba3\u0bc2:"noo",\u0ba3\u0bc6:"ne",\u0ba3\u0bc7:"nae",\u0ba3\u0bc8:"nai",\u0ba3\u0bca:"no",\u0ba3\u0bcb:"noo",\u0ba3\u0bcc:"nau",\u0ba3\u0bcd:"n",\u0ba4:"tha",\u0ba4\u0bbe:"thaa",\u0ba4\u0bbf:"thi",\u0ba4\u0bc0:"thee",\u0ba4\u0bc1:"thu",\u0ba4\u0bc2:"thoo",\u0ba4\u0bc6:"the",\u0ba4\u0bc7:"thae",\u0ba4\u0bc8:"thai",\u0ba4\u0bca:"tho",\u0ba4\u0bcb:"thoo",\u0ba4\u0bcc:"thau",\u0ba4\u0bcd:"th",\u0ba8:"na",\u0ba8\u0bbe:"naa",\u0ba8\u0bbf:"ni",\u0ba8\u0bc0:"nee",\u0ba8\u0bc1:"nu",\u0ba8\u0bc2:"noo",\u0ba8\u0bc6:"ne",\u0ba8\u0bc7:"nae",\u0ba8\u0bc8:"nai",\u0ba8\u0bca:"no",\u0ba8\u0bcb:"noo",\u0ba8\u0bcc:"nau",\u0ba8\u0bcd:"n",\u0baa:"pa",\u0baa\u0bbe:"paa",\u0baa\u0bbf:"pi",\u0baa\u0bc0:"pee",\u0baa\u0bc1:"pu",\u0baa\u0bc2:"poo",\u0baa\u0bc6:"pe",\u0baa\u0bc7:"pae",\u0baa\u0bc8:"pai",\u0baa\u0bca:"po",\u0baa\u0bcb:"poo",\u0baa\u0bcc:"pau",\u0baa\u0bcd:"p",\u0bae:"ma",\u0bae\u0bbe:"maa",\u0bae\u0bbf:"mi",\u0bae\u0bc0:"mee",\u0bae\u0bc1:"mu",\u0bae\u0bc2:"moo",\u0bae\u0bc6:"me",\u0bae\u0bc7:"mae",\u0bae\u0bc8:"mai",\u0bae\u0bca:"mo",\u0bae\u0bcb:"moo",\u0bae\u0bcc:"mau",\u0bae\u0bcd:"m",\u0baf:"ya",\u0baf\u0bbe:"yaa",\u0baf\u0bbf:"yi",\u0baf\u0bc0:"yee",\u0baf\u0bc1:"yu",\u0baf\u0bc2:"yoo",\u0baf\u0bc6:"ye",\u0baf\u0bc7:"yae",\u0baf\u0bc8:"yai",\u0baf\u0bca:"yo",\u0baf\u0bcb:"yoo",\u0baf\u0bcc:"yau",\u0baf\u0bcd:"y",\u0bb0:"ra",\u0bb0\u0bbe:"raa",\u0bb0\u0bbf:"ri",\u0bb0\u0bc0:"ree",\u0bb0\u0bc1:"ru",\u0bb0\u0bc2:"roo",\u0bb0\u0bc6:"re",\u0bb0\u0bc7:"rae",\u0bb0\u0bc8:"rai",\u0bb0\u0bca:"ro",\u0bb0\u0bcb:"roo",\u0bb0\u0bcc:"rau",\u0bb0\u0bcd:"r",\u0bb2:"la",\u0bb2\u0bbe:"laa",\u0bb2\u0bbf:"li",\u0bb2\u0bc0:"lee",\u0bb2\u0bc1:"lu",\u0bb2\u0bc2:"loo",\u0bb2\u0bc6:"le",\u0bb2\u0bc7:"lae",\u0bb2\u0bc8:"lai",\u0bb2\u0bca:"lo",\u0bb2\u0bcb:"loo",\u0bb2\u0bcc:"lau",\u0bb2\u0bcd:"l",\u0bb5:"va",\u0bb5\u0bbe:"vaa",\u0bb5\u0bbf:"vi",\u0bb5\u0bc0:"vee",\u0bb5\u0bc1:"vu",\u0bb5\u0bc2:"voo",\u0bb5\u0bc6:"ve",\u0bb5\u0bc7:"vae",\u0bb5\u0bc8:"vai",\u0bb5\u0bca:"vo",\u0bb5\u0bcb:"voo",\u0bb5\u0bcc:"vau",\u0bb5\u0bcd:"v",\u0bb4:"zha",\u0bb4\u0bbe:"zhaa",\u0bb4\u0bbf:"zhi",\u0bb4\u0bc0:"zhee",\u0bb4\u0bc1:"zhu",\u0bb4\u0bc2:"zhoo",\u0bb4\u0bc6:"zhe",\u0bb4\u0bc7:"zhae",\u0bb4\u0bc8:"zhai",\u0bb4\u0bca:"zho",\u0bb4\u0bcb:"zhoo",\u0bb4\u0bcc:"zhau",\u0bb4\u0bcd:"zh",\u0bb3:"la",\u0bb3\u0bbe:"laa",\u0bb3\u0bbf:"li",\u0bb3\u0bc0:"lee",\u0bb3\u0bc1:"lu",\u0bb3\u0bc2:"loo",\u0bb3\u0bc6:"le",\u0bb3\u0bc7:"lae",\u0bb3\u0bc8:"lai",\u0bb3\u0bca:"lo",\u0bb3\u0bcb:"loo",\u0bb3\u0bcc:"lau",\u0bb3\u0bcd:"l",\u0bb1:"ra",\u0bb1\u0bbe:"raa",\u0bb1\u0bbf:"ri",\u0bb1\u0bc0:"ree",\u0bb1\u0bc1:"ru",\u0bb1\u0bc2:"roo",\u0bb1\u0bc6:"re",\u0bb1\u0bc7:"rae",\u0bb1\u0bc8:"rai",\u0bb1\u0bca:"ro",\u0bb1\u0bcb:"roo",\u0bb1\u0bcc:"rau",\u0bb1\u0bcd:"r",\u0ba9:"na",\u0ba9\u0bbe:"naa",\u0ba9\u0bbf:"ni",\u0ba9\u0bc0:"nee",\u0ba9\u0bc1:"nu",\u0ba9\u0bc2:"noo",\u0ba9\u0bc6:"ne",\u0ba9\u0bc7:"nae",\u0ba9\u0bc8:"nai",\u0ba9\u0bca:"no",\u0ba9\u0bcb:"noo",\u0ba9\u0bcc:"nau",\u0ba9\u0bcd:"n",\u0b9c:"ja",\u0b9c\u0bbe:"jaa",\u0b9c\u0bbf:"ji",\u0b9c\u0bc0:"jee",\u0b9c\u0bc1:"ju",\u0b9c\u0bc2:"joo",\u0b9c\u0bc6:"je",\u0b9c\u0bc7:"jae",\u0b9c\u0bc8:"jai",\u0b9c\u0bca:"jo",\u0b9c\u0bcb:"joo",\u0b9c\u0bcc:"jau",\u0b9c\u0bcd:"j",\u0bb7:"sha",\u0bb7\u0bbe:"shaa",\u0bb7\u0bbf:"shi",\u0bb7\u0bc0:"shee",\u0bb7\u0bc1:"shu",\u0bb7\u0bc2:"shoo",\u0bb7\u0bc6:"she",\u0bb7\u0bc7:"shae",\u0bb7\u0bc8:"shai",\u0bb7\u0bca:"sho",\u0bb7\u0bcb:"shoo",\u0bb7\u0bcc:"shau",\u0bb7\u0bcd:"sh",\u0bb8:"sa",\u0bb8\u0bbe:"saa",\u0bb8\u0bbf:"si",\u0bb8\u0bc0:"see",\u0bb8\u0bc1:"su",\u0bb8\u0bc2:"soo",\u0bb8\u0bc6:"se",\u0bb8\u0bc7:"sae",\u0bb8\u0bc8:"sai",\u0bb8\u0bca:"so",\u0bb8\u0bcb:"soo",\u0bb8\u0bcc:"sau",\u0bb8\u0bcd:"s",\u0bb9:"ha",\u0bb9\u0bbe:"haa",\u0bb9\u0bbf:"hi",\u0bb9\u0bc0:"hee",\u0bb9\u0bc1:"hu",\u0bb9\u0bc2:"hoo",\u0bb9\u0bc6:"he",\u0bb9\u0bc7:"hae",\u0bb9\u0bc8:"hai",\u0bb9\u0bca:"ho",\u0bb9\u0bcb:"hoo",\u0bb9\u0bcc:"hau",\u0bb9\u0bcd:"h",\u0b95\u0bcd\u0bb7:"ksha",\u0bb8\u0bcd\u0bb0\u0bc0:"shri"}}ngOnInit(){this.clientVersion=this.versionService.getVersion().replace("v",""),this.isOffline=!navigator.onLine,window.addEventListener("online",this.handleOnline.bind(this)),window.addEventListener("offline",this.handleOffline.bind(this)),this.loadProducts(),this.loadLastSyncTime(),this.searchSubject$.pipe((0,xr.B)(300),(0,Ei.F)(),(0,ot.Q)(this.destroy$)).subscribe(t=>{this.searchTerm=t,this.applyFilters()})}loadLastSyncTime(){var t=this;return(0,fe.A)(function*(){try{t.lastSyncTime=yield t.offlineStorage.getProductsSyncTime(0)}catch(r){console.warn("Error loading last sync time:",r)}})()}getTimeSinceSync(){if(!this.lastSyncTime)return"Never synced";const r=(new Date).getTime()-this.lastSyncTime.getTime(),i=Math.floor(r/6e4);if(i<1)return"Just now";if(1===i)return"1 minute ago";if(i<60)return`${i} minutes ago`;const a=Math.floor(i/60);if(1===a)return"1 hour ago";if(a<24)return`${a} hours ago`;const s=Math.floor(a/24);return 1===s?"1 day ago":`${s} days ago`}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),window.removeEventListener("online",this.handleOnline.bind(this)),window.removeEventListener("offline",this.handleOffline.bind(this))}loadProducts(){var t=this;return(0,fe.A)(function*(r=!1){if(t.loading=!0,!r)try{const i=yield t.offlineStorage.getProducts();i.length>0&&(t.mapCachedProducts(i),t.loading=!1)}catch(i){console.warn("Error loading from cache:",i)}navigator.onLine&&t.syncProductsFromServer()}).apply(this,arguments)}mapCachedProducts(t){this.products=t.map(r=>({id:r.id,customName:r.name,nameTamil:r.nameTamil||"",description:r.description||"",sku:r.sku||"",barcode1:r.barcode1||"",barcode2:r.barcode2||"",barcode3:r.barcode3||"",price:r.price,originalPrice:r.originalPrice,stockQuantity:r.stock,status:!1!==r.isAvailable?"ACTIVE":"INACTIVE",isAvailable:!1!==r.isAvailable,tags:Array.isArray(r.tags)?r.tags.join(", "):r.tags||"",category:r.category||"",imageUrl:r.imageUrl||"",originalValues:{customName:r.name,category:r.category||"",price:r.price,originalPrice:r.originalPrice,stockQuantity:r.stock,status:!1!==r.isAvailable?"ACTIVE":"INACTIVE",isAvailable:!1!==r.isAvailable,tags:Array.isArray(r.tags)?r.tags.join(", "):r.tags||"",sku:r.sku||"",barcode1:r.barcode1||"",barcode2:r.barcode2||"",barcode3:r.barcode3||"",nameTamil:r.nameTamil||""}})),this.applyFilters(),this.extractCategories()}syncProductsFromServer(){var t=this;return(0,fe.A)(function*(){let i=[],a=0,s=1;try{for(;a<s;){const l=yield t.http.get(`${t.apiUrl}/shop-products/my-products?page=${a}&size=500`).toPromise();let u=[],p=0;if(l?.data?.content?(u=l.data.content,s=l.data.totalPages||1,p=l.data.totalElements||0):Array.isArray(l?.data)?(u=l.data,s=1):Array.isArray(l)&&(u=l,s=1),i=i.concat(u),console.log(`Page ${a+1}/${s}: fetched ${u.length}, total so far: ${i.length}, server says totalElements: ${p}`),a++,a>100)break}console.log(`Loaded ${i.length} products from ${a} pages`),t.products=i.map(l=>({id:l.id,customName:l.displayName||l.customName||l.masterProduct?.name,nameTamil:l.masterProduct?.nameTamil||"",description:l.displayDescription||l.customDescription||l.masterProduct?.description,sku:l.sku||l.masterProduct?.sku||"",barcode1:l.barcode1||"",barcode2:l.barcode2||"",barcode3:l.barcode3||"",price:l.price,originalPrice:l.originalPrice,stockQuantity:l.stockQuantity,status:l.status||(l.isAvailable?"ACTIVE":"INACTIVE"),isAvailable:l.isAvailable,tags:l.masterProduct?.tags||"",category:l.masterProduct?.category?.name||"",imageUrl:l.primaryImageUrl||"",originalValues:{customName:l.displayName||l.customName||l.masterProduct?.name,category:l.masterProduct?.category?.name||"",price:l.price,originalPrice:l.originalPrice,stockQuantity:l.stockQuantity,status:l.status||(l.isAvailable?"ACTIVE":"INACTIVE"),isAvailable:l.isAvailable,tags:l.masterProduct?.tags||"",sku:l.sku||l.masterProduct?.sku||"",barcode1:l.barcode1||"",barcode2:l.barcode2||"",barcode3:l.barcode3||"",nameTamil:l.masterProduct?.nameTamil||""}})),t.applyFilters(),t.extractCategories(),t.loading=!1}catch(l){console.error("Failed to sync products:",l),t.loading=!1,0===t.products.length&&t.snackBar.open("Failed to load products","Close",{duration:3e3})}})()}extractCategories(){this.categories=[...new Set(this.products.map(t=>t.category).filter(Boolean))]}applyFilters(){const t=this.searchTerm?.toLowerCase().trim()||"";this.filteredProducts=this.products.filter(r=>(!t||(r.customName||"").toLowerCase().includes(t)||(r.nameTamil||"").toLowerCase().includes(t)||(r.sku||"").toLowerCase().includes(t)||(r.tags||"").toLowerCase().includes(t))&&(!this.selectedCategory||r.category===this.selectedCategory)&&(!this.selectedStatus||r.status===this.selectedStatus||"available"===this.selectedStatus&&r.isAvailable||"unavailable"===this.selectedStatus&&!r.isAvailable)),this.totalProducts=this.filteredProducts.length,this.currentPageIndex=0}onSearchChange(t){this.searchSubject$.next(t.target.value)}onCategoryChange(t){this.selectedCategory=t,this.applyFilters()}onStatusChange(t){this.selectedStatus=t,this.applyFilters()}onPageChange(t){this.currentPageIndex=t.pageIndex,this.pageSize=t.pageSize}get paginatedProducts(){const t=this.currentPageIndex*this.pageSize;return this.filteredProducts.slice(t,t+this.pageSize)}onPriceChange(t,r){const i=parseFloat(r);!isNaN(i)&&i>=0&&(t.price=i,this.markModified(t))}onMrpChange(t,r){const i=parseFloat(r);!isNaN(i)&&i>=0&&(t.originalPrice=i,this.markModified(t))}onStockChange(t,r){const i=parseInt(r,10);!isNaN(i)&&i>=0&&(t.stockQuantity=i,this.markModified(t))}onStatusDropdownChange(t,r){t.status=r,t.isAvailable="ACTIVE"===r,this.markModified(t)}onTagsChange(t,r){t.tags=r,this.markModified(t)}onSkuChange(t,r){t.sku=r,this.markModified(t)}onBarcode1Change(t,r){t.barcode1=r,this.markModified(t)}onBarcode2Change(t,r){t.barcode2=r,this.markModified(t)}onBarcode3Change(t,r){t.barcode3=r,this.markModified(t)}onTamilNameChange(t,r){t.nameTamil=r,this.markModified(t)}onProductNameChange(t,r){t.customName=r,this.markModified(t)}onCategoryFieldChange(t,r){t.category=r,this.markModified(t)}onCategoryDropdownChange(t,r){const i=r.value;"__NEW__"===i?(r.value=t.category||"",this.dialog.open(so,{width:"420px",maxWidth:"95vw",data:{existingCategories:this.categories},disableClose:!1}).afterClosed().subscribe(s=>{if(s?.name){this.categories.includes(s.name)||(this.categories.push(s.name),this.categories.sort()),t.category=s.name,this.markModified(t);try{localStorage.setItem("cached_product_category_names",JSON.stringify(this.categories))}catch{}}})):this.onCategoryFieldChange(t,i)}markModified(t){const r=t.originalValues;t.customName!==r.customName||t.category!==r.category||t.price!==r.price||t.originalPrice!==r.originalPrice||t.stockQuantity!==r.stockQuantity||t.status!==r.status||t.isAvailable!==r.isAvailable||t.tags!==r.tags||t.sku!==r.sku||t.barcode1!==r.barcode1||t.barcode2!==r.barcode2||t.barcode3!==r.barcode3||t.nameTamil!==r.nameTamil?this.modifiedProducts.set(t.id,t):this.modifiedProducts.delete(t.id)}isModified(t){return this.modifiedProducts.has(t.id)}isCellModified(t,r){if(!this.isModified(t))return!1;const i=t.originalValues;switch(r){case"customName":return t.customName!==i.customName;case"category":return t.category!==i.category;case"price":return t.price!==i.price;case"mrp":return t.originalPrice!==i.originalPrice;case"stock":return t.stockQuantity!==i.stockQuantity;case"status":return t.status!==i.status;case"tags":return t.tags!==i.tags;case"sku":return t.sku!==i.sku;case"barcode1":return t.barcode1!==i.barcode1;case"barcode2":return t.barcode2!==i.barcode2;case"barcode3":return t.barcode3!==i.barcode3;case"nameTamil":return t.nameTamil!==i.nameTamil;default:return!1}}isValidPrice(t){return void 0!==t&&!isNaN(t)&&t>=0}isValidStock(t){return void 0!==t&&!isNaN(t)&&t>=0&&Number.isInteger(t)}isDuplicateBarcode(t,r){const i=t[r]?.trim().toLowerCase();return!!i&&this.products.some(a=>a.id!==t.id&&["sku","barcode1","barcode2","barcode3"].some(l=>{const u=a[l]?.trim().toLowerCase();return u&&u===i}))}isDuplicateWithinProduct(t,r){const i=t[r]?.trim().toLowerCase();return!!i&&["sku","barcode1","barcode2","barcode3"].filter(s=>s!==r).some(s=>{const l=t[s]?.trim().toLowerCase();return l&&l===i})}hasDuplicateError(t,r){return this.isDuplicateBarcode(t,r)||this.isDuplicateWithinProduct(t,r)}getDuplicateErrorMessage(t,r){const i=t[r]?.trim();return i?this.isDuplicateWithinProduct(t,r)?`'${i}' is used in another field of same product`:this.isDuplicateBarcode(t,r)?`'${i}' already exists in another product`:"":""}saveChanges(){var t=this;return(0,fe.A)(function*(){if(0===t.modifiedProducts.size)return void t.snackBar.open("No changes to save","Close",{duration:2e3});const r=[];if(t.modifiedProducts.forEach((p,f)=>{p.customName?.trim()?(t.isValidPrice(p.price)||r.push(`${p.customName}: Invalid price`),void 0!==p.originalPrice&&!t.isValidPrice(p.originalPrice)&&r.push(`${p.customName}: Invalid MRP`),t.isValidStock(p.stockQuantity)||r.push(`${p.customName}: Invalid stock`),["sku","barcode1","barcode2","barcode3"].forEach(_=>{if(t.hasDuplicateError(p,_)){const C=p[_];r.push(`${p.customName}: Duplicate ${_.toUpperCase()} '${C}'`)}})):r.push(`Row ${f}: Product name is required`)}),r.length>0)return void t.snackBar.open(`Please fix errors: ${r.slice(0,3).join(", ")}`,"Close",{duration:5e3});t.saving=!0;let a=0,s=0;const l=Array.from(t.modifiedProducts.values()).map(function(){var p=(0,fe.A)(function*(f){try{return navigator.onLine?yield t.saveProductToServer(f):yield t.saveEditOffline(f),f.originalValues={customName:f.customName,category:f.category,price:f.price,originalPrice:f.originalPrice,stockQuantity:f.stockQuantity,status:f.status,isAvailable:f.isAvailable,tags:f.tags,sku:f.sku,barcode1:f.barcode1,barcode2:f.barcode2,barcode3:f.barcode3,nameTamil:f.nameTamil},t.modifiedProducts.delete(f.id),{success:!0,product:f}}catch(h){return console.error(`Failed to save product ${f.id}:`,h),{success:!1,product:f,error:h}}});return function(f){return p.apply(this,arguments)}}()),u=yield Promise.all(l);a=u.filter(p=>p.success).length,s=u.filter(p=>!p.success).length,t.saving=!1,0===s?t.snackBar.open(`${a} products saved successfully`,"Close",{duration:3e3}):t.snackBar.open(`Saved ${a} products, ${s} failed`,"Close",{duration:5e3}),t.updateLocalCache()})()}saveProductToServer(t){return new Promise((r,i)=>{this.http.put(`${this.apiUrl}/shop-products/${t.id}`,{customName:t.customName,category:t.category,price:t.price,originalPrice:t.originalPrice,stockQuantity:t.stockQuantity,isAvailable:t.isAvailable,status:t.status,sku:t.sku,barcode1:t.barcode1,barcode2:t.barcode2,barcode3:t.barcode3,nameTamil:t.nameTamil}).pipe((0,ot.Q)(this.destroy$)).subscribe({next:()=>r(),error:s=>i(s)})})}saveEditOffline(t){var r=this;return(0,fe.A)(function*(){const i={editId:r.offlineStorage.generateOfflineEditId(),productId:t.id,shopId:0,changes:{customName:t.customName,price:t.price,originalPrice:t.originalPrice,stockQuantity:t.stockQuantity,isAvailable:t.isAvailable,sku:t.sku,barcode1:t.barcode1,barcode2:t.barcode2,barcode3:t.barcode3,nameTamil:t.nameTamil},previousValues:{name:t.originalValues.customName,price:t.originalValues.price,originalPrice:t.originalValues.originalPrice,stockQuantity:t.originalValues.stockQuantity,isAvailable:t.originalValues.isAvailable,sku:t.originalValues.sku,barcode1:t.originalValues.barcode1,barcode2:t.originalValues.barcode2,barcode3:t.originalValues.barcode3,nameTamil:t.originalValues.nameTamil},createdAt:(new Date).toISOString(),synced:!1};yield r.offlineStorage.saveOfflineEdit(i)})()}updateLocalCache(){var t=this;return(0,fe.A)(function*(){try{for(const r of t.products)yield t.offlineStorage.updateLocalProduct(r.id,{name:r.customName,nameTamil:r.nameTamil,price:r.price,originalPrice:r.originalPrice,stock:r.stockQuantity,isAvailable:r.isAvailable,sku:r.sku,barcode1:r.barcode1,barcode2:r.barcode2,barcode3:r.barcode3})}catch(r){console.warn("Failed to update local cache:",r)}})()}discardChanges(){0===this.modifiedProducts.size||!confirm(`Discard all ${this.modifiedProducts.size} unsaved changes?`)||(this.modifiedProducts.forEach(r=>{r.customName=r.originalValues.customName,r.category=r.originalValues.category,r.price=r.originalValues.price,r.originalPrice=r.originalValues.originalPrice,r.stockQuantity=r.originalValues.stockQuantity,r.status=r.originalValues.status,r.isAvailable=r.originalValues.isAvailable,r.tags=r.originalValues.tags,r.sku=r.originalValues.sku,r.barcode1=r.originalValues.barcode1,r.barcode2=r.originalValues.barcode2,r.barcode3=r.originalValues.barcode3,r.nameTamil=r.originalValues.nameTamil}),this.modifiedProducts.clear(),this.snackBar.open("All changes discarded","Close",{duration:2e3}))}getProductImageUrl(t){return t.imageUrl&&(0,Mr.V)(t.imageUrl)||"assets/images/product-placeholder.svg"}getRowNumber(t){return this.currentPageIndex*this.pageSize+t+1}min(t,r){return Math.min(t,r)}triggerImageUpload(t,r){this.uploadingImageFor=t.id,r.click()}onImageSelected(t,r){var i=this;return(0,fe.A)(function*(){const a=t.target;if(!a.files||0===a.files.length)return void(i.uploadingImageFor=null);const s=a.files[0];if(!s.type.startsWith("image/"))return i.snackBar.open("Please select an image file","Close",{duration:3e3}),void(i.uploadingImageFor=null);if(s.size>5242880)return i.snackBar.open("Image must be less than 5MB","Close",{duration:3e3}),void(i.uploadingImageFor=null);try{const l=new FormData;l.append("file",s);const u=yield i.http.post(`${i.apiUrl}/shop-products/${r.id}/image`,l).toPromise();u?.data?.imageUrl||u?.imageUrl?(r.imageUrl=u?.data?.imageUrl||u?.imageUrl,i.snackBar.open("Image updated successfully","Close",{duration:2e3})):(i.loadProducts(!0),i.snackBar.open("Image uploaded","Close",{duration:2e3}))}catch(l){console.error("Failed to upload image:",l),i.snackBar.open(l?.error?.message||"Failed to upload image","Close",{duration:3e3})}finally{i.uploadingImageFor=null,a.value=""}})()}isUploadingImage(t){return this.uploadingImageFor===t.id}getImageSearchUrl(t){return`https://www.google.com/search?q=${encodeURIComponent(t.customName+" product")}&udm=2`}getTranslateUrl(t){return`https://translate.google.com/?sl=en&tl=ta&text=${encodeURIComponent(t.customName)}&op=translate`}transliterateTamil(t){if(!t)return"";let r="",i=0;for(;i<t.length;){let a=!1;for(let s=3;s>=1;s--){const l=t.substring(i,i+s);if(this.tamilToEnglish[l]){r+=this.tamilToEnglish[l],i+=s,a=!0;break}}if(!a){const s=t[i];/[a-zA-Z0-9]/.test(s)?r+=s.toLowerCase():" "===s&&(r+=" "),i++}}return r.trim()}autoGenerateTags(t){const r=new Set,i=["and","or","the","a","an","of","for","with","in","to","is","by","pack","pcs","piece","pieces","gm","gms","kg","ml","ltr","lt"];if(t.customName.toLowerCase().replace(/[^a-z\s]/g," ").split(/\s+/).filter(s=>s.length>1&&!i.includes(s)).forEach(s=>r.add(s)),t.nameTamil){const s=this.transliterateTamil(t.nameTamil);if(s){const l=s.replace(/\s+/g,"");l.length>1&&r.add(l),s.split(/\s+/).forEach(u=>{u.length>1&&r.add(u)})}}if(t.category){const s=t.category.toLowerCase().replace(/[^a-z\s]/g,"");s.length>1&&r.add(s)}t.tags=Array.from(r).join(", "),this.markModified(t),this.snackBar.open(`Generated ${r.size} tags`,"Close",{duration:2e3})}removeImage(t){var r=this;return(0,fe.A)(function*(){if(confirm("Remove this product image?")){r.uploadingImageFor=t.id;try{yield r.http.delete(`${r.apiUrl}/shop-products/${t.id}/image`).toPromise(),t.imageUrl="",r.snackBar.open("Image removed","Close",{duration:2e3})}catch(a){console.error("Failed to remove image:",a),t.imageUrl="",r.snackBar.open("Image removed locally","Close",{duration:2e3})}finally{r.uploadingImageFor=null}}})()}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(gt.Qq),e.rXU(Ce.UG),e.rXU(at.m),e.rXU(e3.I),e.rXU(Pe.bZ))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-bulk-edit"]],decls:44,vars:16,consts:[[1,"bulk-edit-container"],["class","offline-banner",4,"ngIf"],[1,"bulk-edit-header"],[1,"header-left"],[1,"breadcrumb"],[1,"header-right"],[1,"version-info"],[1,"toolbar"],[1,"toolbar-left"],["appearance","outline",1,"search-field"],["matInput","","placeholder","Search by name, SKU, or tags",3,"value","input"],["matSuffix",""],["appearance","outline",1,"filter-field"],[3,"value","selectionChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"toolbar-right"],["mat-raised-button","","color","primary",1,"save-btn",3,"disabled","click"],["class","pending-count",4,"ngIf"],["diameter","18",4,"ngIf"],[1,"status-bar"],[1,"status-left"],["class","product-count",4,"ngIf"],["class","modified-count",4,"ngIf"],[1,"status-right"],["mat-button","","color","warn","class","discard-btn",3,"click",4,"ngIf"],["class","loading-container",4,"ngIf"],["class","grid-container",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","legend",4,"ngIf"],[1,"offline-banner"],[1,"offline-text"],["class","sync-time",4,"ngIf"],[1,"sync-time"],[3,"value"],[1,"pending-count"],["diameter","18"],[1,"product-count"],[1,"modified-count"],["mat-button","","color","warn",1,"discard-btn",3,"click"],[1,"loading-container"],["diameter","40"],[1,"grid-container"],[1,"grid-wrapper"],[1,"excel-grid"],[1,"col-row-num"],[1,"col-image"],[1,"col-product-name"],[1,"col-category"],[1,"col-tamil-name"],[1,"col-sku"],[1,"col-price"],[1,"col-mrp"],[1,"col-stock"],[1,"col-barcode"],[1,"col-status"],[1,"col-tags"],[3,"modified-row",4,"ngFor","ngForOf"],["showFirstLastButtons","","aria-label","Select page",3,"length","pageSize","pageSizeOptions","pageIndex","page"],["matTooltip","Click for options",1,"product-image","clickable",3,"matMenuTriggerFor"],[3,"appOfflineImg","fallback","alt"],[1,"image-overlay"],[4,"ngIf"],["diameter","20",4,"ngIf"],["imageMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],["type","file","hidden","","accept","image/*",3,"change"],["imageInput",""],[1,"name-cell-wrapper"],["type","text","required","",1,"cell-input","name-input",3,"value","change"],["target","_blank","matTooltip","Search image for this product",1,"image-search-link",3,"href"],[1,"cell-input","category-dropdown",3,"value","change"],[3,"value","selected",4,"ngFor","ngForOf"],["value","__NEW__",2,"color","#4caf50","font-weight","bold"],[1,"tamil-cell-wrapper"],["type","text","placeholder","-",1,"cell-input","tamil-input",3,"value","change"],["target","_blank","matTooltip","Translate to Tamil",1,"translate-link",3,"href"],["type","text","placeholder","-",1,"cell-input","sku-input",3,"title","value","change"],["type","number","min","0","step","0.01",1,"cell-input",3,"value","change"],["type","number","min","0","step","1",1,"cell-input",3,"value","change"],["type","text","placeholder","-",1,"cell-input","barcode-input",3,"title","value","change"],[1,"status-dropdown",3,"value","change"],["value","ACTIVE"],["value","INACTIVE"],[1,"tags-cell-wrapper"],["type","text","placeholder","-",1,"cell-input","tags-input",3,"value","change"],["matTooltip","Auto-generate tags (English + Tamil phonetic)",1,"auto-tags-btn",3,"click"],["diameter","20"],["color","warn"],[3,"value","selected"],[1,"empty-state"],[1,"empty-icon"],[1,"legend"],[1,"legend-item"],[1,"legend-color","modified"],[1,"legend-color","invalid"]],template:function(r,i){1&r&&(e.j41(0,"div",0),e.DNE(1,n3,6,1,"div",1),e.j41(2,"div",2)(3,"div",3)(4,"h1"),e.EFF(5,"Bulk Edit Products"),e.k0s(),e.j41(6,"p",4),e.EFF(7,"Home / Shop-owner / Bulk-edit"),e.k0s()(),e.j41(8,"div",5)(9,"span",6),e.EFF(10),e.k0s()()(),e.j41(11,"div",7)(12,"div",8)(13,"mat-form-field",9)(14,"mat-label"),e.EFF(15,"Search products..."),e.k0s(),e.j41(16,"input",10),e.bIt("input",function(s){return i.onSearchChange(s)}),e.k0s(),e.j41(17,"mat-icon",11),e.EFF(18,"search"),e.k0s()(),e.j41(19,"mat-form-field",12)(20,"mat-label"),e.EFF(21,"Category"),e.k0s(),e.j41(22,"mat-select",13),e.bIt("selectionChange",function(s){return i.onCategoryChange(s.value)}),e.j41(23,"mat-option",14),e.EFF(24,"All Categories"),e.k0s(),e.DNE(25,r3,2,2,"mat-option",15),e.k0s()()(),e.j41(26,"div",16)(27,"button",17),e.bIt("click",function(){return i.saveChanges()}),e.j41(28,"mat-icon"),e.EFF(29,"save"),e.k0s(),e.EFF(30," Save Changes "),e.DNE(31,i3,2,1,"span",18),e.DNE(32,o3,1,0,"mat-spinner",19),e.k0s()()(),e.j41(33,"div",20)(34,"div",21),e.DNE(35,a3,2,3,"span",22),e.DNE(36,s3,2,0,"span",22),e.DNE(37,c3,2,1,"span",23),e.k0s(),e.j41(38,"div",24),e.DNE(39,l3,4,0,"button",25),e.k0s()(),e.DNE(40,d3,4,0,"div",26),e.DNE(41,h3,36,5,"div",27),e.DNE(42,_3,8,0,"div",28),e.DNE(43,x3,7,0,"div",29),e.k0s()),2&r&&(e.R7$(1),e.Y8G("ngIf",i.isOffline),e.R7$(9),e.SpI("v",i.clientVersion,""),e.R7$(6),e.Y8G("value",i.searchTerm),e.R7$(6),e.Y8G("value",i.selectedCategory),e.R7$(3),e.Y8G("ngForOf",i.categories),e.R7$(2),e.Y8G("disabled",0===i.modifiedProducts.size||i.saving),e.R7$(4),e.Y8G("ngIf",i.modifiedProducts.size>0),e.R7$(1),e.Y8G("ngIf",i.saving),e.R7$(3),e.Y8G("ngIf",i.totalProducts>0),e.R7$(1),e.Y8G("ngIf",0===i.totalProducts),e.R7$(1),e.Y8G("ngIf",i.modifiedProducts.size>0),e.R7$(2),e.Y8G("ngIf",i.modifiedProducts.size>0),e.R7$(1),e.Y8G("ngIf",i.loading),e.R7$(1),e.Y8G("ngIf",!i.loading),e.R7$(1),e.Y8G("ngIf",!i.loading&&0===i.filteredProducts.length),e.R7$(1),e.Y8G("ngIf",!i.loading&&i.filteredProducts.length>0))},dependencies:[D.Sq,D.bT,b.xH,b.y7,fi,B.$z,H.An,X.LG,ae.kk,ae.fb,ae.Cp,ge.rl,ge.nJ,ge.yw,Ee.fg,lt.iy,ze.VO,Bt.wT,qe.oV],styles:[".bulk-edit-container[_ngcontent-%COMP%]{padding:24px;background:#f0fdf4;min-height:calc(100vh - 64px)}.bulk-edit-container[_ngcontent-%COMP%]   .offline-banner[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 20px;background:linear-gradient(135deg,#fff3e0 0%,#ffe0b2 100%);border:1px solid #ffb74d;border-radius:8px;margin-bottom:16px;color:#e65100;font-weight:500}.bulk-edit-container[_ngcontent-%COMP%]   .offline-banner[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px;color:#e65100}.bulk-edit-container[_ngcontent-%COMP%]   .offline-banner[_ngcontent-%COMP%]   .offline-text[_ngcontent-%COMP%]{flex:1}.bulk-edit-container[_ngcontent-%COMP%]   .offline-banner[_ngcontent-%COMP%]   .sync-time[_ngcontent-%COMP%]{font-size:13px;color:#f57c00;background:rgba(255,255,255,.6);padding:4px 12px;border-radius:12px}.bulk-edit-container[_ngcontent-%COMP%]   .bulk-edit-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:24px}.bulk-edit-container[_ngcontent-%COMP%]   .bulk-edit-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 6px;color:#374151;font-size:28px;font-weight:700;letter-spacing:-.5px}.bulk-edit-container[_ngcontent-%COMP%]   .bulk-edit-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .breadcrumb[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:14px}.bulk-edit-container[_ngcontent-%COMP%]   .bulk-edit-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .version-info[_ngcontent-%COMP%]{background:#4ade80;color:#fff;padding:8px 16px;border-radius:9999px;font-size:13px;font-weight:600;box-shadow:0 2px 8px #4ade804d}.bulk-edit-container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:16px;margin-bottom:16px;flex-wrap:wrap}.bulk-edit-container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{display:flex;gap:16px;flex:1;flex-wrap:wrap}.bulk-edit-container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]{flex:1;min-width:280px;max-width:400px}.bulk-edit-container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .filter-field[_ngcontent-%COMP%]{min-width:160px}.bulk-edit-container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-weight:500;padding:0 28px;height:50px;border-radius:.5rem;background:#4ade80!important;box-shadow:0 4px 16px #4ade8066;transition:all .2s ease}.bulk-edit-container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#22c55e!important;box-shadow:0 0 0 3px #4ade804d}.bulk-edit-container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]:disabled{background:#e5e7eb!important;box-shadow:none}.bulk-edit-container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]   .pending-count[_ngcontent-%COMP%]{font-weight:500;opacity:.9}.bulk-edit-container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin-left:8px}.bulk-edit-container[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;background:#fff;padding:14px 20px;border-radius:12px;margin-bottom:16px;border:1px solid #f1f5f9;box-shadow:0 2px 8px #0000000a}.bulk-edit-container[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]   .status-left[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.bulk-edit-container[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]   .status-left[_ngcontent-%COMP%]   .product-count[_ngcontent-%COMP%]{font-weight:600;color:#1e293b}.bulk-edit-container[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]   .status-left[_ngcontent-%COMP%]   .modified-count[_ngcontent-%COMP%]{color:#f59e0b;font-weight:600}.bulk-edit-container[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]   .status-right[_ngcontent-%COMP%]   .discard-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;border-radius:8px}.bulk-edit-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]{text-align:center;padding:100px 20px}.bulk-edit-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin:0 auto 20px}.bulk-edit-container[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#64748b;margin:0;font-size:15px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]{background:#fff;border-radius:16px;border:1px solid #f1f5f9;overflow:hidden;box-shadow:0 2px 8px #0000000a}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .grid-wrapper[_ngcontent-%COMP%]{overflow-x:auto}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]{width:100%;min-width:1720px;border-collapse:collapse}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:#f8fafc;position:sticky;top:0;z-index:10}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:2px solid #e2e8f0}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:14px 8px;text-align:left;font-weight:700;font-size:11px;text-transform:uppercase;letter-spacing:.5px;color:#475569;white-space:nowrap}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #f1f5f9;transition:all .15s ease}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f0f7ff}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.modified-row[_ngcontent-%COMP%]{background:#fffbeb}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.modified-row[_ngcontent-%COMP%]:hover{background:#fef3c7}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px;vertical-align:middle}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .col-row-num[_ngcontent-%COMP%]{width:40px;text-align:center;color:#94a3b8;font-size:13px;font-weight:500}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .col-image[_ngcontent-%COMP%]{width:55px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .col-product-name[_ngcontent-%COMP%]{min-width:180px;max-width:220px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .col-category[_ngcontent-%COMP%]{width:120px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .col-tamil-name[_ngcontent-%COMP%]{min-width:140px;max-width:180px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .col-sku[_ngcontent-%COMP%]{width:90px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .col-barcode[_ngcontent-%COMP%]{width:110px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .col-price[_ngcontent-%COMP%], .bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .col-mrp[_ngcontent-%COMP%]{width:80px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .col-stock[_ngcontent-%COMP%]{width:70px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .col-status[_ngcontent-%COMP%]{width:95px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .col-tags[_ngcontent-%COMP%]{min-width:100px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .product-image[_ngcontent-%COMP%]{width:44px;height:44px;border-radius:10px;overflow:hidden;border:1px solid #f1f5f9;background:#f8fafc;position:relative}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .product-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .product-image.clickable[_ngcontent-%COMP%]{cursor:pointer;transition:all .2s ease}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .product-image.clickable[_ngcontent-%COMP%]   .image-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .2s ease}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .product-image.clickable[_ngcontent-%COMP%]   .image-overlay[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff;font-size:18px;width:18px;height:18px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .product-image.clickable[_ngcontent-%COMP%]   .image-overlay[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]     circle{stroke:#fff}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .product-image.clickable[_ngcontent-%COMP%]:hover{border-color:#22c55e;box-shadow:0 0 0 2px #22c55e33}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .product-image.clickable[_ngcontent-%COMP%]:hover   .image-overlay[_ngcontent-%COMP%]{opacity:1}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .product-image.clickable.uploading[_ngcontent-%COMP%]   .image-overlay[_ngcontent-%COMP%]{opacity:1;background:rgba(34,197,94,.7)}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .cell-input[_ngcontent-%COMP%]{width:100%;padding:8px 10px;border:1px solid #e5e7eb;border-radius:.5rem;font-size:13px;background:#f9fafb;transition:all .2s ease;color:#374151}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .cell-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#4ade80;background:white;box-shadow:0 0 0 3px #4ade801a}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .cell-input[_ngcontent-%COMP%]:hover:not(:focus){border-color:#d1d5db}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .cell-input.modified[_ngcontent-%COMP%]{background:#fef9c3;border-color:#fbbf24}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .cell-input.invalid[_ngcontent-%COMP%]{border-color:#ef4444;background:#fef2f2}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .cell-input.invalid[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 3px #ef44441a}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .cell-input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield;text-align:right}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .cell-input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button, .bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .cell-input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .name-input[_ngcontent-%COMP%]{font-weight:600}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .name-cell-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .name-cell-wrapper[_ngcontent-%COMP%]   .name-input[_ngcontent-%COMP%]{flex:1}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .name-cell-wrapper[_ngcontent-%COMP%]   .image-search-link[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;color:#3b82f6;text-decoration:none;padding:4px;border-radius:4px;transition:all .2s ease}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .name-cell-wrapper[_ngcontent-%COMP%]   .image-search-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .name-cell-wrapper[_ngcontent-%COMP%]   .image-search-link[_ngcontent-%COMP%]:hover{background:#eff6ff;color:#1d4ed8}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .tamil-input[_ngcontent-%COMP%]{font-size:13px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .tamil-cell-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .tamil-cell-wrapper[_ngcontent-%COMP%]   .tamil-input[_ngcontent-%COMP%]{flex:1}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .tamil-cell-wrapper[_ngcontent-%COMP%]   .translate-link[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;color:#8b5cf6;text-decoration:none;padding:4px;border-radius:4px;transition:all .2s ease}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .tamil-cell-wrapper[_ngcontent-%COMP%]   .translate-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .tamil-cell-wrapper[_ngcontent-%COMP%]   .translate-link[_ngcontent-%COMP%]:hover{background:#f5f3ff;color:#6d28d9}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .sku-input[_ngcontent-%COMP%], .bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .barcode-input[_ngcontent-%COMP%]{font-family:Monaco,Consolas,monospace;font-size:12px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .tags-input[_ngcontent-%COMP%]{text-align:left;font-size:12px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .tags-cell-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .tags-cell-wrapper[_ngcontent-%COMP%]   .tags-input[_ngcontent-%COMP%]{flex:1}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .tags-cell-wrapper[_ngcontent-%COMP%]   .auto-tags-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:none;border:none;color:#f59e0b;padding:4px;border-radius:4px;cursor:pointer;transition:all .2s ease}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .tags-cell-wrapper[_ngcontent-%COMP%]   .auto-tags-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .tags-cell-wrapper[_ngcontent-%COMP%]   .auto-tags-btn[_ngcontent-%COMP%]:hover{background:#fef3c7;color:#d97706}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .category-dropdown[_ngcontent-%COMP%]{font-size:12px;cursor:pointer}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .status-dropdown[_ngcontent-%COMP%]{width:100%;padding:8px 10px;border:1px solid #e5e7eb;border-radius:.5rem;font-size:11px;font-weight:700;cursor:pointer;appearance:auto;transition:all .2s ease;text-transform:uppercase;letter-spacing:.5px;background:#f9fafb}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .status-dropdown[_ngcontent-%COMP%]:focus{outline:none;border-color:#4ade80;box-shadow:0 0 0 3px #4ade801a}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .status-dropdown.status-active[_ngcontent-%COMP%]{background:#dcfce7;color:#166534;border-color:#86efac}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .status-dropdown.status-inactive[_ngcontent-%COMP%]{background:#f9fafb;color:#6b7280}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .status-dropdown.modified[_ngcontent-%COMP%]{border-color:#fbbf24}.bulk-edit-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:100px 20px}.bulk-edit-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{margin-bottom:20px}.bulk-edit-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:72px;width:72px;height:72px;color:#cbd5e1}.bulk-edit-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 10px;color:#475569;font-size:20px;font-weight:600}.bulk-edit-container[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#94a3b8;font-size:15px}.bulk-edit-container[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]{display:flex;gap:28px;margin-top:16px;padding:14px 20px;background:#fff;border-radius:12px;border:1px solid #f1f5f9;box-shadow:0 2px 8px #0000000a}.bulk-edit-container[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;font-size:13px;color:#64748b;font-weight:500}.bulk-edit-container[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-color[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:6px;border:1px solid #e2e8f0}.bulk-edit-container[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-color.modified[_ngcontent-%COMP%]{background:#fef9c3;border-color:#fbbf24}.bulk-edit-container[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-color.invalid[_ngcontent-%COMP%]{background:#fef2f2;border-color:#ef4444}@media (max-width: 1024px){.bulk-edit-container[_ngcontent-%COMP%]{padding:16px}.bulk-edit-container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.bulk-edit-container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]{flex-direction:column}.bulk-edit-container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-left[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]{max-width:none}.bulk-edit-container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-right[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]{width:100%;justify-content:center}}@media (max-width: 768px){.bulk-edit-container[_ngcontent-%COMP%]   .bulk-edit-header[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.bulk-edit-container[_ngcontent-%COMP%]   .bulk-edit-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{align-self:flex-start}.bulk-edit-container[_ngcontent-%COMP%]   .status-bar[_ngcontent-%COMP%]{flex-direction:column;gap:12px;align-items:flex-start}.bulk-edit-container[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]{flex-direction:column;gap:10px}}@media (max-width: 480px){.bulk-edit-container[_ngcontent-%COMP%]{padding:12px}.bulk-edit-container[_ngcontent-%COMP%]   .bulk-edit-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:22px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .product-image[_ngcontent-%COMP%]{width:36px;height:36px}.bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .cell-input[_ngcontent-%COMP%], .bulk-edit-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]   .excel-grid[_ngcontent-%COMP%]   .status-dropdown[_ngcontent-%COMP%]{padding:6px 8px;font-size:12px}}"]})}}return n})()},{path:"inventory",component:Kb},{path:"shop/profile",component:ro},{path:"customers",component:qd},{path:"settings",component:my},{path:"business-hours",component:Cs},{path:"notifications",component:My},{path:"analytics",component:is},{path:"categories",component:s0},{path:"orders/today",component:Qp},{path:"orders/history",component:Qp},{path:"reviews",component:qd},{path:"loyalty",component:qd},{path:"revenue",component:is},{path:"payouts",component:is},{path:"reports",component:is},{path:"products",loadChildren:()=>E.e(334).then(E.bind(E,3334)).then(n=>n.ProductModule)},{path:"shop",loadChildren:()=>Promise.resolve().then(E.bind(E,267)).then(n=>n.ShopModule)}];let v3=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[Xe.iI.forChild(C3),Xe.iI]})}}return n})(),P3=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[D.MD,b.X1,b.YN,rt.G,v3,j.Hu,B.Hl,H.m_,X.D6,me.w,ae.Cn,Me.Y,Ve.YN,ge.RG,Ee.fS,Ce._T,_e.tP,lt.Ou,$t.NQ,ze.Ve,_t.Vg,Pe.hM,qe.uc,Et.X6,Bt.WX,Ze.Wk,it.g7,Ue.RI,Ae.mV,xt.aP,Je.Fg,Bt.Sy,Ke.PO]})}}return n})()},243:Mt=>{"use strict";var re={single_source_shortest_paths:function(E,D,b){var j={},B={};B[D]=0;var X,me,ae,Me,Ve,Ee,H=re.PriorityQueue.make();for(H.push(D,0);!H.empty();)for(ae in Me=(X=H.pop()).cost,Ve=E[me=X.value]||{})Ve.hasOwnProperty(ae)&&(Ee=Me+Ve[ae],(typeof B[ae]>"u"||B[ae]>Ee)&&(B[ae]=Ee,H.push(ae,Ee),j[ae]=me));if(typeof b<"u"&&typeof B[b]>"u"){var lt=["Could not find a path from ",D," to ",b,"."].join("");throw new Error(lt)}return j},extract_shortest_path_from_predecessor_list:function(E,D){for(var b=[],j=D;j;)b.push(j),j=E[j];return b.reverse(),b},find_path:function(E,D,b){var j=re.single_source_shortest_paths(E,D,b);return re.extract_shortest_path_from_predecessor_list(j,b)},PriorityQueue:{make:function(E){var j,D=re.PriorityQueue,b={};for(j in E=E||{},D)D.hasOwnProperty(j)&&(b[j]=D[j]);return b.queue=[],b.sorter=E.sorter||D.default_sorter,b},default_sorter:function(E,D){return E.cost-D.cost},push:function(E,D){this.queue.push({value:E,cost:D}),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};Mt.exports=re},8244:function(Mt,re){!function(E){"use strict";function b(c){var d,g,m,v;for(g=1,m=arguments.length;g<m;g++)for(d in v=arguments[g])c[d]=v[d];return c}var j=Object.create||function(){function c(){}return function(d){return c.prototype=d,new c}}();function B(c,d){var g=Array.prototype.slice;if(c.bind)return c.bind.apply(c,g.call(arguments,1));var m=g.call(arguments,2);return function(){return c.apply(d,m.length?m.concat(g.call(arguments)):arguments)}}var H=0;function X(c){return"_leaflet_id"in c||(c._leaflet_id=++H),c._leaflet_id}function me(c,d,g){var m,v,O,z;return z=function(){m=!1,v&&(O.apply(g,v),v=!1)},O=function(){m?v=arguments:(c.apply(g,arguments),setTimeout(z,d),m=!0)},O}function ae(c,d,g){var m=d[1],v=d[0],O=m-v;return c===m&&g?c:((c-v)%O+O)%O+v}function Me(){return!1}function Ve(c,d){if(!1===d)return c;var g=Math.pow(10,void 0===d?6:d);return Math.round(c*g)/g}function ge(c){return c.trim?c.trim():c.replace(/^\s+|\s+$/g,"")}function Ee(c){return ge(c).split(/\s+/)}function Ce(c,d){for(var g in Object.prototype.hasOwnProperty.call(c,"options")||(c.options=c.options?j(c.options):{}),d)c.options[g]=d[g];return c.options}function _e(c,d,g){var m=[];for(var v in c)m.push(encodeURIComponent(g?v.toUpperCase():v)+"="+encodeURIComponent(c[v]));return(d&&-1!==d.indexOf("?")?"&":"?")+m.join("&")}var lt=/\{ *([\w_ -]+) *\}/g;function $t(c,d){return c.replace(lt,function(g,m){var v=d[m];if(void 0===v)throw new Error("No value provided for variable "+g);return"function"==typeof v&&(v=v(d)),v})}var ze=Array.isArray||function(c){return"[object Array]"===Object.prototype.toString.call(c)};function _t(c,d){for(var g=0;g<c.length;g++)if(c[g]===d)return g;return-1}var Pe="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function qe(c){return window["webkit"+c]||window["moz"+c]||window["ms"+c]}var Et=0;function Bt(c){var d=+new Date,g=Math.max(0,16-(d-Et));return Et=d+g,window.setTimeout(c,g)}var Ze=window.requestAnimationFrame||qe("RequestAnimationFrame")||Bt,it=window.cancelAnimationFrame||qe("CancelAnimationFrame")||qe("CancelRequestAnimationFrame")||function(c){window.clearTimeout(c)};function Ue(c,d,g){if(!g||Ze!==Bt)return Ze.call(window,B(c,d));c.call(d)}function Ae(c){c&&it.call(window,c)}var xt={__proto__:null,extend:b,create:j,bind:B,get lastId(){return H},stamp:X,throttle:me,wrapNum:ae,falseFn:Me,formatNum:Ve,trim:ge,splitWords:Ee,setOptions:Ce,getParamString:_e,template:$t,isArray:ze,indexOf:_t,emptyImageUrl:Pe,requestFn:Ze,cancelFn:it,requestAnimFrame:Ue,cancelAnimFrame:Ae};function Je(){}Je.extend=function(c){var d=function(){Ce(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},g=d.__super__=this.prototype,m=j(g);for(var v in m.constructor=d,d.prototype=m,this)Object.prototype.hasOwnProperty.call(this,v)&&"prototype"!==v&&"__super__"!==v&&(d[v]=this[v]);return c.statics&&b(d,c.statics),c.includes&&(function Ke(c){if(!(typeof L>"u")&&L&&L.Mixin){c=ze(c)?c:[c];for(var d=0;d<c.length;d++)c[d]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}(c.includes),b.apply(null,[m].concat(c.includes))),b(m,c),delete m.statics,delete m.includes,m.options&&(m.options=g.options?j(g.options):{},b(m.options,c.options)),m._initHooks=[],m.callInitHooks=function(){if(!this._initHooksCalled){g.callInitHooks&&g.callInitHooks.call(this),this._initHooksCalled=!0;for(var O=0,z=m._initHooks.length;O<z;O++)m._initHooks[O].call(this)}},d},Je.include=function(c){var d=this.prototype.options;return b(this.prototype,c),c.options&&(this.prototype.options=d,this.mergeOptions(c.options)),this},Je.mergeOptions=function(c){return b(this.prototype.options,c),this},Je.addInitHook=function(c){var d=Array.prototype.slice.call(arguments,1),g="function"==typeof c?c:function(){this[c].apply(this,d)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(g),this};var rt={on:function(c,d,g){if("object"==typeof c)for(var m in c)this._on(m,c[m],d);else for(var v=0,O=(c=Ee(c)).length;v<O;v++)this._on(c[v],d,g);return this},off:function(c,d,g){if(arguments.length)if("object"==typeof c)for(var m in c)this._off(m,c[m],d);else{c=Ee(c);for(var v=1===arguments.length,O=0,z=c.length;O<z;O++)v?this._off(c[O]):this._off(c[O],d,g)}else delete this._events;return this},_on:function(c,d,g,m){if("function"==typeof d){if(!1===this._listens(c,d,g)){g===this&&(g=void 0);var v={fn:d,ctx:g};m&&(v.once=!0),this._events=this._events||{},this._events[c]=this._events[c]||[],this._events[c].push(v)}}else console.warn("wrong listener type: "+typeof d)},_off:function(c,d,g){var m,v,O;if(this._events&&(m=this._events[c])){if(1===arguments.length){if(this._firingCount)for(v=0,O=m.length;v<O;v++)m[v].fn=Me;return void delete this._events[c]}if("function"!=typeof d)return void console.warn("wrong listener type: "+typeof d);var z=this._listens(c,d,g);!1!==z&&(this._firingCount&&(m[z].fn=Me,this._events[c]=m=m.slice()),m.splice(z,1))}},fire:function(c,d,g){if(!this.listens(c,g))return this;var m=b({},d,{type:c,target:this,sourceTarget:d&&d.sourceTarget||this});if(this._events){var v=this._events[c];if(v){this._firingCount=this._firingCount+1||1;for(var O=0,z=v.length;O<z;O++){var J=v[O],te=J.fn;J.once&&this.off(c,te,J.ctx),te.call(J.ctx||this,m)}this._firingCount--}}return g&&this._propagateEvent(m),this},listens:function(c,d,g,m){"string"!=typeof c&&console.warn('"string" type argument expected');var v=d;"function"!=typeof d&&(m=!!d,v=void 0,g=void 0);var O=this._events&&this._events[c];if(O&&O.length&&!1!==this._listens(c,v,g))return!0;if(m)for(var z in this._eventParents)if(this._eventParents[z].listens(c,d,g,m))return!0;return!1},_listens:function(c,d,g){if(!this._events)return!1;var m=this._events[c]||[];if(!d)return!!m.length;g===this&&(g=void 0);for(var v=0,O=m.length;v<O;v++)if(m[v].fn===d&&m[v].ctx===g)return v;return!1},once:function(c,d,g){if("object"==typeof c)for(var m in c)this._on(m,c[m],d,!0);else for(var v=0,O=(c=Ee(c)).length;v<O;v++)this._on(c[v],d,g,!0);return this},addEventParent:function(c){return this._eventParents=this._eventParents||{},this._eventParents[X(c)]=c,this},removeEventParent:function(c){return this._eventParents&&delete this._eventParents[X(c)],this},_propagateEvent:function(c){for(var d in this._eventParents)this._eventParents[d].fire(c.type,b({layer:c.target,propagatedFrom:c.target},c),!0)}};rt.addEventListener=rt.on,rt.removeEventListener=rt.clearAllEventListeners=rt.off,rt.addOneTimeEventListener=rt.once,rt.fireEvent=rt.fire,rt.hasEventListeners=rt.listens;var Xe=Je.extend(rt);function fe(c,d,g){this.x=g?Math.round(c):c,this.y=g?Math.round(d):d}var _r=Math.trunc||function(c){return c>0?Math.floor(c):Math.ceil(c)};function Oe(c,d,g){return c instanceof fe?c:ze(c)?new fe(c[0],c[1]):null==c?c:"object"==typeof c&&"x"in c&&"y"in c?new fe(c.x,c.y):new fe(c,d,g)}function e(c,d){if(c)for(var g=d?[c,d]:c,m=0,v=g.length;m<v;m++)this.extend(g[m])}function Gt(c,d){return!c||c instanceof e?c:new e(c,d)}function Jt(c,d){if(c)for(var g=d?[c,d]:c,m=0,v=g.length;m<v;m++)this.extend(g[m])}function qt(c,d){return c instanceof Jt?c:new Jt(c,d)}function At(c,d,g){if(isNaN(c)||isNaN(d))throw new Error("Invalid LatLng object: ("+c+", "+d+")");this.lat=+c,this.lng=+d,void 0!==g&&(this.alt=+g)}function at(c,d,g){return c instanceof At?c:ze(c)&&"object"!=typeof c[0]?3===c.length?new At(c[0],c[1],c[2]):2===c.length?new At(c[0],c[1]):null:null==c?c:"object"==typeof c&&"lat"in c?new At(c.lat,"lng"in c?c.lng:c.lon,c.alt):void 0===d?null:new At(c,d,g)}fe.prototype={clone:function(){return new fe(this.x,this.y)},add:function(c){return this.clone()._add(Oe(c))},_add:function(c){return this.x+=c.x,this.y+=c.y,this},subtract:function(c){return this.clone()._subtract(Oe(c))},_subtract:function(c){return this.x-=c.x,this.y-=c.y,this},divideBy:function(c){return this.clone()._divideBy(c)},_divideBy:function(c){return this.x/=c,this.y/=c,this},multiplyBy:function(c){return this.clone()._multiplyBy(c)},_multiplyBy:function(c){return this.x*=c,this.y*=c,this},scaleBy:function(c){return new fe(this.x*c.x,this.y*c.y)},unscaleBy:function(c){return new fe(this.x/c.x,this.y/c.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=_r(this.x),this.y=_r(this.y),this},distanceTo:function(c){var d=(c=Oe(c)).x-this.x,g=c.y-this.y;return Math.sqrt(d*d+g*g)},equals:function(c){return(c=Oe(c)).x===this.x&&c.y===this.y},contains:function(c){return c=Oe(c),Math.abs(c.x)<=Math.abs(this.x)&&Math.abs(c.y)<=Math.abs(this.y)},toString:function(){return"Point("+Ve(this.x)+", "+Ve(this.y)+")"}},e.prototype={extend:function(c){var d,g;if(!c)return this;if(c instanceof fe||"number"==typeof c[0]||"x"in c)d=g=Oe(c);else if(g=(c=Gt(c)).max,!(d=c.min)||!g)return this;return this.min||this.max?(this.min.x=Math.min(d.x,this.min.x),this.max.x=Math.max(g.x,this.max.x),this.min.y=Math.min(d.y,this.min.y),this.max.y=Math.max(g.y,this.max.y)):(this.min=d.clone(),this.max=g.clone()),this},getCenter:function(c){return Oe((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,c)},getBottomLeft:function(){return Oe(this.min.x,this.max.y)},getTopRight:function(){return Oe(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(c){var d,g;return(c="number"==typeof c[0]||c instanceof fe?Oe(c):Gt(c))instanceof e?(d=c.min,g=c.max):d=g=c,d.x>=this.min.x&&g.x<=this.max.x&&d.y>=this.min.y&&g.y<=this.max.y},intersects:function(c){c=Gt(c);var d=this.min,g=this.max,m=c.min,v=c.max;return v.x>=d.x&&m.x<=g.x&&v.y>=d.y&&m.y<=g.y},overlaps:function(c){c=Gt(c);var d=this.min,g=this.max,m=c.min,v=c.max;return v.x>d.x&&m.x<g.x&&v.y>d.y&&m.y<g.y},isValid:function(){return!(!this.min||!this.max)},pad:function(c){var d=this.min,g=this.max,m=Math.abs(d.x-g.x)*c,v=Math.abs(d.y-g.y)*c;return Gt(Oe(d.x-m,d.y-v),Oe(g.x+m,g.y+v))},equals:function(c){return!!c&&(c=Gt(c),this.min.equals(c.getTopLeft())&&this.max.equals(c.getBottomRight()))}},Jt.prototype={extend:function(c){var m,v,d=this._southWest,g=this._northEast;if(c instanceof At)m=c,v=c;else{if(!(c instanceof Jt))return c?this.extend(at(c)||qt(c)):this;if(v=c._northEast,!(m=c._southWest)||!v)return this}return d||g?(d.lat=Math.min(m.lat,d.lat),d.lng=Math.min(m.lng,d.lng),g.lat=Math.max(v.lat,g.lat),g.lng=Math.max(v.lng,g.lng)):(this._southWest=new At(m.lat,m.lng),this._northEast=new At(v.lat,v.lng)),this},pad:function(c){var d=this._southWest,g=this._northEast,m=Math.abs(d.lat-g.lat)*c,v=Math.abs(d.lng-g.lng)*c;return new Jt(new At(d.lat-m,d.lng-v),new At(g.lat+m,g.lng+v))},getCenter:function(){return new At((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new At(this.getNorth(),this.getWest())},getSouthEast:function(){return new At(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(c){c="number"==typeof c[0]||c instanceof At||"lat"in c?at(c):qt(c);var m,v,d=this._southWest,g=this._northEast;return c instanceof Jt?(m=c.getSouthWest(),v=c.getNorthEast()):m=v=c,m.lat>=d.lat&&v.lat<=g.lat&&m.lng>=d.lng&&v.lng<=g.lng},intersects:function(c){c=qt(c);var d=this._southWest,g=this._northEast,m=c.getSouthWest(),v=c.getNorthEast();return v.lat>=d.lat&&m.lat<=g.lat&&v.lng>=d.lng&&m.lng<=g.lng},overlaps:function(c){c=qt(c);var d=this._southWest,g=this._northEast,m=c.getSouthWest(),v=c.getNorthEast();return v.lat>d.lat&&m.lat<g.lat&&v.lng>d.lng&&m.lng<g.lng},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(c,d){return!!c&&(c=qt(c),this._southWest.equals(c.getSouthWest(),d)&&this._northEast.equals(c.getNorthEast(),d))},isValid:function(){return!(!this._southWest||!this._northEast)}},At.prototype={equals:function(c,d){return!!c&&(c=at(c),Math.max(Math.abs(this.lat-c.lat),Math.abs(this.lng-c.lng))<=(void 0===d?1e-9:d))},toString:function(c){return"LatLng("+Ve(this.lat,c)+", "+Ve(this.lng,c)+")"},distanceTo:function(c){return sr.distance(this,at(c))},wrap:function(){return sr.wrapLatLng(this)},toBounds:function(c){var d=180*c/40075017,g=d/Math.cos(Math.PI/180*this.lat);return qt([this.lat-d,this.lng-g],[this.lat+d,this.lng+g])},clone:function(){return new At(this.lat,this.lng,this.alt)}};var c,gt={latLngToPoint:function(c,d){var g=this.projection.project(c),m=this.scale(d);return this.transformation._transform(g,m)},pointToLatLng:function(c,d){var g=this.scale(d),m=this.transformation.untransform(c,g);return this.projection.unproject(m)},project:function(c){return this.projection.project(c)},unproject:function(c){return this.projection.unproject(c)},scale:function(c){return 256*Math.pow(2,c)},zoom:function(c){return Math.log(c/256)/Math.LN2},getProjectedBounds:function(c){if(this.infinite)return null;var d=this.projection.bounds,g=this.scale(c);return new e(this.transformation.transform(d.min,g),this.transformation.transform(d.max,g))},infinite:!1,wrapLatLng:function(c){var d=this.wrapLng?ae(c.lng,this.wrapLng,!0):c.lng;return new At(this.wrapLat?ae(c.lat,this.wrapLat,!0):c.lat,d,c.alt)},wrapLatLngBounds:function(c){var d=c.getCenter(),g=this.wrapLatLng(d),m=d.lat-g.lat,v=d.lng-g.lng;if(0===m&&0===v)return c;var O=c.getSouthWest(),z=c.getNorthEast();return new Jt(new At(O.lat-m,O.lng-v),new At(z.lat-m,z.lng-v))}},sr=b({},gt,{wrapLng:[-180,180],R:6371e3,distance:function(c,d){var g=Math.PI/180,m=c.lat*g,v=d.lat*g,O=Math.sin((d.lat-c.lat)*g/2),z=Math.sin((d.lng-c.lng)*g/2),J=O*O+Math.cos(m)*Math.cos(v)*z*z,te=2*Math.atan2(Math.sqrt(J),Math.sqrt(1-J));return this.R*te}}),Qn={R:6378137,MAX_LATITUDE:85.0511287798,project:function(c){var d=Math.PI/180,g=this.MAX_LATITUDE,m=Math.max(Math.min(g,c.lat),-g),v=Math.sin(m*d);return new fe(this.R*c.lng*d,this.R*Math.log((1+v)/(1-v))/2)},unproject:function(c){var d=180/Math.PI;return new At((2*Math.atan(Math.exp(c.y/this.R))-Math.PI/2)*d,c.x*d/this.R)},bounds:(c=6378137*Math.PI,new e([-c,-c],[c,c]))};function Jn(c,d,g,m){if(ze(c))return this._a=c[0],this._b=c[1],this._c=c[2],void(this._d=c[3]);this._a=c,this._b=d,this._c=g,this._d=m}function cr(c,d,g,m){return new Jn(c,d,g,m)}Jn.prototype={transform:function(c,d){return this._transform(c.clone(),d)},_transform:function(c,d){return c.x=(d=d||1)*(this._a*c.x+this._b),c.y=d*(this._c*c.y+this._d),c},untransform:function(c,d){return new fe((c.x/(d=d||1)-this._b)/this._a,(c.y/d-this._d)/this._c)}};var li=b({},sr,{code:"EPSG:3857",projection:Qn,transformation:function(){var c=.5/(Math.PI*Qn.R);return cr(c,.5,-c,.5)}()}),Bc=b({},li,{code:"EPSG:900913"});function Mr(c){return document.createElementNS("http://www.w3.org/2000/svg",c)}function di(c,d){var m,v,O,z,J,te,g="";for(m=0,O=c.length;m<O;m++){for(v=0,z=(J=c[m]).length;v<z;v++)g+=(v?"L":"M")+(te=J[v]).x+" "+te.y;g+=d?et.svg?"z":"x":""}return g||"M0 0"}var $r=document.documentElement.style,ot="ActiveXObject"in window,qr=ot&&!document.addEventListener,_n="msLaunchUri"in navigator&&!("documentMode"in document),to=wr("webkit"),ls=wr("android"),ds=wr("android 2")||wr("android 3"),wi=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),vt=ls&&wr("Google")&&wi<537&&!("AudioNode"in window),wt=!!window.opera,us=!_n&&wr("chrome"),gs=wr("gecko")&&!to&&!wt&&!ot,Lc=!us&&wr("safari"),ps=wr("phantom"),fs="OTransition"in $r,$c=0===navigator.platform.indexOf("Win"),ms=ot&&"transition"in $r,ia="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ds,hs="MozPerspective"in $r,Gc=!window.L_DISABLE_3D&&(ms||ia||hs)&&!fs&&!ps,no=typeof orientation<"u"||wr("mobile"),Uc=no&&to,zc=no&&ia,_s=!window.PointerEvent&&window.MSPointerEvent,xs=!(!window.PointerEvent&&!_s),No="ontouchstart"in window||!!window.TouchEvent,Vc=!window.L_NO_TOUCH&&(No||xs),Yc=no&&wt,Xc=no&&gs,Hc=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Cs=function(){var c=!1;try{var d=Object.defineProperty({},"passive",{get:function(){c=!0}});window.addEventListener("testPassiveEventSupport",Me,d),window.removeEventListener("testPassiveEventSupport",Me,d)}catch{}return c}(),Wc=!!document.createElement("canvas").getContext,oa=!(!document.createElementNS||!Mr("svg").createSVGRect),qc=!!oa&&function(){var c=document.createElement("div");return c.innerHTML="<svg/>","http://www.w3.org/2000/svg"===(c.firstChild&&c.firstChild.namespaceURI)}(),Zc=!oa&&function(){try{var c=document.createElement("div");c.innerHTML='<v:shape adj="1"/>';var d=c.firstChild;return d.style.behavior="url(#default#VML)",d&&"object"==typeof d.adj}catch{return!1}}();function wr(c){return navigator.userAgent.toLowerCase().indexOf(c)>=0}var et={ie:ot,ielt9:qr,edge:_n,webkit:to,android:ls,android23:ds,androidStock:vt,opera:wt,chrome:us,gecko:gs,safari:Lc,phantom:ps,opera12:fs,win:$c,ie3d:ms,webkit3d:ia,gecko3d:hs,any3d:Gc,mobile:no,mobileWebkit:Uc,mobileWebkit3d:zc,msPointer:_s,pointer:xs,touch:Vc,touchNative:No,mobileOpera:Yc,mobileGecko:Xc,retina:Hc,passiveEvents:Cs,canvas:Wc,svg:oa,vml:Zc,inlineSvg:qc,mac:0===navigator.platform.indexOf("Mac"),linux:0===navigator.platform.indexOf("Linux")},vs=et.msPointer?"MSPointerDown":"pointerdown",Ps=et.msPointer?"MSPointerMove":"pointermove",bs=et.msPointer?"MSPointerUp":"pointerup",ks=et.msPointer?"MSPointerCancel":"pointercancel",aa={touchstart:vs,touchmove:Ps,touchend:bs,touchcancel:ks},Os={touchstart:function il(c,d){d.MSPOINTER_TYPE_TOUCH&&d.pointerType===d.MSPOINTER_TYPE_TOUCH&&En(d),ro(c,d)},touchmove:ro,touchend:ro,touchcancel:ro},Fi={},ys=!1;function Kc(c,d,g){return"touchstart"===d&&function rl(){ys||(document.addEventListener(vs,tl,!0),document.addEventListener(Ps,nl,!0),document.addEventListener(bs,Ms,!0),document.addEventListener(ks,Ms,!0),ys=!0)}(),Os[d]?(g=Os[d].bind(this,g),c.addEventListener(aa[d],g,!1),g):(console.warn("wrong event specified:",d),Me)}function tl(c){Fi[c.pointerId]=c}function nl(c){Fi[c.pointerId]&&(Fi[c.pointerId]=c)}function Ms(c){delete Fi[c.pointerId]}function ro(c,d){if(d.pointerType!==(d.MSPOINTER_TYPE_MOUSE||"mouse")){for(var g in d.touches=[],Fi)d.touches.push(Fi[g]);d.changedTouches=[d],c(d)}}var al=200;var Gr,oo,da,Bo,pa,sa=jo(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),xr=jo(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Ei="webkitTransition"===xr||"OTransition"===xr?xr+"End":"transitionend";function ws(c){return"string"==typeof c?document.getElementById(c):c}function io(c,d){var g=c.style[d]||c.currentStyle&&c.currentStyle[d];if((!g||"auto"===g)&&document.defaultView){var m=document.defaultView.getComputedStyle(c,null);g=m?m[d]:null}return"auto"===g?null:g}function jt(c,d,g){var m=document.createElement(c);return m.className=d||"",g&&g.appendChild(m),m}function Kt(c){var d=c.parentNode;d&&d.removeChild(c)}function Ao(c){for(;c.firstChild;)c.removeChild(c.firstChild)}function Si(c){var d=c.parentNode;d&&d.lastChild!==c&&d.appendChild(c)}function Ti(c){var d=c.parentNode;d&&d.firstChild!==c&&d.insertBefore(c,d.firstChild)}function ca(c,d){if(void 0!==c.classList)return c.classList.contains(d);var g=Do(c);return g.length>0&&new RegExp("(^|\\s)"+d+"(\\s|$)").test(g)}function Pt(c,d){if(void 0!==c.classList)for(var g=Ee(d),m=0,v=g.length;m<v;m++)c.classList.add(g[m]);else if(!ca(c,d)){var O=Do(c);la(c,(O?O+" ":"")+d)}}function cn(c,d){void 0!==c.classList?c.classList.remove(d):la(c,ge((" "+Do(c)+" ").replace(" "+d+" "," ")))}function la(c,d){void 0===c.className.baseVal?c.className=d:c.className.baseVal=d}function Do(c){return c.correspondingElement&&(c=c.correspondingElement),void 0===c.className.baseVal?c.className:c.className.baseVal}function lr(c,d){"opacity"in c.style?c.style.opacity=d:"filter"in c.style&&function ll(c,d){var g=!1,m="DXImageTransform.Microsoft.Alpha";try{g=c.filters.item(m)}catch{if(1===d)return}d=Math.round(100*d),g?(g.Enabled=100!==d,g.Opacity=d):c.style.filter+=" progid:"+m+"(opacity="+d+")"}(c,d)}function jo(c){for(var d=document.documentElement.style,g=0;g<c.length;g++)if(c[g]in d)return c[g];return!1}function ui(c,d,g){var m=d||new fe(0,0);c.style[sa]=(et.ie3d?"translate("+m.x+"px,"+m.y+"px)":"translate3d("+m.x+"px,"+m.y+"px,0)")+(g?" scale("+g+")":"")}function dn(c,d){c._leaflet_pos=d,et.any3d?ui(c,d):(c.style.left=d.x+"px",c.style.top=d.y+"px")}function He(c){return c._leaflet_pos||new fe(0,0)}if("onselectstart"in document)Gr=function(){mt(window,"selectstart",En)},oo=function(){Ut(window,"selectstart",En)};else{var ao=jo(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Gr=function(){if(ao){var c=document.documentElement.style;da=c[ao],c[ao]="none"}},oo=function(){ao&&(document.documentElement.style[ao]=da,da=void 0)}}function ua(){mt(window,"dragstart",En)}function ga(){Ut(window,"dragstart",En)}function fa(c){for(;-1===c.tabIndex;)c=c.parentNode;c.style&&(Lo(),Bo=c,pa=c.style.outlineStyle,c.style.outlineStyle="none",mt(window,"keydown",Lo))}function Lo(){Bo&&(Bo.style.outlineStyle=pa,Bo=void 0,pa=void 0,Ut(window,"keydown",Lo))}function Fs(c){do{c=c.parentNode}while(!(c.offsetWidth&&c.offsetHeight||c===document.body));return c}function ma(c){var d=c.getBoundingClientRect();return{x:d.width/c.offsetWidth||1,y:d.height/c.offsetHeight||1,boundingClientRect:d}}var dl={__proto__:null,TRANSFORM:sa,TRANSITION:xr,TRANSITION_END:Ei,get:ws,getStyle:io,create:jt,remove:Kt,empty:Ao,toFront:Si,toBack:Ti,hasClass:ca,addClass:Pt,removeClass:cn,setClass:la,getClass:Do,setOpacity:lr,testProp:jo,setTransform:ui,setPosition:dn,getPosition:He,get disableTextSelection(){return Gr},get enableTextSelection(){return oo},disableImageDrag:ua,enableImageDrag:ga,preventOutline:fa,restoreOutline:Lo,getSizedParentNode:Fs,getScale:ma};function mt(c,d,g,m){if(d&&"object"==typeof d)for(var v in d)_a(c,v,d[v],g);else for(var O=0,z=(d=Ee(d)).length;O<z;O++)_a(c,d[O],g,m);return this}var Cr="_leaflet_events";function Ut(c,d,g,m){if(1===arguments.length)so(c),delete c[Cr];else if(d&&"object"==typeof d)for(var v in d)xa(c,v,d[v],g);else if(d=Ee(d),2===arguments.length)so(c,function(J){return-1!==_t(d,J)});else for(var O=0,z=d.length;O<z;O++)xa(c,d[O],g,m);return this}function so(c,d){for(var g in c[Cr]){var m=g.split(/\d/)[0];(!d||d(m))&&xa(c,m,null,null,g)}}var ha={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function _a(c,d,g,m){var v=d+X(g)+(m?"_"+X(m):"");if(c[Cr]&&c[Cr][v])return this;var O=function(J){return g.call(m||c,J||window.event)},z=O;!et.touchNative&&et.pointer&&0===d.indexOf("touch")?O=Kc(c,d,O):et.touch&&"dblclick"===d?O=function sl(c,d){c.addEventListener("dblclick",d);var m,g=0;function v(O){if(1===O.detail){if("mouse"!==O.pointerType&&(!O.sourceCapabilities||O.sourceCapabilities.firesTouchEvents)){var z=Es(O);if(!z.some(function(te){return te instanceof HTMLLabelElement&&te.attributes.for})||z.some(function(te){return te instanceof HTMLInputElement||te instanceof HTMLSelectElement})){var J=Date.now();J-g<=al?2==++m&&d(function ol(c){var g,m,d={};for(m in c)d[m]=(g=c[m])&&g.bind?g.bind(c):g;return c=d,d.type="dblclick",d.detail=2,d.isTrusted=!1,d._simulated=!0,d}(O)):m=1,g=J}}}else m=O.detail}return c.addEventListener("click",v),{dblclick:d,simDblclick:v}}(c,O):"addEventListener"in c?"touchstart"===d||"touchmove"===d||"wheel"===d||"mousewheel"===d?c.addEventListener(ha[d]||d,O,!!et.passiveEvents&&{passive:!1}):"mouseenter"===d||"mouseleave"===d?c.addEventListener(ha[d],O=function(J){J=J||window.event,fi(c,J)&&z(J)},!1):c.addEventListener(d,z,!1):c.attachEvent("on"+d,O),c[Cr]=c[Cr]||{},c[Cr][v]=O}function xa(c,d,g,m,v){v=v||d+X(g)+(m?"_"+X(m):"");var O=c[Cr]&&c[Cr][v];if(!O)return this;!et.touchNative&&et.pointer&&0===d.indexOf("touch")?function el(c,d,g){aa[d]?c.removeEventListener(aa[d],g,!1):console.warn("wrong event specified:",d)}(c,d,O):et.touch&&"dblclick"===d?function cl(c,d){c.removeEventListener("dblclick",d.dblclick),c.removeEventListener("click",d.simDblclick)}(c,O):"removeEventListener"in c?c.removeEventListener(ha[d]||d,O,!1):c.detachEvent("on"+d,O),c[Cr][v]=null}function gi(c){return c.stopPropagation?c.stopPropagation():c.originalEvent?c.originalEvent._stopped=!0:c.cancelBubble=!0,this}function Ca(c){return _a(c,"wheel",gi),this}function co(c){return mt(c,"mousedown touchstart dblclick contextmenu",gi),c._leaflet_disable_click=!0,this}function En(c){return c.preventDefault?c.preventDefault():c.returnValue=!1,this}function pi(c){return En(c),gi(c),this}function Es(c){if(c.composedPath)return c.composedPath();for(var d=[],g=c.target;g;)d.push(g),g=g.parentNode;return d}function Ss(c,d){if(!d)return new fe(c.clientX,c.clientY);var g=ma(d),m=g.boundingClientRect;return new fe((c.clientX-m.left)/g.x-d.clientLeft,(c.clientY-m.top)/g.y-d.clientTop)}var ul=et.linux&&et.chrome?window.devicePixelRatio:et.mac?3*window.devicePixelRatio:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ts(c){return et.edge?c.wheelDeltaY/2:c.deltaY&&0===c.deltaMode?-c.deltaY/ul:c.deltaY&&1===c.deltaMode?20*-c.deltaY:c.deltaY&&2===c.deltaMode?60*-c.deltaY:c.deltaX||c.deltaZ?0:c.wheelDelta?(c.wheelDeltaY||c.wheelDelta)/2:c.detail&&Math.abs(c.detail)<32765?20*-c.detail:c.detail?c.detail/-32765*60:0}function fi(c,d){var g=d.relatedTarget;if(!g)return!0;try{for(;g&&g!==c;)g=g.parentNode}catch{return!1}return g!==c}var gl={__proto__:null,on:mt,off:Ut,stopPropagation:gi,disableScrollPropagation:Ca,disableClickPropagation:co,preventDefault:En,stop:pi,getPropagationPath:Es,getMousePosition:Ss,getWheelDelta:Ts,isExternalTarget:fi,addListener:mt,removeListener:Ut},Is=Xe.extend({run:function(c,d,g,m){this.stop(),this._el=c,this._inProgress=!0,this._duration=g||.25,this._easeOutPower=1/Math.max(m||.5,.2),this._startPos=He(c),this._offset=d.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=Ue(this._animate,this),this._step()},_step:function(c){var d=+new Date-this._startTime,g=1e3*this._duration;d<g?this._runFrame(this._easeOut(d/g),c):(this._runFrame(1),this._complete())},_runFrame:function(c,d){var g=this._startPos.add(this._offset.multiplyBy(c));d&&g._round(),dn(this._el,g),this.fire("step")},_complete:function(){Ae(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(c){return 1-Math.pow(1-c,this._easeOutPower)}}),Rt=Xe.extend({options:{crs:li,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(c,d){d=Ce(this,d),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(c),this._initLayout(),this._onResize=B(this._onResize,this),this._initEvents(),d.maxBounds&&this.setMaxBounds(d.maxBounds),void 0!==d.zoom&&(this._zoom=this._limitZoom(d.zoom)),d.center&&void 0!==d.zoom&&this.setView(at(d.center),d.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=xr&&et.any3d&&!et.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),mt(this._proxy,Ei,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(c,d,g){return d=void 0===d?this._zoom:this._limitZoom(d),c=this._limitCenter(at(c),d,this.options.maxBounds),g=g||{},this._stop(),this._loaded&&!g.reset&&!0!==g&&(void 0!==g.animate&&(g.zoom=b({animate:g.animate},g.zoom),g.pan=b({animate:g.animate,duration:g.duration},g.pan)),this._zoom!==d?this._tryAnimatedZoom&&this._tryAnimatedZoom(c,d,g.zoom):this._tryAnimatedPan(c,g.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(c,d,g.pan&&g.pan.noMoveStart),this)},setZoom:function(c,d){return this._loaded?this.setView(this.getCenter(),c,{zoom:d}):(this._zoom=c,this)},zoomIn:function(c,d){return this.setZoom(this._zoom+(c=c||(et.any3d?this.options.zoomDelta:1)),d)},zoomOut:function(c,d){return this.setZoom(this._zoom-(c=c||(et.any3d?this.options.zoomDelta:1)),d)},setZoomAround:function(c,d,g){var m=this.getZoomScale(d),v=this.getSize().divideBy(2),z=(c instanceof fe?c:this.latLngToContainerPoint(c)).subtract(v).multiplyBy(1-1/m),J=this.containerPointToLatLng(v.add(z));return this.setView(J,d,{zoom:g})},_getBoundsCenterZoom:function(c,d){d=d||{},c=c.getBounds?c.getBounds():qt(c);var g=Oe(d.paddingTopLeft||d.padding||[0,0]),m=Oe(d.paddingBottomRight||d.padding||[0,0]),v=this.getBoundsZoom(c,!1,g.add(m));if((v="number"==typeof d.maxZoom?Math.min(d.maxZoom,v):v)===1/0)return{center:c.getCenter(),zoom:v};var O=m.subtract(g).divideBy(2),z=this.project(c.getSouthWest(),v),J=this.project(c.getNorthEast(),v);return{center:this.unproject(z.add(J).divideBy(2).add(O),v),zoom:v}},fitBounds:function(c,d){if(!(c=qt(c)).isValid())throw new Error("Bounds are not valid.");var g=this._getBoundsCenterZoom(c,d);return this.setView(g.center,g.zoom,d)},fitWorld:function(c){return this.fitBounds([[-90,-180],[90,180]],c)},panTo:function(c,d){return this.setView(c,this._zoom,{pan:d})},panBy:function(c,d){if(d=d||{},!(c=Oe(c).round()).x&&!c.y)return this.fire("moveend");if(!0!==d.animate&&!this.getSize().contains(c))return this._resetView(this.unproject(this.project(this.getCenter()).add(c)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Is,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),d.noMoveStart||this.fire("movestart"),!1!==d.animate){Pt(this._mapPane,"leaflet-pan-anim");var g=this._getMapPanePos().subtract(c).round();this._panAnim.run(this._mapPane,g,d.duration||.25,d.easeLinearity)}else this._rawPanBy(c),this.fire("move").fire("moveend");return this},flyTo:function(c,d,g){if(!1===(g=g||{}).animate||!et.any3d)return this.setView(c,d,g);this._stop();var m=this.project(this.getCenter()),v=this.project(c),O=this.getSize(),z=this._zoom;c=at(c),d=void 0===d?z:d;var J=Math.max(O.x,O.y),te=J*this.getZoomScale(z,d),be=v.distanceTo(m)||1,Ge=1.42,st=Ge*Ge;function ut(Zt){var Ta=(te*te-J*J+(Zt?-1:1)*st*st*be*be)/(2*(Zt?te:J)*st*be),oc=Math.sqrt(Ta*Ta+1)-Ta;return oc<1e-9?-18:Math.log(oc)}function en(Zt){return(Math.exp(Zt)-Math.exp(-Zt))/2}function kn(Zt){return(Math.exp(Zt)+Math.exp(-Zt))/2}var xn=ut(0);function nc(Zt){return J*(kn(xn)*function nr(Zt){return en(Zt)/kn(Zt)}(xn+Ge*Zt)-en(xn))/st}var Nl=Date.now(),Un=(ut(1)-xn)/Ge,Tr=g.duration?1e3*g.duration:1e3*Un*.8;return this._moveStart(!0,g.noMoveStart),function zi(){var Zt=(Date.now()-Nl)/Tr,Yo=function rc(Zt){return 1-Math.pow(1-Zt,1.5)}(Zt)*Un;Zt<=1?(this._flyToFrame=Ue(zi,this),this._move(this.unproject(m.add(v.subtract(m).multiplyBy(nc(Yo)/be)),z),this.getScaleZoom(J/function Ui(Zt){return J*(kn(xn)/kn(xn+Ge*Zt))}(Yo),z),{flyTo:!0})):this._move(c,d)._moveEnd(!0)}.call(this),this},flyToBounds:function(c,d){var g=this._getBoundsCenterZoom(c,d);return this.flyTo(g.center,g.zoom,d)},setMaxBounds:function(c){return c=qt(c),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),c.isValid()?(this.options.maxBounds=c,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(c){var d=this.options.minZoom;return this.options.minZoom=c,this._loaded&&d!==c&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(c):this},setMaxZoom:function(c){var d=this.options.maxZoom;return this.options.maxZoom=c,this._loaded&&d!==c&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(c):this},panInsideBounds:function(c,d){this._enforcingBounds=!0;var g=this.getCenter(),m=this._limitCenter(g,this._zoom,qt(c));return g.equals(m)||this.panTo(m,d),this._enforcingBounds=!1,this},panInside:function(c,d){var g=Oe((d=d||{}).paddingTopLeft||d.padding||[0,0]),m=Oe(d.paddingBottomRight||d.padding||[0,0]),v=this.project(this.getCenter()),O=this.project(c),z=this.getPixelBounds(),J=Gt([z.min.add(g),z.max.subtract(m)]),te=J.getSize();if(!J.contains(O)){this._enforcingBounds=!0;var be=O.subtract(J.getCenter()),Ge=J.extend(O).getSize().subtract(te);v.x+=be.x<0?-Ge.x:Ge.x,v.y+=be.y<0?-Ge.y:Ge.y,this.panTo(this.unproject(v),d),this._enforcingBounds=!1}return this},invalidateSize:function(c){if(!this._loaded)return this;c=b({animate:!1,pan:!0},!0===c?{animate:!0}:c);var d=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var g=this.getSize(),m=d.divideBy(2).round(),v=g.divideBy(2).round(),O=m.subtract(v);return O.x||O.y?(c.animate&&c.pan?this.panBy(O):(c.pan&&this._rawPanBy(O),this.fire("move"),c.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(B(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:d,newSize:g})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(c){if(c=this._locateOptions=b({timeout:1e4,watch:!1},c),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var d=B(this._handleGeolocationResponse,this),g=B(this._handleGeolocationError,this);return c.watch?this._locationWatchId=navigator.geolocation.watchPosition(d,g,c):navigator.geolocation.getCurrentPosition(d,g,c),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(c){if(this._container._leaflet_id){var d=c.code,g=c.message||(1===d?"permission denied":2===d?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:d,message:"Geolocation error: "+g+"."})}},_handleGeolocationResponse:function(c){if(this._container._leaflet_id){var m=new At(c.coords.latitude,c.coords.longitude),v=m.toBounds(2*c.coords.accuracy),O=this._locateOptions;if(O.setView){var z=this.getBoundsZoom(v);this.setView(m,O.maxZoom?Math.min(z,O.maxZoom):z)}var J={latlng:m,bounds:v,timestamp:c.timestamp};for(var te in c.coords)"number"==typeof c.coords[te]&&(J[te]=c.coords[te]);this.fire("locationfound",J)}},addHandler:function(c,d){if(!d)return this;var g=this[c]=new d(this);return this._handlers.push(g),this.options[c]&&g.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}var c;for(c in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),Kt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Ae(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[c].remove();for(c in this._panes)Kt(this._panes[c]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(c,d){var m=jt("div","leaflet-pane"+(c?" leaflet-"+c.replace("Pane","")+"-pane":""),d||this._mapPane);return c&&(this._panes[c]=m),m},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var c=this.getPixelBounds();return new Jt(this.unproject(c.getBottomLeft()),this.unproject(c.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(c,d,g){c=qt(c),g=Oe(g||[0,0]);var m=this.getZoom()||0,v=this.getMinZoom(),O=this.getMaxZoom(),z=c.getNorthWest(),J=c.getSouthEast(),te=this.getSize().subtract(g),be=Gt(this.project(J,m),this.project(z,m)).getSize(),Ge=et.any3d?this.options.zoomSnap:1,st=te.x/be.x,ut=te.y/be.y,en=d?Math.max(st,ut):Math.min(st,ut);return m=this.getScaleZoom(en,m),Ge&&(m=Math.round(m/(Ge/100))*(Ge/100),m=d?Math.ceil(m/Ge)*Ge:Math.floor(m/Ge)*Ge),Math.max(v,Math.min(O,m))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new fe(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(c,d){var g=this._getTopLeftPoint(c,d);return new e(g,g.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(c){return this.options.crs.getProjectedBounds(void 0===c?this.getZoom():c)},getPane:function(c){return"string"==typeof c?this._panes[c]:c},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(c,d){var g=this.options.crs;return d=void 0===d?this._zoom:d,g.scale(c)/g.scale(d)},getScaleZoom:function(c,d){var g=this.options.crs,m=g.zoom(c*g.scale(d=void 0===d?this._zoom:d));return isNaN(m)?1/0:m},project:function(c,d){return d=void 0===d?this._zoom:d,this.options.crs.latLngToPoint(at(c),d)},unproject:function(c,d){return d=void 0===d?this._zoom:d,this.options.crs.pointToLatLng(Oe(c),d)},layerPointToLatLng:function(c){var d=Oe(c).add(this.getPixelOrigin());return this.unproject(d)},latLngToLayerPoint:function(c){return this.project(at(c))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(c){return this.options.crs.wrapLatLng(at(c))},wrapLatLngBounds:function(c){return this.options.crs.wrapLatLngBounds(qt(c))},distance:function(c,d){return this.options.crs.distance(at(c),at(d))},containerPointToLayerPoint:function(c){return Oe(c).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(c){return Oe(c).add(this._getMapPanePos())},containerPointToLatLng:function(c){var d=this.containerPointToLayerPoint(Oe(c));return this.layerPointToLatLng(d)},latLngToContainerPoint:function(c){return this.layerPointToContainerPoint(this.latLngToLayerPoint(at(c)))},mouseEventToContainerPoint:function(c){return Ss(c,this._container)},mouseEventToLayerPoint:function(c){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(c))},mouseEventToLatLng:function(c){return this.layerPointToLatLng(this.mouseEventToLayerPoint(c))},_initContainer:function(c){var d=this._container=ws(c);if(!d)throw new Error("Map container not found.");if(d._leaflet_id)throw new Error("Map container is already initialized.");mt(d,"scroll",this._onScroll,this),this._containerId=X(d)},_initLayout:function(){var c=this._container;this._fadeAnimated=this.options.fadeAnimation&&et.any3d,Pt(c,"leaflet-container"+(et.touch?" leaflet-touch":"")+(et.retina?" leaflet-retina":"")+(et.ielt9?" leaflet-oldie":"")+(et.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var d=io(c,"position");"absolute"!==d&&"relative"!==d&&"fixed"!==d&&"sticky"!==d&&(c.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var c=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),dn(this._mapPane,new fe(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Pt(c.markerPane,"leaflet-zoom-hide"),Pt(c.shadowPane,"leaflet-zoom-hide"))},_resetView:function(c,d,g){dn(this._mapPane,new fe(0,0));var m=!this._loaded;this._loaded=!0,d=this._limitZoom(d),this.fire("viewprereset");var v=this._zoom!==d;this._moveStart(v,g)._move(c,d)._moveEnd(v),this.fire("viewreset"),m&&this.fire("load")},_moveStart:function(c,d){return c&&this.fire("zoomstart"),d||this.fire("movestart"),this},_move:function(c,d,g,m){void 0===d&&(d=this._zoom);var v=this._zoom!==d;return this._zoom=d,this._lastCenter=c,this._pixelOrigin=this._getNewPixelOrigin(c),m?g&&g.pinch&&this.fire("zoom",g):((v||g&&g.pinch)&&this.fire("zoom",g),this.fire("move",g)),this},_moveEnd:function(c){return c&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Ae(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(c){dn(this._mapPane,this._getMapPanePos().subtract(c))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(c){this._targets={},this._targets[X(this._container)]=this;var d=c?Ut:mt;d(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&d(window,"resize",this._onResize,this),et.any3d&&this.options.transform3DLimit&&(c?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Ae(this._resizeRequest),this._resizeRequest=Ue(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var c=this._getMapPanePos();Math.max(Math.abs(c.x),Math.abs(c.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(c,d){for(var m,g=[],v="mouseout"===d||"mouseover"===d,O=c.target||c.srcElement,z=!1;O;){if((m=this._targets[X(O)])&&("click"===d||"preclick"===d)&&this._draggableMoved(m)){z=!0;break}if(m&&m.listens(d,!0)&&(v&&!fi(O,c)||(g.push(m),v))||O===this._container)break;O=O.parentNode}return!g.length&&!z&&!v&&this.listens(d,!0)&&(g=[this]),g},_isClickDisabled:function(c){for(;c&&c!==this._container;){if(c._leaflet_disable_click)return!0;c=c.parentNode}},_handleDOMEvent:function(c){var d=c.target||c.srcElement;if(!(!this._loaded||d._leaflet_disable_events||"click"===c.type&&this._isClickDisabled(d))){var g=c.type;"mousedown"===g&&fa(d),this._fireDOMEvent(c,g)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(c,d,g){if("click"===c.type){var m=b({},c);m.type="preclick",this._fireDOMEvent(m,m.type,g)}var v=this._findEventTargets(c,d);if(g){for(var O=[],z=0;z<g.length;z++)g[z].listens(d,!0)&&O.push(g[z]);v=O.concat(v)}if(v.length){"contextmenu"===d&&En(c);var J=v[0],te={originalEvent:c};if("keypress"!==c.type&&"keydown"!==c.type&&"keyup"!==c.type){var be=J.getLatLng&&(!J._radius||J._radius<=10);te.containerPoint=be?this.latLngToContainerPoint(J.getLatLng()):this.mouseEventToContainerPoint(c),te.layerPoint=this.containerPointToLayerPoint(te.containerPoint),te.latlng=be?J.getLatLng():this.layerPointToLatLng(te.layerPoint)}for(z=0;z<v.length;z++)if(v[z].fire(d,te,!0),te.originalEvent._stopped||!1===v[z].options.bubblingMouseEvents&&-1!==_t(this._mouseEvents,d))return}},_draggableMoved:function(c){return(c=c.dragging&&c.dragging.enabled()?c:this).dragging&&c.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var c=0,d=this._handlers.length;c<d;c++)this._handlers[c].disable()},whenReady:function(c,d){return this._loaded?c.call(d||this,{target:this}):this.on("load",c,d),this},_getMapPanePos:function(){return He(this._mapPane)||new fe(0,0)},_moved:function(){var c=this._getMapPanePos();return c&&!c.equals([0,0])},_getTopLeftPoint:function(c,d){return(c&&void 0!==d?this._getNewPixelOrigin(c,d):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(c,d){var g=this.getSize()._divideBy(2);return this.project(c,d)._subtract(g)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(c,d,g){var m=this._getNewPixelOrigin(g,d);return this.project(c,d)._subtract(m)},_latLngBoundsToNewLayerBounds:function(c,d,g){var m=this._getNewPixelOrigin(g,d);return Gt([this.project(c.getSouthWest(),d)._subtract(m),this.project(c.getNorthWest(),d)._subtract(m),this.project(c.getSouthEast(),d)._subtract(m),this.project(c.getNorthEast(),d)._subtract(m)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(c){return this.latLngToLayerPoint(c).subtract(this._getCenterLayerPoint())},_limitCenter:function(c,d,g){if(!g)return c;var m=this.project(c,d),v=this.getSize().divideBy(2),O=new e(m.subtract(v),m.add(v)),z=this._getBoundsOffset(O,g,d);return Math.abs(z.x)<=1&&Math.abs(z.y)<=1?c:this.unproject(m.add(z),d)},_limitOffset:function(c,d){if(!d)return c;var g=this.getPixelBounds(),m=new e(g.min.add(c),g.max.add(c));return c.add(this._getBoundsOffset(m,d))},_getBoundsOffset:function(c,d,g){var m=Gt(this.project(d.getNorthEast(),g),this.project(d.getSouthWest(),g)),v=m.min.subtract(c.min),O=m.max.subtract(c.max);return new fe(this._rebound(v.x,-O.x),this._rebound(v.y,-O.y))},_rebound:function(c,d){return c+d>0?Math.round(c-d)/2:Math.max(0,Math.ceil(c))-Math.max(0,Math.floor(d))},_limitZoom:function(c){var d=this.getMinZoom(),g=this.getMaxZoom(),m=et.any3d?this.options.zoomSnap:1;return m&&(c=Math.round(c/m)*m),Math.max(d,Math.min(g,c))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){cn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(c,d){var g=this._getCenterOffset(c)._trunc();return!(!0!==(d&&d.animate)&&!this.getSize().contains(g)||(this.panBy(g,d),0))},_createAnimProxy:function(){var c=this._proxy=jt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(c),this.on("zoomanim",function(d){var g=sa,m=this._proxy.style[g];ui(this._proxy,this.project(d.center,d.zoom),this.getZoomScale(d.zoom,1)),m===this._proxy.style[g]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Kt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var c=this.getCenter(),d=this.getZoom();ui(this._proxy,this.project(c,d),this.getZoomScale(d,1))},_catchTransitionEnd:function(c){this._animatingZoom&&c.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(c,d,g){if(this._animatingZoom)return!0;if(g=g||{},!this._zoomAnimated||!1===g.animate||this._nothingToAnimate()||Math.abs(d-this._zoom)>this.options.zoomAnimationThreshold)return!1;var m=this.getZoomScale(d),v=this._getCenterOffset(c)._divideBy(1-1/m);return!(!0!==g.animate&&!this.getSize().contains(v)||(Ue(function(){this._moveStart(!0,g.noMoveStart||!1)._animateZoom(c,d,!0)},this),0))},_animateZoom:function(c,d,g,m){this._mapPane&&(g&&(this._animatingZoom=!0,this._animateToCenter=c,this._animateToZoom=d,Pt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:c,zoom:d,noUpdate:m}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(B(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&cn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});var vr=Je.extend({options:{position:"topright"},initialize:function(c){Ce(this,c)},getPosition:function(){return this.options.position},setPosition:function(c){var d=this._map;return d&&d.removeControl(this),this.options.position=c,d&&d.addControl(this),this},getContainer:function(){return this._container},addTo:function(c){this.remove(),this._map=c;var d=this._container=this.onAdd(c),g=this.getPosition(),m=c._controlCorners[g];return Pt(d,"leaflet-control"),-1!==g.indexOf("bottom")?m.insertBefore(d,m.firstChild):m.appendChild(d),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Kt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(c){this._map&&c&&c.screenX>0&&c.screenY>0&&this._map.getContainer().focus()}}),lo=function(c){return new vr(c)};Rt.include({addControl:function(c){return c.addTo(this),this},removeControl:function(c){return c.remove(),this},_initControlPos:function(){var c=this._controlCorners={},d="leaflet-",g=this._controlContainer=jt("div",d+"control-container",this._container);function m(v,O){c[v+O]=jt("div",d+v+" "+d+O,g)}m("top","left"),m("top","right"),m("bottom","left"),m("bottom","right")},_clearControlPos:function(){for(var c in this._controlCorners)Kt(this._controlCorners[c]);Kt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Rs=vr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(c,d,g,m){return g<m?-1:m<g?1:0}},initialize:function(c,d,g){for(var m in Ce(this,g),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1,c)this._addLayer(c[m],m);for(m in d)this._addLayer(d[m],m,!0)},onAdd:function(c){this._initLayout(),this._update(),this._map=c,c.on("zoomend",this._checkDisabledLayers,this);for(var d=0;d<this._layers.length;d++)this._layers[d].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(c){return vr.prototype.addTo.call(this,c),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(c,d){return this._addLayer(c,d),this._map?this._update():this},addOverlay:function(c,d){return this._addLayer(c,d,!0),this._map?this._update():this},removeLayer:function(c){c.off("add remove",this._onLayerChange,this);var d=this._getLayer(X(c));return d&&this._layers.splice(this._layers.indexOf(d),1),this._map?this._update():this},expand:function(){Pt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var c=this._map.getSize().y-(this._container.offsetTop+50);return c<this._section.clientHeight?(Pt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=c+"px"):cn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return cn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var c="leaflet-control-layers",d=this._container=jt("div",c),g=this.options.collapsed;d.setAttribute("aria-haspopup",!0),co(d),Ca(d);var m=this._section=jt("section",c+"-list");g&&(this._map.on("click",this.collapse,this),mt(d,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var v=this._layersLink=jt("a",c+"-toggle",d);v.href="#",v.title="Layers",v.setAttribute("role","button"),mt(v,{keydown:function(O){13===O.keyCode&&this._expandSafely()},click:function(O){En(O),this._expandSafely()}},this),g||this.expand(),this._baseLayersList=jt("div",c+"-base",m),this._separator=jt("div",c+"-separator",m),this._overlaysList=jt("div",c+"-overlays",m),d.appendChild(m)},_getLayer:function(c){for(var d=0;d<this._layers.length;d++)if(this._layers[d]&&X(this._layers[d].layer)===c)return this._layers[d]},_addLayer:function(c,d,g){this._map&&c.on("add remove",this._onLayerChange,this),this._layers.push({layer:c,name:d,overlay:g}),this.options.sortLayers&&this._layers.sort(B(function(m,v){return this.options.sortFunction(m.layer,v.layer,m.name,v.name)},this)),this.options.autoZIndex&&c.setZIndex&&(this._lastZIndex++,c.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Ao(this._baseLayersList),Ao(this._overlaysList),this._layerControlInputs=[];var c,d,g,m,v=0;for(g=0;g<this._layers.length;g++)this._addItem(m=this._layers[g]),d=d||m.overlay,c=c||!m.overlay,v+=m.overlay?0:1;return this.options.hideSingleBase&&(this._baseLayersList.style.display=(c=c&&v>1)?"":"none"),this._separator.style.display=d&&c?"":"none",this},_onLayerChange:function(c){this._handlingClick||this._update();var d=this._getLayer(X(c.target)),g=d.overlay?"add"===c.type?"overlayadd":"overlayremove":"add"===c.type?"baselayerchange":null;g&&this._map.fire(g,d)},_createRadioElement:function(c,d){var g='<input type="radio" class="leaflet-control-layers-selector" name="'+c+'"'+(d?' checked="checked"':"")+"/>",m=document.createElement("div");return m.innerHTML=g,m.firstChild},_addItem:function(c){var m,d=document.createElement("label"),g=this._map.hasLayer(c.layer);c.overlay?((m=document.createElement("input")).type="checkbox",m.className="leaflet-control-layers-selector",m.defaultChecked=g):m=this._createRadioElement("leaflet-base-layers_"+X(this),g),this._layerControlInputs.push(m),m.layerId=X(c.layer),mt(m,"click",this._onInputClick,this);var v=document.createElement("span");v.innerHTML=" "+c.name;var O=document.createElement("span");return d.appendChild(O),O.appendChild(m),O.appendChild(v),(c.overlay?this._overlaysList:this._baseLayersList).appendChild(d),this._checkDisabledLayers(),d},_onInputClick:function(){if(!this._preventClick){var d,g,c=this._layerControlInputs,m=[],v=[];this._handlingClick=!0;for(var O=c.length-1;O>=0;O--)g=this._getLayer((d=c[O]).layerId).layer,d.checked?m.push(g):d.checked||v.push(g);for(O=0;O<v.length;O++)this._map.hasLayer(v[O])&&this._map.removeLayer(v[O]);for(O=0;O<m.length;O++)this._map.hasLayer(m[O])||this._map.addLayer(m[O]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var d,g,c=this._layerControlInputs,m=this._map.getZoom(),v=c.length-1;v>=0;v--)g=this._getLayer((d=c[v]).layerId).layer,d.disabled=void 0!==g.options.minZoom&&m<g.options.minZoom||void 0!==g.options.maxZoom&&m>g.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var c=this._section;this._preventClick=!0,mt(c,"click",En),this.expand();var d=this;setTimeout(function(){Ut(c,"click",En),d._preventClick=!1})}}),va=vr.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(c){var d="leaflet-control-zoom",g=jt("div",d+" leaflet-bar"),m=this.options;return this._zoomInButton=this._createButton(m.zoomInText,m.zoomInTitle,d+"-in",g,this._zoomIn),this._zoomOutButton=this._createButton(m.zoomOutText,m.zoomOutTitle,d+"-out",g,this._zoomOut),this._updateDisabled(),c.on("zoomend zoomlevelschange",this._updateDisabled,this),g},onRemove:function(c){c.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(c){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(c.shiftKey?3:1))},_zoomOut:function(c){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(c.shiftKey?3:1))},_createButton:function(c,d,g,m,v){var O=jt("a",g,m);return O.innerHTML=c,O.href="#",O.title=d,O.setAttribute("role","button"),O.setAttribute("aria-label",d),co(O),mt(O,"click",pi),mt(O,"click",v,this),mt(O,"click",this._refocusOnMap,this),O},_updateDisabled:function(){var c=this._map,d="leaflet-disabled";cn(this._zoomInButton,d),cn(this._zoomOutButton,d),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||c._zoom===c.getMinZoom())&&(Pt(this._zoomOutButton,d),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||c._zoom===c.getMaxZoom())&&(Pt(this._zoomInButton,d),this._zoomInButton.setAttribute("aria-disabled","true"))}});Rt.mergeOptions({zoomControl:!0}),Rt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new va,this.addControl(this.zoomControl))});var Ns=vr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(c){var d="leaflet-control-scale",g=jt("div",d),m=this.options;return this._addScales(m,d+"-line",g),c.on(m.updateWhenIdle?"moveend":"move",this._update,this),c.whenReady(this._update,this),g},onRemove:function(c){c.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(c,d,g){c.metric&&(this._mScale=jt("div",d,g)),c.imperial&&(this._iScale=jt("div",d,g))},_update:function(){var c=this._map,d=c.getSize().y/2,g=c.distance(c.containerPointToLatLng([0,d]),c.containerPointToLatLng([this.options.maxWidth,d]));this._updateScales(g)},_updateScales:function(c){this.options.metric&&c&&this._updateMetric(c),this.options.imperial&&c&&this._updateImperial(c)},_updateMetric:function(c){var d=this._getRoundNum(c);this._updateScale(this._mScale,d<1e3?d+" m":d/1e3+" km",d/c)},_updateImperial:function(c){var g,m,v,d=3.2808399*c;d>5280?(m=this._getRoundNum(g=d/5280),this._updateScale(this._iScale,m+" mi",m/g)):(v=this._getRoundNum(d),this._updateScale(this._iScale,v+" ft",v/d))},_updateScale:function(c,d,g){c.style.width=Math.round(this.options.maxWidth*g)+"px",c.innerHTML=d},_getRoundNum:function(c){var d=Math.pow(10,(Math.floor(c)+"").length-1),g=c/d;return d*(g>=10?10:g>=5?5:g>=3?3:g>=2?2:1)}}),Pa=vr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(et.inlineSvg?'<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg> ':"")+"Leaflet</a>"},initialize:function(c){Ce(this,c),this._attributions={}},onAdd:function(c){for(var d in c.attributionControl=this,this._container=jt("div","leaflet-control-attribution"),co(this._container),c._layers)c._layers[d].getAttribution&&this.addAttribution(c._layers[d].getAttribution());return this._update(),c.on("layeradd",this._addAttribution,this),this._container},onRemove:function(c){c.off("layeradd",this._addAttribution,this)},_addAttribution:function(c){c.layer.getAttribution&&(this.addAttribution(c.layer.getAttribution()),c.layer.once("remove",function(){this.removeAttribution(c.layer.getAttribution())},this))},setPrefix:function(c){return this.options.prefix=c,this._update(),this},addAttribution:function(c){return c?(this._attributions[c]||(this._attributions[c]=0),this._attributions[c]++,this._update(),this):this},removeAttribution:function(c){return c?(this._attributions[c]&&(this._attributions[c]--,this._update()),this):this},_update:function(){if(this._map){var c=[];for(var d in this._attributions)this._attributions[d]&&c.push(d);var g=[];this.options.prefix&&g.push(this.options.prefix),c.length&&g.push(c.join(", ")),this._container.innerHTML=g.join(' <span aria-hidden="true">|</span> ')}}});Rt.mergeOptions({attributionControl:!0}),Rt.addInitHook(function(){this.options.attributionControl&&(new Pa).addTo(this)});vr.Layers=Rs,vr.Zoom=va,vr.Scale=Ns,vr.Attribution=Pa,lo.layers=function(c,d,g){return new Rs(c,d,g)},lo.zoom=function(c){return new va(c)},lo.scale=function(c){return new Ns(c)},lo.attribution=function(c){return new Pa(c)};var Fr=Je.extend({initialize:function(c){this._map=c},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Fr.addTo=function(c,d){return c.addHandler(d,this),this};var Cl={Events:rt},As=et.touch?"touchstart mousedown":"mousedown",Zr=Xe.extend({options:{clickTolerance:3},initialize:function(c,d,g,m){Ce(this,m),this._element=c,this._dragStartTarget=d||c,this._preventOutline=g},enable:function(){this._enabled||(mt(this._dragStartTarget,As,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Zr._dragging===this&&this.finishDrag(!0),Ut(this._dragStartTarget,As,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(c){if(this._enabled&&(this._moved=!1,!ca(this._element,"leaflet-zoom-anim"))){if(c.touches&&1!==c.touches.length)return void(Zr._dragging===this&&this.finishDrag());if(!(Zr._dragging||c.shiftKey||1!==c.which&&1!==c.button&&!c.touches||(Zr._dragging=this,this._preventOutline&&fa(this._element),ua(),Gr(),this._moving))){this.fire("down");var d=c.touches?c.touches[0]:c,g=Fs(this._element);this._startPoint=new fe(d.clientX,d.clientY),this._startPos=He(this._element),this._parentScale=ma(g);var m="mousedown"===c.type;mt(document,m?"mousemove":"touchmove",this._onMove,this),mt(document,m?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(c){if(this._enabled){if(c.touches&&c.touches.length>1)return void(this._moved=!0);var d=c.touches&&1===c.touches.length?c.touches[0]:c,g=new fe(d.clientX,d.clientY)._subtract(this._startPoint);!g.x&&!g.y||Math.abs(g.x)+Math.abs(g.y)<this.options.clickTolerance||(g.x/=this._parentScale.x,g.y/=this._parentScale.y,En(c),this._moved||(this.fire("dragstart"),this._moved=!0,Pt(document.body,"leaflet-dragging"),this._lastTarget=c.target||c.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Pt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(g),this._moving=!0,this._lastEvent=c,this._updatePosition())}},_updatePosition:function(){var c={originalEvent:this._lastEvent};this.fire("predrag",c),dn(this._element,this._newPos),this.fire("drag",c)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(c){cn(document.body,"leaflet-dragging"),this._lastTarget&&(cn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ut(document,"mousemove touchmove",this._onMove,this),Ut(document,"mouseup touchend touchcancel",this._onUp,this),ga(),oo();var d=this._moved&&this._moving;this._moving=!1,Zr._dragging=!1,d&&this.fire("dragend",{noInertia:c,distance:this._newPos.distanceTo(this._startPos)})}});function Ds(c,d,g){var m,O,z,J,te,be,Ge,st,ut,v=[1,4,2,8];for(O=0,Ge=c.length;O<Ge;O++)c[O]._code=mi(c[O],d);for(J=0;J<4;J++){for(st=v[J],m=[],O=0,z=(Ge=c.length)-1;O<Ge;z=O++)be=c[z],(te=c[O])._code&st?be._code&st||((ut=$o(be,te,st,d,g))._code=mi(ut,d),m.push(ut)):(be._code&st&&((ut=$o(be,te,st,d,g))._code=mi(ut,d),m.push(ut)),m.push(te));c=m}return c}function js(c,d){var g,m,v,O,z,J,te,be;if(!c||0===c.length)throw new Error("latlngs not passed");dr(c)||(console.warn("latlngs are not flat! Only the first ring will be used"),c=c[0]);var st=at([0,0]),ut=qt(c);ut.getNorthWest().distanceTo(ut.getSouthWest())*ut.getNorthEast().distanceTo(ut.getNorthWest())<1700&&(st=ba(c));var kn=c.length,nr=[];for(g=0;g<kn;g++){var xn=at(c[g]);nr.push(d.project(at([xn.lat-st.lat,xn.lng-st.lng])))}for(J=te=be=0,g=0,m=kn-1;g<kn;m=g++)te+=((v=nr[g]).x+(O=nr[m]).x)*(z=v.y*O.x-O.y*v.x),be+=(v.y+O.y)*z,J+=3*z;var Ui=d.unproject(Oe(0===J?nr[0]:[te/J,be/J]));return at([Ui.lat+st.lat,Ui.lng+st.lng])}function ba(c){for(var d=0,g=0,m=0,v=0;v<c.length;v++){var O=at(c[v]);d+=O.lat,g+=O.lng,m++}return at([d/m,g/m])}var $s,vl={__proto__:null,clipPolygon:Ds,polygonCenter:js,centroid:ba};function Bs(c,d){if(!d||!c.length)return c.slice();var g=d*d;return function bl(c,d){var g=c.length,v=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(g);v[0]=v[g-1]=1,ka(c,v,d,0,g-1);var O,z=[];for(O=0;O<g;O++)v[O]&&z.push(c[O]);return z}(c=function kl(c,d){for(var g=[c[0]],m=1,v=0,O=c.length;m<O;m++)Ol(c[m],c[v])>d&&(g.push(c[m]),v=m);return v<O-1&&g.push(c[O-1]),g}(c,g),g)}function Ls(c,d,g){return Math.sqrt(uo(c,d,g,!0))}function ka(c,d,g,m,v){var z,J,te,O=0;for(J=m+1;J<=v-1;J++)(te=uo(c[J],c[m],c[v],!0))>O&&(z=J,O=te);O>g&&(d[z]=1,ka(c,d,g,m,z),ka(c,d,g,z,v))}function Gs(c,d,g,m,v){var J,te,be,O=m?$s:mi(c,g),z=mi(d,g);for($s=z;;){if(!(O|z))return[c,d];if(O&z)return!1;be=mi(te=$o(c,d,J=O||z,g,v),g),J===O?(c=te,O=be):(d=te,z=be)}}function $o(c,d,g,m,v){var be,Ge,O=d.x-c.x,z=d.y-c.y,J=m.min,te=m.max;return 8&g?(be=c.x+O*(te.y-c.y)/z,Ge=te.y):4&g?(be=c.x+O*(J.y-c.y)/z,Ge=J.y):2&g?(be=te.x,Ge=c.y+z*(te.x-c.x)/O):1&g&&(be=J.x,Ge=c.y+z*(J.x-c.x)/O),new fe(be,Ge,v)}function mi(c,d){var g=0;return c.x<d.min.x?g|=1:c.x>d.max.x&&(g|=2),c.y<d.min.y?g|=4:c.y>d.max.y&&(g|=8),g}function Ol(c,d){var g=d.x-c.x,m=d.y-c.y;return g*g+m*m}function uo(c,d,g,m){var be,v=d.x,O=d.y,z=g.x-v,J=g.y-O,te=z*z+J*J;return te>0&&((be=((c.x-v)*z+(c.y-O)*J)/te)>1?(v=g.x,O=g.y):be>0&&(v+=z*be,O+=J*be)),z=c.x-v,J=c.y-O,m?z*z+J*J:new fe(v,O)}function dr(c){return!ze(c[0])||"object"!=typeof c[0][0]&&typeof c[0][0]<"u"}function Us(c){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),dr(c)}function zs(c,d){var g,m,v,O,z,J,te,be;if(!c||0===c.length)throw new Error("latlngs not passed");dr(c)||(console.warn("latlngs are not flat! Only the first ring will be used"),c=c[0]);var Ge=at([0,0]),st=qt(c);st.getNorthWest().distanceTo(st.getSouthWest())*st.getNorthEast().distanceTo(st.getNorthWest())<1700&&(Ge=ba(c));var en=c.length,kn=[];for(g=0;g<en;g++){var nr=at(c[g]);kn.push(d.project(at([nr.lat-Ge.lat,nr.lng-Ge.lng])))}for(g=0,m=0;g<en-1;g++)m+=kn[g].distanceTo(kn[g+1])/2;if(0===m)be=kn[0];else for(g=0,O=0;g<en-1;g++)if((O+=v=(z=kn[g]).distanceTo(J=kn[g+1]))>m){be=[J.x-(te=(O-m)/v)*(J.x-z.x),J.y-te*(J.y-z.y)];break}var xn=d.unproject(Oe(be));return at([xn.lat+Ge.lat,xn.lng+Ge.lng])}var yl={__proto__:null,simplify:Bs,pointToSegmentDistance:Ls,closestPointOnSegment:function Pl(c,d,g){return uo(c,d,g)},clipSegment:Gs,_getEdgeIntersection:$o,_getBitCode:mi,_sqClosestPointOnSegment:uo,isFlat:dr,_flat:Us,polylineCenter:zs},Oa={project:function(c){return new fe(c.lng,c.lat)},unproject:function(c){return new At(c.y,c.x)},bounds:new e([-180,-90],[180,90])},ya={R:6378137,R_MINOR:6356752.314245179,bounds:new e([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(c){var d=Math.PI/180,g=this.R,m=c.lat*d,v=this.R_MINOR/g,O=Math.sqrt(1-v*v),z=O*Math.sin(m),J=Math.tan(Math.PI/4-m/2)/Math.pow((1-z)/(1+z),O/2);return m=-g*Math.log(Math.max(J,1e-10)),new fe(c.lng*d*g,m)},unproject:function(c){for(var be,d=180/Math.PI,g=this.R,m=this.R_MINOR/g,v=Math.sqrt(1-m*m),O=Math.exp(-c.y/g),z=Math.PI/2-2*Math.atan(O),J=0,te=.1;J<15&&Math.abs(te)>1e-7;J++)be=v*Math.sin(z),be=Math.pow((1-be)/(1+be),v/2),z+=te=Math.PI/2-2*Math.atan(O*be)-z;return new At(z*d,c.x*d/g)}},Ml={__proto__:null,LonLat:Oa,Mercator:ya,SphericalMercator:Qn},wl=b({},sr,{code:"EPSG:3395",projection:ya,transformation:function(){var c=.5/(Math.PI*ya.R);return cr(c,.5,-c,.5)}()}),Ii=b({},sr,{code:"EPSG:4326",projection:Oa,transformation:cr(1/180,1,-1/180,.5)}),Kn=b({},gt,{projection:Oa,transformation:cr(1,0,-1,0),scale:function(c){return Math.pow(2,c)},zoom:function(c){return Math.log(c)/Math.LN2},distance:function(c,d){var g=d.lng-c.lng,m=d.lat-c.lat;return Math.sqrt(g*g+m*m)},infinite:!0});gt.Earth=sr,gt.EPSG3395=wl,gt.EPSG3857=li,gt.EPSG900913=Bc,gt.EPSG4326=Ii,gt.Simple=Kn;var Sn=Xe.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(c){return c.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(c){return c&&c.removeLayer(this),this},getPane:function(c){return this._map.getPane(c?this.options[c]||c:this.options.pane)},addInteractiveTarget:function(c){return this._map._targets[X(c)]=this,this},removeInteractiveTarget:function(c){return delete this._map._targets[X(c)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(c){var d=c.target;if(d.hasLayer(this)){if(this._map=d,this._zoomAnimated=d._zoomAnimated,this.getEvents){var g=this.getEvents();d.on(g,this),this.once("remove",function(){d.off(g,this)},this)}this.onAdd(d),this.fire("add"),d.fire("layeradd",{layer:this})}}});Rt.include({addLayer:function(c){if(!c._layerAdd)throw new Error("The provided object is not a Layer.");var d=X(c);return this._layers[d]||(this._layers[d]=c,c._mapToAdd=this,c.beforeAdd&&c.beforeAdd(this),this.whenReady(c._layerAdd,c)),this},removeLayer:function(c){var d=X(c);return this._layers[d]?(this._loaded&&c.onRemove(this),delete this._layers[d],this._loaded&&(this.fire("layerremove",{layer:c}),c.fire("remove")),c._map=c._mapToAdd=null,this):this},hasLayer:function(c){return X(c)in this._layers},eachLayer:function(c,d){for(var g in this._layers)c.call(d,this._layers[g]);return this},_addLayers:function(c){for(var d=0,g=(c=c?ze(c)?c:[c]:[]).length;d<g;d++)this.addLayer(c[d])},_addZoomLimit:function(c){(!isNaN(c.options.maxZoom)||!isNaN(c.options.minZoom))&&(this._zoomBoundLayers[X(c)]=c,this._updateZoomLevels())},_removeZoomLimit:function(c){var d=X(c);this._zoomBoundLayers[d]&&(delete this._zoomBoundLayers[d],this._updateZoomLevels())},_updateZoomLevels:function(){var c=1/0,d=-1/0,g=this._getZoomSpan();for(var m in this._zoomBoundLayers){var v=this._zoomBoundLayers[m].options;c=void 0===v.minZoom?c:Math.min(c,v.minZoom),d=void 0===v.maxZoom?d:Math.max(d,v.maxZoom)}this._layersMaxZoom=d===-1/0?void 0:d,this._layersMinZoom=c===1/0?void 0:c,g!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ri=Sn.extend({initialize:function(c,d){var g,m;if(Ce(this,d),this._layers={},c)for(g=0,m=c.length;g<m;g++)this.addLayer(c[g])},addLayer:function(c){var d=this.getLayerId(c);return this._layers[d]=c,this._map&&this._map.addLayer(c),this},removeLayer:function(c){var d=c in this._layers?c:this.getLayerId(c);return this._map&&this._layers[d]&&this._map.removeLayer(this._layers[d]),delete this._layers[d],this},hasLayer:function(c){return("number"==typeof c?c:this.getLayerId(c))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(c){var g,m,d=Array.prototype.slice.call(arguments,1);for(g in this._layers)(m=this._layers[g])[c]&&m[c].apply(m,d);return this},onAdd:function(c){this.eachLayer(c.addLayer,c)},onRemove:function(c){this.eachLayer(c.removeLayer,c)},eachLayer:function(c,d){for(var g in this._layers)c.call(d,this._layers[g]);return this},getLayer:function(c){return this._layers[c]},getLayers:function(){var c=[];return this.eachLayer(c.push,c),c},setZIndex:function(c){return this.invoke("setZIndex",c)},getLayerId:function(c){return X(c)}}),ur=Ri.extend({addLayer:function(c){return this.hasLayer(c)?this:(c.addEventParent(this),Ri.prototype.addLayer.call(this,c),this.fire("layeradd",{layer:c}))},removeLayer:function(c){return this.hasLayer(c)?(c in this._layers&&(c=this._layers[c]),c.removeEventParent(this),Ri.prototype.removeLayer.call(this,c),this.fire("layerremove",{layer:c})):this},setStyle:function(c){return this.invoke("setStyle",c)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var c=new Jt;for(var d in this._layers){var g=this._layers[d];c.extend(g.getBounds?g.getBounds():g.getLatLng())}return c}}),Tn=Je.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(c){Ce(this,c)},createIcon:function(c){return this._createIcon("icon",c)},createShadow:function(c){return this._createIcon("shadow",c)},_createIcon:function(c,d){var g=this._getIconUrl(c);if(!g){if("icon"===c)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var m=this._createImg(g,d&&"IMG"===d.tagName?d:null);return this._setIconStyles(m,c),(this.options.crossOrigin||""===this.options.crossOrigin)&&(m.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),m},_setIconStyles:function(c,d){var g=this.options,m=g[d+"Size"];"number"==typeof m&&(m=[m,m]);var v=Oe(m),O=Oe("shadow"===d&&g.shadowAnchor||g.iconAnchor||v&&v.divideBy(2,!0));c.className="leaflet-marker-"+d+" "+(g.className||""),O&&(c.style.marginLeft=-O.x+"px",c.style.marginTop=-O.y+"px"),v&&(c.style.width=v.x+"px",c.style.height=v.y+"px")},_createImg:function(c,d){return(d=d||document.createElement("img")).src=c,d},_getIconUrl:function(c){return et.retina&&this.options[c+"RetinaUrl"]||this.options[c+"Url"]}});var Qr=Tn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(c){return"string"!=typeof Qr.imagePath&&(Qr.imagePath=this._detectIconPath()),(this.options.imagePath||Qr.imagePath)+Tn.prototype._getIconUrl.call(this,c)},_stripUrl:function(c){var d=function(g,m,v){var O=m.exec(g);return O&&O[v]};return(c=d(c,/^url\((['"])?(.+)\1\)$/,2))&&d(c,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var c=jt("div","leaflet-default-icon-path",document.body),d=io(c,"background-image")||io(c,"backgroundImage");if(document.body.removeChild(c),d=this._stripUrl(d))return d;var g=document.querySelector('link[href$="leaflet.css"]');return g?g.href.substring(0,g.href.length-11-1):""}}),Vs=Fr.extend({initialize:function(c){this._marker=c},addHooks:function(){var c=this._marker._icon;this._draggable||(this._draggable=new Zr(c,c,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Pt(c,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&cn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(c){var d=this._marker,g=d._map,m=this._marker.options.autoPanSpeed,v=this._marker.options.autoPanPadding,O=He(d._icon),z=g.getPixelBounds(),J=g.getPixelOrigin(),te=Gt(z.min._subtract(J).add(v),z.max._subtract(J).subtract(v));if(!te.contains(O)){var be=Oe((Math.max(te.max.x,O.x)-te.max.x)/(z.max.x-te.max.x)-(Math.min(te.min.x,O.x)-te.min.x)/(z.min.x-te.min.x),(Math.max(te.max.y,O.y)-te.max.y)/(z.max.y-te.max.y)-(Math.min(te.min.y,O.y)-te.min.y)/(z.min.y-te.min.y)).multiplyBy(m);g.panBy(be,{animate:!1}),this._draggable._newPos._add(be),this._draggable._startPos._add(be),dn(d._icon,this._draggable._newPos),this._onDrag(c),this._panRequest=Ue(this._adjustPan.bind(this,c))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(c){this._marker.options.autoPan&&(Ae(this._panRequest),this._panRequest=Ue(this._adjustPan.bind(this,c)))},_onDrag:function(c){var d=this._marker,g=d._shadow,m=He(d._icon),v=d._map.layerPointToLatLng(m);g&&dn(g,m),d._latlng=v,c.latlng=v,c.oldLatLng=this._oldLatLng,d.fire("move",c).fire("drag",c)},_onDragEnd:function(c){Ae(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",c)}}),go=Sn.extend({options:{icon:new Qr,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(c,d){Ce(this,d),this._latlng=at(c)},onAdd:function(c){this._zoomAnimated=this._zoomAnimated&&c.options.markerZoomAnimation,this._zoomAnimated&&c.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(c){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&c.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(c){var d=this._latlng;return this._latlng=at(c),this.update(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},setZIndexOffset:function(c){return this.options.zIndexOffset=c,this.update()},getIcon:function(){return this.options.icon},setIcon:function(c){return this.options.icon=c,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var c=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(c)}return this},_initIcon:function(){var c=this.options,d="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),g=c.icon.createIcon(this._icon),m=!1;g!==this._icon&&(this._icon&&this._removeIcon(),m=!0,c.title&&(g.title=c.title),"IMG"===g.tagName&&(g.alt=c.alt||"")),Pt(g,d),c.keyboard&&(g.tabIndex="0",g.setAttribute("role","button")),this._icon=g,c.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&mt(g,"focus",this._panOnFocus,this);var v=c.icon.createShadow(this._shadow),O=!1;v!==this._shadow&&(this._removeShadow(),O=!0),v&&(Pt(v,d),v.alt=""),this._shadow=v,c.opacity<1&&this._updateOpacity(),m&&this.getPane().appendChild(this._icon),this._initInteraction(),v&&O&&this.getPane(c.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ut(this._icon,"focus",this._panOnFocus,this),Kt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Kt(this._shadow),this._shadow=null},_setPos:function(c){this._icon&&dn(this._icon,c),this._shadow&&dn(this._shadow,c),this._zIndex=c.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(c){this._icon&&(this._icon.style.zIndex=this._zIndex+c)},_animateZoom:function(c){var d=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center).round();this._setPos(d)},_initInteraction:function(){if(this.options.interactive&&(Pt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Vs)){var c=this.options.draggable;this.dragging&&(c=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Vs(this),c&&this.dragging.enable()}},setOpacity:function(c){return this.options.opacity=c,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var c=this.options.opacity;this._icon&&lr(this._icon,c),this._shadow&&lr(this._shadow,c)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var c=this._map;if(c){var d=this.options.icon.options,g=d.iconSize?Oe(d.iconSize):Oe(0,0),m=d.iconAnchor?Oe(d.iconAnchor):Oe(0,0);c.panInside(this._latlng,{paddingTopLeft:m,paddingBottomRight:g.subtract(m)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});var gr=Sn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(c){this._renderer=c.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(c){return Ce(this,c),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&c&&Object.prototype.hasOwnProperty.call(c,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ai=gr.extend({options:{fill:!0,radius:10},initialize:function(c,d){Ce(this,d),this._latlng=at(c),this._radius=this.options.radius},setLatLng:function(c){var d=this._latlng;return this._latlng=at(c),this.redraw(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(c){return this.options.radius=this._radius=c,this.redraw()},getRadius:function(){return this._radius},setStyle:function(c){var d=c&&c.radius||this._radius;return gr.prototype.setStyle.call(this,c),this.setRadius(d),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var c=this._radius,d=this._radiusY||c,g=this._clickTolerance(),m=[c+g,d+g];this._pxBounds=new e(this._point.subtract(m),this._point.add(m))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(c){return c.distanceTo(this._point)<=this._radius+this._clickTolerance()}});var Ys=Ai.extend({initialize:function(c,d,g){if("number"==typeof d&&(d=b({},g,{radius:d})),Ce(this,d),this._latlng=at(c),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(c){return this._mRadius=c,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var c=[this._radius,this._radiusY||this._radius];return new Jt(this._map.layerPointToLatLng(this._point.subtract(c)),this._map.layerPointToLatLng(this._point.add(c)))},setStyle:gr.prototype.setStyle,_project:function(){var c=this._latlng.lng,d=this._latlng.lat,g=this._map,m=g.options.crs;if(m.distance===sr.distance){var v=Math.PI/180,O=this._mRadius/sr.R/v,z=g.project([d+O,c]),J=g.project([d-O,c]),te=z.add(J).divideBy(2),be=g.unproject(te).lat,Ge=Math.acos((Math.cos(O*v)-Math.sin(d*v)*Math.sin(be*v))/(Math.cos(d*v)*Math.cos(be*v)))/v;(isNaN(Ge)||0===Ge)&&(Ge=O/Math.cos(Math.PI/180*d)),this._point=te.subtract(g.getPixelOrigin()),this._radius=isNaN(Ge)?0:te.x-g.project([be,c-Ge]).x,this._radiusY=te.y-z.y}else{var st=m.unproject(m.project(this._latlng).subtract([this._mRadius,0]));this._point=g.latLngToLayerPoint(this._latlng),this._radius=this._point.x-g.latLngToLayerPoint(st).x}this._updateBounds()}});var er=gr.extend({options:{smoothFactor:1,noClip:!1},initialize:function(c,d){Ce(this,d),this._setLatLngs(c)},getLatLngs:function(){return this._latlngs},setLatLngs:function(c){return this._setLatLngs(c),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(c){for(var v,O,d=1/0,g=null,m=uo,z=0,J=this._parts.length;z<J;z++)for(var te=this._parts[z],be=1,Ge=te.length;be<Ge;be++){var st=m(c,v=te[be-1],O=te[be],!0);st<d&&(d=st,g=m(c,v,O))}return g&&(g.distance=Math.sqrt(d)),g},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return zs(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(c,d){return d=d||this._defaultShape(),c=at(c),d.push(c),this._bounds.extend(c),this.redraw()},_setLatLngs:function(c){this._bounds=new Jt,this._latlngs=this._convertLatLngs(c)},_defaultShape:function(){return dr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(c){for(var d=[],g=dr(c),m=0,v=c.length;m<v;m++)g?(d[m]=at(c[m]),this._bounds.extend(d[m])):d[m]=this._convertLatLngs(c[m]);return d},_project:function(){var c=new e;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,c),this._bounds.isValid()&&c.isValid()&&(this._rawPxBounds=c,this._updateBounds())},_updateBounds:function(){var c=this._clickTolerance(),d=new fe(c,c);this._rawPxBounds&&(this._pxBounds=new e([this._rawPxBounds.min.subtract(d),this._rawPxBounds.max.add(d)]))},_projectLatlngs:function(c,d,g){var O,z,v=c.length;if(c[0]instanceof At){for(z=[],O=0;O<v;O++)z[O]=this._map.latLngToLayerPoint(c[O]),g.extend(z[O]);d.push(z)}else for(O=0;O<v;O++)this._projectLatlngs(c[O],d,g)},_clipPoints:function(){var c=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(c)){if(this.options.noClip)return void(this._parts=this._rings);var g,m,v,O,z,J,te,d=this._parts;for(g=0,v=0,O=this._rings.length;g<O;g++)for(m=0,z=(te=this._rings[g]).length;m<z-1;m++)(J=Gs(te[m],te[m+1],c,m,!0))&&(d[v]=d[v]||[],d[v].push(J[0]),(J[1]!==te[m+1]||m===z-2)&&(d[v].push(J[1]),v++))}},_simplifyPoints:function(){for(var c=this._parts,d=this.options.smoothFactor,g=0,m=c.length;g<m;g++)c[g]=Bs(c[g],d)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(c,d){var g,m,v,O,z,J,te=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(c))return!1;for(g=0,O=this._parts.length;g<O;g++)for(m=0,v=(z=(J=this._parts[g]).length)-1;m<z;v=m++)if((d||0!==m)&&Ls(c,J[v],J[m])<=te)return!0;return!1}});er._flat=Us;var Er=er.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return js(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(c){var d=er.prototype._convertLatLngs.call(this,c),g=d.length;return g>=2&&d[0]instanceof At&&d[0].equals(d[g-1])&&d.pop(),d},_setLatLngs:function(c){er.prototype._setLatLngs.call(this,c),dr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return dr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var c=this._renderer._bounds,d=this.options.weight,g=new fe(d,d);if(c=new e(c.min.subtract(g),c.max.add(g)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(c)){if(this.options.noClip)return void(this._parts=this._rings);for(var O,m=0,v=this._rings.length;m<v;m++)(O=Ds(this._rings[m],c,!0)).length&&this._parts.push(O)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(c){var g,m,v,O,z,J,te,be,d=!1;if(!this._pxBounds||!this._pxBounds.contains(c))return!1;for(O=0,te=this._parts.length;O<te;O++)for(z=0,J=(be=(g=this._parts[O]).length)-1;z<be;J=z++)(m=g[z]).y>c.y!=(v=g[J]).y>c.y&&c.x<(v.x-m.x)*(c.y-m.y)/(v.y-m.y)+m.x&&(d=!d);return d||er.prototype._containsPoint.call(this,c,!0)}});var dt=ur.extend({initialize:function(c,d){Ce(this,d),this._layers={},c&&this.addData(c)},addData:function(c){var g,m,v,d=ze(c)?c:c.features;if(d){for(g=0,m=d.length;g<m;g++)((v=d[g]).geometries||v.geometry||v.features||v.coordinates)&&this.addData(v);return this}var O=this.options;if(O.filter&&!O.filter(c))return this;var z=pr(c,O);return z?(z.feature=ji(c),z.defaultOptions=z.options,this.resetStyle(z),O.onEachFeature&&O.onEachFeature(c,z),this.addLayer(z)):this},resetStyle:function(c){return void 0===c?this.eachLayer(this.resetStyle,this):(c.options=b({},c.defaultOptions),this._setLayerStyle(c,this.options.style),this)},setStyle:function(c){return this.eachLayer(function(d){this._setLayerStyle(d,c)},this)},_setLayerStyle:function(c,d){c.setStyle&&("function"==typeof d&&(d=d(c.feature)),c.setStyle(d))}});function pr(c,d){var J,te,be,Ge,g="Feature"===c.type?c.geometry:c,m=g?g.coordinates:null,v=[],O=d&&d.pointToLayer,z=d&&d.coordsToLatLng||Uo;if(!m&&!g)return null;switch(g.type){case"Point":return Ur(O,c,J=z(m),d);case"MultiPoint":for(be=0,Ge=m.length;be<Ge;be++)J=z(m[be]),v.push(Ur(O,c,J,d));return new ur(v);case"LineString":case"MultiLineString":return te=Rn(m,"LineString"===g.type?0:1,z),new er(te,d);case"Polygon":case"MultiPolygon":return te=Rn(m,"Polygon"===g.type?1:2,z),new Er(te,d);case"GeometryCollection":for(be=0,Ge=g.geometries.length;be<Ge;be++){var st=pr({geometry:g.geometries[be],type:"Feature",properties:c.properties},d);st&&v.push(st)}return new ur(v);case"FeatureCollection":for(be=0,Ge=g.features.length;be<Ge;be++){var ut=pr(g.features[be],d);ut&&v.push(ut)}return new ur(v);default:throw new Error("Invalid GeoJSON object.")}}function Ur(c,d,g,m){return c?c(d,g):new go(g,m&&m.markersInheritOptions&&m)}function Uo(c){return new At(c[1],c[0],c[2])}function Rn(c,d,g){for(var z,m=[],v=0,O=c.length;v<O;v++)z=d?Rn(c[v],d-1,g):(g||Uo)(c[v]),m.push(z);return m}function hi(c,d){return void 0!==(c=at(c)).alt?[Ve(c.lng,d),Ve(c.lat,d),Ve(c.alt,d)]:[Ve(c.lng,d),Ve(c.lat,d)]}function Pr(c,d,g,m){for(var v=[],O=0,z=c.length;O<z;O++)v.push(d?Pr(c[O],dr(c[O])?0:d-1,g,m):hi(c[O],m));return!d&&g&&v.length>0&&v.push(v[0].slice()),v}function Di(c,d){return c.feature?b({},c.feature,{geometry:d}):ji(d)}function ji(c){return"Feature"===c.type||"FeatureCollection"===c.type?c:{type:"Feature",properties:{},geometry:c}}var un={toGeoJSON:function(c){return Di(this,{type:"Point",coordinates:hi(this.getLatLng(),c)})}};function Xs(c,d){return new dt(c,d)}go.include(un),Ys.include(un),Ai.include(un),er.include({toGeoJSON:function(c){var d=!dr(this._latlngs);return Di(this,{type:(d?"Multi":"")+"LineString",coordinates:Pr(this._latlngs,d?1:0,!1,c)})}}),Er.include({toGeoJSON:function(c){var d=!dr(this._latlngs),g=d&&!dr(this._latlngs[0]),m=Pr(this._latlngs,g?2:d?1:0,!0,c);return d||(m=[m]),Di(this,{type:(g?"Multi":"")+"Polygon",coordinates:m})}}),Ri.include({toMultiPoint:function(c){var d=[];return this.eachLayer(function(g){d.push(g.toGeoJSON(c).geometry.coordinates)}),Di(this,{type:"MultiPoint",coordinates:d})},toGeoJSON:function(c){var d=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===d)return this.toMultiPoint(c);var g="GeometryCollection"===d,m=[];return this.eachLayer(function(v){if(v.toGeoJSON){var O=v.toGeoJSON(c);if(g)m.push(O.geometry);else{var z=ji(O);"FeatureCollection"===z.type?m.push.apply(m,z.features):m.push(z)}}}),g?Di(this,{geometries:m,type:"GeometryCollection"}):{type:"FeatureCollection",features:m}}});var Nn=Xs,Kr=Sn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(c,d,g){this._url=c,this._bounds=qt(d),Ce(this,g)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Pt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Kt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(c){return this.options.opacity=c,this._image&&this._updateOpacity(),this},setStyle:function(c){return c.opacity&&this.setOpacity(c.opacity),this},bringToFront:function(){return this._map&&Si(this._image),this},bringToBack:function(){return this._map&&Ti(this._image),this},setUrl:function(c){return this._url=c,this._image&&(this._image.src=c),this},setBounds:function(c){return this._bounds=qt(c),this._map&&this._reset(),this},getEvents:function(){var c={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},setZIndex:function(c){return this.options.zIndex=c,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var c="IMG"===this._url.tagName,d=this._image=c?this._url:jt("img");Pt(d,"leaflet-image-layer"),this._zoomAnimated&&Pt(d,"leaflet-zoom-animated"),this.options.className&&Pt(d,this.options.className),d.onselectstart=Me,d.onmousemove=Me,d.onload=B(this.fire,this,"load"),d.onerror=B(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(d.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),c?this._url=d.src:(d.src=this._url,d.alt=this.options.alt)},_animateZoom:function(c){var d=this._map.getZoomScale(c.zoom),g=this._map._latLngBoundsToNewLayerBounds(this._bounds,c.zoom,c.center).min;ui(this._image,g,d)},_reset:function(){var c=this._image,d=new e(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),g=d.getSize();dn(c,d.min),c.style.width=g.x+"px",c.style.height=g.y+"px"},_updateOpacity:function(){lr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&null!=this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var c=this.options.errorOverlayUrl;c&&this._url!==c&&(this._url=c,this._image.src=c)},getCenter:function(){return this._bounds.getCenter()}}),fr=Kr.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var c="VIDEO"===this._url.tagName,d=this._image=c?this._url:jt("video");if(Pt(d,"leaflet-image-layer"),this._zoomAnimated&&Pt(d,"leaflet-zoom-animated"),this.options.className&&Pt(d,this.options.className),d.onselectstart=Me,d.onmousemove=Me,d.onloadeddata=B(this.fire,this,"load"),c){for(var g=d.getElementsByTagName("source"),m=[],v=0;v<g.length;v++)m.push(g[v].src);this._url=g.length>0?m:[d.src]}else{ze(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(d.style,"objectFit")&&(d.style.objectFit="fill"),d.autoplay=!!this.options.autoplay,d.loop=!!this.options.loop,d.muted=!!this.options.muted,d.playsInline=!!this.options.playsInline;for(var O=0;O<this._url.length;O++){var z=jt("source");z.src=this._url[O],d.appendChild(z)}}}});var po=Kr.extend({_initImage:function(){var c=this._image=this._url;Pt(c,"leaflet-image-layer"),this._zoomAnimated&&Pt(c,"leaflet-zoom-animated"),this.options.className&&Pt(c,this.options.className),c.onselectstart=Me,c.onmousemove=Me}});var Sr=Sn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(c,d){c&&(c instanceof At||ze(c))?(this._latlng=at(c),Ce(this,d)):(Ce(this,c),this._source=d),this.options.content&&(this._content=this.options.content)},openOn:function(c){return(c=arguments.length?c:this._source._map).hasLayer(this)||c.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(c){return this._map?this.close():(arguments.length?this._source=c:c=this._source,this._prepareOpen(),this.openOn(c._map)),this},onAdd:function(c){this._zoomAnimated=c._zoomAnimated,this._container||this._initLayout(),c._fadeAnimated&&lr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),c._fadeAnimated&&lr(this._container,1),this.bringToFront(),this.options.interactive&&(Pt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(c){c._fadeAnimated?(lr(this._container,0),this._removeTimeout=setTimeout(B(Kt,void 0,this._container),200)):Kt(this._container),this.options.interactive&&(cn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(c){return this._latlng=at(c),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(c){return this._content=c,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var c={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Si(this._container),this},bringToBack:function(){return this._map&&Ti(this._container),this},_prepareOpen:function(c){var d=this._source;if(!d._map)return!1;if(d instanceof ur){d=null;var g=this._source._layers;for(var m in g)if(g[m]._map){d=g[m];break}if(!d)return!1;this._source=d}if(!c)if(d.getCenter)c=d.getCenter();else if(d.getLatLng)c=d.getLatLng();else{if(!d.getBounds)throw new Error("Unable to get source layer LatLng.");c=d.getBounds().getCenter()}return this.setLatLng(c),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var c=this._contentNode,d="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof d)c.innerHTML=d;else{for(;c.hasChildNodes();)c.removeChild(c.firstChild);c.appendChild(d)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var c=this._map.latLngToLayerPoint(this._latlng),d=Oe(this.options.offset),g=this._getAnchor();this._zoomAnimated?dn(this._container,c.add(g)):d=d.add(c).add(g);var m=this._containerBottom=-d.y,v=this._containerLeft=-Math.round(this._containerWidth/2)+d.x;this._container.style.bottom=m+"px",this._container.style.left=v+"px"}},_getAnchor:function(){return[0,0]}});Rt.include({_initOverlay:function(c,d,g,m){var v=d;return v instanceof c||(v=new c(m).setContent(d)),g&&v.setLatLng(g),v}}),Sn.include({_initOverlay:function(c,d,g,m){var v=g;return v instanceof c?(Ce(v,m),v._source=this):(v=d&&!m?d:new c(m,this)).setContent(g),v}});var fo=Sr.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(c){return!(c=arguments.length?c:this._source._map).hasLayer(this)&&c._popup&&c._popup.options.autoClose&&c.removeLayer(c._popup),c._popup=this,Sr.prototype.openOn.call(this,c)},onAdd:function(c){Sr.prototype.onAdd.call(this,c),c.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof gr||this._source.on("preclick",gi))},onRemove:function(c){Sr.prototype.onRemove.call(this,c),c.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof gr||this._source.off("preclick",gi))},getEvents:function(){var c=Sr.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(c.preclick=this.close),this.options.keepInView&&(c.moveend=this._adjustPan),c},_initLayout:function(){var c="leaflet-popup",d=this._container=jt("div",c+" "+(this.options.className||"")+" leaflet-zoom-animated"),g=this._wrapper=jt("div",c+"-content-wrapper",d);if(this._contentNode=jt("div",c+"-content",g),co(d),Ca(this._contentNode),mt(d,"contextmenu",gi),this._tipContainer=jt("div",c+"-tip-container",d),this._tip=jt("div",c+"-tip",this._tipContainer),this.options.closeButton){var m=this._closeButton=jt("a",c+"-close-button",d);m.setAttribute("role","button"),m.setAttribute("aria-label","Close popup"),m.href="#close",m.innerHTML='<span aria-hidden="true">&#215;</span>',mt(m,"click",function(v){En(v),this.close()},this)}},_updateLayout:function(){var c=this._contentNode,d=c.style;d.width="",d.whiteSpace="nowrap";var g=c.offsetWidth;g=Math.min(g,this.options.maxWidth),g=Math.max(g,this.options.minWidth),d.width=g+1+"px",d.whiteSpace="",d.height="";var v=this.options.maxHeight,O="leaflet-popup-scrolled";v&&c.offsetHeight>v?(d.height=v+"px",Pt(c,O)):cn(c,O),this._containerWidth=this._container.offsetWidth},_animateZoom:function(c){var d=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center),g=this._getAnchor();dn(this._container,d.add(g))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning)return void(this._autopanning=!1);var c=this._map,d=parseInt(io(this._container,"marginBottom"),10)||0,g=this._container.offsetHeight+d,m=this._containerWidth,v=new fe(this._containerLeft,-g-this._containerBottom);v._add(He(this._container));var O=c.layerPointToContainerPoint(v),z=Oe(this.options.autoPanPadding),J=Oe(this.options.autoPanPaddingTopLeft||z),te=Oe(this.options.autoPanPaddingBottomRight||z),be=c.getSize(),Ge=0,st=0;O.x+m+te.x>be.x&&(Ge=O.x+m-be.x+te.x),O.x-Ge-J.x<0&&(Ge=O.x-J.x),O.y+g+te.y>be.y&&(st=O.y+g-be.y+te.y),O.y-st-J.y<0&&(st=O.y-J.y),(Ge||st)&&(this.options.keepInView&&(this._autopanning=!0),c.fire("autopanstart").panBy([Ge,st]))}},_getAnchor:function(){return Oe(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});Rt.mergeOptions({closePopupOnClick:!0}),Rt.include({openPopup:function(c,d,g){return this._initOverlay(fo,c,d,g).openOn(this),this},closePopup:function(c){return(c=arguments.length?c:this._popup)&&c.close(),this}}),Sn.include({bindPopup:function(c,d){return this._popup=this._initOverlay(fo,this._popup,c,d),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(c){return this._popup&&(this instanceof ur||(this._popup._source=this),this._popup._prepareOpen(c||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(c){return this._popup&&this._popup.setContent(c),this},getPopup:function(){return this._popup},_openPopup:function(c){if(this._popup&&this._map){pi(c);var d=c.layer||c.target;if(this._popup._source===d&&!(d instanceof gr))return void(this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(c.latlng));this._popup._source=d,this.openPopup(c.latlng)}},_movePopup:function(c){this._popup.setLatLng(c.latlng)},_onKeyPress:function(c){13===c.originalEvent.keyCode&&this._openPopup(c)}});var _i=Sr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(c){Sr.prototype.onAdd.call(this,c),this.setOpacity(this.options.opacity),c.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(c){Sr.prototype.onRemove.call(this,c),c.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var c=Sr.prototype.getEvents.call(this);return this.options.permanent||(c.preclick=this.close),c},_initLayout:function(){this._contentNode=this._container=jt("div","leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide")),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+X(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(c){var d,g,m=this._map,v=this._container,O=m.latLngToContainerPoint(m.getCenter()),z=m.layerPointToContainerPoint(c),J=this.options.direction,te=v.offsetWidth,be=v.offsetHeight,Ge=Oe(this.options.offset),st=this._getAnchor();"top"===J?(d=te/2,g=be):"bottom"===J?(d=te/2,g=0):"center"===J?(d=te/2,g=be/2):"right"===J?(d=0,g=be/2):"left"===J?(d=te,g=be/2):z.x<O.x?(J="right",d=0,g=be/2):(J="left",d=te+2*(Ge.x+st.x),g=be/2),c=c.subtract(Oe(d,g,!0)).add(Ge).add(st),cn(v,"leaflet-tooltip-right"),cn(v,"leaflet-tooltip-left"),cn(v,"leaflet-tooltip-top"),cn(v,"leaflet-tooltip-bottom"),Pt(v,"leaflet-tooltip-"+J),dn(v,c)},_updatePosition:function(){var c=this._map.latLngToLayerPoint(this._latlng);this._setPosition(c)},setOpacity:function(c){this.options.opacity=c,this._container&&lr(this._container,c)},_animateZoom:function(c){var d=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center);this._setPosition(d)},_getAnchor:function(){return Oe(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});Rt.include({openTooltip:function(c,d,g){return this._initOverlay(_i,c,d,g).openOn(this),this},closeTooltip:function(c){return c.close(),this}}),Sn.include({bindTooltip:function(c,d){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(_i,this._tooltip,c,d),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(c){if(c||!this._tooltipHandlersAdded){var d=c?"off":"on",g={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?g.add=this._openTooltip:(g.mouseover=this._openTooltip,g.mouseout=this.closeTooltip,g.click=this._openTooltip,this._map?this._addFocusListeners():g.add=this._addFocusListeners),this._tooltip.options.sticky&&(g.mousemove=this._moveTooltip),this[d](g),this._tooltipHandlersAdded=!c}},openTooltip:function(c){return this._tooltip&&(this instanceof ur||(this._tooltip._source=this),this._tooltip._prepareOpen(c)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(c){return this._tooltip&&this._tooltip.setContent(c),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(c){var d="function"==typeof c.getElement&&c.getElement();d&&(mt(d,"focus",function(){this._tooltip._source=c,this.openTooltip()},this),mt(d,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(c){var d="function"==typeof c.getElement&&c.getElement();d&&d.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(c){if(this._tooltip&&this._map){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var d=this;return void this._map.once("moveend",function(){d._openOnceFlag=!1,d._openTooltip(c)})}this._tooltip._source=c.layer||c.target,this.openTooltip(this._tooltip.options.sticky?c.latlng:void 0)}},_moveTooltip:function(c){var g,m,d=c.latlng;this._tooltip.options.sticky&&c.originalEvent&&(g=this._map.mouseEventToContainerPoint(c.originalEvent),m=this._map.containerPointToLayerPoint(g),d=this._map.layerPointToLatLng(m)),this._tooltip.setLatLng(d)}});var zo=Tn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(c){var d=c&&"DIV"===c.tagName?c:document.createElement("div"),g=this.options;if(g.html instanceof Element?(Ao(d),d.appendChild(g.html)):d.innerHTML=!1!==g.html?g.html:"",g.bgPos){var m=Oe(g.bgPos);d.style.backgroundPosition=-m.x+"px "+-m.y+"px"}return this._setIconStyles(d,"icon"),d},createShadow:function(){return null}});Tn.Default=Qr;var tt=Sn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:et.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(c){Ce(this,c)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(c){c._addZoomLimit(this)},onRemove:function(c){this._removeAllTiles(),Kt(this._container),c._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Si(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ti(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(c){return this.options.opacity=c,this._updateOpacity(),this},setZIndex:function(c){return this.options.zIndex=c,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var c=this._clampZoom(this._map.getZoom());c!==this._tileZoom&&(this._tileZoom=c,this._updateLevels()),this._update()}return this},getEvents:function(){var c={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=me(this._onMoveEnd,this.options.updateInterval,this)),c.move=this._onMove),this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},createTile:function(){return document.createElement("div")},getTileSize:function(){var c=this.options.tileSize;return c instanceof fe?c:new fe(c,c)},_updateZIndex:function(){this._container&&null!=this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(c){for(var O,d=this.getPane().children,g=-c(-1/0,1/0),m=0,v=d.length;m<v;m++)O=d[m].style.zIndex,d[m]!==this._container&&O&&(g=c(g,+O));isFinite(g)&&(this.options.zIndex=g+c(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!et.ielt9){lr(this._container,this.options.opacity);var c=+new Date,d=!1,g=!1;for(var m in this._tiles){var v=this._tiles[m];if(v.current&&v.loaded){var O=Math.min(1,(c-v.loaded)/200);lr(v.el,O),O<1?d=!0:(v.active?g=!0:this._onOpaqueTile(v),v.active=!0)}}g&&!this._noPrune&&this._pruneTiles(),d&&(Ae(this._fadeFrame),this._fadeFrame=Ue(this._updateOpacity,this))}},_onOpaqueTile:Me,_initContainer:function(){this._container||(this._container=jt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var c=this._tileZoom,d=this.options.maxZoom;if(void 0!==c){for(var g in this._levels)g=Number(g),this._levels[g].el.children.length||g===c?(this._levels[g].el.style.zIndex=d-Math.abs(c-g),this._onUpdateLevel(g)):(Kt(this._levels[g].el),this._removeTilesAtZoom(g),this._onRemoveLevel(g),delete this._levels[g]);var m=this._levels[c],v=this._map;return m||((m=this._levels[c]={}).el=jt("div","leaflet-tile-container leaflet-zoom-animated",this._container),m.el.style.zIndex=d,m.origin=v.project(v.unproject(v.getPixelOrigin()),c).round(),m.zoom=c,this._setZoomTransform(m,v.getCenter(),v.getZoom()),this._onCreateLevel(m)),this._level=m,m}},_onUpdateLevel:Me,_onRemoveLevel:Me,_onCreateLevel:Me,_pruneTiles:function(){if(this._map){var c,d,g=this._map.getZoom();if(g>this.options.maxZoom||g<this.options.minZoom)return void this._removeAllTiles();for(c in this._tiles)(d=this._tiles[c]).retain=d.current;for(c in this._tiles)if((d=this._tiles[c]).current&&!d.active){var m=d.coords;this._retainParent(m.x,m.y,m.z,m.z-5)||this._retainChildren(m.x,m.y,m.z,m.z+2)}for(c in this._tiles)this._tiles[c].retain||this._removeTile(c)}},_removeTilesAtZoom:function(c){for(var d in this._tiles)this._tiles[d].coords.z===c&&this._removeTile(d)},_removeAllTiles:function(){for(var c in this._tiles)this._removeTile(c)},_invalidateAll:function(){for(var c in this._levels)Kt(this._levels[c].el),this._onRemoveLevel(Number(c)),delete this._levels[c];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(c,d,g,m){var v=Math.floor(c/2),O=Math.floor(d/2),z=g-1,J=new fe(+v,+O);J.z=+z;var te=this._tileCoordsToKey(J),be=this._tiles[te];return be&&be.active?(be.retain=!0,!0):(be&&be.loaded&&(be.retain=!0),z>m&&this._retainParent(v,O,z,m))},_retainChildren:function(c,d,g,m){for(var v=2*c;v<2*c+2;v++)for(var O=2*d;O<2*d+2;O++){var z=new fe(v,O);z.z=g+1;var J=this._tileCoordsToKey(z),te=this._tiles[J];te&&te.active?te.retain=!0:(te&&te.loaded&&(te.retain=!0),g+1<m&&this._retainChildren(v,O,g+1,m))}},_resetView:function(c){var d=c&&(c.pinch||c.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),d,d)},_animateZoom:function(c){this._setView(c.center,c.zoom,!0,c.noUpdate)},_clampZoom:function(c){var d=this.options;return void 0!==d.minNativeZoom&&c<d.minNativeZoom?d.minNativeZoom:void 0!==d.maxNativeZoom&&d.maxNativeZoom<c?d.maxNativeZoom:c},_setView:function(c,d,g,m){var v=Math.round(d);v=void 0!==this.options.maxZoom&&v>this.options.maxZoom||void 0!==this.options.minZoom&&v<this.options.minZoom?void 0:this._clampZoom(v),(!m||this.options.updateWhenZooming&&v!==this._tileZoom)&&(this._tileZoom=v,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==v&&this._update(c),g||this._pruneTiles(),this._noPrune=!!g),this._setZoomTransforms(c,d)},_setZoomTransforms:function(c,d){for(var g in this._levels)this._setZoomTransform(this._levels[g],c,d)},_setZoomTransform:function(c,d,g){var m=this._map.getZoomScale(g,c.zoom),v=c.origin.multiplyBy(m).subtract(this._map._getNewPixelOrigin(d,g)).round();et.any3d?ui(c.el,v,m):dn(c.el,v)},_resetGrid:function(){var c=this._map,d=c.options.crs,g=this._tileSize=this.getTileSize(),m=this._tileZoom,v=this._map.getPixelWorldBounds(this._tileZoom);v&&(this._globalTileRange=this._pxBoundsToTileRange(v)),this._wrapX=d.wrapLng&&!this.options.noWrap&&[Math.floor(c.project([0,d.wrapLng[0]],m).x/g.x),Math.ceil(c.project([0,d.wrapLng[1]],m).x/g.y)],this._wrapY=d.wrapLat&&!this.options.noWrap&&[Math.floor(c.project([d.wrapLat[0],0],m).y/g.x),Math.ceil(c.project([d.wrapLat[1],0],m).y/g.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(c){var d=this._map,g=d._animatingZoom?Math.max(d._animateToZoom,d.getZoom()):d.getZoom(),m=d.getZoomScale(g,this._tileZoom),v=d.project(c,this._tileZoom).floor(),O=d.getSize().divideBy(2*m);return new e(v.subtract(O),v.add(O))},_update:function(c){var d=this._map;if(d){var g=this._clampZoom(d.getZoom());if(void 0===c&&(c=d.getCenter()),void 0!==this._tileZoom){var m=this._getTiledPixelBounds(c),v=this._pxBoundsToTileRange(m),O=v.getCenter(),z=[],J=this.options.keepBuffer,te=new e(v.getBottomLeft().subtract([J,-J]),v.getTopRight().add([J,-J]));if(!(isFinite(v.min.x)&&isFinite(v.min.y)&&isFinite(v.max.x)&&isFinite(v.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var be in this._tiles){var Ge=this._tiles[be].coords;(Ge.z!==this._tileZoom||!te.contains(new fe(Ge.x,Ge.y)))&&(this._tiles[be].current=!1)}if(Math.abs(g-this._tileZoom)>1)return void this._setView(c,g);for(var st=v.min.y;st<=v.max.y;st++)for(var ut=v.min.x;ut<=v.max.x;ut++){var en=new fe(ut,st);if(en.z=this._tileZoom,this._isValidTile(en)){var kn=this._tiles[this._tileCoordsToKey(en)];kn?kn.current=!0:z.push(en)}}if(z.sort(function(xn,Ui){return xn.distanceTo(O)-Ui.distanceTo(O)}),0!==z.length){this._loading||(this._loading=!0,this.fire("loading"));var nr=document.createDocumentFragment();for(ut=0;ut<z.length;ut++)this._addTile(z[ut],nr);this._level.el.appendChild(nr)}}}},_isValidTile:function(c){var d=this._map.options.crs;if(!d.infinite){var g=this._globalTileRange;if(!d.wrapLng&&(c.x<g.min.x||c.x>g.max.x)||!d.wrapLat&&(c.y<g.min.y||c.y>g.max.y))return!1}if(!this.options.bounds)return!0;var m=this._tileCoordsToBounds(c);return qt(this.options.bounds).overlaps(m)},_keyToBounds:function(c){return this._tileCoordsToBounds(this._keyToTileCoords(c))},_tileCoordsToNwSe:function(c){var d=this._map,g=this.getTileSize(),m=c.scaleBy(g),v=m.add(g);return[d.unproject(m,c.z),d.unproject(v,c.z)]},_tileCoordsToBounds:function(c){var d=this._tileCoordsToNwSe(c),g=new Jt(d[0],d[1]);return this.options.noWrap||(g=this._map.wrapLatLngBounds(g)),g},_tileCoordsToKey:function(c){return c.x+":"+c.y+":"+c.z},_keyToTileCoords:function(c){var d=c.split(":"),g=new fe(+d[0],+d[1]);return g.z=+d[2],g},_removeTile:function(c){var d=this._tiles[c];d&&(Kt(d.el),delete this._tiles[c],this.fire("tileunload",{tile:d.el,coords:this._keyToTileCoords(c)}))},_initTile:function(c){Pt(c,"leaflet-tile");var d=this.getTileSize();c.style.width=d.x+"px",c.style.height=d.y+"px",c.onselectstart=Me,c.onmousemove=Me,et.ielt9&&this.options.opacity<1&&lr(c,this.options.opacity)},_addTile:function(c,d){var g=this._getTilePos(c),m=this._tileCoordsToKey(c),v=this.createTile(this._wrapCoords(c),B(this._tileReady,this,c));this._initTile(v),this.createTile.length<2&&Ue(B(this._tileReady,this,c,null,v)),dn(v,g),this._tiles[m]={el:v,coords:c,current:!0},d.appendChild(v),this.fire("tileloadstart",{tile:v,coords:c})},_tileReady:function(c,d,g){d&&this.fire("tileerror",{error:d,tile:g,coords:c});var m=this._tileCoordsToKey(c);(g=this._tiles[m])&&(g.loaded=+new Date,this._map._fadeAnimated?(lr(g.el,0),Ae(this._fadeFrame),this._fadeFrame=Ue(this._updateOpacity,this)):(g.active=!0,this._pruneTiles()),d||(Pt(g.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:g.el,coords:c})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),et.ielt9||!this._map._fadeAnimated?Ue(this._pruneTiles,this):setTimeout(B(this._pruneTiles,this),250)))},_getTilePos:function(c){return c.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(c){var d=new fe(this._wrapX?ae(c.x,this._wrapX):c.x,this._wrapY?ae(c.y,this._wrapY):c.y);return d.z=c.z,d},_pxBoundsToTileRange:function(c){var d=this.getTileSize();return new e(c.min.unscaleBy(d).floor(),c.max.unscaleBy(d).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var c in this._tiles)if(!this._tiles[c].loaded)return!1;return!0}});var $i=tt.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(c,d){this._url=c,(d=Ce(this,d)).detectRetina&&et.retina&&d.maxZoom>0?(d.tileSize=Math.floor(d.tileSize/2),d.zoomReverse?(d.zoomOffset--,d.minZoom=Math.min(d.maxZoom,d.minZoom+1)):(d.zoomOffset++,d.maxZoom=Math.max(d.minZoom,d.maxZoom-1)),d.minZoom=Math.max(0,d.minZoom)):d.zoomReverse?d.minZoom=Math.min(d.maxZoom,d.minZoom):d.maxZoom=Math.max(d.minZoom,d.maxZoom),"string"==typeof d.subdomains&&(d.subdomains=d.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(c,d){return this._url===c&&void 0===d&&(d=!0),this._url=c,d||this.redraw(),this},createTile:function(c,d){var g=document.createElement("img");return mt(g,"load",B(this._tileOnLoad,this,d,g)),mt(g,"error",B(this._tileOnError,this,d,g)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(g.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"==typeof this.options.referrerPolicy&&(g.referrerPolicy=this.options.referrerPolicy),g.alt="",g.src=this.getTileUrl(c),g},getTileUrl:function(c){var d={r:et.retina?"@2x":"",s:this._getSubdomain(c),x:c.x,y:c.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var g=this._globalTileRange.max.y-c.y;this.options.tms&&(d.y=g),d["-y"]=g}return $t(this._url,b(d,this.options))},_tileOnLoad:function(c,d){et.ielt9?setTimeout(B(c,this,null,d),0):c(null,d)},_tileOnError:function(c,d,g){var m=this.options.errorTileUrl;m&&d.getAttribute("src")!==m&&(d.src=m),c(g,d)},_onTileRemove:function(c){c.tile.onload=null},_getZoomForUrl:function(){var c=this._tileZoom;return this.options.zoomReverse&&(c=this.options.maxZoom-c),c+this.options.zoomOffset},_getSubdomain:function(c){var d=Math.abs(c.x+c.y)%this.options.subdomains.length;return this.options.subdomains[d]},_abortLoading:function(){var c,d;for(c in this._tiles)if(this._tiles[c].coords.z!==this._tileZoom&&((d=this._tiles[c].el).onload=Me,d.onerror=Me,!d.complete)){d.src=Pe;var g=this._tiles[c].coords;Kt(d),delete this._tiles[c],this.fire("tileabort",{tile:d,coords:g})}},_removeTile:function(c){var d=this._tiles[c];if(d)return d.el.setAttribute("src",Pe),tt.prototype._removeTile.call(this,c)},_tileReady:function(c,d,g){if(this._map&&(!g||g.getAttribute("src")!==Pe))return tt.prototype._tileReady.call(this,c,d,g)}});function mo(c,d){return new $i(c,d)}var zr=$i.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(c,d){this._url=c;var g=b({},this.defaultWmsParams);for(var m in d)m in this.options||(g[m]=d[m]);var v=(d=Ce(this,d)).detectRetina&&et.retina?2:1,O=this.getTileSize();g.width=O.x*v,g.height=O.y*v,this.wmsParams=g},onAdd:function(c){this._crs=this.options.crs||c.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version),this.wmsParams[this._wmsVersion>=1.3?"crs":"srs"]=this._crs.code,$i.prototype.onAdd.call(this,c)},getTileUrl:function(c){var d=this._tileCoordsToNwSe(c),g=this._crs,m=Gt(g.project(d[0]),g.project(d[1])),v=m.min,O=m.max,z=(this._wmsVersion>=1.3&&this._crs===Ii?[v.y,v.x,O.y,O.x]:[v.x,v.y,O.x,O.y]).join(","),J=$i.prototype.getTileUrl.call(this,c);return J+_e(this.wmsParams,J,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+z},setParams:function(c,d){return b(this.wmsParams,c),d||this.redraw(),this}});$i.WMS=zr,mo.wms=function qs(c,d){return new zr(c,d)};var Vr=Sn.extend({options:{padding:.1},initialize:function(c){Ce(this,c),X(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Pt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var c={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(c.zoomanim=this._onAnimZoom),c},_onAnimZoom:function(c){this._updateTransform(c.center,c.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(c,d){var g=this._map.getZoomScale(d,this._zoom),m=this._map.getSize().multiplyBy(.5+this.options.padding),v=this._map.project(this._center,d),O=m.multiplyBy(-g).add(v).subtract(this._map._getNewPixelOrigin(c,d));et.any3d?ui(this._container,O,g):dn(this._container,O)},_reset:function(){for(var c in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[c]._reset()},_onZoomEnd:function(){for(var c in this._layers)this._layers[c]._project()},_updatePaths:function(){for(var c in this._layers)this._layers[c]._update()},_update:function(){var c=this.options.padding,d=this._map.getSize(),g=this._map.containerPointToLayerPoint(d.multiplyBy(-c)).round();this._bounds=new e(g,g.add(d.multiplyBy(1+2*c)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Zs=Vr.extend({options:{tolerance:0},getEvents:function(){var c=Vr.prototype.getEvents.call(this);return c.viewprereset=this._onViewPreReset,c},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Vr.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var c=this._container=document.createElement("canvas");mt(c,"mousemove",this._onMouseMove,this),mt(c,"click dblclick mousedown mouseup contextmenu",this._onClick,this),mt(c,"mouseout",this._handleMouseOut,this),c._leaflet_disable_events=!0,this._ctx=c.getContext("2d")},_destroyContainer:function(){Ae(this._redrawRequest),delete this._ctx,Kt(this._container),Ut(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var d in this._redrawBounds=null,this._layers)this._layers[d]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){Vr.prototype._update.call(this);var c=this._bounds,d=this._container,g=c.getSize(),m=et.retina?2:1;dn(d,c.min),d.width=m*g.x,d.height=m*g.y,d.style.width=g.x+"px",d.style.height=g.y+"px",et.retina&&this._ctx.scale(2,2),this._ctx.translate(-c.min.x,-c.min.y),this.fire("update")}},_reset:function(){Vr.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(c){this._updateDashArray(c),this._layers[X(c)]=c;var d=c._order={layer:c,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=d),this._drawLast=d,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(c){this._requestRedraw(c)},_removePath:function(c){var d=c._order,g=d.next,m=d.prev;g?g.prev=m:this._drawLast=m,m?m.next=g:this._drawFirst=g,delete c._order,delete this._layers[X(c)],this._requestRedraw(c)},_updatePath:function(c){this._extendRedrawBounds(c),c._project(),c._update(),this._requestRedraw(c)},_updateStyle:function(c){this._updateDashArray(c),this._requestRedraw(c)},_updateDashArray:function(c){if("string"==typeof c.options.dashArray){var m,v,d=c.options.dashArray.split(/[, ]+/),g=[];for(v=0;v<d.length;v++){if(m=Number(d[v]),isNaN(m))return;g.push(m)}c.options._dashArray=g}else c.options._dashArray=c.options.dashArray},_requestRedraw:function(c){this._map&&(this._extendRedrawBounds(c),this._redrawRequest=this._redrawRequest||Ue(this._redraw,this))},_extendRedrawBounds:function(c){if(c._pxBounds){var d=(c.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new e,this._redrawBounds.extend(c._pxBounds.min.subtract([d,d])),this._redrawBounds.extend(c._pxBounds.max.add([d,d]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var c=this._redrawBounds;if(c){var d=c.getSize();this._ctx.clearRect(c.min.x,c.min.y,d.x,d.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var c,d=this._redrawBounds;if(this._ctx.save(),d){var g=d.getSize();this._ctx.beginPath(),this._ctx.rect(d.min.x,d.min.y,g.x,g.y),this._ctx.clip()}this._drawing=!0;for(var m=this._drawFirst;m;m=m.next)c=m.layer,(!d||c._pxBounds&&c._pxBounds.intersects(d))&&c._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(c,d){if(this._drawing){var g,m,v,O,z=c._parts,J=z.length,te=this._ctx;if(J){for(te.beginPath(),g=0;g<J;g++){for(m=0,v=z[g].length;m<v;m++)te[m?"lineTo":"moveTo"]((O=z[g][m]).x,O.y);d&&te.closePath()}this._fillStroke(te,c)}}},_updateCircle:function(c){if(this._drawing&&!c._empty()){var d=c._point,g=this._ctx,m=Math.max(Math.round(c._radius),1),v=(Math.max(Math.round(c._radiusY),1)||m)/m;1!==v&&(g.save(),g.scale(1,v)),g.beginPath(),g.arc(d.x,d.y/v,m,0,2*Math.PI,!1),1!==v&&g.restore(),this._fillStroke(g,c)}},_fillStroke:function(c,d){var g=d.options;g.fill&&(c.globalAlpha=g.fillOpacity,c.fillStyle=g.fillColor||g.color,c.fill(g.fillRule||"evenodd")),g.stroke&&0!==g.weight&&(c.setLineDash&&c.setLineDash(d.options&&d.options._dashArray||[]),c.globalAlpha=g.opacity,c.lineWidth=g.weight,c.strokeStyle=g.color,c.lineCap=g.lineCap,c.lineJoin=g.lineJoin,c.stroke())},_onClick:function(c){for(var g,m,d=this._map.mouseEventToLayerPoint(c),v=this._drawFirst;v;v=v.next)(g=v.layer).options.interactive&&g._containsPoint(d)&&("click"!==c.type&&"preclick"!==c.type||!this._map._draggableMoved(g))&&(m=g);this._fireEvent(!!m&&[m],c)},_onMouseMove:function(c){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var d=this._map.mouseEventToLayerPoint(c);this._handleMouseHover(c,d)}},_handleMouseOut:function(c){var d=this._hoveredLayer;d&&(cn(this._container,"leaflet-interactive"),this._fireEvent([d],c,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(c,d){if(!this._mouseHoverThrottled){for(var g,m,v=this._drawFirst;v;v=v.next)(g=v.layer).options.interactive&&g._containsPoint(d)&&(m=g);m!==this._hoveredLayer&&(this._handleMouseOut(c),m&&(Pt(this._container,"leaflet-interactive"),this._fireEvent([m],c,"mouseover"),this._hoveredLayer=m)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],c),this._mouseHoverThrottled=!0,setTimeout(B(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(c,d,g){this._map._fireDOMEvent(d,g||d.type,c)},_bringToFront:function(c){var d=c._order;if(d){var g=d.next,m=d.prev;if(!g)return;g.prev=m,m?m.next=g:g&&(this._drawFirst=g),d.prev=this._drawLast,this._drawLast.next=d,d.next=null,this._drawLast=d,this._requestRedraw(c)}},_bringToBack:function(c){var d=c._order;if(d){var g=d.next,m=d.prev;if(!m)return;m.next=g,g?g.prev=m:m&&(this._drawLast=m),d.prev=null,d.next=this._drawFirst,this._drawFirst.prev=d,this._drawFirst=d,this._requestRedraw(c)}}});function Fa(c){return et.canvas?new Zs(c):null}var xi=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(c){return document.createElement("<lvml:"+c+' class="lvml">')}}catch{}return function(c){return document.createElement("<"+c+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Tl={_initContainer:function(){this._container=jt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Vr.prototype._update.call(this),this.fire("update"))},_initPath:function(c){var d=c._container=xi("shape");Pt(d,"leaflet-vml-shape "+(this.options.className||"")),d.coordsize="1 1",c._path=xi("path"),d.appendChild(c._path),this._updateStyle(c),this._layers[X(c)]=c},_addPath:function(c){var d=c._container;this._container.appendChild(d),c.options.interactive&&c.addInteractiveTarget(d)},_removePath:function(c){var d=c._container;Kt(d),c.removeInteractiveTarget(d),delete this._layers[X(c)]},_updateStyle:function(c){var d=c._stroke,g=c._fill,m=c.options,v=c._container;v.stroked=!!m.stroke,v.filled=!!m.fill,m.stroke?(d||(d=c._stroke=xi("stroke")),v.appendChild(d),d.weight=m.weight+"px",d.color=m.color,d.opacity=m.opacity,d.dashStyle=m.dashArray?ze(m.dashArray)?m.dashArray.join(" "):m.dashArray.replace(/( *, *)/g," "):"",d.endcap=m.lineCap.replace("butt","flat"),d.joinstyle=m.lineJoin):d&&(v.removeChild(d),c._stroke=null),m.fill?(g||(g=c._fill=xi("fill")),v.appendChild(g),g.color=m.fillColor||m.color,g.opacity=m.fillOpacity):g&&(v.removeChild(g),c._fill=null)},_updateCircle:function(c){var d=c._point.round(),g=Math.round(c._radius),m=Math.round(c._radiusY||g);this._setPath(c,c._empty()?"M0 0":"AL "+d.x+","+d.y+" "+g+","+m+" 0,23592600")},_setPath:function(c,d){c._path.v=d},_bringToFront:function(c){Si(c._container)},_bringToBack:function(c){Ti(c._container)}},Vo=et.vml?xi:Mr,ho=Vr.extend({_initContainer:function(){this._container=Vo("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Vo("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Kt(this._container),Ut(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!this._map._animatingZoom||!this._bounds){Vr.prototype._update.call(this);var c=this._bounds,d=c.getSize(),g=this._container;(!this._svgSize||!this._svgSize.equals(d))&&(this._svgSize=d,g.setAttribute("width",d.x),g.setAttribute("height",d.y)),dn(g,c.min),g.setAttribute("viewBox",[c.min.x,c.min.y,d.x,d.y].join(" ")),this.fire("update")}},_initPath:function(c){var d=c._path=Vo("path");c.options.className&&Pt(d,c.options.className),c.options.interactive&&Pt(d,"leaflet-interactive"),this._updateStyle(c),this._layers[X(c)]=c},_addPath:function(c){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(c._path),c.addInteractiveTarget(c._path)},_removePath:function(c){Kt(c._path),c.removeInteractiveTarget(c._path),delete this._layers[X(c)]},_updatePath:function(c){c._project(),c._update()},_updateStyle:function(c){var d=c._path,g=c.options;d&&(g.stroke?(d.setAttribute("stroke",g.color),d.setAttribute("stroke-opacity",g.opacity),d.setAttribute("stroke-width",g.weight),d.setAttribute("stroke-linecap",g.lineCap),d.setAttribute("stroke-linejoin",g.lineJoin),g.dashArray?d.setAttribute("stroke-dasharray",g.dashArray):d.removeAttribute("stroke-dasharray"),g.dashOffset?d.setAttribute("stroke-dashoffset",g.dashOffset):d.removeAttribute("stroke-dashoffset")):d.setAttribute("stroke","none"),g.fill?(d.setAttribute("fill",g.fillColor||g.color),d.setAttribute("fill-opacity",g.fillOpacity),d.setAttribute("fill-rule",g.fillRule||"evenodd")):d.setAttribute("fill","none"))},_updatePoly:function(c,d){this._setPath(c,di(c._parts,d))},_updateCircle:function(c){var d=c._point,g=Math.max(Math.round(c._radius),1),v="a"+g+","+(Math.max(Math.round(c._radiusY),1)||g)+" 0 1,0 ",O=c._empty()?"M0 0":"M"+(d.x-g)+","+d.y+v+2*g+",0 "+v+2*-g+",0 ";this._setPath(c,O)},_setPath:function(c,d){c._path.setAttribute("d",d)},_bringToFront:function(c){Si(c._path)},_bringToBack:function(c){Ti(c._path)}});function Gi(c){return et.svg||et.vml?new ho(c):null}et.vml&&ho.include(Tl),Rt.include({getRenderer:function(c){var d=c.options.renderer||this._getPaneRenderer(c.options.pane)||this.options.renderer||this._renderer;return d||(d=this._renderer=this._createRenderer()),this.hasLayer(d)||this.addLayer(d),d},_getPaneRenderer:function(c){if("overlayPane"===c||void 0===c)return!1;var d=this._paneRenderers[c];return void 0===d&&(d=this._createRenderer({pane:c}),this._paneRenderers[c]=d),d},_createRenderer:function(c){return this.options.preferCanvas&&Fa(c)||Gi(c)}});var ei=Er.extend({initialize:function(c,d){Er.prototype.initialize.call(this,this._boundsToLatLngs(c),d)},setBounds:function(c){return this.setLatLngs(this._boundsToLatLngs(c))},_boundsToLatLngs:function(c){return[(c=qt(c)).getSouthWest(),c.getNorthWest(),c.getNorthEast(),c.getSouthEast()]}});ho.create=Vo,ho.pointsToPath=di,dt.geometryToLayer=pr,dt.coordsToLatLng=Uo,dt.coordsToLatLngs=Rn,dt.latLngToCoords=hi,dt.latLngsToCoords=Pr,dt.getFeature=Di,dt.asFeature=ji,Rt.mergeOptions({boxZoom:!0});var Qs=Fr.extend({initialize:function(c){this._map=c,this._container=c._container,this._pane=c._panes.overlayPane,this._resetStateTimeout=0,c.on("unload",this._destroy,this)},addHooks:function(){mt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ut(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Kt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(c){if(!c.shiftKey||1!==c.which&&1!==c.button)return!1;this._clearDeferredResetState(),this._resetState(),Gr(),ua(),this._startPoint=this._map.mouseEventToContainerPoint(c),mt(document,{contextmenu:pi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(c){this._moved||(this._moved=!0,this._box=jt("div","leaflet-zoom-box",this._container),Pt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(c);var d=new e(this._point,this._startPoint),g=d.getSize();dn(this._box,d.min),this._box.style.width=g.x+"px",this._box.style.height=g.y+"px"},_finish:function(){this._moved&&(Kt(this._box),cn(this._container,"leaflet-crosshair")),oo(),ga(),Ut(document,{contextmenu:pi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(c){if((1===c.which||1===c.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(B(this._resetState,this),0);var d=new Jt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(d).fire("boxzoomend",{boxZoomBounds:d})}},_onKeyDown:function(c){27===c.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Rt.addInitHook("addHandler","boxZoom",Qs),Rt.mergeOptions({doubleClickZoom:!0});var Yr=Fr.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(c){var d=this._map,g=d.getZoom(),m=d.options.zoomDelta,v=c.originalEvent.shiftKey?g-m:g+m;"center"===d.options.doubleClickZoom?d.setZoom(v):d.setZoomAround(c.containerPoint,v)}});Rt.addInitHook("addHandler","doubleClickZoom",Yr),Rt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Ea=Fr.extend({addHooks:function(){if(!this._draggable){var c=this._map;this._draggable=new Zr(c._mapPane,c._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),c.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),c.on("zoomend",this._onZoomEnd,this),c.whenReady(this._onZoomEnd,this))}Pt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){cn(this._map._container,"leaflet-grab"),cn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var c=this._map;if(c._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var d=qt(this._map.options.maxBounds);this._offsetLimit=Gt(this._map.latLngToContainerPoint(d.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(d.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;c.fire("movestart").fire("dragstart"),c.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(c){if(this._map.options.inertia){var d=this._lastTime=+new Date,g=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(g),this._times.push(d),this._prunePositions(d)}this._map.fire("move",c).fire("drag",c)},_prunePositions:function(c){for(;this._positions.length>1&&c-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var c=this._map.getSize().divideBy(2),d=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=d.subtract(c).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(c,d){return c-(c-d)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var c=this._draggable._newPos.subtract(this._draggable._startPos),d=this._offsetLimit;c.x<d.min.x&&(c.x=this._viscousLimit(c.x,d.min.x)),c.y<d.min.y&&(c.y=this._viscousLimit(c.y,d.min.y)),c.x>d.max.x&&(c.x=this._viscousLimit(c.x,d.max.x)),c.y>d.max.y&&(c.y=this._viscousLimit(c.y,d.max.y)),this._draggable._newPos=this._draggable._startPos.add(c)}},_onPreDragWrap:function(){var c=this._worldWidth,d=Math.round(c/2),g=this._initialWorldOffset,m=this._draggable._newPos.x,v=(m-d+g)%c+d-g,O=(m+d+g)%c-d-g,z=Math.abs(v+g)<Math.abs(O+g)?v:O;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=z},_onDragEnd:function(c){var d=this._map,g=d.options,m=!g.inertia||c.noInertia||this._times.length<2;if(d.fire("dragend",c),m)d.fire("moveend");else{this._prunePositions(+new Date);var v=this._lastPos.subtract(this._positions[0]),z=g.easeLinearity,J=v.multiplyBy(z/((this._lastTime-this._times[0])/1e3)),te=J.distanceTo([0,0]),be=Math.min(g.inertiaMaxSpeed,te),Ge=J.multiplyBy(be/te),st=be/(g.inertiaDeceleration*z),ut=Ge.multiplyBy(-st/2).round();ut.x||ut.y?(ut=d._limitOffset(ut,d.options.maxBounds),Ue(function(){d.panBy(ut,{duration:st,easeLinearity:z,noMoveStart:!0,animate:!0})})):d.fire("moveend")}}});Rt.addInitHook("addHandler","dragging",Ea),Rt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Js=Fr.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(c){this._map=c,this._setPanDelta(c.options.keyboardPanDelta),this._setZoomDelta(c.options.zoomDelta)},addHooks:function(){var c=this._map._container;c.tabIndex<=0&&(c.tabIndex="0"),mt(c,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ut(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var c=document.body,d=document.documentElement,g=c.scrollTop||d.scrollTop,m=c.scrollLeft||d.scrollLeft;this._map._container.focus(),window.scrollTo(m,g)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(c){var m,v,d=this._panKeys={},g=this.keyCodes;for(m=0,v=g.left.length;m<v;m++)d[g.left[m]]=[-1*c,0];for(m=0,v=g.right.length;m<v;m++)d[g.right[m]]=[c,0];for(m=0,v=g.down.length;m<v;m++)d[g.down[m]]=[0,c];for(m=0,v=g.up.length;m<v;m++)d[g.up[m]]=[0,-1*c]},_setZoomDelta:function(c){var m,v,d=this._zoomKeys={},g=this.keyCodes;for(m=0,v=g.zoomIn.length;m<v;m++)d[g.zoomIn[m]]=c;for(m=0,v=g.zoomOut.length;m<v;m++)d[g.zoomOut[m]]=-c},_addHooks:function(){mt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ut(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(c){if(!(c.altKey||c.ctrlKey||c.metaKey)){var m,d=c.keyCode,g=this._map;if(d in this._panKeys){if(!g._panAnim||!g._panAnim._inProgress)if(m=this._panKeys[d],c.shiftKey&&(m=Oe(m).multiplyBy(3)),g.options.maxBounds&&(m=g._limitOffset(Oe(m),g.options.maxBounds)),g.options.worldCopyJump){var v=g.wrapLatLng(g.unproject(g.project(g.getCenter()).add(m)));g.panTo(v)}else g.panBy(m)}else if(d in this._zoomKeys)g.setZoom(g.getZoom()+(c.shiftKey?3:1)*this._zoomKeys[d]);else{if(27!==d||!g._popup||!g._popup.options.closeOnEscapeKey)return;g.closePopup()}pi(c)}}});Rt.addInitHook("addHandler","keyboard",Js),Rt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Ks=Fr.extend({addHooks:function(){mt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ut(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(c){var d=Ts(c),g=this._map.options.wheelDebounceTime;this._delta+=d,this._lastMousePos=this._map.mouseEventToContainerPoint(c),this._startTime||(this._startTime=+new Date);var m=Math.max(g-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(B(this._performZoom,this),m),pi(c)},_performZoom:function(){var c=this._map,d=c.getZoom(),g=this._map.options.zoomSnap||0;c._stop();var v=4*Math.log(2/(1+Math.exp(-Math.abs(this._delta/(4*this._map.options.wheelPxPerZoomLevel)))))/Math.LN2,O=g?Math.ceil(v/g)*g:v,z=c._limitZoom(d+(this._delta>0?O:-O))-d;this._delta=0,this._startTime=null,z&&("center"===c.options.scrollWheelZoom?c.setZoom(d+z):c.setZoomAround(this._lastMousePos,d+z))}});Rt.addInitHook("addHandler","scrollWheelZoom",Ks);Rt.mergeOptions({tapHold:et.touchNative&&et.safari&&et.mobile,tapTolerance:15});var Sa=Fr.extend({addHooks:function(){mt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ut(this._map._container,"touchstart",this._onDown,this)},_onDown:function(c){if(clearTimeout(this._holdTimeout),1===c.touches.length){var d=c.touches[0];this._startPos=this._newPos=new fe(d.clientX,d.clientY),this._holdTimeout=setTimeout(B(function(){this._cancel(),this._isTapValid()&&(mt(document,"touchend",En),mt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",d))},this),600),mt(document,"touchend touchcancel contextmenu",this._cancel,this),mt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function c(){Ut(document,"touchend",En),Ut(document,"touchend touchcancel",c)},_cancel:function(){clearTimeout(this._holdTimeout),Ut(document,"touchend touchcancel contextmenu",this._cancel,this),Ut(document,"touchmove",this._onMove,this)},_onMove:function(c){var d=c.touches[0];this._newPos=new fe(d.clientX,d.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(c,d){var g=new MouseEvent(c,{bubbles:!0,cancelable:!0,view:window,screenX:d.screenX,screenY:d.screenY,clientX:d.clientX,clientY:d.clientY});g._simulated=!0,d.target.dispatchEvent(g)}});Rt.addInitHook("addHandler","tapHold",Sa),Rt.mergeOptions({touchZoom:et.touch,bounceAtZoomLimits:!0});var tc=Fr.extend({addHooks:function(){Pt(this._map._container,"leaflet-touch-zoom"),mt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){cn(this._map._container,"leaflet-touch-zoom"),Ut(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(c){var d=this._map;if(c.touches&&2===c.touches.length&&!d._animatingZoom&&!this._zooming){var g=d.mouseEventToContainerPoint(c.touches[0]),m=d.mouseEventToContainerPoint(c.touches[1]);this._centerPoint=d.getSize()._divideBy(2),this._startLatLng=d.containerPointToLatLng(this._centerPoint),"center"!==d.options.touchZoom&&(this._pinchStartLatLng=d.containerPointToLatLng(g.add(m)._divideBy(2))),this._startDist=g.distanceTo(m),this._startZoom=d.getZoom(),this._moved=!1,this._zooming=!0,d._stop(),mt(document,"touchmove",this._onTouchMove,this),mt(document,"touchend touchcancel",this._onTouchEnd,this),En(c)}},_onTouchMove:function(c){if(c.touches&&2===c.touches.length&&this._zooming){var d=this._map,g=d.mouseEventToContainerPoint(c.touches[0]),m=d.mouseEventToContainerPoint(c.touches[1]),v=g.distanceTo(m)/this._startDist;if(this._zoom=d.getScaleZoom(v,this._startZoom),!d.options.bounceAtZoomLimits&&(this._zoom<d.getMinZoom()&&v<1||this._zoom>d.getMaxZoom()&&v>1)&&(this._zoom=d._limitZoom(this._zoom)),"center"===d.options.touchZoom){if(this._center=this._startLatLng,1===v)return}else{var O=g._add(m)._divideBy(2)._subtract(this._centerPoint);if(1===v&&0===O.x&&0===O.y)return;this._center=d.unproject(d.project(this._pinchStartLatLng,this._zoom).subtract(O),this._zoom)}this._moved||(d._moveStart(!0,!1),this._moved=!0),Ae(this._animRequest);var z=B(d._move,d,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=Ue(z,this,!0),En(c)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,Ae(this._animRequest),Ut(document,"touchmove",this._onTouchMove,this),Ut(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});Rt.addInitHook("addHandler","touchZoom",tc),Rt.BoxZoom=Qs,Rt.DoubleClickZoom=Yr,Rt.Drag=Ea,Rt.Keyboard=Js,Rt.ScrollWheelZoom=Ks,Rt.TapHold=Sa,Rt.TouchZoom=tc,E.Bounds=e,E.Browser=et,E.CRS=gt,E.Canvas=Zs,E.Circle=Ys,E.CircleMarker=Ai,E.Class=Je,E.Control=vr,E.DivIcon=zo,E.DivOverlay=Sr,E.DomEvent=gl,E.DomUtil=dl,E.Draggable=Zr,E.Evented=Xe,E.FeatureGroup=ur,E.GeoJSON=dt,E.GridLayer=tt,E.Handler=Fr,E.Icon=Tn,E.ImageOverlay=Kr,E.LatLng=At,E.LatLngBounds=Jt,E.Layer=Sn,E.LayerGroup=Ri,E.LineUtil=yl,E.Map=Rt,E.Marker=go,E.Mixin=Cl,E.Path=gr,E.Point=fe,E.PolyUtil=vl,E.Polygon=Er,E.Polyline=er,E.Popup=fo,E.PosAnimation=Is,E.Projection=Ml,E.Rectangle=ei,E.Renderer=Vr,E.SVG=ho,E.SVGOverlay=po,E.TileLayer=$i,E.Tooltip=_i,E.Transformation=Jn,E.Util=xt,E.VideoOverlay=fr,E.bind=B,E.bounds=Gt,E.canvas=Fa,E.circle=function on(c,d,g){return new Ys(c,d,g)},E.circleMarker=function Nt(c,d){return new Ai(c,d)},E.control=lo,E.divIcon=function Sl(c){return new zo(c)},E.extend=b,E.featureGroup=function(c,d){return new ur(c,d)},E.geoJSON=Xs,E.geoJson=Nn,E.gridLayer=function Ws(c){return new tt(c)},E.icon=function Go(c){return new Tn(c)},E.imageOverlay=function(c,d,g){return new Kr(c,d,g)},E.latLng=at,E.latLngBounds=qt,E.layerGroup=function(c,d){return new Ri(c,d)},E.map=function pl(c,d){return new Rt(c,d)},E.marker=function Ni(c,d){return new go(c,d)},E.point=Oe,E.polygon=function tr(c,d){return new Er(c,d)},E.polyline=function Jr(c,d){return new er(c,d)},E.popup=function(c,d){return new fo(c,d)},E.rectangle=function Il(c,d){return new ei(c,d)},E.setOptions=Ce,E.stamp=X,E.svg=Gi,E.svgOverlay=function El(c,d,g){return new po(c,d,g)},E.tileLayer=mo,E.tooltip=function(c,d){return new _i(c,d)},E.transformation=cr,E.version="1.9.4",E.videoOverlay=function wa(c,d,g){return new fr(c,d,g)};var Rl=window.L;E.noConflict=function(){return window.L=Rl,this},window.L=E}(re)},8314:(Mt,re,E)=>{const b=E(2836),j=E(9460),B=E(7030),H=E(6511);function X(me,ae,Me,Ve,ge){const Ee=[].slice.call(arguments,1),Ce=Ee.length,_e="function"==typeof Ee[Ce-1];if(!_e&&!b())throw new Error("Callback required as last argument");if(!_e){if(Ce<1)throw new Error("Too few arguments provided");return 1===Ce?(Me=ae,ae=Ve=void 0):2===Ce&&!ae.getContext&&(Ve=Me,Me=ae,ae=void 0),new Promise(function(lt,$t){try{const ze=j.create(Me,Ve);lt(me(ze,ae,Ve))}catch(ze){$t(ze)}})}if(Ce<2)throw new Error("Too few arguments provided");2===Ce?(ge=Me,Me=ae,ae=Ve=void 0):3===Ce&&(ae.getContext&&typeof ge>"u"?(ge=Ve,Ve=void 0):(ge=Ve,Ve=Me,Me=ae,ae=void 0));try{const lt=j.create(Me,Ve);ge(null,me(lt,ae,Ve))}catch(lt){ge(lt)}}X.bind(null,B.render),re.dY=X.bind(null,B.renderToDataURL),X.bind(null,function(me,ae,Me){return H.render(me,Me)})},2836:Mt=>{Mt.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},6214:(Mt,re,E)=>{const D=E(9089).getSymbolSize;re.getRowColCoords=function(j){if(1===j)return[];const B=Math.floor(j/7)+2,H=D(j),X=145===H?26:2*Math.ceil((H-13)/(2*B-2)),me=[H-7];for(let ae=1;ae<B-1;ae++)me[ae]=me[ae-1]-X;return me.push(6),me.reverse()},re.getPositions=function(j){const B=[],H=re.getRowColCoords(j),X=H.length;for(let me=0;me<X;me++)for(let ae=0;ae<X;ae++)0===me&&0===ae||0===me&&ae===X-1||me===X-1&&0===ae||B.push([H[me],H[ae]]);return B}},1018:(Mt,re,E)=>{const D=E(1677),b=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function j(B){this.mode=D.ALPHANUMERIC,this.data=B}j.getBitsLength=function(H){return 11*Math.floor(H/2)+H%2*6},j.prototype.getLength=function(){return this.data.length},j.prototype.getBitsLength=function(){return j.getBitsLength(this.data.length)},j.prototype.write=function(H){let X;for(X=0;X+2<=this.data.length;X+=2){let me=45*b.indexOf(this.data[X]);me+=b.indexOf(this.data[X+1]),H.put(me,11)}this.data.length%2&&H.put(b.indexOf(this.data[X]),6)},Mt.exports=j},4662:Mt=>{function re(){this.buffer=[],this.length=0}re.prototype={get:function(E){const D=Math.floor(E/8);return 1==(this.buffer[D]>>>7-E%8&1)},put:function(E,D){for(let b=0;b<D;b++)this.putBit(1==(E>>>D-b-1&1))},getLengthInBits:function(){return this.length},putBit:function(E){const D=Math.floor(this.length/8);this.buffer.length<=D&&this.buffer.push(0),E&&(this.buffer[D]|=128>>>this.length%8),this.length++}},Mt.exports=re},5941:Mt=>{function re(E){if(!E||E<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=E,this.data=new Uint8Array(E*E),this.reservedBit=new Uint8Array(E*E)}re.prototype.set=function(E,D,b,j){const B=E*this.size+D;this.data[B]=b,j&&(this.reservedBit[B]=!0)},re.prototype.get=function(E,D){return this.data[E*this.size+D]},re.prototype.xor=function(E,D,b){this.data[E*this.size+D]^=b},re.prototype.isReserved=function(E,D){return this.reservedBit[E*this.size+D]},Mt.exports=re},4969:(Mt,re,E)=>{const D=E(1677);function b(j){this.mode=D.BYTE,this.data="string"==typeof j?(new TextEncoder).encode(j):new Uint8Array(j)}b.getBitsLength=function(B){return 8*B},b.prototype.getLength=function(){return this.data.length},b.prototype.getBitsLength=function(){return b.getBitsLength(this.data.length)},b.prototype.write=function(j){for(let B=0,H=this.data.length;B<H;B++)j.put(this.data[B],8)},Mt.exports=b},3677:(Mt,re,E)=>{const D=E(7424),b=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],j=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];re.getBlocksCount=function(H,X){switch(X){case D.L:return b[4*(H-1)+0];case D.M:return b[4*(H-1)+1];case D.Q:return b[4*(H-1)+2];case D.H:return b[4*(H-1)+3];default:return}},re.getTotalCodewordsCount=function(H,X){switch(X){case D.L:return j[4*(H-1)+0];case D.M:return j[4*(H-1)+1];case D.Q:return j[4*(H-1)+2];case D.H:return j[4*(H-1)+3];default:return}}},7424:(Mt,re)=>{re.L={bit:1},re.M={bit:0},re.Q={bit:3},re.H={bit:2},re.isValid=function(b){return b&&typeof b.bit<"u"&&b.bit>=0&&b.bit<4},re.from=function(b,j){if(re.isValid(b))return b;try{return function E(D){if("string"!=typeof D)throw new Error("Param is not a string");switch(D.toLowerCase()){case"l":case"low":return re.L;case"m":case"medium":return re.M;case"q":case"quartile":return re.Q;case"h":case"high":return re.H;default:throw new Error("Unknown EC Level: "+D)}}(b)}catch{return j}}},6269:(Mt,re,E)=>{const D=E(9089).getSymbolSize;re.getPositions=function(B){const H=D(B);return[[0,0],[H-7,0],[0,H-7]]}},6254:(Mt,re,E)=>{const D=E(9089),B=D.getBCHDigit(1335);re.getEncodedBits=function(X,me){const ae=X.bit<<3|me;let Me=ae<<10;for(;D.getBCHDigit(Me)-B>=0;)Me^=1335<<D.getBCHDigit(Me)-B;return 21522^(ae<<10|Me)}},6686:(Mt,re)=>{const E=new Uint8Array(512),D=new Uint8Array(256);(function(){let j=1;for(let B=0;B<255;B++)E[B]=j,D[j]=B,j<<=1,256&j&&(j^=285);for(let B=255;B<512;B++)E[B]=E[B-255]})(),re.log=function(j){if(j<1)throw new Error("log("+j+")");return D[j]},re.exp=function(j){return E[j]},re.mul=function(j,B){return 0===j||0===B?0:E[D[j]+D[B]]}},3264:(Mt,re,E)=>{const D=E(1677),b=E(9089);function j(B){this.mode=D.KANJI,this.data=B}j.getBitsLength=function(H){return 13*H},j.prototype.getLength=function(){return this.data.length},j.prototype.getBitsLength=function(){return j.getBitsLength(this.data.length)},j.prototype.write=function(B){let H;for(H=0;H<this.data.length;H++){let X=b.toSJIS(this.data[H]);if(X>=33088&&X<=40956)X-=33088;else{if(!(X>=57408&&X<=60351))throw new Error("Invalid SJIS character: "+this.data[H]+"\nMake sure your charset is UTF-8");X-=49472}X=192*(X>>>8&255)+(255&X),B.put(X,13)}},Mt.exports=j},3361:(Mt,re)=>{re.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};function D(b,j,B){switch(b){case re.Patterns.PATTERN000:return(j+B)%2==0;case re.Patterns.PATTERN001:return j%2==0;case re.Patterns.PATTERN010:return B%3==0;case re.Patterns.PATTERN011:return(j+B)%3==0;case re.Patterns.PATTERN100:return(Math.floor(j/2)+Math.floor(B/3))%2==0;case re.Patterns.PATTERN101:return j*B%2+j*B%3==0;case re.Patterns.PATTERN110:return(j*B%2+j*B%3)%2==0;case re.Patterns.PATTERN111:return(j*B%3+(j+B)%2)%2==0;default:throw new Error("bad maskPattern:"+b)}}re.isValid=function(j){return null!=j&&""!==j&&!isNaN(j)&&j>=0&&j<=7},re.from=function(j){return re.isValid(j)?parseInt(j,10):void 0},re.getPenaltyN1=function(j){const B=j.size;let H=0,X=0,me=0,ae=null,Me=null;for(let Ve=0;Ve<B;Ve++){X=me=0,ae=Me=null;for(let ge=0;ge<B;ge++){let Ee=j.get(Ve,ge);Ee===ae?X++:(X>=5&&(H+=X-5+3),ae=Ee,X=1),Ee=j.get(ge,Ve),Ee===Me?me++:(me>=5&&(H+=me-5+3),Me=Ee,me=1)}X>=5&&(H+=X-5+3),me>=5&&(H+=me-5+3)}return H},re.getPenaltyN2=function(j){const B=j.size;let H=0;for(let X=0;X<B-1;X++)for(let me=0;me<B-1;me++){const ae=j.get(X,me)+j.get(X,me+1)+j.get(X+1,me)+j.get(X+1,me+1);(4===ae||0===ae)&&H++}return 3*H},re.getPenaltyN3=function(j){const B=j.size;let H=0,X=0,me=0;for(let ae=0;ae<B;ae++){X=me=0;for(let Me=0;Me<B;Me++)X=X<<1&2047|j.get(ae,Me),Me>=10&&(1488===X||93===X)&&H++,me=me<<1&2047|j.get(Me,ae),Me>=10&&(1488===me||93===me)&&H++}return 40*H},re.getPenaltyN4=function(j){let B=0;const H=j.data.length;for(let me=0;me<H;me++)B+=j.data[me];return 10*Math.abs(Math.ceil(100*B/H/5)-10)},re.applyMask=function(j,B){const H=B.size;for(let X=0;X<H;X++)for(let me=0;me<H;me++)B.isReserved(me,X)||B.xor(me,X,D(j,me,X))},re.getBestMask=function(j,B){const H=Object.keys(re.Patterns).length;let X=0,me=1/0;for(let ae=0;ae<H;ae++){B(ae),re.applyMask(ae,j);const Me=re.getPenaltyN1(j)+re.getPenaltyN2(j)+re.getPenaltyN3(j)+re.getPenaltyN4(j);re.applyMask(ae,j),Me<me&&(me=Me,X=ae)}return X}},1677:(Mt,re,E)=>{const D=E(377),b=E(9359);re.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},re.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},re.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},re.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},re.MIXED={bit:-1},re.getCharCountIndicator=function(H,X){if(!H.ccBits)throw new Error("Invalid mode: "+H);if(!D.isValid(X))throw new Error("Invalid version: "+X);return X>=1&&X<10?H.ccBits[0]:X<27?H.ccBits[1]:H.ccBits[2]},re.getBestModeForData=function(H){return b.testNumeric(H)?re.NUMERIC:b.testAlphanumeric(H)?re.ALPHANUMERIC:b.testKanji(H)?re.KANJI:re.BYTE},re.toString=function(H){if(H&&H.id)return H.id;throw new Error("Invalid mode")},re.isValid=function(H){return H&&H.bit&&H.ccBits},re.from=function(H,X){if(re.isValid(H))return H;try{return function j(B){if("string"!=typeof B)throw new Error("Param is not a string");switch(B.toLowerCase()){case"numeric":return re.NUMERIC;case"alphanumeric":return re.ALPHANUMERIC;case"kanji":return re.KANJI;case"byte":return re.BYTE;default:throw new Error("Unknown mode: "+B)}}(H)}catch{return X}}},6628:(Mt,re,E)=>{const D=E(1677);function b(j){this.mode=D.NUMERIC,this.data=j.toString()}b.getBitsLength=function(B){return 10*Math.floor(B/3)+(B%3?B%3*3+1:0)},b.prototype.getLength=function(){return this.data.length},b.prototype.getBitsLength=function(){return b.getBitsLength(this.data.length)},b.prototype.write=function(B){let H,X,me;for(H=0;H+3<=this.data.length;H+=3)X=this.data.substr(H,3),me=parseInt(X,10),B.put(me,10);const ae=this.data.length-H;ae>0&&(X=this.data.substr(H),me=parseInt(X,10),B.put(me,3*ae+1))},Mt.exports=b},1744:(Mt,re,E)=>{const D=E(6686);re.mul=function(j,B){const H=new Uint8Array(j.length+B.length-1);for(let X=0;X<j.length;X++)for(let me=0;me<B.length;me++)H[X+me]^=D.mul(j[X],B[me]);return H},re.mod=function(j,B){let H=new Uint8Array(j);for(;H.length-B.length>=0;){const X=H[0];for(let ae=0;ae<B.length;ae++)H[ae]^=D.mul(B[ae],X);let me=0;for(;me<H.length&&0===H[me];)me++;H=H.slice(me)}return H},re.generateECPolynomial=function(j){let B=new Uint8Array([1]);for(let H=0;H<j;H++)B=re.mul(B,new Uint8Array([1,D.exp(H)]));return B}},9460:(Mt,re,E)=>{const D=E(9089),b=E(7424),j=E(4662),B=E(5941),H=E(6214),X=E(6269),me=E(3361),ae=E(3677),Me=E(6289),Ve=E(1252),ge=E(6254),Ee=E(1677),Ce=E(2868);function _t(Ze,it,Ue){const Ae=Ze.size,xt=ge.getEncodedBits(it,Ue);let Je,Ke;for(Je=0;Je<15;Je++)Ke=1==(xt>>Je&1),Ze.set(Je<6?Je:Je<8?Je+1:Ae-15+Je,8,Ke,!0),Ze.set(8,Je<8?Ae-Je-1:Je<9?15-Je-1+1:15-Je-1,Ke,!0);Ze.set(Ae-8,8,1,!0)}function Bt(Ze,it,Ue,Ae){let xt;if(Array.isArray(Ze))xt=Ce.fromArray(Ze);else{if("string"!=typeof Ze)throw new Error("Invalid data");{let fe=it;if(!fe){const _r=Ce.rawSplit(Ze);fe=Ve.getBestVersionForData(_r,Ue)}xt=Ce.fromString(Ze,fe||40)}}const Je=Ve.getBestVersionForData(xt,Ue);if(!Je)throw new Error("The amount of data is too big to be stored in a QR Code");if(it){if(it<Je)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+Je+".\n")}else it=Je;const Ke=function qe(Ze,it,Ue){const Ae=new j;Ue.forEach(function(Xe){Ae.put(Xe.mode.bit,4),Ae.put(Xe.getLength(),Ee.getCharCountIndicator(Xe.mode,Ze)),Xe.write(Ae)});const Ke=8*(D.getSymbolTotalCodewords(Ze)-ae.getTotalCodewordsCount(Ze,it));for(Ae.getLengthInBits()+4<=Ke&&Ae.put(0,4);Ae.getLengthInBits()%8!=0;)Ae.putBit(0);const rt=(Ke-Ae.getLengthInBits())/8;for(let Xe=0;Xe<rt;Xe++)Ae.put(Xe%2?17:236,8);return function Et(Ze,it,Ue){const Ae=D.getSymbolTotalCodewords(it),Je=Ae-ae.getTotalCodewordsCount(it,Ue),Ke=ae.getBlocksCount(it,Ue),Xe=Ke-Ae%Ke,fe=Math.floor(Ae/Ke),_r=Math.floor(Je/Ke),Oe=_r+1,e=fe-_r,Gt=new Me(e);let Jt=0;const qt=new Array(Ke),At=new Array(Ke);let at=0;const gt=new Uint8Array(Ze.buffer);for(let cr=0;cr<Ke;cr++){const li=cr<Xe?_r:Oe;qt[cr]=gt.slice(Jt,Jt+li),At[cr]=Gt.encode(qt[cr]),Jt+=li,at=Math.max(at,li)}const sr=new Uint8Array(Ae);let Qn,Jn,eo=0;for(Qn=0;Qn<at;Qn++)for(Jn=0;Jn<Ke;Jn++)Qn<qt[Jn].length&&(sr[eo++]=qt[Jn][Qn]);for(Qn=0;Qn<e;Qn++)for(Jn=0;Jn<Ke;Jn++)sr[eo++]=At[Jn][Qn];return sr}(Ae,Ze,it)}(it,Ue,xt),rt=D.getSymbolSize(it),Xe=new B(rt);return function _e(Ze,it){const Ue=Ze.size,Ae=X.getPositions(it);for(let xt=0;xt<Ae.length;xt++){const Je=Ae[xt][0],Ke=Ae[xt][1];for(let rt=-1;rt<=7;rt++)if(!(Je+rt<=-1||Ue<=Je+rt))for(let Xe=-1;Xe<=7;Xe++)Ke+Xe<=-1||Ue<=Ke+Xe||Ze.set(Je+rt,Ke+Xe,rt>=0&&rt<=6&&(0===Xe||6===Xe)||Xe>=0&&Xe<=6&&(0===rt||6===rt)||rt>=2&&rt<=4&&Xe>=2&&Xe<=4,!0)}}(Xe,it),function lt(Ze){const it=Ze.size;for(let Ue=8;Ue<it-8;Ue++){const Ae=Ue%2==0;Ze.set(Ue,6,Ae,!0),Ze.set(6,Ue,Ae,!0)}}(Xe),function $t(Ze,it){const Ue=H.getPositions(it);for(let Ae=0;Ae<Ue.length;Ae++){const xt=Ue[Ae][0],Je=Ue[Ae][1];for(let Ke=-2;Ke<=2;Ke++)for(let rt=-2;rt<=2;rt++)Ze.set(xt+Ke,Je+rt,-2===Ke||2===Ke||-2===rt||2===rt||0===Ke&&0===rt,!0)}}(Xe,it),_t(Xe,Ue,0),it>=7&&function ze(Ze,it){const Ue=Ze.size,Ae=Ve.getEncodedBits(it);let xt,Je,Ke;for(let rt=0;rt<18;rt++)xt=Math.floor(rt/3),Je=rt%3+Ue-8-3,Ke=1==(Ae>>rt&1),Ze.set(xt,Je,Ke,!0),Ze.set(Je,xt,Ke,!0)}(Xe,it),function Pe(Ze,it){const Ue=Ze.size;let Ae=-1,xt=Ue-1,Je=7,Ke=0;for(let rt=Ue-1;rt>0;rt-=2)for(6===rt&&rt--;;){for(let Xe=0;Xe<2;Xe++)if(!Ze.isReserved(xt,rt-Xe)){let fe=!1;Ke<it.length&&(fe=1==(it[Ke]>>>Je&1)),Ze.set(xt,rt-Xe,fe),Je--,-1===Je&&(Ke++,Je=7)}if(xt+=Ae,xt<0||Ue<=xt){xt-=Ae,Ae=-Ae;break}}}(Xe,Ke),isNaN(Ae)&&(Ae=me.getBestMask(Xe,_t.bind(null,Xe,Ue))),me.applyMask(Ae,Xe),_t(Xe,Ue,Ae),{modules:Xe,version:it,errorCorrectionLevel:Ue,maskPattern:Ae,segments:xt}}re.create=function(it,Ue){if(typeof it>"u"||""===it)throw new Error("No input text");let xt,Je,Ae=b.M;return typeof Ue<"u"&&(Ae=b.from(Ue.errorCorrectionLevel,b.M),xt=Ve.from(Ue.version),Je=me.from(Ue.maskPattern),Ue.toSJISFunc&&D.setToSJISFunction(Ue.toSJISFunc)),Bt(it,xt,Ae,Je)}},6289:(Mt,re,E)=>{const D=E(1744);function b(j){this.genPoly=void 0,this.degree=j,this.degree&&this.initialize(this.degree)}b.prototype.initialize=function(B){this.degree=B,this.genPoly=D.generateECPolynomial(this.degree)},b.prototype.encode=function(B){if(!this.genPoly)throw new Error("Encoder not initialized");const H=new Uint8Array(B.length+this.degree);H.set(B);const X=D.mod(H,this.genPoly),me=this.degree-X.length;if(me>0){const ae=new Uint8Array(this.degree);return ae.set(X,me),ae}return X},Mt.exports=b},9359:(Mt,re)=>{const E="[0-9]+";let b="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";b=b.replace(/u/g,"\\u");const j="(?:(?![A-Z0-9 $%*+\\-./:]|"+b+")(?:.|[\r\n]))+";re.KANJI=new RegExp(b,"g"),re.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),re.BYTE=new RegExp(j,"g"),re.NUMERIC=new RegExp(E,"g"),re.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");const B=new RegExp("^"+b+"$"),H=new RegExp("^"+E+"$"),X=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");re.testKanji=function(ae){return B.test(ae)},re.testNumeric=function(ae){return H.test(ae)},re.testAlphanumeric=function(ae){return X.test(ae)}},2868:(Mt,re,E)=>{const D=E(1677),b=E(6628),j=E(1018),B=E(4969),H=E(3264),X=E(9359),me=E(9089),ae=E(243);function Me(ze){return unescape(encodeURIComponent(ze)).length}function Ve(ze,_t,Pe){const qe=[];let Et;for(;null!==(Et=ze.exec(Pe));)qe.push({data:Et[0],index:Et.index,mode:_t,length:Et[0].length});return qe}function ge(ze){const _t=Ve(X.NUMERIC,D.NUMERIC,ze),Pe=Ve(X.ALPHANUMERIC,D.ALPHANUMERIC,ze);let qe,Et;return me.isKanjiModeEnabled()?(qe=Ve(X.BYTE,D.BYTE,ze),Et=Ve(X.KANJI,D.KANJI,ze)):(qe=Ve(X.BYTE_KANJI,D.BYTE,ze),Et=[]),_t.concat(Pe,qe,Et).sort(function(Ze,it){return Ze.index-it.index}).map(function(Ze){return{data:Ze.data,mode:Ze.mode,length:Ze.length}})}function Ee(ze,_t){switch(_t){case D.NUMERIC:return b.getBitsLength(ze);case D.ALPHANUMERIC:return j.getBitsLength(ze);case D.KANJI:return H.getBitsLength(ze);case D.BYTE:return B.getBitsLength(ze)}}function $t(ze,_t){let Pe;const qe=D.getBestModeForData(ze);if(Pe=D.from(_t,qe),Pe!==D.BYTE&&Pe.bit<qe.bit)throw new Error('"'+ze+'" cannot be encoded with mode '+D.toString(Pe)+".\n Suggested mode is: "+D.toString(qe));switch(Pe===D.KANJI&&!me.isKanjiModeEnabled()&&(Pe=D.BYTE),Pe){case D.NUMERIC:return new b(ze);case D.ALPHANUMERIC:return new j(ze);case D.KANJI:return new H(ze);case D.BYTE:return new B(ze)}}re.fromArray=function(_t){return _t.reduce(function(Pe,qe){return"string"==typeof qe?Pe.push($t(qe,null)):qe.data&&Pe.push($t(qe.data,qe.mode)),Pe},[])},re.fromString=function(_t,Pe){const Et=function _e(ze){const _t=[];for(let Pe=0;Pe<ze.length;Pe++){const qe=ze[Pe];switch(qe.mode){case D.NUMERIC:_t.push([qe,{data:qe.data,mode:D.ALPHANUMERIC,length:qe.length},{data:qe.data,mode:D.BYTE,length:qe.length}]);break;case D.ALPHANUMERIC:_t.push([qe,{data:qe.data,mode:D.BYTE,length:qe.length}]);break;case D.KANJI:_t.push([qe,{data:qe.data,mode:D.BYTE,length:Me(qe.data)}]);break;case D.BYTE:_t.push([{data:qe.data,mode:D.BYTE,length:Me(qe.data)}])}}return _t}(ge(_t,me.isKanjiModeEnabled())),Bt=function lt(ze,_t){const Pe={},qe={start:{}};let Et=["start"];for(let Bt=0;Bt<ze.length;Bt++){const Ze=ze[Bt],it=[];for(let Ue=0;Ue<Ze.length;Ue++){const Ae=Ze[Ue],xt=""+Bt+Ue;it.push(xt),Pe[xt]={node:Ae,lastCount:0},qe[xt]={};for(let Je=0;Je<Et.length;Je++){const Ke=Et[Je];Pe[Ke]&&Pe[Ke].node.mode===Ae.mode?(qe[Ke][xt]=Ee(Pe[Ke].lastCount+Ae.length,Ae.mode)-Ee(Pe[Ke].lastCount,Ae.mode),Pe[Ke].lastCount+=Ae.length):(Pe[Ke]&&(Pe[Ke].lastCount=Ae.length),qe[Ke][xt]=Ee(Ae.length,Ae.mode)+4+D.getCharCountIndicator(Ae.mode,_t))}}Et=it}for(let Bt=0;Bt<Et.length;Bt++)qe[Et[Bt]].end=0;return{map:qe,table:Pe}}(Et,Pe),Ze=ae.find_path(Bt.map,"start","end"),it=[];for(let Ue=1;Ue<Ze.length-1;Ue++)it.push(Bt.table[Ze[Ue]].node);return re.fromArray(function Ce(ze){return ze.reduce(function(_t,Pe){const qe=_t.length-1>=0?_t[_t.length-1]:null;return qe&&qe.mode===Pe.mode?(_t[_t.length-1].data+=Pe.data,_t):(_t.push(Pe),_t)},[])}(it))},re.rawSplit=function(_t){return re.fromArray(ge(_t,me.isKanjiModeEnabled()))}},9089:(Mt,re)=>{let E;const D=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];re.getSymbolSize=function(j){if(!j)throw new Error('"version" cannot be null or undefined');if(j<1||j>40)throw new Error('"version" should be in range from 1 to 40');return 4*j+17},re.getSymbolTotalCodewords=function(j){return D[j]},re.getBCHDigit=function(b){let j=0;for(;0!==b;)j++,b>>>=1;return j},re.setToSJISFunction=function(j){if("function"!=typeof j)throw new Error('"toSJISFunc" is not a valid function.');E=j},re.isKanjiModeEnabled=function(){return typeof E<"u"},re.toSJIS=function(j){return E(j)}},377:(Mt,re)=>{re.isValid=function(D){return!isNaN(D)&&D>=1&&D<=40}},1252:(Mt,re,E)=>{const D=E(9089),b=E(3677),j=E(7424),B=E(1677),H=E(377),me=D.getBCHDigit(7973);function Me(Ee,Ce){return B.getCharCountIndicator(Ee,Ce)+4}function Ve(Ee,Ce){let _e=0;return Ee.forEach(function(lt){const $t=Me(lt.mode,Ce);_e+=$t+lt.getBitsLength()}),_e}re.from=function(Ce,_e){return H.isValid(Ce)?parseInt(Ce,10):_e},re.getCapacity=function(Ce,_e,lt){if(!H.isValid(Ce))throw new Error("Invalid QR Code version");typeof lt>"u"&&(lt=B.BYTE);const _t=8*(D.getSymbolTotalCodewords(Ce)-b.getTotalCodewordsCount(Ce,_e));if(lt===B.MIXED)return _t;const Pe=_t-Me(lt,Ce);switch(lt){case B.NUMERIC:return Math.floor(Pe/10*3);case B.ALPHANUMERIC:return Math.floor(Pe/11*2);case B.KANJI:return Math.floor(Pe/13);default:return Math.floor(Pe/8)}},re.getBestVersionForData=function(Ce,_e){let lt;const $t=j.from(_e,j.M);if(Array.isArray(Ce)){if(Ce.length>1)return function ge(Ee,Ce){for(let _e=1;_e<=40;_e++)if(Ve(Ee,_e)<=re.getCapacity(_e,Ce,B.MIXED))return _e}(Ce,$t);if(0===Ce.length)return 1;lt=Ce[0]}else lt=Ce;return function ae(Ee,Ce,_e){for(let lt=1;lt<=40;lt++)if(Ce<=re.getCapacity(lt,_e,Ee))return lt}(lt.mode,lt.getLength(),$t)},re.getEncodedBits=function(Ce){if(!H.isValid(Ce)||Ce<7)throw new Error("Invalid QR Code version");let _e=Ce<<12;for(;D.getBCHDigit(_e)-me>=0;)_e^=7973<<D.getBCHDigit(_e)-me;return Ce<<12|_e}},7030:(Mt,re,E)=>{const D=E(7077);re.render=function(H,X,me){let ae=me,Me=X;typeof ae>"u"&&(!X||!X.getContext)&&(ae=X,X=void 0),X||(Me=function j(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}()),ae=D.getOptions(ae);const Ve=D.getImageWidth(H.modules.size,ae),ge=Me.getContext("2d"),Ee=ge.createImageData(Ve,Ve);return D.qrToImageData(Ee.data,H,ae),function b(B,H,X){B.clearRect(0,0,H.width,H.height),H.style||(H.style={}),H.height=X,H.width=X,H.style.height=X+"px",H.style.width=X+"px"}(ge,Me,Ve),ge.putImageData(Ee,0,0),Me},re.renderToDataURL=function(H,X,me){let ae=me;return typeof ae>"u"&&(!X||!X.getContext)&&(ae=X,X=void 0),ae||(ae={}),re.render(H,X,ae).toDataURL(ae.type||"image/png",(ae.rendererOpts||{}).quality)}},6511:(Mt,re,E)=>{const D=E(7077);function b(H,X){const me=H.a/255,ae=X+'="'+H.hex+'"';return me<1?ae+" "+X+'-opacity="'+me.toFixed(2).slice(1)+'"':ae}function j(H,X,me){let ae=H+X;return typeof me<"u"&&(ae+=" "+me),ae}re.render=function(X,me,ae){const Me=D.getOptions(me),Ve=X.modules.size,ge=X.modules.data,Ee=Ve+2*Me.margin,Ce=Me.color.light.a?"<path "+b(Me.color.light,"fill")+' d="M0 0h'+Ee+"v"+Ee+'H0z"/>':"",_e="<path "+b(Me.color.dark,"stroke")+' d="'+function B(H,X,me){let ae="",Me=0,Ve=!1,ge=0;for(let Ee=0;Ee<H.length;Ee++){const Ce=Math.floor(Ee%X),_e=Math.floor(Ee/X);!Ce&&!Ve&&(Ve=!0),H[Ee]?(ge++,Ee>0&&Ce>0&&H[Ee-1]||(ae+=Ve?j("M",Ce+me,.5+_e+me):j("m",Me,0),Me=0,Ve=!1),Ce+1<X&&H[Ee+1]||(ae+=j("h",ge),ge=0)):Me++}return ae}(ge,Ve,Me.margin)+'"/>',ze='<svg xmlns="http://www.w3.org/2000/svg" '+(Me.width?'width="'+Me.width+'" height="'+Me.width+'" ':"")+'viewBox="0 0 '+Ee+" "+Ee+'" shape-rendering="crispEdges">'+Ce+_e+"</svg>\n";return"function"==typeof ae&&ae(null,ze),ze}},7077:(Mt,re)=>{function E(D){if("number"==typeof D&&(D=D.toString()),"string"!=typeof D)throw new Error("Color should be defined as hex string");let b=D.slice().replace("#","").split("");if(b.length<3||5===b.length||b.length>8)throw new Error("Invalid hex color: "+D);(3===b.length||4===b.length)&&(b=Array.prototype.concat.apply([],b.map(function(B){return[B,B]}))),6===b.length&&b.push("F","F");const j=parseInt(b.join(""),16);return{r:j>>24&255,g:j>>16&255,b:j>>8&255,a:255&j,hex:"#"+b.slice(0,6).join("")}}re.getOptions=function(b){b||(b={}),b.color||(b.color={});const B=b.width&&b.width>=21?b.width:void 0;return{width:B,scale:B?4:b.scale||4,margin:typeof b.margin>"u"||null===b.margin||b.margin<0?4:b.margin,color:{dark:E(b.color.dark||"#000000ff"),light:E(b.color.light||"#ffffffff")},type:b.type,rendererOpts:b.rendererOpts||{}}},re.getScale=function(b,j){return j.width&&j.width>=b+2*j.margin?j.width/(b+2*j.margin):j.scale},re.getImageWidth=function(b,j){const B=re.getScale(b,j);return Math.floor((b+2*j.margin)*B)},re.qrToImageData=function(b,j,B){const H=j.modules.size,X=j.modules.data,me=re.getScale(H,B),ae=Math.floor((H+2*B.margin)*me),Me=B.margin*me,Ve=[B.color.light,B.color.dark];for(let ge=0;ge<ae;ge++)for(let Ee=0;Ee<ae;Ee++){let Ce=4*(ge*ae+Ee),_e=B.color.light;ge>=Me&&Ee>=Me&&ge<ae-Me&&Ee<ae-Me&&(_e=Ve[X[Math.floor((ge-Me)/me)*H+Math.floor((Ee-Me)/me)]?1:0]),b[Ce++]=_e.r,b[Ce++]=_e.g,b[Ce++]=_e.b,b[Ce]=_e.a}}}}]);