<div class="bulk-price-dialog">
  <h2 mat-dialog-title>Bulk Price Update</h2>
  
  <div mat-dialog-content class="dialog-content">
    <p class="selected-count">
      <mat-icon>inventory</mat-icon>
      Update prices for {{ data.products.length }} selected products
    </p>
    
    <form [formGroup]="bulkUpdateForm" class="update-form">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Update Type</mat-label>
        <mat-select formControlName="priceType">
          <mat-option value="fixed">Set Fixed Price</mat-option>
          <mat-option value="percentage">Percentage Increase/Decrease</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field 
        appearance="outline" 
        class="full-width" 
        *ngIf="bulkUpdateForm.get('priceType')?.value === 'fixed'">
        <mat-label>New Price (₹)</mat-label>
        <input matInput type="number" formControlName="newPrice" placeholder="Enter new price">
        <span matPrefix>₹&nbsp;</span>
      </mat-form-field>

      <mat-form-field 
        appearance="outline" 
        class="full-width" 
        *ngIf="bulkUpdateForm.get('priceType')?.value === 'percentage'">
        <mat-label>Percentage Change</mat-label>
        <input matInput type="number" formControlName="percentage" placeholder="Enter percentage (+ or -)">
        <span matSuffix>%</span>
        <mat-hint>Enter positive for increase, negative for decrease (e.g., 10 or -5)</mat-hint>
      </mat-form-field>
    </form>

    <!-- Preview Section -->
    <div class="preview-section" *ngIf="bulkUpdateForm.valid">
      <h3>Preview (First 3 products)</h3>
      <div class="preview-list">
        <div class="preview-item" *ngFor="let product of data.products.slice(0, 3)">
          <div class="product-info">
            <span class="product-name">{{ product.customName }}</span>
            <div class="price-comparison">
              <span class="current-price">₹{{ product.price | number:'1.0-0' }}</span>
              <mat-icon>arrow_forward</mat-icon>
              <span class="new-price">₹{{ getPreviewPrice(product.price) | number:'1.0-0' }}</span>
            </div>
          </div>
        </div>
        <div class="more-indicator" *ngIf="data.products.length > 3">
          <span>...and {{ data.products.length - 3 }} more products</span>
        </div>
      </div>
    </div>

    <div class="warning-message" *ngIf="data.usingFallbackData">
      <mat-icon>info</mat-icon>
      <span>Demo mode: Changes will be applied locally only</span>
    </div>
  </div>

  <div mat-dialog-actions align="end">
    <button mat-button (click)="onCancel()">Cancel</button>
    <button mat-raised-button color="primary" 
            [disabled]="!bulkUpdateForm.valid" 
            (click)="onUpdate()">
      Update Prices
    </button>
  </div>
</div>