<div class="promo-container">
  <div class="page-header">
    <div class="header-left">
      <h1>
        <mat-icon>local_offer</mat-icon>
        Promo Codes
      </h1>
      <p class="subtitle">Create and manage promotions for your shop</p>
    </div>
    <div class="header-actions">
      <button mat-raised-button color="primary" (click)="openCreateDialog()">
        <mat-icon>add</mat-icon>
        Create Promo
      </button>
    </div>
  </div>

  <mat-card class="promo-card">
    <div class="loading-spinner" *ngIf="isLoading">
      <mat-spinner diameter="40"></mat-spinner>
    </div>

    <div class="empty-state" *ngIf="!isLoading && promoCodes.length === 0">
      <mat-icon class="empty-icon">local_offer</mat-icon>
      <h3>No Promo Codes Yet</h3>
      <p>Create your first promo code to attract more customers!</p>
      <button mat-raised-button color="primary" (click)="openCreateDialog()">
        <mat-icon>add</mat-icon>
        Create Your First Promo
      </button>
    </div>

    <div class="promo-grid" *ngIf="!isLoading && promoCodes.length > 0">
      <div class="promo-item" *ngFor="let promo of promoCodes" [ngClass]="getStatusClass(promo)">
        <!-- Banner Image -->
        <div class="promo-banner" *ngIf="promo.imageUrl">
          <img [src]="getImageUrl(promo.imageUrl)" alt="Promo banner">
        </div>
        <div class="promo-banner default-banner" *ngIf="!promo.imageUrl">
          <mat-icon>local_offer</mat-icon>
        </div>

        <!-- Action Buttons -->
        <div class="promo-actions">
          <button mat-icon-button matTooltip="Edit" (click)="openEditDialog(promo)">
            <mat-icon>edit</mat-icon>
          </button>
          <button mat-icon-button [matTooltip]="promo.status === 'ACTIVE' ? 'Deactivate' : 'Activate'"
                  (click)="toggleStatus(promo)" *ngIf="!isExpired(promo)">
            <mat-icon>{{ promo.status === 'ACTIVE' ? 'pause' : 'play_arrow' }}</mat-icon>
          </button>
          <button mat-icon-button matTooltip="Delete" color="warn" (click)="deletePromo(promo)">
            <mat-icon>delete</mat-icon>
          </button>
        </div>

        <!-- Content -->
        <div class="promo-content">
          <div class="promo-header">
            <span class="discount-badge">{{ getDiscountText(promo) }}</span>
            <span class="status-badge" [ngClass]="getStatusClass(promo)">{{ getStatusText(promo) }}</span>
          </div>

          <h3 class="promo-title">{{ promo.title }}</h3>
          <p class="promo-description" *ngIf="promo.description">{{ promo.description }}</p>

          <div class="promo-code-box" (click)="copyCode(promo.code)">
            <span class="code">{{ promo.code }}</span>
            <mat-icon matTooltip="Click to copy">content_copy</mat-icon>
          </div>

          <div class="promo-details">
            <div class="detail-item">
              <mat-icon>shopping_cart</mat-icon>
              <span>{{ getMinOrderText(promo) }}</span>
            </div>
            <div class="detail-item">
              <mat-icon>event</mat-icon>
              <span>{{ promo.startDate | date:'dd MMM' }} - {{ promo.endDate | date:'dd MMM yyyy' }}</span>
            </div>
            <div class="detail-item" *ngIf="promo.usageLimit">
              <mat-icon>people</mat-icon>
              <span>{{ promo.usageCount || 0 }}/{{ promo.usageLimit }} used</span>
            </div>
          </div>

          <div class="promo-tags">
            <span class="tag" *ngIf="promo.firstTimeOnly">
              <mat-icon>person_add</mat-icon> First-time only
            </span>
            <span class="tag" *ngIf="promo.maximumDiscountAmount">
              Max: â‚¹{{ promo.maximumDiscountAmount }}
            </span>
          </div>
        </div>
      </div>
    </div>
  </mat-card>
</div>
