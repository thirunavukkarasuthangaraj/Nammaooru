<div class="shopping-cart-page">
  <!-- Page Header -->
  <mat-card class="page-header">
    <div class="header-container">
      <button mat-stroked-button color="primary" class="back-button" (click)="goBack()">
        <mat-icon>arrow_back</mat-icon>
        Continue Shopping
      </button>
      <div class="header-title">
        <mat-icon class="cart-icon">shopping_cart</mat-icon>
        <h1>Your Shopping Cart</h1>
        <span class="item-count" *ngIf="cartItems.length > 0">({{cartItems.length}} items)</span>
      </div>
    </div>
  </mat-card>

  <!-- Main Content -->
  <div class="cart-main-content">
    
    <!-- Empty Cart State -->
    <div class="empty-cart-container" *ngIf="cartItems.length === 0">
      <mat-card class="empty-cart-card">
        <mat-icon class="empty-icon">remove_shopping_cart</mat-icon>
        <h2>Your cart is empty</h2>
        <p>Looks like you haven't added anything to your cart yet</p>
        <button mat-raised-button color="primary" (click)="goToShops()">
          <mat-icon>store</mat-icon>
          Start Shopping
        </button>
      </mat-card>
    </div>

    <!-- Cart Content -->
    <div class="cart-content-grid" *ngIf="cartItems.length > 0">
      
      <!-- Left Column: Cart Items -->
      <div class="cart-items-column">
        
        <!-- Shop Info -->
        <mat-card class="shop-info-banner" *ngIf="cart.shopName">
          <mat-icon class="shop-icon">storefront</mat-icon>
          <div class="shop-details">
            <h3>{{cart.shopName}}</h3>
            <p>Delivery in 30-45 minutes</p>
          </div>
        </mat-card>

        <!-- Cart Items List -->
        <mat-card class="cart-items-card">
          <mat-card-header>
            <mat-card-title>Cart Items</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <div class="cart-item" *ngFor="let item of cartItems; let last = last">
              <div class="item-image">
                <img [src]="item.productImage || '/assets/images/product-placeholder.svg'" 
                     [alt]="item.productName">
              </div>
              
              <div class="item-details">
                <h4 class="item-name">{{item.productName}}</h4>
                <p class="item-shop">{{item.shopName}}</p>
                <span class="item-unit">{{item.unit}}</span>
              </div>
              
              <div class="item-price">
                <span class="price">₹{{item.price}}</span>
                <span class="unit">/{{item.unit}}</span>
              </div>
              
              <div class="item-quantity">
                <button mat-icon-button color="primary" (click)="decreaseQuantity(item)">
                  <mat-icon>remove_circle_outline</mat-icon>
                </button>
                <span class="quantity-value">{{item.quantity}}</span>
                <button mat-icon-button color="primary" (click)="increaseQuantity(item)">
                  <mat-icon>add_circle_outline</mat-icon>
                </button>
              </div>
              
              <div class="item-subtotal">
                <span class="subtotal-label">Subtotal</span>
                <span class="subtotal-value">₹{{item.price * item.quantity}}</span>
              </div>
              
              <div class="item-remove">
                <button mat-icon-button color="warn" (click)="removeItem(item)">
                  <mat-icon>delete_outline</mat-icon>
                </button>
              </div>
            </div>
          </mat-card-content>
          
          <mat-card-actions>
            <button mat-button color="warn" (click)="clearCart()">
              <mat-icon>delete_sweep</mat-icon>
              Clear Cart
            </button>
            <button mat-button (click)="goToShops()">
              <mat-icon>add_circle_outline</mat-icon>
              Add More Items
            </button>
          </mat-card-actions>
        </mat-card>
      </div>

      <!-- Right Column: Order Summary -->
      <div class="order-summary-column">
        
        <!-- Order Summary Card -->
        <mat-card class="order-summary-card">
          <mat-card-header>
            <mat-card-title>Order Summary</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            
            <!-- Price Breakdown -->
            <div class="price-breakdown">
              <div class="price-row">
                <span class="label">Items Subtotal:</span>
                <span class="value">₹{{cart.subtotal}}</span>
              </div>
              <div class="price-row">
                <span class="label">Delivery Fee:</span>
                <span class="value">₹{{cart.deliveryFee || 40}}</span>
              </div>
              <div class="price-row discount" *ngIf="cart.discount > 0">
                <span class="label">Discount:</span>
                <span class="value">-₹{{cart.discount}}</span>
              </div>
            </div>
            
            <mat-divider></mat-divider>
            
            <div class="total-section">
              <span class="total-label">Total Amount:</span>
              <span class="total-value">₹{{cart.total || cart.subtotal + (cart.deliveryFee || 40)}}</span>
            </div>

            <!-- Discount Code Section -->
            <div class="discount-section" *ngIf="!discountApplied">
              <mat-form-field appearance="outline" class="discount-field">
                <mat-label>Have a discount code?</mat-label>
                <input matInput [(ngModel)]="discountCode" placeholder="Enter code">
                <button mat-icon-button matSuffix color="primary" 
                        (click)="applyDiscount()" 
                        [disabled]="!discountCode">
                  <mat-icon>local_offer</mat-icon>
                </button>
              </mat-form-field>
            </div>

            <div class="discount-success" *ngIf="discountApplied">
              <mat-icon>check_circle</mat-icon>
              <span>Discount applied successfully!</span>
            </div>

            <!-- Checkout Button -->
            <button mat-raised-button 
                    color="accent" 
                    class="checkout-button"
                    (click)="proceedToCheckout()"
                    [disabled]="cartItems.length === 0">
              <mat-icon>shopping_cart_checkout</mat-icon>
              Proceed to Checkout
            </button>

            <!-- Payment Info -->
            <div class="payment-info">
              <mat-icon>payments</mat-icon>
              <div>
                <strong>Payment Method</strong>
                <p>Cash on Delivery Available</p>
              </div>
            </div>
          </mat-card-content>
        </mat-card>

        <!-- Delivery Info Card -->
        <mat-card class="delivery-info-card">
          <mat-card-content>
            <h4>
              <mat-icon>local_shipping</mat-icon>
              Delivery Information
            </h4>
            <div class="info-item">
              <mat-icon>schedule</mat-icon>
              <span>Estimated: 30-45 minutes</span>
            </div>
            <div class="info-item">
              <mat-icon>local_offer</mat-icon>
              <span>Free delivery above ₹500</span>
            </div>
            <div class="info-item">
              <mat-icon>support_agent</mat-icon>
              <span>Support: +91 98765 43210</span>
            </div>
          </mat-card-content>
        </mat-card>
      </div>
    </div>
  </div>
</div>